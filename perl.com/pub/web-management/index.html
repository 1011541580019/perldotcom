<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" id="sixapart-standard">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="generator" content="Movable Type Pro 5.02" />
<link rel="stylesheet" href="/pub/styles.css" type="text/css" />
<link rel="start" href="/pub/" title="Home" />
<link rel="alternate" type="application/atom+xml" title="Recent Entries" href="/pub/atom.xml" />
<script type="text/javascript" src="/pub/mt.js"></script>

<script type="text/javascript">

 var _gaq = _gaq || [];
 _gaq.push(['_setAccount', 'UA-50555-22']);
 _gaq.push(['_trackPageview']);

 (function() {
   var ga = document.createElement('script'); ga.type =
   'text/javascript'; ga.async = true;
   ga.src = ('https:' == document.location.protocol ? 'https://ssl' :
   'http://www') + '.google-analytics.com/ga.js';
   var s = document.getElementsByTagName('script')[0];
   s.parentNode.insertBefore(ga, s);
 })();

</script>
    <title>Perl.com: Web Management Archives</title>


</head>
<body id="perl-com" class="mt-archive-listing mt-category-archive layout-wt">
    <div id="container">
        <div id="container-inner">


            <div id="header">
    <div id="header-inner">
        <div id="header-content">
        <div id="top_advert"> 
<!-- Put any landscape advert in here -->
<a href="http://www.perlfoundation.org/" target="_new">
<img src="/i/tpf_banner.png" width="468" height="60" /></a>
        </div> 



            <div id="header-name"><a href="/pub/" accesskey="1">Perl.com</a></div>
            <div id="header-description"></div>




        </div>
    </div>
</div>



            <div id="content">
                <div id="content-inner">


                    <div id="alpha">
                        <div id="alpha-inner">

                            
                            <h1 id="page-title" class="archive-title">Recently in <em>Web Management</em> Category</h1>






                            
                            <div id="entry-710" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2005/01/bricolage-configuration.html" rel="bookmark">Bricolage Configuration Directives</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">David Wheeler</span> on <abbr class="published" title="2005-01-06T00:00:00-08:00">January  6, 2005 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            
<!-- sidebar begins -->
<!-- don't move sidebars -->
<!-- sidebar ends -->
<br clear="all" />
<p>In my previous article, I provided <a
href="/pub/a/2004/10/28/bricolage_installation.html"
title="Installing Bricolage">a guided tour of the Bricolage installation
process</a>.  If you followed along, you should now have a nice, functioning
installation of Bricolage 1.8 all ready to go. But as <a
href="http://www.com-www.com/weirdal/mrpopeil.html" title="Mr. Popeil">Mr.
Popeil</a> used to say, <em>"But wait, there's more!"</em></p>

<p>Like many other applications, Bricolage comes with a runtime configuration
file. This file, named <em>bricolage.conf</em>, lives in the <em>conf</em>
subdirectory of your Bricolage root. It contains a list of settings that tell
Bricolage how to find things, how to connect to the database, which optional
features to include, and other good stuff. This article provides a guided tour
of all of the configuration settings in <em>bricolage.conf</em> to enable you
to configure things exactly the way you need them, so that you can manage your
sites more effectively with Bricolage.</p>

<h3><a id="configurationformat">Configuration Format</a></h3>

<p>The format of <em>bricolage.conf</em>, derived from the <a
href="http://www.oreilly.com/catalog/cookbook/" title="Perl Cookbook in the
O'Reilly Catalog"><q>Perl Cookbook</q></a>, is quite simple. A directive
appears on a single line, followed by a space, an equal sign, and then the
value. Anything after a pound sign (<q>#</q>) is a comment. Typical entries
look like this:</p>

<pre><code>APACHE_BIN   = /usr/local/apache/bin/httpd
APACHE_CONF  = /usr/local/bricolage/conf/httpd.conf
LISTEN_PORT  = 80
SSL_PORT     = 443
SSL_ENABLE   = No</code></pre>

<p>Most <em>bricolage.conf</em> configuration options are one of two types:
Boolean values or strings. A Boolean configuration directive can be either
enabled or disabled, but you have several ways in which to do so.  To enable a
Boolean directive, simply set its value to <q>Yes</q>, <q>On</q>, or <q>1</q>
(the number one). To disable it, set it to <q>No</q>, <q>Off</q>, or <q>0</q>
(zero). String values follow the equal sign. They can be as long as necessary,
but cannot break across lines.</p>

<h3><a id="apacheconfiguration">Apache Configuration</a></h3>



<p>The first section of <em>bricolage.conf</em> configures Bricolage to use the
Apache web server. Because Bricolage runs on top of Apache but uses its own
startup scripts, it needs to know where to find Apache resources so that it can
configure and start Apache properly. Bricolage's default method of dynamically
configuring Apache therefore relies on these directives. The installation sets
many of them for you, but not all, so it's worth it to have a look to see if
you need to tweak any of them:</p>

<dl>
<dt><a id="apachebin"><code>APACHE_BIN</code></a></dt>
<dd>
<p>This directive tells Bricolage where to find your Apache
<em>httpd</em> executable, which it uses to start itself up.</p>

</dd>
<dt><a id="apachecon"><code>APACHE_CON</code></a></dt>
<dd>

<p>This directive points to the <em>httpd.conf</em> file. This, of course, is
the famous Apache configuration file. It, too, needs configuration to run
Bricolage (the Bricolage installer configures the default <em>httpd.conf</em>
in the <em>conf</em> subdirectory of your Bricolage root directory), and
Bricolage, in turn, uses this directive to tell <em>httpd</em> where to find
the configuration file when it starts up.</p>

</dd>
<dt><a id="listenport"><code>LISTEN_PORT</code></a></dt>
<dd>

<p>This is the TCP/IP port on which Bricolage will listen for requests. It uses
the HTTP standard port 80 by default, but you can <a
href="http://www.bricolage.cc/docs/howtos/2004/04/19/virtual_host_config/"
title="How to run Bricolage on a Virtual Host and on Non-Standard Ports">change
Bricolage to use another port</a> if you already have another server listening
on port 80.</p>

</dd>
<dt><a id="sslport"><code>SSL_PORT</code></a></dt>
<dd>

<p>This is the TCP/IP port on which Bricolage will listen for secure sockets
layer (SSL) requests. It defaults to the standard HTTP SSL port 443, but again,
you can change it to another port if something else is already using port 443.
SSL is disabled by default, however, so read on for details on how to turn it
on.</p>

</dd>
<dt><a id="sslenable"><code>SSL_ENABLE</code></a></dt>
<dd>

<p>This directive turns on SSL support. You must have either
<code>mod_ssl</code> or Apache-SSL installed and properly configured in your
Apache server. Not quite a Boolean configuration directive, the possible values
for <code>SSL_ENABEL</code> are <q>No</q> (or <q>Off</q> or <q>0</q> [zero]),
<q>mod_ssl</q>, or <q>apache-ssl</q>. SSL is a useful feature for keeping
communications encrypted between the server and users' browsers.</p>

</dd>
<dt><a id="alwaysusessl"><code>ALWAYS_USE_SSL</code></a></dt>
<dd>

<p>By default, an SSL-enabled Bricolage installation uses SSL only for logging
in to Bricolage and in the user profile (where users can change their
passwords). Users can elect to encrypt all communications by checking the
<q>Always use SSL</q> checkbox when logging in, but some security policies may
require the encryption of <em>all</em> communications. In such cases, enable
this Boolean directive to force the encryption of <em>all</em> communications
between the Bricolage server and users' browsers.</p>

</dd>
<dt><a id="sslcertificatekeyfile"><code>SSL_CERTIFICATE_KEY_FILE</code></a></dt>
<dt><a id="sslcertificatefile"><code>SSL_CERTIFICATE_FILE</code></a></dt>
<dd>

<p>These directives specify the location of your SSL keys. If you've configured
<code>mod_ssl</code> or Apache-SSL, you should already be familiar with these
files. They help to encrypt and decrypt requests between the server and the
browser. If you use <code>make certificate</code> to generate your SSL
certificate during the Apache build process, by default your server key file
will be <em>server.key</em> in the <em>conf/ssl.key</em> subdirectory of your
Apache root directory, while the server public key file will be
<em>server.crt</em> and in the <em>conf/ssl.crt</em> subdirectory. Bricolage
uses these directives to set the Apache <code>SSLCertificateKeyFile</code> and
<code>SSLCertificateFile</code> directives, respectively, in its dynamic
configuration of Apache.</p>

</dd>
<dt><a id="namevhost"><code>NAME_VHOST</code></a></dt>
<dd>

<p>This directive roughly corresponds to the Apache <em>httpd.conf</em>
<code>NameVirtualHost</code> directive. Set it to the IP address on which the
Bricolage Apache server will listen for requests. If you have only one IP
address on your server, the simplest thing to do is to leave this directive set
to <q>*</q>, which applies to all IP addresses. Again, Bricolage uses this
directive in its dynamic configuration of Apache.</p>

</dd>
<dt><a id="vhostservername"><code>VHOST_SERVER_NAME</code></a></dt>
<dd>

<p>This is the virtual host name under which to run Bricolage.  Bricolage
requires a full host or virtual host to run and will use this directive to
configure the virtual host dynamically. Leave it set to <q>_default_</q> to use
the default host name set in your <em>httpd.conf</em> file.</p>

</dd>
<dt><a id="manualapache"><code>MANUAL_APACHE</code></a></dt>
<dd>

<!-- prod: intertextual link here; please verify across pages -->

<p>Bricolage uses Apache::ReadConfig to configure the httpd daemon.  There is
no <em>httpd.conf</em> include file. If you want to take control of your
Bricolage Apache server by manually configuring it, enable this Boolean
directive. It will generate a file, <em>bric_httpd.conf</em>, in the
<em>bricolage</em> subdirectory of your temporary directory (see the <a
href="#tempdir">TEMP_DIR</a> directive for the location of the temporary
directory). This file will contain all of the Apache configuration directives
that Bricolage uses to configure Apache dynamically. Restarting Bricolage will
rewrite this file, but if you want to use it and edit it manually, copy it to
the <em>conf</em> subdirectory of your Bricolage root directory, disable the
<code>MANUAL_APACHE</code> directive, and then change the section of the
<em>httpd.conf</em> file that configures Bricolage from:</p>

<pre><code>PerlPassEnv BRICOLAGE_ROOT
PerlModule Bric::App::ApacheConfig</code></pre>

<p>To:</p>

<pre><code>Include /usr/local/bricolage/conf/bric_httpd.conf
PerlPassEnv BRICOLAGE_ROOT
PerlModule Bric::App::ApacheStartup</code></pre>

<p>Here <em>/usr/local/bricolage/conf/bric_httpd.conf</em> is the full path
name to the newly generated <em>bric_httpd.conf</em> file. You can now tweak
this file to your heart's content. Just be sure to generate a new one after
each upgrade of Bricolage, as certain directives may change between
releases.</p>

</dd>
<dt><a id="sysuser"><code>SYS_USER</code></a></dt>
<dt><a id="sysgroup"><code>SYS_GROUP</code></a></dt>
<dd>

<p>These directives configure the system user and group used by Bricolage. They
should contain the same value as the <code>User</code> and <code>Group</code>
<em>httpd.conf</em> directives, usually <q>nobody</q> or <q>www</q>. Any files
written to the file system by Bricolage will be owned by this user and
group.</p>

</dd>
</dl>
<h3><a id="databaseconfiguration">Database Configuration</a></h3>

<p>The next major section of the Bricolage configuration file configures the
database. Bricolage uses PostgreSQL 7.3 or later for its data store. Connecting
to that database requires several attributes, not least of which are the
username and password.  These are all set during installation, but it's worth
being familiar with them in case things change down the line.</p>

<dl>
<dt><a id="dbname"><code>DB_NAME</code></a></dt>
<dd>

<p>The name of the database that stores Bricolage's data. The installer will
set this for you. The default value, <q>bric</q>, works well in most
situations, but it might be set to a different name if you entered one during
installation, perhaps because you already had another database named
<q>bric</q>; Why would you want to do that? Perhaps you have multiple Bricolage
installations on the same host. Another reason it might be different is that
your ISP provides you with a single database that they name according to their
own naming conventions. At any rate, you're unlikely to need to change the
value of this directive.</p>

</dd>
<dt><a id="dbuser"><code>DB_USER</code></a></dt>
<dd>

<p>The username that Bricolage will use when connecting to the database. Again,
you are unlikely to need to change this directive, especially because, when
Bricolage creates the database, it specifically assigns permissions for this
user to access the appropriate tables, sequences, and such. Note that, for
security reasons, you should <em>never</em> use the PostgreSQL superuser for
this directive.</p>

</dd>
<dt><a id="dbpass"><code>DB_PASS</code></a></dt>
<dd>

<p>The password for the <code>DB_USER</code> to use to connect to the
PostgreSQL database. You'll need to change this directive if the password ever
changes in the database.  Depending on your PostgreSQL server's security model,
it might not matter what the password is. For example, if the PostgreSQL is on
the same host as your Bricolage server and trusts local users (the default
configuration), it will ignore the password. Consult your PostgreSQL <a
href="http://www.postgresql.org/docs/current/static/client-authentication.html"
title="Documentation for PostgreSQL Client Authentication">authentication
settings</a> (in the server's <em>pg_hba.conf</em> file) or check with your
PostgreSQL DBA if you have questions.</p>

</dd>
<dt><a id="dbhost"><code>DB_HOST</code></a></dt>
<dd>

<p>This is the host name of your PostgreSQL server. If it's on the same host as
your Bricolage server, it will likely be commented out, thereby letting
Bricolage default to <q>localhost</q>.  Otherwise, it will be a different host
name or IP address.  Change this setting if ever your PostgreSQL server moves
to a different host or has its host name or IP address changed.</p>

</dd>
<dt><a id="dbport"><code>DB_PORT</code></a></dt>
<dd>

<p>The TCP/IP port on which your PostgreSQL server listens for connections.
This directive will be commented out if you've installed PostgreSQL locally and
you're using Unix sockets instead of TCP/IP for its connectivity (a good idea
for security-conscious environments). It will also be commented out if
Bricolage should use the default PostgreSQL port of 5432.  Otherwise, if
Bricolage must connect to the PostgreSQL server via TCP/IP on a port other than
5432, set this directive to the appropriate port number.</p>

</dd>
</dl>













<h3><a id="directorysettings">Directory Settings</a></h3>

<p>Bricolage stores a lot of files on your server's file system, generally in
well-named directories below your Bricolage root directory. Sometimes you may
want them installed elsewhere, perhaps for the purposes of conserving disk
space or distributing I/O between different partitions. If you want to move any
of these directories to a location other than that set by the installer, copy
over any existing files to ensure that Bricolage continues to operate
correctly.</p>

<dl>
<dt><a id="tempdir"><code>TEMP_DIR</code></a></dt>
<dd>

<p>Bricolage creates several temporary files as it runs, for its cache, user
sessions, and the like. If you selected the <q>multi</q> option when installing
Bricolage, this directive will point to a directory named <em>tmp</em> under
your Bricolage root. Otherwise, it will point to your system's global
<em>tmp</em> directory.</p>

</dd>
<dt><a id="masoncomproot"><code>MASON_COMP_ROOT</code></a></dt>
<dd>

<p>The Bricolage UI uses <a href="http://www.masonhq.com/" title="Mason
HQ">HTML::Mason</a>. All of the components to power the UI live in this
directory, generally a subdirectory of your Bricolage root named <em>comp</em>.
However, media files uploaded to Bricolage also go in this directory, which
means that it can become quite large if you manage a lot of media documents. It
might be useful, therefore, to move this directory to a separate partition.</p>

</dd>
<dt><a id="masondataroot"><code>MASON_DATA_ROOT</code></a></dt>
<dd>

<p>Mason compiles the Bricolage UI components into object files and stores them
in this directory. For the most part you don't need to worry about where these
files live (the default is the <em>data</em> directory under the Bricolage root
directory), although Bricolage will read from it quite a lot as it loads the
object files into memory, so disk I/O is important. It's unlikely to grow too
except...</p>

</dd>
<dt><a id="burnroot"><code>BURN_ROOT</code></a></dt>
<dd>

<p>This directive tells Bricolage where to store formatting templates, object
files, and burned files that are ready for distribution. As such, it can also
grow quite large, especially if you've published or previewed a lot of
documents. Bricolage never deletes these files so that you always have a
canonical directory of the distribution files output by Bricolage. However, the
default location for the <code>BURN_ROOT</code> is under the directory
specified by the <code>MASON_DATA_ROOT</code> directive.  If you encounter disk
space problems, you might want to move this directory to another partition.</p>

</dd>
</dl>
<h3><a id="xml::writerconfiguration">XML::Writer Configuration</a></h3>

<p>The Bricolage Mason burner is responsible for pushing documents through
Mason formatting templates. If you're writing templates that output XML (and
I'll demonstrate writing templates in a later article, so hang in there!), you
might want to simplify things by using an <a
href="http://search.cpan.org/dist/XML-Writer/" title="XML::Writer on
CPAN">XML::Writer</a> object to generate the XML.  Bricolage simplifies things
by providing these directives to create a globally available XML::Writer object
for use in all Mason templates.</p>

<dl>
<dt><a id="includexmlwriter"><code>INCLUDE_XML_WRITER</code></a></dt>
<dd>

<p>Enable this Boolean directive to tell Bricolage to create an XML::Writer
object that's globally available as <code>$writer</code> to all Mason
templates. Bricolage is smart enough to configure the XML::Writer object to
output XML to Mason's buffer, so that you can even mix standard Mason output in
your templates with XML::Writer output.</p>

</dd>
<dt><a id="xmlwriterargs"><code>XML_WRITER_ARGS</code></a></dt>
<dd>

<p>Use this directive to specify a list of options to pass to the XML::Writer
constructor when <code>INCLUDE_XML_WRITER</code> is enabled. This directive is
a string containing a Perl expression to pass to XML::Writer. The <a
href="http://search.cpan.org/dist/XML-Writer/Writer.pm#Writing_XML" title="Read
the XML::Writer documentation on CPAN">XML::Writer documentation</a> has the
full list of possible parameters.  Common parameters include
<code>NEWLINES</code> to trigger the output of new lines between XML elements,
and <code>DATA_INDENT</code> to indent nested XML elements by a certain number
of characters.</p>

</dd>
</dl>
<h3><a id="authenticationconfiguration">Authentication Configuration</a></h3>

<p>Several configuration directives affect the behavior and security of the
Bricolage authentication system. Bricolage handles its own authentication,
storing passwords in the database as MD5-encrypted hashes and recording
authentication in a browser cookie. In a security-conscious environment, it
pays to be familiar with these directives and even to review their settings
periodically.</p>

<dl>
<dt><a id="authttl"><code>AUTH_TTL</code></a></dt>
<dd>

<p>This directive specifies the time-to-live, in seconds, for an authentication
session. Each time an authenticated user sends a request to the server, the
elapsed time resets to zero. You could therefore set <code>AUTH_TTL</code> to
3600 seconds for a one-hour time-to-live, and a user would be able to use
Bricolage all day, as long as each request was less than an hour apart (but she
might have to re-authenticate after lunch). This directive is especially useful
in environments where users access Bricolage from public workstations and
forget to log out. The default value of 28800 (eight hours) is probably too
long in a production environment.</p>

</dd>
<dt><a id="authsecret"><code>AUTH_SECRET</code></a></dt>
<dd>

<p>Bricolage stores the user authentication session locally and keys it off of
an MD5 string stored in a browser cookie. The MD5 string comes from the
browser's IP subnet, the expiration time, the user name, and the last access
time. Because such a string is potentially replicable by someone trying to
crack the system, Bricolage also uses a random string of characters to salt the
MD5 string. <code>AUTH_SECRET</code> is the string used for this purpose. The
installer generates it for you, but you might want to change it now and then,
in order to keep it random and meet the specifications of your security policy.
All users will need to re-authenticate after you change
<code>AUTH_SECRET</code> and restart Bricolage.</p>

</dd>
<dt><a id="loginlength"><code>LOGIN_LENGTH</code></a></dt>
<dd>

<p>This directive specifies a minimum user name length. Each user must have a
user name of at least this number of characters.  The default, <q>5</q>, is
generally adequate, and allows the default <q>admin</q> user name to work
properly.</p>

</dd>
<dt><a id="passwdlength"><code>PASSWD_LENGTH</code></a></dt>
<dd>

<p>This directive corresponds to the <code>LOGIN_LENGTH</code> directive, but
applies to passwords. The password length in Bricolage is unlimited, but it's
generally a good idea to ensure that they all contain a minimum number of
characters. The default is <q>5</q>.</p>

</dd>
</dl>
<h3><a id="distributionconfiguration">Distribution Configuration</a></h3>

<p>When Bricolage previews or publishes documents, it pushes them through
formatting templates (written in Mason, Template Toolkit, or HTML::Template)
and writes the resulting files to disk. It then distributes those files to the
appropriate servers specified in the destination manager in the user interface.
(A later article will explain more of the Bricolage administrative interface.)
Many run-time configuration directives affect the behavior of the Bricolage
distribution server.</p>

<dl>
<dt><a id="enabledist"><code>ENABLE_DIST</code></a></dt>
<dd>

<!-- prod: intertextual link here; please verify across pages -->

<p>This Boolean directive enables Bricolage distribution. The only reason to
disable distribution is if you set up a separate distribution server. To my
knowledge, no one has actually done this, even though Bricolage supports it.
The <a href="#queuepublishjobs">QUEUE_PUBLISH_JOBS</a> directive is more
popular to reduce Bricolage server overhead.</p>

</dd>
<dt><a id="distattempts"><code>DIST_ATTEMPTS</code></a></dt>
<dd>

<p>Bricolage distributes files via file system copy, FTP, SFTP, or
WebDAV&#x2014;depending on your destination configuration. We all know that
failures can occasionally occur. Bricolage will attempt to distribute a file
after a failed distribution and will do it multiple times. Set the
<code>DIST_ATTEMPTS</code> directive to the number of times it should attempt
to distribute a file before giving up.</p>

</dd>
<dt><a id="previewlocal"><code>PREVIEW_LOCAL</code></a></dt>
<dd>

<p>This Boolean directive enables Bricolage's internal preview server. This is
just a URI in the Bricolage UI that knows to serve previewed content rather
than the UI. This is handy for evaluating Bricolage, but be sure to disable it
in a production environment, especially if your front-end server needs to serve
something other than static HTML. The recommended approach is to set up a
separate preview server that is identical to your production server and
configure a destination to distribute and redirect previews to that server.</p>

</dd>
<dt><a id="previewmason"><code>PREVIEW_MASON</code></a></dt>
<dd>

<p>With the <code>PREVIEW_LOCAL</code> directive enabled, if the content you're
generating includes Mason calls, you can enable this boolean directive to make
Bricolage's internal preview server evaluate the Mason code before serving
documents.</p>

</dd>
<dt><a id="defmediatype"><code>DEF_MEDIA_TYPE</code></a></dt>
<dd>

<p>This string directive identifies the default media type (also called a
<q>MIME type</q>) of files for which Bricolage cannot determine the media type.
The default value, <q>text/html</q>, covers a lot of typical files in a Web
content management environment, such as <em>.php</em> or <em>.jsp</em> files.
To add new types for Bricolage to recognize, use the media type manager in the
UI.</p>

</dd>
<dt><a id="enablesftpmover"><code>ENABLE_SFTP_MOVER</code></a></dt>
<dd>

<p>By default, Bricolage does not support distribution via secure FTP (SFTP). If
you need it, install the required Net::SFTP module, enable this directive, and
restart Bricolage.</p>

</dd>
<dt><a id="sftphome"><code>SFTP_HOME</code></a></dt>
<dd>

<p>If you've enabled SFTP distribution, use this directive specify a home
directory for SFTP to use, especially if you want to use public and private SSH
keys. Consult the <a href="http://search.cpan.org/dist/net-SFTP/"
title="Net::SFTP on CPAN">Net::SFTP</a> documentation for details.</p>

</dd>
<dt><a id="enablesftpv2"><code>ENABLE_SFTP_V2</code></a></dt>
<dd>

<p>Enable this directive to prefer SSH2 support for SFTP distribution. You'll
also need to install more Perl modules from CPAN. Consult the Net::SFTP
documentation for details.</p>

</dd>
<dt><a id="sftpmovercipher"><code>SFTP_MOVER_CIPHER</code></a></dt>
<dd>

<p>Net::SFTP uses the <a href="http://search.cpan.org/dist/Net-SSH-Perl/"
title="Net::SSH::Perl on CPAN">Net::SSH::Perl</a> module to handle the SSH side
of things. This module supports multiple encryption ciphers. If you prefer one,
specify it via this directive.</p>

</dd>
<dt><a id="enablewebdavmover"><code>ENABLE_WEBDAV_MOVER</code></a></dt>
<dd>

<p>Bricolage also supports distribution via <a href="http://www.webdav.org/"
title="WebDav Resources">WebDAV</a>, a standard for distributing documents via
the HTTP protocol. DAV, as it is also known, has support in multiple web
servers including Microsoft's IIS and Apache 2. If you'd like to distribute
document files to your production server or servers via DAV, install the <a
href="http://search.cpan.org/dist/HTTP-DAV/" title="HTTP::DAV on
CPAN">HTTP::DAV</a> module, enable this Boolean directive and restart
Bricolage.</p>

</dd>
<dt><a id="queuepublishjobs"><code>QUEUE_PUBLISH_JOBS</code></a></dt>
<dd>

<p>By default, when a user schedules a document to publish immediately, the
Bricolage server will immediately execute the distribution. If users publish a
lot of documents or you're bulk publishing large sections of your site at once,
this can really slow down the Bricolage UI for other users. This is even true
even if you've scheduled a bulk of documents to publish at a future date and
time, because the way the default <em>bric_dist_mon</em> script works is to
tickle the Bricolage server to distribute documents.</p>

<p>The way around this problem is to enable the <code>QUEUE_PUBLISH_JOBS</code>
boolean directive and then use the <em>bric_queued</em> program instead of
<em>bric_dist_mon</em>.  With <code>QUEUE_PUBLISH_JOBS</code> enabled, the
Bricolage server will <em>never</em> burn and distribute documents, even if a
user schedules them to publish <em>yesterday</em>. Instead,
<em>bric_queued</em> handles all of the burning and distribution itself,
without having the Bricolage server expend resources on the task. With this
approach, be sure to run <em>bric_queued</em> from a fairly aggressive cron
job.</p>

</dd>
<dt><a id="ftpunlinkbeforemove"><code>FTP_UNLINK_BEFORE_MOVE</code></a></dt>
<dd>

<p>When Bricolage distributes files via FTP, it uploads them with a temporary
file name, and then, when the transfer is complete, it renames the file to the
final name. However, if an earlier version of the file is already present, the
rename might fail. (This depends on your FTP server, but Microsoft's IIS is the
server that led us to add this feature.) In such a case, enable this directive
and Bricolage will delete any existing instance of the file before renaming the
temporary file.</p>

</dd>
</dl>













<h3><a id="alertconfiguration">Alert Configuration</a></h3>

<p>Bricolage has an interface for sending alert emails when it logs events that
meet certain criteria against objects. Bricolage needs to know a few things
before it can send the alerts.</p>

<dl>
<dt><a id="smtpserver"><code>SMTP_SERVER</code></a></dt>
<dd>

<p>Bricolage uses an SMTP server to send alert email messages. The default
value for this directive, <q>localhost</q>, is fine if you use a Unix system
with sendmail (or some other SMTP server) running locally. If your organization
has a dedicated SMTP server or if your Bricolage host has none of its own,
change the value of this directive.</p>

</dd>
<dt><a id="alertfrom"><code>ALERT_FROM</code></a></dt>
<dd>

<p>Set this directive to an email address that you want to appear in the
<q>From</q> header of alert emails. I typically set it to something like
<q>Bricolage Admin &lt;www@example.com&gt;</q>, but use whatever is appropriate
for your organization.  If your users are inclined to reply to alert emails,
you may want to set up a special <code>ALERT_FROM</code> email address that has
an auto-responder to let the user know that the reply will go unread.</p>

</dd>
<dt><a id="alerttometh"><code>ALERT_TO_METH</code></a></dt>
<dd>

<p>This string directive indicates which header to use for specifying alert
recipients in email alerts. The possible values are <q>To</q> and
<q>Bcc</q>.</p>

</dd>
</dl>

<h3><a id="userinterfaceconfiguration">User Interface Configuration</a></h3>

<p>Some configuration directives enable you to affect how the Bricolage user
interface works in subtle ways. If you haven't used the Bricolage browser-based
interface much yet, some of these won't make much sense just now. Feel free to
come back and look again when you're you've had some experience with the
Bricolage interface and want to make it behave more according to your own
notions of correctness.</p>

<dl>
<dt><a id="fullsearch"><code>FULL_SEARCH</code></a></dt>
<dd>

<p>By default, when you search for objects in the Bricolage admin interfaces,
or for stories, media, or templates in the asset library, the Bricolage UI
appends a wildcard character to the end of your search string. Thus if you
search for <q>foo</q>, the search will return results for all records that
<em>start with <q>foo</q></em>. If, however, you set the
<code>FULL_SEARCH</code> Boolean directive to a true value, all searches in the
Bricolage UI will become substring searches. So a search for <q>foo</q> will
return all records where <q>foo</q> appears anywhere in a record.</p>

<p>The downside to this approach is that it prevents PostgreSQL from using its
database indexes. In principal, this is only a problem if you have a large
number of objects in Bricolage. If, say, you had 100,000 stories in Bricolage,
you would notice that story searches would be noticeably slower with
<code>FULL_SEARCH</code> enabled than with it disabled. Leave it disabled if
you expect to manage a lot of documents. Your users can always manually prepend
the wildcard character (<q>%</q>) to the front of search queries if they want a
substring search.</p>

</dd>
<dt><a id="allowworkflowtransfer"><code>ALLOW_WORKFLOW_TRANSFER</code></a></dt>
<dd>

<p>Bricolage workflows are made up of a series of desks. In general, workflows
have their own desks, but desks can appear in more than one workflow. In such a
case, documents moved to such a shared desk in one workflow will be visible on
the same desk in another workflow. This is great for managing common tasks
across workflows, such as translation or legal review.  The upshot is that, by
default, a document placed on a desk in one workflow cannot be transferred from
that desk to another desk in a different workflow.  Users can only move it to
other desks in the workflow in which it originated.  Set the
<code>ALLOW_WORKFLOW_TRANSFER</code> Boolean directive to a true value to
remove this constraint, so that a document placed on a desk in one workflow can
be moved from that desk to other desks in other workflows that the desk is
in.</p>

</dd>
<dt><a id="allowallsitescx"><code>ALLOW_ALL_SITES_CX</code></a></dt>
<dd>

<p>When managing multiple sites in Bricolage, the user interface will display a
<q>site context</q> select list. Only the workflows for the selected site will
be displayed. If you want to allow users to see all of the workflows for all of
the sites that they have permission to access, set this Boolean directive to a
true value to add an <q>All Sites</q> option to the <q>Site context</q> select
list. But beware! If you have access to a lot of sites, you'll have access to a
bewildering number of workflows when you select this option!</p>

</dd>
<dt><a id="yearspanbefore"><code>YEAR_SPAN_BEFORE</code></a></dt>
<dt><a id="yearspanafter"><code>YEAR_SPAN_AFTER</code></a></dt>
<dd>

<p>For the input of dates in Bricolage, the user interface offers select lists
for the day, month, and year. By default, the years available in the
<q>Year</q> select list have a limit of the ten years before and after the
value for the year or the current year.  If you need more years in your select
list, set these directives to the number of years before and after the current
value or current year. For example, if you manage a site of historical
photographs with Bricolage, you might need to select years that range back over
100 years. In such a case, set <code>YEAR_SPAN_BEFORE</code> to <q>100</q>. A
science fiction book review site, on the other hand, might need years much
farther in the future. For such a case, set <code>YEAR_SPAN_AFTER</code> to the
appropriately high number.</p>

</dd>
<dt><a id="defaultfilename"><code>DEFAULT_FILENAME</code></a></dt>
<dt><a id="defaultfileext"><code>DEFAULT_FILE_EXT</code></a></dt>
<dd>

<p>The file names generated for story documents are set on a per-output channel
basis. The user interface offers default values for these settings in the
output channel profile. The default file name is <q>index</q>, and the default
file name suffix is <q>html</q>. If, say, you were outputing content to an IIS
server, you might want to set the <code>DEFAULT_FILENAME</code> directive to
<q>default</q> and the <code>DEFAULT_FILE_EXT</code> directive to <q>htm</q>,
instead. It's not a big deal either way, though, because you can actually set
the values you need for each output in the user interface. These are just the
displayed defaults, settable as directives for the ultimate in laziness.</p>

</dd>
<dt><a id="enableocassetassociation"><code>ENABLE_OC_ASSET_ASSOCIATION</code></a></dt>
<dd>

<p>Document models are associated with output channels in Bricolage. When you
create a new document based on a model, it will automatically have the output
channel associations defined by the model. If you'd like users to be able to
change the associations&#x2014;say, to assign output channels defined by the
model to be optionally associated with documents based on that model&#x2014;set
this directive to a true value. If, however, the added complexity of output
channel associations will only confuse your users, set this directive to a
false value to remove the user interface for changing document output channel
associations.</p>

</dd>
<dt><a id="enablecategorybrowser"><code>ENABLE_CATEGORY_BROWSER</code></a></dt>
<dd>

<p>When editing a story document in Bricolage, you'll see a select list of all
categories that you have READ permission to access to allow you to optionally
add the story to a new category. Most of the time, however, you'll only add a
story to one or two categories, and then never change these settings.
Therefore, if you have a lot of categories in your Bricolage installation (and
there are systems in production with over 2000 categories), it's wasteful to
load them all every time you edit a story document when you'll never change
them again.</p>

<p>In such a case, set the Boolean <code>ENABLE_CATEGORY_BROWSER</code>
directive to a true value and restart Bricolage. This will change the story
profile to offer a link to a category browser, which enables you to search for
the category or categories to associate with a story. Now, not only will you no
longer load all categories every time you access the story profile (and the
story profile is, for content producers, the most commonly accessed page in the
Bricolage UI), but you'll only load those you search for in the category
browser. I highly recommend that every Bricolage admin to set this directive to
a true value.</p>

</dd>
</dl>
<h3><a id="documentmanagementconfiguration">Document Management
Configuration</a></h3>

<p>These directives relate to how Bricolage manages documents.</p>

<dl>
<dt><a id="publishrelatedassets"><code>PUBLISH_RELATED_ASSETS</code></a></dt>
<dd>

<p>Bricolage allows you to create relationships between documents.  These can
point to <q>related stories</q> or add images to a document, among other
things. By default, when you publish a document, Bricolage will also try to
publish any related documents. This will help to prevent 404s or broken image
problems.  In some cases, you might not want this behavior, so set the
<code>PUBLISH_RELATED_ASSETS</code> Boolean directive to a false value.</p>

</dd>
<dt><a id="storyuriwithfilename"><code>STORY_URI_WITH_FILENAME</code></a></dt>
<dd>

<p>Story documents in Bricolage must have unique URIs. URIs consist of a
story's category and optionally other parts of the story, such as its cover
date and its slug (a one-word description of a story). They do not, however,
consist of the file name. This is in keeping with W3C <a
href="http://www.w3.org/Provider/Style/URI.html" title="&#x201c;Cool URIs don't
change&#x201c;, by Tim Berners-Lee">suggestions</a>.  The idea is that the
story has a directory URI, and there may be several forms of the story with
different file names in that directory, such as <q>index.html</q> for HTML,
<q>rdf.xml</q> for RDF, and <q>index.pdf</q> for PDFs.</p>

<p>However, some organizations have Website policies that demand the inclusion
of file names in the URI. This is so that different documents can be in the
same directory. A common example might be a <q>About Us</q> directory with
separate <q>/about/index.html</q>, <q>/about/contact.html</q>, and
<q>/about/copyright.html</q> documents. Such URIs are not possible by default
in Bricolage, which requires that all stories have unique URIs, because each of
these stories would have the same URI, namely <q>/about</q>. To get around this
issue, set the <code>STORY_URI_WITH_FILENAME</code> Boolean directive to a true
value. From then on, all stories will include their file names in their URIs.
Be careful, though! Existing stories will not have their URIs changed.  Decide
how you want to set this directive when you start using Bricolage, and never
change it.</p>

</dd>
<dt><a id="allowsluglessnonfixed"><code>ALLOW_SLUGLESS_NONFIXED</code></a></dt>
<dd>

<p>The URIs for story documents are determined by patterns specified on a
per-output channel basis. There are two different URI formats in each output
channel, one for fixed documents and one for non-fixed documents. Non-fixed
documents typically use parts of the cover date in their URIs, while fixed URIs
do not. Each document model has a flag set to indicate whether documents based
on the model will use the fixed for non-fixed URI patterns. The result is that,
for non-fixed stories, you might have URIs like
<q>/reviews/books/2004/12/23/princess_bride</q>. Here the URI format includes
the slug, a one-word summary of the contents of a story (the
<q>princess_bride</q> part of this example). However, slugs are optional in
stories, even non-fixed stories. If you want to force all non-fixed stories to
include the slug in order to guarantee the creation of more meaningful URIs,
set this Boolean directive to a true value.</p>

</dd>
<dt><a id="autogenerateslug"><code>AUTOGENERATE_SLUG</code></a></dt>
<dd>

<p>This Boolean directive complements the <code>ALLOW_SLUGLESS_NONFIXED</code>
directive. If you want to keep the slug optional but generate one when a user
neglects to type one in, set <code>AUTOGENERATE_SLUG</code> to a true value.
This will cause Bricolage to generate a simple slug based on the title of the
story. For example, a story with the title <q>Essential Perl 6</q> would have
the slug <q>essential_perl_6</q> generated for it.</p>

</dd>
</dl>

<h3><a id="apache::sizelimitconfiguration">Apache::SizeLimit
Configuration</a></h3>

<p>Bricolage is a large application that includes many CPAN modules as well as
its own 120,000+ lines of code. When you start it up, its processes can take up
30MB of memory or more. In general this isn't a problem, because Apache shares
that memory between child processes. As each process handles requests, however,
its size can swell independent of other processes. If you're performing
resource intensive activities, such as publishing a lot of documents at once,
the process that handles the request can become quite large. Because Perl (and,
by extension, <code>mod_perl</code>) does not return memory to the system, this
can give the appearance that you have a memory leak.</p>

<p>The solution to this problem is to use the <a
href="http://search.cpan.org/dist/mod_perl-1.29/lib/Apache/SizeLimit.pm"
title="Apache::SizeLimit on CPAN">Apache::SizeLimit</a> module distributed with
<code>mod_perl</code> to check your <code>mod_perl</code> processes
periodically and kill them when they exceed a certain size. Bricolage has
integrated support for Apache::SizeLimit that these directives can quickly
enable and configure.</p>

<dl>
<dt><a id="checkprocesssize"><code>CHECK_PROCESS_SIZE</code></a></dt>
<dd>

<p>This Boolean directive turns on the Apache::SizeLimit support.  After you
set it to a true value and restart Bricolage, it will use the settings in the
following directives to decide how often to check your processes and to kill
them when they get to be too big.</p>

</dd>
<dt><a id="maxprocesssize"><code>MAX_PROCESS_SIZE</code></a></dt>
<dd>

<p>This is the maximum size, in bytes, that processes can reach before
Apache::SizeLimit will kill them.</p>

</dd>
<dt><a id="checkfrequency"><code>CHECK_FREQUENCY</code></a></dt>
<dd>

<p>This directive determines how often Apache::SizeLimit will check the size of
your <code>mod_perl</code> processes. If you set it to <q>5</q>, it will check
a process after every fifth request handled by that process. The default is
<q>1</q>.</p>

</dd>
<dt><a id="minsharesize"><code>MIN_SHARE_SIZE</code></a></dt>
<dd>

<p>This directive indicates the minimum amount of shared memory the process
must employ to avoid being considered a candidate for termination. Consult the
Apache::SizeLimit documentation for more information. The default is <q>0</q>,
meaning that all Apache <code>mod_perl</code> processes will have their sizes
checked.</p>

</dd>
<dt><a id="maxunsharedsize"><code>MAX_UNSHARED_SIZE</code></a></dt>
<dd>

<p>This directive sets a limit on the amount of unshared memory a process may
consume to not be a candidate for termination. You can use this directive to
tweak your settings if you find that Apache::SizeLimit terminates processes
while they are still mainly using shared memory. The default is <q>0</q>.</p>

</dd>
</dl>













<h3><a id="virtualftpserverconfiguration">Virtual FTP Server
Configuration</a></h3>

<p>Bricolage pushes story documents through formatting templates to generate
output when you preview or publish them. Formatting templates can use Mason,
Template Toolkit, or HTML::Template. If you have a lot of different types of
story documents, or just elements of story documents, you'll likely end up with
a lot of templates to manage. Editing templates in the browser interface's
<code>textarea</code> fields can be a pain. A better approach is to use the
Bricolage virtual FTP server, which provides access to all Bricolage templates
via FTP. If the security of your password isn't a serious consideration
(because FTP sends passwords in the clear, and maybe you work behind a firewall
or over a virtual private network), enable the virtual FTP server and edit
Bricolage templates from within your favorite FTP-enabled editor (Emacs, Vim,
HomeSite, etc.). Here's how.</p>

<dl>
<dt><a id="enableftpserver"><code>ENABLE_FTP_SERVER</code></a></dt>
<dd>

<p>This boolean directive enables the virtual FTP server.  Set it to a true
value, tune the other FTP directives, reboot Bricolage, fire up the <a
href="http://www.bricolage.cc/docs/current/api/bric_ftpd.html" title="bric_ftpd
man page"><em>bric_ftpd</em></a> application, and get to work! Just connect to
your Bricolage FTP server on the port specified by the <code>FTP_PORT</code>
directive, login with your Bricolage username and password, and you can browse
templates by site, output channel, and category.</p>

</dd>
<dt><a id="ftpport"><code>FTP_PORT</code></a></dt>
<dd>

<p>This directive specifies a TCP/IP port on which the Bricolage virtual FTP
server will listen for connections. The default is <q>2121</q>.</p>

</dd>
<dt><a id="ftpaddress"><code>FTP_ADDRESS</code></a></dt>
<dd>

<p>If your host has more than one IP address, specify one of them here to have
the virtual FTP server to listen for connections on that IP address only. By
default, the FTP server will listen on all of your host's IP addresses.</p>

</dd>
<dt><a id="ftplog"><code>FTP_LOG</code></a></dt>
<dd>

<p>The location of the virtual FTP server log. By default, it will be in the
<em>log</em> subdirectory of your Bricolage root directory.</p>

</dd>
<dt><a id="ftppidfile"><code>FTP_PID_FILE</code></a></dt>
<dd>

<p>Specify the location of the PID file for the Bricolage FTP server.
<em>bric_ftpd</em> will use this file to record the PID of the server when you
start it and to stop the server when you execute <code>bric_ftpd -k</code>. The
default is to store the PID file in the <em>log</em> subdirectory of your
Bricolage root directory.</p>

</dd>
<dt><a id="ftpdeployonupload"><code>FTP_DEPLOY_ON_UPLOAD</code></a></dt>
<dd>

<p>As of Bricolage 1.8 and later, the Bricolage FTP server will save templates
to your private sandbox when you upload them. This means that they will be
checked out to you, appear in your personal workspace in the UI, and execute
when you (and only you) preview stories that use them. To check in and deploy a
template to use in production when other users preview and publish documents,
simply append the string <em>.deploy</em> to the end of the file name when you
upload it and Bricolage will do the rest.</p>

<p>Prior to version 1.8.0, the Bricolage virtual FTP server checked out,
updated, checked in, and deployed templates on every upload.  If for some
reason you prefer this approach (and to be honest, I can't imagine why
<em>anyone</em> would!), set the <code>FTP_DEPLOY_ON_UPLOAD</code> directive to
a true value and restart <em>bric_ftpd</em>.</p>

</dd>
<dt><a id="ftpdebug"><code>FTP_DEBUG</code></a></dt>
<dd>

<p>If for some reason the virtual FTP server isn't behaving the way you expect,
set this Boolean directive to a true value and restart <em>bric_ftpd</em>. Then
tail the FTP log (specified by the <code>FTP_LOG</code> directive) to diagnose
the problem.</p>

</dd>
</dl>
<h3><a id="preloadingconfiguration">Preloading Configuration</a></h3>

<p>Because Bricolage runs on Apache 1.3, the parent process loads all of its
code at startup time, before it forks off any children. This is memory
efficient, because most modern operating systems use a copy-on-write forking
design. This means that the children all share memory with the parent until
they write to that memory, at which time the kernel copies that memory to the
child process.</p>

<p>When loading a lot of code, children never overwrite much of it.  It's
highly advantageous to load as much code as you think you'll need into the
parent process at startup time, to prevent each of the children from loading it
themselves and taking up that much more memory. These directives help you to do
just that.</p>

<dl>
<dt><a id="perlloader"><code>PERL_LOADER</code></a></dt>
<dd>

<p>This string directive can be any Perl code you like, as long as it's all on
one line in the <em>bricolage.conf</em> file. Bricolage will execute this code
at startup time, in the namespace used by the Mason burner. This is very useful
for loading Perl modules that your templates use, so that you're not loading
them in each child process. The default value loads <a
href="http://search.cpan.org/dist/mod_perl-1.29/Util/Util.pm"
title="Apache::Util on CPAN">Apache::Util</a>, which has many useful HTML
output utility functions, and <a
href="http://www.bricolage.cc/docs/current/api/Bric::Util::Burner"
title="Bric::Util::Burner documentation">Bric::Util::Burner</a>, which exports
several constants that you can use in templates to tell what type of burn is
being executed (preview or publish).  Other common modules you might want to
load here include <a href="http://search.cpan.org/dist/CGI.pm/" title="CGI on
CPAN">CGI.pm</a> or <a href="http://search.cpan.org/dist/XML-RSS/"
title="XML::RSS on CPAN">XML::RSS</a> to assist with HTML and RSS output,
respectively. You can load anything here, really.</p>

</dd>
<dt><a id="loadlanguages"><code>LOAD_LANGUAGES</code></a></dt>
<dd>

<p>Bricolage has localizations for multiple languages, including German,
Portuguese, Italian, Cantonese, Mandarin, and Russian. The localization
libraries are Perl modules loaded at server startup time. For the most
efficient use of memory, load the languages you expect to use most often by
specifying the appropriate language codes (such as <q>en</q> for English,
<q>pt_pt</q> for Portuguese, <q>de_de</q> for German, etc.) in a
space-delimited list via the <code>LOAD_LANGUAGES</code> directive.</p>

</dd>
<dt><a id="loadcharsets"><code>LOAD_CHAR_SETS</code></a></dt>
<dd>

<p>This directive functions just like the <code>LOAD_LANGUAGES</code>
directive, except that it loads the libraries that convert to and from UTF-8.
Bricolage allows individual users to use different character sets when
accessing the Bricolage UI, including ISO-8859-1, ISO-8859-2, Big5, ShiftJIS,
GB-2312, and others. To save memory overhead, specify each character set that
you expect your users will need to use day-to-day in Bricolage in a
space-delimited list in the <code>LOAD_CHAR_SETS</code> directive.</p>

</dd>
</dl>
<h3><a id="thumbnailconfiguration">Thumbnail Configuration</a></h3>

<p>As of Bricolage 1.8.0, Bricolage can generate thumbnail versions of image
files uploaded for media documents. All you need to do is install the <a
href="http://search.cpan.org/dist/Imager/" title="Imager on CPAN">Imager</a>
module from CPAN (along with the necessary libraries for the image formats you
use&#x2014;see the <a
href="http://search.cpan.org/src/TONYC/Imager-0.44/README" title="Imager
README">Imager README</a> file for details) and configure thumbnail support via
these directives.</p>

<dl>
<dt><a id="usethumbnails"><code>USE_THUMBNAILS</code></a></dt>
<dd>

<p>Set this Boolean directive to a true value and restart Bricolage to have
thumbnails generated for all image files in Bricolage.  You must have Imager
installed, of course. You might also want to consider installing media type
icons specific to particular types of non-image files. See the <em>README</em>
file and script in <em>contrib/copy_gnome_icons</em> in the Bricolage sources
for information on which icon files to use and how to install them using the
<em>copy_gnome_icons</em> script.</p>

</dd>
<dt><a id="thumbnailsize"><code>THUMBNAIL_SIZE</code></a></dt>
<dd>

<p>Set this directive to the maximum dimension of thumbnail images, in pixels.
Bricolage will use this number to constrain the size of the thumbnail so that
its greatest dimension does not exceed this number. For example, if
<code>THUMBNAIL_SIZE</code> has its default value, <q>75</q>, and you upload a
150 x 100 pixel image file, Bricolage will generate a 75 x 50 pixel
thumbnail.</p>

</dd>
</dl>
<h3><a id="htmlareaconfiguration">htmlArea Configuration</a></h3>

<p>Bricolage 1.8.0 added support for WYSIWYG (what you see is what you get)
editing via the <a href="http://www.htmlarea.com/" title="htmlArea
Website">htmlArea</a> JavaScript editor, though it has this feature disabled by
default. To enable it, download and install htmlArea 3.0 (in beta release as of
this writing) in the <em>comp/media/htmlarea</em> directory under your
Bricolage root.  Then configure it via these directives and restart Bricolage.
You will then be able to specify a <q>WYSIWYG</q> field type in document
element definitions, and content editors can take advantage of htmlArea's
WYSIWYG features when editing content in those fields.</p>

<dl>
<dt><a id="enablehtmlarea"><code>ENABLE_HTMLAREA</code></a></dt>
<dd>

<p>Set this Boolean directive to a true value to enable Bricolage's htmlArea
support. You must have htmlArea installed in the <em>comp/media/htmlarea</em>
directory under your Bricolage root.</p>

</dd>
<dt><a id="htmlareatoolbar"><code>HTMLAREA_TOOLBAR</code></a></dt>
<dd>

<p>The htmlArea editor offers a lot of WYSIWYG features as controls (buttons)
in its interface. The controls handle tasks such as copy, paste, italicize,
boldface, link, etc. By default, Bricolage enables only a subset of these
controls. The subset excludes layout type features such as font selection and
color, line justification, and the like. The idea is to provide only the tools
needed for users to easily add semantically meaningful markup rather than
layout markup, so as to keep content independent of presentation.  If you
really need to allow your users to use six different type faces in twelve
colors, you can enable the htmlArea controls for these features via the
<code>HTMLAREA_TOOLBAR</code> directive.  The value of the directive is a
comma-separated list of single-quoted strings with brackets at either end. See
the htmlArea documentation for a <a
href="http://www.htmlarea.com/htmlarea_2/documentation.html#setup3"
title="&#x201c;htmlArea documentation: How can I change what controls are
displayed on the toolbar?&#x201c;">complete list of supported controls</a>.</p>

</dd>
</dl>
<h3><a id="upnext">Up Next</a></h3>

<p>Now you have all the information you need to configure how Bricolage
operates to your heart's content. My next article will explore the nitty-gritty
of defining document models in Bricolage.</p>




        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1008" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2004/10/bricolage-installation.html" rel="bookmark">Installing Bricolage</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">David Wheeler</span> on <abbr class="published" title="2004-10-28T00:00:00-08:00">October 28, 2004 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            
<br clear="all" />
<p>Now that <a href="/pub/a/2004/08/27/bricolage.html"
title="Content Management with Bricolage">Content Management with Bricolage</a>
has piqued your interest, you might be wondering what you need to do to install
it. I'll be the first to admit that installing Bricolage is not trivial, given
that it requires several third-party applications and modules to do its job.
That said, the installer tries hard to identify what pieces you have and which
ones you don't, to help you through the process. Even still, it can help to
have a nice guide to step you through the process.</p>

<p>This article is here to help.</p>

<h3>Packaging Systems</h3>

<p>First off, depending on your operating system, you may be able to install
Bricolage via the supported packaging system. If you run FreeBSD, you can
install a recent version from the Free BSD ports collection. To do so, update
your ports tree, and then:</p>

<pre><code>% cd /usr/ports/www/bricolage
% make
% make install</code></pre>

<p>A Debian package is also available. To install it, add these lines to your
<em>/etc/apt/sources.list</em> file:</p>

<pre><code># bricolage
deb http://tetsuo.geekhive.net/mark/debian/unstable /
deb-src http://tetsuo.geekhive.net/mark/debian/unstable /</code></pre>

<p>Then you can install Bricolage using <code>apt-get</code>:</p>

<pre><code># apt-get install bricolage-db
# apt-get install bricolage</code></pre>

<csperl file="grab" domain="on" record="b/970" template="b/article_sidebar.view">

<p>The packaged distributions of Bricolage are great because they handle all of
the dependencies for you, making installation extremely easy. The downside,
however, is that there is frequently a lag behind a new release of Bricolage
and the updating of the relevant packages. For example, the current stable
release of Bricolage is 1.8.2, but the FreeBSD ports package is currently at
1.8.1. The Debian port is at 1.8.0. Furthermore, as of this writing, neither
packaging system supports upgrading an existing installation of Bricolage,
which may require database updates.</p>

<h3>Building Bricolage</h3>

<p>The alternative is to compile and install Bricolage and all of its
dependencies yourself. This is not as difficult as it might at first sound,
because Bricolage is a 100% Perl application and therefore requires no
compilation. Many of the dependencies, however, <em>do</em> require compilation
and have their own histories of successful installation on a given platform.
For the most part, however, they have solid histories of success, and in the
event of trouble, there are lots of resources for help on the Internet (see,
for example, my articles on <a href="http://www.oreillynet.com/pub/au/1059"
title="building Apache/mod_perl on Mac OS X">building
Apache/<code>mod_perl</code> on Mac OS X</a>). The platform-specific
<em>README</em> files that come with Bricolage also contain useful information
to help with your installation.</p>

<p>The next few sections of this article cover manual installation of
Bricolage. If you're happy with a package install, this information can still
be very useful for understanding Bricolage's requirements. If you're antsy, <a
href="/pub/a/2004/10/28/bricolage_installation.html?page=3#upnext" title="Bricolage Runtime Configuration">skip to the
end</a> to find out where to go next.</p>

<h3>Prerequisites</h3>

<p>First: did you read the <em>README</em> file for your platform?</p>

<p>The most important prerequisites for Bricolage are:</p>

<dl>
<dt>Perl</dt>
<dd>

<p>What kind of <cite>Perl.com</cite> article <em>wouldn't</em> have this
requirement? Bricolage requires Perl 5.6.1 or later, but if you're going to
work with <em>any</em> kind of non-ASCII characters in your content, I
<em>strongly</em> recommend Perl 5.8.3 or later for its solid Unicode support.
All text content managed by Bricolage is UTF-8, so for sites such as <a
href="http://www.rfa.org/" title="RFA publishes in ten different
languages!">Radio Free Asia</a> the newer versions of Perl are a must.</p>

<p>Experience has also shown that some vendor versions of Perl don't work too
well. Red Hat's Perl, in particular, seems to have several problems that just
go away once a sys-admin decides to compile her own. <em>Caveat
Perler.</em></p>
</dd>

<dt>Apache</dt>
<dd>

<p>Bricolage doesn't serve content, but it does require a web server to serve
its interface. It requires Apache 1.3.12 or later, with a strong recommendation
for the latest, 1.3.31.  Bricolage does not yet support Apache 2, though the
upcoming release of <code>mod_perl</code> 2 will lead to a port.</p>
</dd>

<dt><code>mod_perl</code></dt>
<dd>

<p>Speaking of <code>mod_perl</code>, Bricolage requires <code>mod_perl</code>
1.25 or later, with a strong recommendation to use the latest, 1.29.  You can
either statically compile <code>mod_perl</code> into Apache or, as of the
recent release of Bricolage 1.8.2, compile it as a dynamically shared object
library (DSO).  However, in order to use <code>mod_perl</code> as a DSO, you
must have compiled with a Perl that was configured with
<code>-Uusemymalloc</code> <em>or</em> <code>-Ubincompat5005</code>. See <a
href="http://perl.apache.org/docs/1.0/guide/install.html#When_DSO_can_be_Used"
title="When DSO can be Used in the mod_perl FAQ">this <code>mod_perl</code>
FAQ</a> for more details. Bricolage's installer will check this configuration
against the Perl you use to run the installation and will complain if the
installing Perl lacks these attributes.  However, this check is only valid if
the Perl running the installation is the same as the Perl used by
<code>mod_perl</code>, so it pays to be aware of this issue.</p>

<p>As I said, Bricolage does not currently support <code>mod_perl</code> 2.
However, now that <code>mod_perl</code> 2 is nearing release, there is greater
interest in porting Bricolage to it (and therefore to Apache 2). Some work has
begun in this area, and we hope to be able to announce <code>mod_perl</code> 2
support by the end of the year.</p> </dd>

<dt>PostgreSQL</dt>
<dd>

<p>Bricolage stores all of its data in a <a href="http://www.postgresql.org/"
title="PostgreSQL website">PostgreSQL</a> database. For those not familiar with
PostgreSQL, it is an advanced, ACID-compliant, open-source object-relational
database management system. I've found the compilation very easy on all
platforms I've tried it on (although I have had to install <a
href="http://www.justatheory.com/computers/os/macosx/libreadline.html"
title="Compiling libreadline on Mac OS X"><em>libreadline</em></a> on Mac OS X,
first). Bricolage requires PostgreSQL 7.3 or later and recommends version 7.4.
Bricolage will support the forthcoming PostgreSQL 8.0 around the time of its
release, but to date no one has tested them together.</p>

<p>The one other recommendation I make is that you <a
href="http://www.justatheory.com/computers/databases/postgresql/always_use_c_locale.html"
title="Always use the C Locale with PostgreSQL">specify
<code>--no-locale</code> or <code>--locale=C</code> when you initialize the
PostgreSQL database</a>. This is especially important if you will be managing
content in more than one language, as it will prevent searches and sort
ordering from being specific to one language and possibly incompatible with
others.  A <a
href="http://archives.postgresql.org/pgsql-general/2004-08/msg01079.php"
title="Subject: UTF-8 and LIKE vs =">Unicode and searching discussion on the
pgsql-general mail list</a> provides a broader perspective.</p> </dd>

<dt><code>mod_ssl</code> or <code>apache-ssl</code></dt>
<dd>

<p>If you want encrypted communications between Bricolage and its clients,
install either <code>mod_ssl</code> or <code>apache-ssl</code>. SSL is optional
in Bricolage, but I recommend using it for security purposes. Bricolage can use
SSL for all requests or just for authentication and password changing requests.
Tune in for the next article in this series, <q>Bricolage Runtime
Configuration</q>, for information on configuring SSL support.</p>
</dd>

<dt>Expat</dt>
<dd>

<p>Bricolage uses the <a
href="http://search.cpan.org/dist/XML-Parser">XML::Parser</a> Perl module,
which in turn requires the Expat XML parser library. Most Unix systems have a
version of Expat installed already, but if you need it, install it from the <a
href="http://expat.sourceforge.net/" title="The Expat XML Parser">Expat home
page</a>.</p> </dd>

<dt>CPAN Modules</dt>
<dd>

<p>Bricolage uses a very large number of CPAN modules. Most of those required
in turn require still more modules. For the most part, we recommend that you
let the Bricolage installer install the required modules. It will determine
which modules you need and install them using the <code>CPAN</code> module. If
you want to get ahead of the game, use the <code>CPAN</code> module to install
them yourself, first. The easiest way to do it is to install <a
href="http://search.cpan.org/dist/Bundle-Bricolage/">Bundle::Bricolage</a>.
This module bundles up all of the required modules so that <code>CPAN</code>
will install them for you:</p>

<pre><code>% perl -MCPAN -e 'install Bundle::Bricolage'</code></pre>

<p>There are also several optional modules.  Install these all in one command
by using the <a href="http://search.cpan.org/dist/Bundle-BricolagePlus/"
title="Bundle::BricolagePlus on CPAN">Bundle::BricolagePlus</a> module:</p>

<pre><code>% perl -MCPAN -e 'install Bundle::BricolagePlus'</code></pre>

<p>Installing the Perl modules yourself can be useful if you expect to have
trouble with one or more of them, as you can easily go back and manually
install any troublesome modules. If you want to install them all yourself,
without using the bundles, the <em>INSTALL</em> file has a complete list
(copied from <a href="http://www.bricolage.cc/docs/current/api/Bric::Admin"
title="Bric::Admin">Bric::Admin</a>).  I don't recommend this approach,
however; it will take you all night!</p> </dd>

</dl>

<p><strong>Note:</strong> Bricolage currently does not run on Windows. This
situation will likely change soon, with the forthcoming introduction of
PostgreSQL 8.0 with native Windows support as well as <code>mod_perl</code> 2.
Watch the <a href="http://www.bricolage.cc/" title="Bricolage
website">Bricolage web site</a> for announcements in the coming months.</p>













<h3>Installation</h3>

<p>With all of the major dependencies worked out, it's time to install
Bricolage. Download it from the <a href="http://www.bricolage.cc/downloads/"
title="Bricolage Downloads">Bricolage download page</a> to the directory of
your choice. Bricolage is distributed as a tarball like most Perl modules.
Decompress it and then execute the usual Perl module commands to install
it:</p>

<pre><code>% wget http://www.bricolage.cc/downloads/bricolage-1.8.2.tar.gz
% tar zxvf bricolage-1.8.2.tar.gz
% cd bricolage-1.8.2
% perl Makefile.PL
% make
% make test
% make install</code></pre>

<p>OK, to be fair, the process is actually more complicated than that,
principally during <code>make</code>. Let's walk through the process.</p>

<h3>Installation Configuration</h3>

<p>The first step, <code>perl Makefile.PL</code>, doesn't really do what it
does with your typical Perl modules. It's really just a wrapper around a custom
<code>Makefile</code> to make sure that everything thereafter uses the Perl
binary with which you executed <em>Makefile.PL</em>. If you're using an
installation of Perl somewhere other than in your path, use it to execute
<em>Makefile.PL</em> explicitly, such as <code>/path/to/my/perl
Makefile.PL</code>.</p>

<p>The next step, <code>make</code>, will take the most time as the installer
pauses to ask several questions. Let's take it step-by-step.</p>

<pre><code>% make
/usr/bin/perl inst/required.pl


==&gt; Probing Required Software &lt;==

looking for PostgreSQL with version &gt;= 7.3.0...
Found PostgreSQL's pg_config at '/usr/local/pgsql/bin/pg_config'.
Is this correct? [yes] </code></pre>

<p>The first thing the Bricolage installer does is to check for all of its
dependencies. Here, it asks for the location of <code>pg_config</code>, the
PostgreSQL configuration program. The installer will use this application to
determine the version number of PostgreSQL, among other things. If you're using
a package-installed version of PostgreSQL, make sure that you have the
PostgreSQL development tools installed, as well (yes, I'm looking at
<em>you</em>, Red Hat users!). Bricolage will look in several common locations
for <code>pg_config</code>; if it doesn't find it, or if it finds the wrong one
(because you have more than one installed), type in the location of
<code>pg_config</code>. Otherwise, simply accept the one it has found.</p>

<pre><code>Is this correct? [yes] <strong>[Return]</strong>
Found acceptable version of Postgres: 7.4.3.
Looking for Apache with version &gt;= 1.3.12...
Found Apache server binary at '/usr/sbin/httpd'.
Is this correct? [yes] </code></pre>

<p>Next, the Bricolage installer searches for an instance of Apache 1.3.x. This
time it's looking for the <code>httpd</code> executable. The same comments that
applied to PostgreSQL apply to the Apache Web server; either accept the
instance of <code>httpd</code> or type in an alternate. On my Mac, I never use
Apple's Apache (an old habit because Apple's Apache uses a DSO
<code>mod_perl</code>, whereas I always compile my own with a static
<code>mod_perl</code>).</p>

<pre><code>Is this correct? [yes] <strong>no</strong>
Enter path to Apache server binary [/usr/sbin/httpd] <strong>/usr/local/apache/bin/httpd</strong>
Are you sure you want to use '/usr/local/apache/bin/httpd'? [yes] <strong>[Return]</strong>
Found Apache executable at /usr/local/apache/bin/httpd.
Found acceptable version of Apache: 1.3.31.
Looking for expat...
Found expat at /usr/local/lib/libexpat.so.</code></pre>

<p>From here, the Bricolage installer continues looking for other dependencies,
starting with the Expat XML parsing library. Then the installer probes for all
of the required and optional Perl modules:</p>

<pre><code>==&gt; Finished Probing Required Software &lt;==

/usr/bin/perl inst/modules.pl


==&gt; Probing Required Perl Modules &lt;==

Looking for Storable...found.
Looking for Time::HiRes...found.
Looking for Unix::Syslog...found.
Looking for Net::Cmd...found.
Looking for Devel::Symdump...found.
Looking for DBI...found.
Checking that DBI version is &gt;= 1.18... ok.
&x2026;</code></pre>

<p>As I said, Bricolage requires quite a few Perl modules, so I'm truncating
the list here for the sake of space. If any required modules are missing, the
installer makes a note of it. If any optional modules are missing, it will
prompt you to find out if you want to install them. Respond as appropriate.</p>

<pre><code>&#x2026;
Looking for HTML::Template...found.
Looking for HTML::Template::Expr...found.
Looking for Template...found.
Checking that Template version is &gt;= 2.14... ok.
Looking for Encode...found.
Looking for Pod::Simple...found.
Looking for Test::Pod...found.
Checking that Test::Pod version is &gt;= 0.95... ok.
Looking for Devel::Profiler... found.
Checking that Devel::Profiler version is &gt;= 0.03... ok.
Looking for Apache::SizeLimit...found.
Looking for Net::FTPServer...found.
Looking for Net::SFTP...not found.
Do you want to install the optional module Net::SFTP? [no] <strong>[Return]</strong>
Looking for HTTP::DAV...not found.
Do you want to install the optional module HTTP::DAV? [no] <strong>[Return]</strong>
Looking for Text::Levenshtein...not found.
Do you want to install the optional module Text::Levenshtein? [no] <strong>yes</strong>
Looking for Crypt::SSLeay...found.
Looking for Imager...found.
Looking for Text::Aspell...not found.

Do you want to install the optional module Text::Aspell? [no] <strong>[Return]</strong>
Looking for XML::DOM...not found.
Do you want to install the optional module XML::DOM? [no] <strong>[Return]</strong>
Looking for CGI...found.</code></pre>

<p>In this example, I've elected to install the <a
href="http://search.cpan.org/dist/Text-Levenshtein">Text::Levenshtein</a>
module, but no other optional modules not already installed.</p>


<h4>Optional Perl Modules</h4>

<p>Of course, if you previously installed Bundle::BricolagePlus from CPAN, you
will have all of the optional modules installed.  Let me provide a bit of
background on each optional module so that you can decide for yourself which
you need and which you don't. If you're just starting out with Bricolage, I
recommend you don't worry too much about the optional modules; you can always
add them if you decide that you need them later.</p>

<dl>
<dt>HTML::Template and HTML::Template::Expr</dt>
<dd>

<p>These two modules are necessary to create HTML::Template templates to format
your content in Bricolage. Most Bricolage users use the required HTML::Mason
module, but you should elect to install these modules if you're an
HTML::Template user.</p>
</dd>

<dt>Template 2.14</dt>
<dd>

<p>Install the Perl Template Toolkit if you plan to write your content
formatting templates in Template Toolkit rather than in Mason or
HTML::Template.</p>
</dd>

<dt>Encode</dt>
<dd>

<p>The Encode module comes with and only works with Perl 5.8.0 and later.
Install it you plan to support any character encodings other than UTF-8 in the
Bricolage UI.</p>
</dd>

<dt>Pod::Simple and Test::Pod 0.95</dt>
<dd>

<p>These modules help to test the Bricolage API documentation,
but are not otherwise necessary.</p>
</dd>

<dt>Devel::Profiler 0.03</dt>
<dd>

<p>This module can be useful if you experience performance problems with Bricolage and need to profile it to identify the bottleneck.  You can always
install it later if you need it.</p>
</dd>

<dt>Apache::SizeLimit</dt>
<dd>

<p>This module is useful for busy Bricolage installations. Because Perl does
not return memory to the operating system when it has finished with it, the
Apache/<code>mod_perl</code> processes can sometimes get quite large. This is
especially true if you use the SOAP interface to import or publish a lot of
documents.  Apache::SizeLimit allows you to configure <code>mod_perl</code> to
kill off its processes when they exceed a certain size, thus returning the
memory to the OS. This is the best way to keep the size of Bricolage under
control in a busy environment.</p>
</dd>

<dt>Net::FTPServer</dt>
<dd>

<p>This module is necessary to use the Bricolage virtual FTP server.  The
virtual FTP server makes it easy to edit Bricolage templates via FTP. It's a
very nice feature when you're doing a lot of template development work,
offering a more integrated interface for your favorite editor than the
cut-and-paste approach of the UI. The downside is that FTP is an unencrypted
protocol, so it sends passwords used to log in to the Bricolage virtual FTP
server sent in the clear. This may not be so important if you're using
Bricolage behind a firewall or on a VPN, and is irrelevant if you're not using
SSL, because you're already sending passwords in the clear; but don't do
that.</p>

</dd>

<dt>Net::SFTP 0.08</dt>
<dd>

<p>This module is necessary if you plan to distribute document files to your
delivery server via secure FTP. Bricolage supports file system copying, FTP,
secure FTP, and DAV distribution.</p>
</dd>

<dt>HTTP::DAV</dt>
<dd>

<p>Install this module if you plan to distribute document files to your
delivery server via DAV.</p>
</dd>

<dt>Text::Levenshtein</dt>
<dd>

<p>This module is an optional alternative to the required Text::Soundex module.
Bricolage uses it to analyze field names and suggest alternatives for
misspellings in the <q>Super Bulk Edit</q> interface. Either of these modules
is fine, although many people consider Text::Levenshtein to have a superior
algorithm. I'll show an example of how this works in the Super Bulk Edit
interface in a later article.</p>

</dd>

<dt>Crypt::SSLeay</dt>
<dd>

<p>Install this module if you plan to use SSL with Bricolage.  It allows the
SOAP clients to negotiate an encrypted connection to Bricolage.</p>

</dd>

<dt>Imager</dt>
<dd>

<p>This module is necessary if you plan to enable thumbnail images in Bricolage
&#x2014; why wouldn't you want that? You'll need to make sure that you first
have all of the supporting libraries you need installed, such as
<em>libpng</em>, <em>libtiff</em>, and <em>libgif</em> (or <em>giflib</em>).
I'll discuss enabling thumbnail support in the next article.</p>

</dd>

<dt>Text::Aspell, XML::DOM, and CGI</dt>
<dd>

<p>These modules are necessary to use the spell-checking available with the
optional HTMLArea module. I'll discuss HTMLArea support in the next
article.</p>

</dd>
</dl>













<h4>Back to Installation Configuration</h4>

<p>After the Bricolage installer has determined which Perl module dependencies need to be satisfied, it moves on to checking the Apache dependencies,
using the path to the <code>httpd</code> binary we provided earlier:</p>

<pre><code>==&gt; Finished Probing Required Perl Modules &lt;==

/usr/bin/perl inst/apache.pl


==&gt; Probing Apache Configuration &lt;==

Extracting configuration data from `/usr/local/apache/bin/httpd -V`.
Reading Apache conf file: /usr/local/apache/conf/httpd.conf.
Extracting static module list from `/usr/local/apache/bin/httpd -l`.
Your Apache supports loadable modules (DSOs).
Found Apache user: nobody
Found Apache group: nobody
Checking for required Apache modules...
All required modules found.
====================================================================

Your Apache configuration suggested the following defaults.  Press
[return] to confirm each item or type an alternative.  In most cases
the default should be correct.

Apache User:                     [nobody]</code></pre>

<p>The most important settings relative to Apache are the Apache user, group,
and port, as well as the domain name of your new Bricolage server. The
Bricolage installer probes the default Apache <em>httpd.conf</em> file to
select default values, so you can often accept these:</p>

<pre><code>Apache User:                     [nobody] <strong>[Return]</strong>
Apache Group:                    [nobody] <strong>[Return]</strong>
Apache Port:                     [80] <strong>[Return]</strong>
Apache Server Name:              [geertz.example.com] <strong>bricolage.example.com</strong></code></pre>

<p>Here I've elected only to change the hostname for my Bricolage server.
Because Bricolage requires its own hostname to run, I've just given it a
meaningful name. Be sure to set up DNS as necessary to point to your
Bricolage-specific domain name. You can also run Bricolage on alternate ports,
which can be useful on a server running Bricolage in addition to an existing web server (see the Bricolage web site for more information on <a
href="http://www.bricolage.cc/docs/howtos/2004/09/18/separate_instance_config/"
title="Running Bricolage on the Same Machine as the Front-End Server">running
Bricolage concurrent with another web server process</a>).</p>

<p>Bricolage will also check to see if your Apache binary includes support for
<code>mod_ssl</code> or Apache-SSL. If so, it will ask if you wish to use SSL
support with Bricolage:</p>

<pre><code>Do you want to use SSL? [no] <strong>yes</strong>
SSL certificate file location [/usr/local/apache/conf/ssl.crt/server.crt] <strong>[Return]</strong>
SSL certificate key file location [/usr/local/apache/conf/ssl.key/server.key] <strong>[Return]</strong>
Apache SSL Port:                 [443] <strong>[Return]</strong></code></pre>

<p>Here I've elected to use the default values. If your Apache server has both
<code>mod_ssl</code> and Apache-SSL support, the installer will prompt to find
out which you wish to use. The installer will pull the default SSL certificates
from the Apache <em>conf</em> directory; type in alternatives if you want to
use different certificates or if the installer couldn't find any.</p>

<p>Once it has all of the Apache configuration information in hand, the
Bricolage installer moves on to gathering PostgreSQL information:</p>

<pre><code>==&gt; Finished Probing Apache Configuration &lt;==

/usr/bin/perl inst/postgres.pl


==&gt; Probing PostgreSQL Configuration &lt;==

Extracting postgres include dir from /usr/local/pgsql/bin/pg_config.
Extracting postgres lib dir from /usr/local/pgsql/bin/pg_config.
Extracting postgres bin dir from /usr/local/pgsql/bin/pg_config.
Finding psql.
Finding PostgreSQL version.</code></pre>

<p>In order to create the Bricolage database and populate it with default data,
the installer needs access to the database server as the PostgreSQL
administrative or <q>Root</q> user, usually <q>postgres</q>. Then it will ask
you to pick names for the Bricolage database and PostgreSQL user, which it will
create:</p>

<pre><code>Postgres Root Username [postgres] <strong>[Return]</strong>
Postgres Root Password (leave empty for no password) [] <strong>[Return]</strong>
Postgres System Username [postgres] <strong>[Return]</strong>
Bricolage Postgres Username [bric] <strong>[Return]</strong>
Bricolage Postgres Password [NONE] <strong>password</strong>
Are you sure you want to use 'password'? [yes] <strong>[Return]</strong>
Bricolage Database Name [bric] <strong>[Return]</strong></code></pre>

<p>Here I've accepted the default value for the <q>Postgres Root
Username</q>. I left the password empty because by default PostgreSQL allows
local users to access the server without a username. Instances of PostgreSQL
installed from a package may have other authentication rules; consult the
documentation for your installation of PostgreSQL for details. The <q>Postgres
System Username</q> is necessary only if you're running PostgreSQL on the same
box as Bricolage. If so, then you'll need to type in the Unix username under
which PostgreSQL runs (also usually <q>postgres</q>). If PostgreSQL is running
on another box, enter <q>root</q> or some other real local username for this
option.</p>

<p>You can give your Bricolage database and PostgreSQL user any names you like,
but the defaults are typical. You must provide a password for the Bricolage
PostgreSQL username (here I've entered <q>password</q>). Next, the Bricolage
installer will prompt for the location of your PostgreSQL server:</p>

<pre><code>Postgres Database Server Hostname (default is unset, i.e. local domain socket)
      [] <strong>[Return]</strong>
Postgres Database Server Port Number (default is local domain socket)
      [] <strong>[Return]</strong></code></pre>

<p>Here I've accepted the defaults, because I'm running PostgreSQL on the local
box and on the default port. In fact, if you leave these two options to their
empty defaults, Bricolage will use a Unix socket to communicate with the
PostgreSQL server. This has the advantage of not only being faster than a
TCP/IP connection, but it also allows you to turn off PostgreSQL's TCP/IP
support if you worry about having another port open on your server. However, if
PostgreSQL is running on a separate box, you must enter a host name or IP
address. If it's running on a port other than the default port (5432), enter
the appropriate port number.</p>

<p>Next, the Bricolage installer asks how you want to install its various
parts:</p>

<pre><code>==&gt; Finished Probing PostgreSQL Configuration &lt;==

/usr/bin/perl inst/config.pl


==&gt; Gathering User Configuration &lt;==

========================================================================

Bricolage comes with two sets of defaults.  You'll have the
opportunity to override these defaults but choosing wisely here will
probably save you the trouble.  Your choices are:

  s - "single"   one installation for the entire system

  m - "multi"    an installation that lives next to other installations
                 on the same machine

Your choice? [s] </code></pre>

<p>There are essentially two ways to install Bricolage: The first,
<q>single</q>, assumes that you will only ever have a single instance of
Bricolage installed on your server. In such a case, it will install all of the
Perl modules into the appropriate Perl <code>@INC</code> directory like any
other Perl module and the executables into the same <em>bin</em> directory as
your instance of Perl (such as <em>/usr/local/bin</em>).</p>

<p>The second way to install Bricolage is with the <q>multi</q> option. This
option allows you to have multiple versions of Bricolage installed on a single
server. Even if you never intend to do this, I generally recommend taking this
approach, because the upshot is that <em>all</em> of your Bricolage files (with
the exception of the database, the location of which depends on your PostgreSQL
configuration) will install into a single directory.  This makes it very easy
to keep track of where everything is.</p>

<pre><code>Your choice? [s] <strong>m</strong></code></pre>

<p>Next, the Bricolage installer wants to know where to install Bricolage.  The
default option, <em>/usr/local/bricolage</em>, is the easiest, but you can put
it anywhere you like. All of the other relevant directories will by default be
subdirectories of this directory, but you can change them too. For example, you
might prefer to have the error log file in the typical log directory for your
OS, such as <em>/var/log</em>. Personally, I prefer to keep everything in one
place.</p>

<pre><code>Bricolage Root Directory [/usr/local/bricolage] <strong>[Return]</strong>
Temporary Directory [/usr/local/bricolage/tmp] <strong>[Return]</strong>
Perl Module Directory [/usr/local/bricolage/lib] <strong>[Return]</strong>
Executable Directory [/usr/local/bricolage/bin] <strong>[Return]</strong>
Man-Page Directory (! to skip) [/usr/local/bricolage/man] <strong>[Return]</strong>
Log Directory [/usr/local/bricolage/log] <strong>[Return]</strong>
PID File Location [/usr/local/bricolage/log/httpd.pid] <strong>[Return]</strong>
Mason Component Directory [/usr/local/bricolage/comp] <strong>[Return]</strong>
Mason Data Directory [/usr/local/bricolage/data] <strong>[Return]</strong></code></pre>

<p>If you elected for the <q>single</q> installation option, then your choices
would look more like:</p>

<pre><code>Bricolage Root Directory [/usr/local/bricolage] <strong>[Return]</strong>
Temporary Directory [/tmp] <strong>[Return]</strong>
Perl Module Directory [/usr/local/lib/perl5/site_perl/5.8.5] <strong>[Return]</strong>
Executable Directory [/usr/local/bin] <strong>[Return]</strong>
Man-Page Directory (! to skip) [/usr/local/man] <strong>[Return]</strong>
Log Directory [/usr/local/apache/logs/] <strong>[Return]</strong>
PID File Location [/usr/local/apache/logs/httpd.pid] <strong>[Return]</strong>
Mason Component Directory [/usr/local/bricolage/comp] <strong>[Return]</strong>
Mason Data Directory [/usr/local/bricolage/data] <strong>[Return]</strong></code></pre>

<p>Again, you can customize these as you like. That's it for the installation
configuration!</p>

<pre><code>==&gt; Finished Gathering User Configuration &lt;==


===========================================================
===========================================================

Bricolage Build Complete. You may now proceed to
"make cpan", which must be run as root, to install any
needed Perl modules; then to
"make test" to run some basic tests of the API; then to
"make install", which must be run as root.

===========================================================
===========================================================</code></pre>

<h4>Installing CPAN Modules</h4>

<p>Whether you elected to install optional CPAN modules, the Bricolage
installer still might have identified missing module dependencies, so it's a
good idea to follow the helpful instructions and run <code>make cpan</code>. Of
course, the <code>cpan</code> target will implicitly execute if you just moved
on to <code>make test</code>, but it's a good idea to run it on its own to have
more control over things and to identify any possible problems.  My system had
all of the dependencies satisfied already (I've done this once or twice
before), but you'll recall that I had elected to install the optional
Text::Leventshtein module. The Bricolage installer will therefore attempt to
install it from CPAN.</p>

<pre><code>% make cpan
/usr/bin/perl inst/cpan.pl
This process must (usually) be run as root.
Continue as non-root user? [yes] <strong>n</strong>
make: *** [cpan] Error 1</code></pre>

<p>Whoops! Don't make the mistake I just made! <code>make cpan</code> must run
as the root user.</p>

<pre><code>% sudo make cpan 
/usr/bin/perl inst/cpan.pl


==&gt; Installing Modules From CPAN &lt;==

CPAN: Storable loaded ok
CPAN: LWP::UserAgent loaded ok

&x2026;

Found Text::Levenshtein.  Installing...
Running install for module Text::Levenshtein
Running make for J/JG/JGOLDBERG/Text-Levenshtein-0.05.tar.gz
Fetching with LWP:
  http://www.perl.com/CPAN/authors/id/J/JG/JGOLDBERG/Text-Levenshtein-0.05.tar.gz

&x2026;

Text::Levenshtein installed successfully.


==&gt; Finished Installing Modules From CPAN &lt;==</code></pre>

<p>I've truncated the output here, but you should have the general idea. The
Bricolage installer uses the Perl <code>CPAN</code> module to install any
needed modules from CPAN.  If you encounter any problems, you might need to
stop and manually configure and install a module. If so, once you're ready to
continue with the Bricolage installation, delete the <em>modules.db</em> file
in order to force the installer to detect all modules again so that it notices
that you now have the module installed:</p>

<pre><code>% rm modules.db
% sudo make cpan</code></pre>

<h4>Running Tests</h4>

<p>The next step in installing Bricolage is optional, but will help identify
any pitfalls before going any further. That's running the test suite.</p>

<pre><code>% make test                                    
PERL_DL_NONLAZY=1 /usr/bin/perl inst/runtests.pl
t/Bric/Test/Runner....ok                                                     
All tests successful, 7 subtests skipped.
Files=1, Tests=2510, 21 wallclock secs ( 8.83 cusr +  1.39 csys = 10.22 CPU)</code></pre>

<h4>Make it So!</h4>

<p>Once all tests pass, you're ready to install Bricolage:</p>

<pre><code>% sudo make install
/usr/bin/perl inst/is_root.pl
/usr/bin/perl inst/cpan.pl
All modules installed. No need to install from CPAN.
rm -f lib/Makefile
cd lib; /usr/bin/perl Makefile.PL; make install
&x2026;
==&gt; Finished Copying Bricolage Files &lt;==</code></pre>

<p>If you happened to select a database name for Bricolage for a database that
already exists, the installer will warn you about it:</p>

<pre><code>/usr/bin/perl inst/db.pl


==&gt; Creating Bricolage Database &lt;==

Becoming postgres...
Creating database named bric...
Database named "bric" already exists.  Drop database? [no] </code></pre>

<p>Now you have a choice. If you elect to dropt the database, the Bricolage
installer will drop it and then create a new copy &mdash; but it must have
<q>Root</q> user access to the PostgreSQL server. In other situations you might
want to continue with the installed database, as in the case when your ISP has
created the database for you ahead of time. You will also receive a prompt if
the PostgreSQL user for the Bricolage database already exists. Again, you can
either opt to drop and recreate the user or continue with the existing
username:</p>

<pre><code>Database named "bric" already exists.  Drop database? [no] <strong>[Return]</strong>
Create tables in existing database? [yes] <strong>[Return]</strong>
Creating user named bric...
User named "bric" already exists. Continue with this user? [yes] <strong>[Return]</strong>
Loading Bricolage Database (this may take a few minutes).</code> </pre>

<p>At this point, the Bricolage installer is creating the Bricolage database.
On my Mac, it takes about a minute to create the database, but your mileage may
vary. Once that ends, the installer grants the appropriate PostgreSQL
permissions and the installation is complete!</p>

<pre><code>Done.
Finishing database...
Done.
/usr/bin/perl inst/db_grant.pl
Becoming postgres...
Granting privileges...
Done.
/usr/bin/perl inst/done.pl


=========================================================================
=========================================================================

                   Bricolage Installation Complete

You may now start your Bricolage server with the command (as root):

  /usr/local/bricolage/bin/bric_apachectl start

If this command fails, look in your error log for more information:

  /usr/local/bricolage/log/error_log

Once your server is started, open a web browser and enter the URL for
your server:

  http://bricolage.example.com

Login in as "admin" with the default password "change me now!". Your
first action should be changing this password. Navigate into the ADMIN -&gt;
SYSTEM -&gt; Users menu, search for the "admin" user, click the "Edit"
link, and change the password.

=========================================================================
=========================================================================</code></pre>

<h4>Start 'er Up and Login</h4>

<p>That's it. Bricolage should start with the command helpfully provided by the
installer:</p>

<pre><code>% sudo /usr/local/bricolage/bin/bric_apachectl start
bric_apachectl start: starting httpd
bric_apachectl start: httpd started</code></pre>

<p>If you set the Bricolage root directory to something other than
<em>/usr/local/bricolage</em>, you'll need to set the
<code>$BRICOLAGE_CONF</code> environment variable, first. For example, using
Bash or Zsh, do:</p>

<pre><code>% BRICOLAGE_ROOT=/opt/bricolage \
&gt; sudo /opt/bricolage/bin/bric_apachectl start
bric_apachectl start: starting httpd
bric_apachectl start: httpd started</code></pre>

<p>Once Bricolage successfully starts, point your browser to the appropriate
URL and login as the <q>admin</q> user and change the password!</p>

<h3><a id="upnext">Up Next: Bricolage Runtime Configuration</a></h3>

<p>Now that you have Bricolage up and running, you can start using it. Consult
the documentation as directed in the <em>README</em> file to get started. Feel
free to also subscribe to the <a href="http://www.bricolage.cc/support/lists/"
title="Bricolage Mail Lists">Bricolage mail lists</a> to ask any questions and
to learn from the brave souls who have gone before you.</p>

<p>If you're interested in tuning your Bricolage installation, be sure to catch
my next article, <q>Bricolage Runtime Configuration</q>, in which I'll cover
all of the options when configuring Bricolage for added functionality and
features.</p>











        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-976" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2004/08/bricolage.html" rel="bookmark">Content Management with Bricolage</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">David Wheeler</span> on <abbr class="published" title="2004-08-27T00:00:00-08:00">August 27, 2004 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            
<!-- sidebar begins -->
<!-- don't move sidebars -->
<!-- sidebar ends -->
<br clear="all" />
<p>If you've ever had to manage a web site with tens of thousands of pages of
content where many people need to be able to update that content, you've no
doubt recognized the need for a content management system (CMS). Once you start to
manage <em>several</em> such sites, the problem becomes even worse. Since
you're reading this article on Perl.com, I'm going to go out on a limb and
guess that you're actually interested in Perl-based content management
systems.</p>

<p>Well, you're in luck.</p>

<p>This article is the first in a series on Perl.com introducing Bricolage, a
Perl-powered, open-source, enterprise-class CMS currently in production for
some of the most actively updated sites on the Internet today, including <a href="http://www.maccentral.com/" title="Visit MacCentral">MacCentral</a>,
<a href="http://et.yahoo.com/" title="Visit ETonline">ETonline</a>, and the <a href="http://www.who.int/" title="Visit the WHO site">World Health
Organization</a>. I start with a high-level overview (think <em>executive
summary</em>) of the concept of content management, the nature of the content
management ecosystem, and how Bricolage competes with other solutions in that
ecosystem. Future articles will cover installation, document modeling,
templating, and the Bricolage SOAP interface, among other topics. But first,
the basics.</p>

<h3>What is Content Management?</h3>

<p>So much is made of the importance of web content management these days that
the term, unfortunately, has been used to apply to just about any piece of
software that somehow relates to the Web or to HTML. This trend has naturally
eroded the meaning of the term <dfn>content management</dfn>. So I'm just
going to punt on providing yet another definition, and focus instead on
contrasting some of the categories of site-management software. In the
process, I highlight where and how Bricolage fits into the CM ecosystem, and
you get the benefit of determining what category of solution best fits your
own content management needs.</p>

<h4>Content Management vs. Community Building</h4>

<csperl file="grab" domain="on" record="b/971" template="b/article_sidebar.view">

<p>First, there is the difference between content management systems and what
I call <dfn>community-building</dfn> solutions, such as <a href="http://www.slashcode.com/" title="Visit Slashcode.com">Slash</a> and the
<a href="http://phpnuke.org/" title="PHP-Nuke">various</a> <a href="http://www.postnuke.com/" title="PostNuke">Nuke</a> <a href="http://cpgnuke.com/" title="CPG Nuke">engines</a>. These applications
are ideal for setting up community-building and discussion sites, such as <a href="http://www.slashdot.org/" title="Slashdot">Slashdot</a>, <a href="http://www.macrumors.com/" title="MacRumors.com">MacRumors.com</a>, or
(my favorite) <a href="http://use.perl.org/" title="use Perl">use
Perl</a>. The idea behind these solutions is to allow site users to register
with the site and post comments about articles, content on other sites, or
each other's comments.</p>

<p>True content management systems, on the other hand, are primarily designed
to allow organizations to centrally manage and deliver <dfn>content</dfn>,
such as articles, white papers, marketing materials, or what have you. The
emphasis is not on discussion (and indeed, most content management
systems -- including Bricolage -- don't offer discussion interfaces),
but on assuring the consistency of content structure and formatting. Good
examples of such systems include <a href="http://www.bricolage.cc/"
title="Visit the Bricolage site">Bricolage</a>,
<a href="http://www.plone.org/" title="Visit the Plone site">Plone</a>,
<a href="http://www.vignette.com/" title="Vignette">Vignette</a>, and <a href="http://www.interwoven.com/" title="Interwoven">Interwoven TeamSite</a>.</p>

<h4>Application Framework vs. Turnkey Application</h4>

<p>Next, there's the distinction between <dfn>application frameworks</dfn> and
<dfn>turnkey applications</dfn>. Frameworks are not actual solutions, but
provide the tools for you to create your own solutions. Anyone who has
programmed in Java understands what a framework is; a content-management
framework provides an array of tools and libraries that you can use (or pay
high-priced consultants to use on your behalf) to create an application to
meet your needs.</p>

<p>Many organizations have bought such frameworks, and in large,
heterogeneous environments with six- and seven-figure budgets and years to
implement a solution, it can make a lot of sense. Good examples of such
frameworks are Vignette, TeamSite, and the Python-based <a href="http://www.zope.com/" title="Zope Corporation">Zope</a>.</p>

<p>A turnkey application, on the other hand, is a complete application out of
the box. It will still likely require a good deal of customization to
implement a turnkey application-based solution in a complex environment, but
we're typically talking weeks or, at the most, a few months. The downside to
such a solution is that you're limited to the features that the developers of
the application anticipated would be needed; only with open-source solutions
do you have the possibility of adding your own. Fortunately, this category of
content management is well represented in the open-source space, including
such stalwarts as Bricolage, Plone (built on the Zope framework),
and <a href="http://typo3.org/" title="The Typo3 site">TYPO3</a>.</p>

<h4>Application Server vs. Document Management and Publishing</h4>

<p>And finally, there is the difference between content management
<dfn>application servers</dfn> and <dfn>document management and
publishing</dfn> solutions. Application servers serve dual roles in life: they
provide an interface for managing content, and they deliver that content to
the final audience. This approach has advantages for some organizations, in
that it requires only a single server, document updates are immediate, and you
need deal with only one technology. Plone, Zope, and the <a href="http://c2.com/cgi/wiki?WikiWikiWeb" title="WikiWiki">various</a> <a href="http://www.twiki.org/" title="Twiki">Wiki</a> <a href="http://www.kwiki.org/" title="Kwiki">solutions</a> for ad-hoc content
management are typical content-management application servers. <a href="http://www.blosxom.com/" title="Blosxom">Blogging</a> <a href="http://www.moveabletype.org/" title="Movable Type">software</a> tends to
fall into this category, as well.</p>

<p>The downside to application servers is that, because they both manage and
deliver content, your choice of delivery technology is limited to the
technology choices of the software developers. With Plone, for example, you
have to use Zope to serve content to the final audience. Furthermore, many of
them provide templates for the output of content that limit how much you can
customize the look and feel of your site. And finally, performance on a
high-volume site can suffer, due to the overhead of the API and database, as
well as the trickiness of distributing content across an array of application
servers (think caching).</p>

<p>Document management and publishing systems, however, function entirely
independent of delivery solutions. They focus on managing documents, moving
them through workflow, ensuring the consistency of their structures, and
publishing them to external systems for delivery to the end audience. Content
is completely independent of presentation in these systems. Upon publication,
they push content through templates to format it into one or more types of
output (HTML, XML, RSS, Mason, PHP, etc.), and then distribute the resulting
files to other servers (typically a web, file, or application server) for
delivery to the final audience.</p>

<p>This separation allows the document management
and publishing server to do what it does best, freeing up the delivery server
to do what it does best: serve content. Bricolage is perhaps the best-known solution in this category. Another one is the recently introduced <a href="http://krang.sourceforge.net/" title="The Krang site">Krang</a>, which
is itself heavily based on Bricolage.</p>

<p>The downside to the document management and publishing systems is that,
while you are free to use whatever delivery technology you wish (plain HTML,
PHP, JSP, ASP, TT3, SSI, etc.), for security and scalability reasons the
publishing server generally must run on its own hardware, independent of the
delivery server. Furthermore, these solutions tend to have a broader set of
features than their application-server cousins. Since they don't worry about
serving content, they can provide other essentials such as document modeling,
workflow, multi-site management, multiple output channels, etc. While such
functionality increases the flexibility of the software, it can also increase
the complexity of an implementation. The upshot is that the implementation of
such a solution requires a good deal of forethought and planning.</p>

<h3>Why Bricolage?</h3>

<p>Now that you have a feel for where Bricolage fits into the content-management universe (see how it's grown beyond an &quot;ecosystem&quot; in the
space of a few paragraphs?), let's take a look at why Bricolage is a good
solution for the complex content-management needs of organizations with large
volumes of content, many content contributors and editors, and/or multiple
sites to manage. Essentially, this boils down to a brief overview of some of
the more important features of Bricolage. Once you've read this section, you
should have a good idea of whether Bricolage is right for your
organization.</p>

<h4>Browser-based Editing and Administration</h4>
  
    <p>Bricolage provides a complete browser-based interface. Designed to work
      with any standards-compliant graphical browser, you can handle nearly
      all configuration and administration tasks via the browser. All document
      editing can be carried out in the browser, as well. Content authors can
      create and edit content using up to four different interfaces, including
      separate fields for each block-level piece of content (paragraphs,
      headers, blockquotes, etc.), bulk editing of multiple fields at once, or
      WYSIWYG-style editing with <a href="http://www.interactivetools.com/products/htmlarea/" title="The
      htmlArea site">htmlArea</a> in Internet Explorer and Gecko-based
      browsers such as Mozilla and Firefox.</p>
   

  <h4>Document Modeling</h4>
  
    <p>The document-modeling features of Bricolage allow you to model the
    structure of your documents entirely via the browser-based interface. Once
    you've ascertained the different types of documents your organization
    needs to manage, and what their structures will be, you can model them in
    Bricolage. All documents created in Bricolage are based on such models,
    and as such, must adhere to the hierarchical definition of elements and
    fields that constitute their models. This approach assures the consistency
    of document structure.</p>

    <div style="width: 400px;">
      <img src="/pub/2004/08/27/graphics/element_profile_half.gif" width="400" height="609" alt="Bricolage Element Profile" />
      <p><em>Bricolage's element-administration interface makes it easy to create 
        new elements, add sub-elements, and create content fields.</em></p>
    </div>














    <p>Bricolage document models are built into a tree-like structure of
    <dfn>elements</dfn> and <dfn>fields</dfn>. Elements are the building
    blocks of content in Bricolage. They represent various parts of documents,
    such as pages; side bars; related media such as images, lists, related
    links; and the like. Every element can contain zero or more sub-elements,
    and together the hierarchy of elements make up the &quot;branches&quot; of the
    document model tree. Fields represent the &quot;leaves&quot;, and are the
    containers into which content can be entered. Any kind of HTML field can
    be defined for use in the Bricolage UI, including <code>text</code> input
    fields, <code>textarea</code> fields, and <code>select</code>
    lists. Typical fields include &quot;paragraphs,&quot; &quot;headers,&quot; &quot;list
    items,&quot; &quot;teasers,&quot; and &quot;URLs.&quot;</p>

    <p>When an editor creates a document, it is based on a document model, and
    its structure must adhere to the model's element structure. Documents
    consist of a tree structure of elements, corresponding to the element
    structure of the document model, and in this way ensure the consistency of
    structure across documents. For more on Bricolage document modeling and
    elements, watch for the third article in this series, &quot;Bricolage
    Document Modeling.&quot;</p>
  

  <h4>Separation of Content from Presentation</h4>
  
    <p>Since Bricolage document models are purely about structure, and a
    document's content will be stored in Bricolage in the same structured
    fashion as its model defines, no presentation information is generally
    included in a document. In other words, the content of a document is pure
    content, with little or no reference to formatting. Instead, it is a
    simple structural object representing the tree-like configuration of
    content elements.</p>

    <p>The upside to this architecture is that highly structured content
    enables a virtually unlimited array of output options. The templates that
    format content can take advantage of the well-defined composition of a
    document model to grab the elements they need for the format they
    understand. Thus, a single document can be used to output a structured XML
    file, a set of HTML pages, an RSS feed, a PDF file, or whatever you
    require.</p>

<p>Done right, you get the Holy Grail of one canonical document and
    unlimited representations of that document. This capability is especially
    important in the fast-moving environment of the Internet, where new
    formatting standards are regularly introduced, demanding the creation of
    new templates to output existing content to satisfy the new standards.</p>
  

  <h4>Content Categorization</h4>
  
    <p>All Bricolage documents can be organized into one or more categories.
    These categories are hierarchical, and the hierarchies are used in part to
    create document URLs. This design allows you to store your documents in
    sensible locations on your web site, and provides them with legible URLs
    that search engines just love. Furthermore, it's easy to search for
    documents in a given category or set of categories using the Bricolage
    API, so that you can quickly create templates to generate category-specific directories of documents, such as RSS feeds.</p>

    <div style="width: 400px;">
      <img src="/pub/2004/08/27/graphics/category_manager_half.gif" width="400" height="305"
           alt="Bricolage Category Manager" />
      <p><em>Bricolage allows you to create an unlimited number of hierarchical 
        categories in which to file documents.</em></p>
    </div>
  

  <h4>Meaningful URLs</h4>
  
    <p>In addition to categories, Bricolage document URLs can include the
    year, month, day of the month, and/or a <dfn>slug</dfn> &#x2014; which is a
    short string describing the document, such as &quot;bricolage-intro.&quot;
    Combined, these pieces of metadata generate meaningful URLs, such
    as <code>/features/perl/2004/17/26/bricolage-intro</code> for a Perl
    feature introducing Bricolage and published on 26 July 2004. Such URLs are
    very search-engine friendly, too, so they should greatly enhance your
    Google rankings, for example.</p>
  

  <h4>Keywords</h4>
  
    <p>Bricolage documents can be associated with arbitrary keywords. These,
    too, can be queried via the Bricolage API, making keyword indexes a
    possibility. And of course, they're available in templates for
    outputting <code>&lt;meta&gt;</code> tags, <a href="http://dublincore.org/" title="Dublin Core Metadata
    Intiative">Dublin Core Metadata</a>, and the like.</p>
  

  <h4>Workflow</h4>
  
    <p>Bricolage provides a workflow interface for managing your documents and
    templates. A <dfn>workflow</dfn> is a way to organize the process of
    creating a document. Typically, a document workflow defines areas of
    responsibility in the process of creating a document, such as writing,
    copy editing, legal review, and publishing. True to its original genesis
    among newspaper publishers, Bricolage workflows divide these
    responsibilities between <dfn>desks</dfn>. So one might have a workflow
    named &quot;Document&quot; for managing documents, with an &quot;Edit Desk,&quot;
    a &quot;Copy Desk,&quot; a &quot;Legal Desk,&quot; and a &quot;Publish Desk.&quot;</p>

    <div style="width: 400px;">
      <img src="/pub/2004/08/27/graphics/desk_story_half.gif" width="400" height="313"
           alt="Bricolage Document Workflow" />
      <p><em>Bricolage workflows can be configured to reflect your organization's 
        standard editorial processes.</em></p>
    </div>

    <p>You can create as many workflows as your organization requires, each
    with as many desks as you require. Desks can be shared across
    workflows &#x2014; if you need certain parties to assume similar
    responsibilities in different workflows &#x2014; and you can set up
    permissions such that certain users have access only to the documents in
    specific workflows and on specific desks. In short, you have a lot of
    flexibility to closely model the actual workflow in your organization, so
    that working with Bricolage is simply an extension of your users' standard
    editorial processes.</p>
  

  <h4>Output Channels</h4>
  
    <p>Output channels are collections of templates that output content in
    particular formats. Typical Bricolage solutions in production today have
    output channels for XHTML, RSS, WML, etc. Furthermore, output channels can
    include templates from other output channels. When Bricolage looks for a
    template, it looks in the output channel being published to, and then any
    output channels it includes. The search for the template resembles how
    Perl searches through the <code>@INC</code> array for a module. The upshot
    is that Bricolage makes it easy for you to create libraries of templates
    that can be used across output channels.</p>

    <p>Bricolage templates correspond to document categories and elements, so
    that one element template outputs the content of a single element, or
    wraps the output of document-element templates for all documents in a
    category. Because a single element definition can be associated with
    different document models, this approach ensures the formatting of the
    content in elements based on that definition will be consistent across all
    documents.</p>
  

  <h4>Perl Templating</h4>
  
    <p>The templates in Bricolage output channels can be implemented in one
    of three templating architectures:
    <a href="http://www.masonhq.com/" title="Mason HQ">Mason</a>,
    <a href="http://www.template-toolkit.org/" title="Template Toolkit
    home">Template Toolkit</a>, or <a href="http://html-template.sourceforge.net/" title="HTML::Template
    home">HTML::Template</a>.</p>

<p>Yes, that's right, not only do you have three
    different choices for templating in Bricolage, but they're all Perl-based!
    In addition to being able to provide a familiar templating environment to
    tens of thousands of Perl programmers worldwide, the templating solutions
    can leverage the full power of Perl to generate output for your
    documents. That power of course includes <a href="http://search.cpan.org/"
    title="Search CPAN">CPAN</a>, where you'll find modules to ease the
    generation of <a href="http://search.cpan.org/dist/XML-RSS/"
    title="XML::RSS on CPAN">RSS</a> feeds, <a href="http://search.cpan.org/dist/CGI/" title="CGI.pm on
    CPAN">HTML</a>, <a href="http://search.cpan.org/dist/XML-Generator/"
    title="XML::Generator on CPAN">XML</a>, <a href="http://search.cpan.org/dist/PDFLib/" title="PDFLib on
    CPAN">PDFs</a>, or even <a href="http://search.cpan.org/dist/Spreadsheet-WriteExcel/"
    title="Spreadsheet::WriteExcel on CPAN">Excel files</a>!</p>
   
    <p>Furthermore, Bricolage has a sub-classable templating architecture,
    which means that, with a little bit of work, you can add your own
    templating architecture. Anyone care to add support for <a href="http://perl.apache.org/embperl/" title="Embperl home">Embperl</a>,
    <a href="http://www.apache-asp.org/" title="Apache::ASP
    home">Apache::ASP</a>, or <a href="http://search.cpan.org/dist/XML-LibXSLT/" title="XML::LibXSLT on
    CPAN">XSLT</a>?</p>

    <p>For more on Bricolage templating, watch for the fourth article in this
    series, &quot;Mason Templating in Bricolage.&quot;</p>
  

  <h4>Multi-site Management</h4>
  
    <p>More and more organizations are finding themselves managing more and
    more sites as part of their content-management responsibilities. As of
    version 1.8.0, Bricolage offers support for managing multiple sites from a
    single instance. Different sites can have their own categories, workflows
    (but share desks), output channels (but can include output channels from
    other sites), and distribution destinations. They can also share document
    models, so that different sites can manage the same types of documents but
    publish them with their own templates. This flexible multi-site management
    allows you to divide responsibilities appropriately while keeping all
    content centrally managed and accessible via a common interface.</p>

    <div style="width: 400px;">
      <img src="/pub/2004/08/27/graphics/site_profile_half.gif" width="400" height="274"
           alt="Bricolage Site Profile" />
      <p><em>You can manage any number of different sites in Bricolage, each with 
        its own documents, categories, templates, and workflows.</em></p>
    </div>
  















  <h4>Document Aliasing</h4>
  
    <p>Once you have several departments in your organization managing their
    own sites, they might decide that they need to publish <em>each
    other's</em> content. Fortunately, if these sites are using the same
    document models, they can. Users with READ access to another site can
    create <dfn>aliases</dfn> to documents on that site. They can edit the
    title, URL, and keywords of the alias for the benefit of their own site,
    but the content remains in read-only form, so that editorial control
    remains in the hands of the originating site. Document aliasing thus
    provides a simple approach for sites to publish each other's content
    without violating one another's editorial integrity.</p>
  

  <h4>SOAP Interface</h4>
  
    <p>Bricolage features a robust and full-featured SOAP interface. The included
    <em>bric_soap</em> command-line client makes it easy to import and export
    documents, templates, and administrative objects, as well as bulk publish
    or update content. The ability to import content is especially important
    for organizations that wish to migrate their existing documents into Bricolage for management and publishing going forward. Watch for an
    article later in this series that highlights the flexibility and power of
    the Bricolage SOAP server.</p>
  

  <h4>Scalability</h4>
  
    <p>Bricolage is designed to scale to the needs of the largest
    organizations. Its scalability manifests in three directions.
    <em>Horizontal</em> scalability is ensured by the ability to distribute
    the load between separate database, application, preview, and distribution
    servers. And remember, because Bricolage operates independent of the
    delivery of content to the final audience, your site's front-end servers
    can scale independently of Bricolage.</p>

    <p>The browser-based interface provides <em>Geographical</em> scalability
    by allowing users to securely use Bricolage from anywhere in the
    world. Whether content editors are down the hall, across the country, or
    on the other side of the globe, if they have a browser and access to the
    Bricolage server's network, then they can be contributing content to your
    sites.</p>

    <p>And finally, the Bricolage feature-set ensures <em>organizational</em>
    scalability, allowing for the centralized management of multiple sites,
    multiple types of documents, content categorization, and flexible
    templating across an organization and its sites. These features can be
    exercised as necessary as the needs of your organization evolve. In other
    words, Bricolage rapidly adapts to the changing requirements of your
    content-management environment.</p>
  

  <h4>Security</h4>
  
    <p>Bricolage provides comprehensive security via encryption, user
    permissions, and its independence from your delivery servers. All
    communications with Bricolage can be encrypted over SSH/TLS to ensure
    secure use of the server from anywhere in the world. The same applies to
    the SOAP server, of course. At the access level, Bricolage provides a
    comprehensive permissions system to ensure that users get access only to
    the content and administrative objects relevant to getting their work
    done. And because Bricolage does not serve content to your final
    audience &#x2014; it generally runs as a back-office application and often
    behind a secure firewall &#x2014; your content library remains safe in
    Bricolage even if the security of your front-end servers becomes
    compromised.</p>

    <div style="width: 400px;">
      <img src="/pub/2004/08/27/graphics/user_group_permissions_half.gif" width="400" height="846"
           alt="Bricolage Permissions Administration" />
      <p><em>Bricolage offers a comprehensive permissions system to ensure users get access to only the objects they need to get their jobs done.</em></p>
    </div>
  

  <h4>ROI</h4>
  
    <p>Bricolage's open-source licensing helps to ensure that it is fully
    buzzword compliant, in that you can achieve a much higher return on
    investment (ROI) than with competitive commercial systems. Furthermore,
    Bricolage runs exclusively open-source software, including Apache/mod_perl
    and the PostgreSQL RDBMS, so there are no hidden licensing costs,
    either. And finally, even organizations that decide to use &lt;plug&gt;<a href="http://www.kineticode.com/" title="Kineticode">professional
    consulting services</a>&lt;/plug&gt; for their Bricolage implementations
    find that the expense tends to be around half what it costs for the
    rollout of a commercial content-management solution.</p>
  


<h3>Who Uses Bricolage?</h3>

<p>Despite its genesis in the online news niche, Bricolage has managed it to
go into production in a variety of settings. This success is a function of its
broad feature-set, as well as the regard it has gained from <a href="http://www.eweek.com/article2/0,3959,652977,00.asp" title="eWeek Reviews
Bricolage">the press</a>. So who uses it?</p>

<ul>
  <li>Print Publishing
    <ul>
      <li><a href="http://www.macworld.com/" title=""><cite>Macworld</cite> Magazine</a></li>
      <li><a href="http://www.2magazine.com/" title=""><cite>2: The Magazine for Couples</cite></a></li>
      <li><a href="http://www.thepirtgroup.com/" title="">PIRT</a></li>
      <li><a href="http://jn.sapo.pt/" title=""><cite>Jornal de Not&iacute;cias</cite></a></li>
      <li><a href="http://www.pots.com.tw/" title=""><cite>POTS</cite></a></li>
    </ul>
  </li>

  <li>Web Publishing
    <ul>
      <li><a href="http://www.salon.com/" title=""><cite>Salon.com</cite></a></li>
      <li><a href="http://www.maccentral.com/" title=""><cite>MacCentral</cite></a></li>
      <li><a href="http://www.newzilla.org/" title="">Newzilla</a></li>
    </ul>
  </li>

  <li>Academia
    <ul>
      <li><a href="http://www.oup.co.uk/" title="">Oxford University Press</a></li>
      <li><a href="http://www.adams.edu/" title="">Adams State College</a></li>
      <li><a href="http://my.labschool.org/" title="">The Lab School of Washington</a></li>
      <li><a href="http://www-bmu.psychiatry.cam.ac.uk/" title="">Brain Mapping Unit, University of Cambridge</a></li>
    </ul>
  </li>

  <li>Research
    <ul>
      <li><a href="http://www.rand.org/" title="">The RAND Corporation</a></li>
      <li><a href="http://www.who.int/" title="">World Health Organization</a></li>
    </ul>
  </li>

  <li>Broadcasting
    <ul>
      <li><a href="http://www.rfa.org/" title="">Radio Free Asia</a></li>
      <li><a href="http://et.yahoo.com/" title="">Entertainment Tonight Online</a></li>
    </ul>
  </li>

  <li>Financial Services
    <ul>
      <li><a href="http://dfafunds.com/" title="">Dimensional Fund Advisors</a></li>
    </ul>
  </li>

  <li>Non-Profit
    <ul>
      <li><a href="http://www.adcouncil.org/" title="">Ad Council</a></li>
      <li><a href="http://www.openforumeurope.org/" title="">Open Forum Europe</a></li>
    </ul>
  </li>

  <li>Corporate
    <ul>
      <li><a href="http://www.kineticode.com/" title="">Kineticode</a></li>
      <li><a href="http://www.plsweb.com/" title="">Performance Learning Systems</a></li>
      <li><a href="http://www.fotango.com/" title="">Fotango</a></li>
      <li><a href="http://www.archenergy.com/" title="">Architectural Energy</a></li>
    </ul>
  </li>
</ul>

<p>And there are many other organizations quietly using Bricolage without
publicly making that fact known.</p>

<h3>Right for You?</h3>

<p>If Bricolage sounds like a good fit for your organization's content-management needs, or if you're interested in how Bricolage really works, stay
tuned to Perl.com for my next article, &quot;Bricolage Installation and
Configuration,&quot; and we'll have you up and running in no time!</p>

<h3>Acknowledgments</h3>

<p>I'd like to thank Darren Duncan, James Duncan Davidson, and Rael Dornfest
for providing valuable feedback on drafts of this article.</p>





        </div>



    </div>
    <div class="asset-footer"></div>
</div>




                            <div class="content-nav">
                                <a href="/pub/web-development/">&laquo; Web Development</a> |
                                <a href="/pub/">Main Index</a> |
                                <a href="/pub/archives.html">Archives</a>
                                | <a href="/pub/webcgi/">Web/CGI &raquo;</a>
                            </div>


                        </div>
                    </div>


                    <div id="beta">
    <div id="beta-inner">


    
    <div class="widget-what-is-perl widget">
    <div class="widget-content widget-content-what-is-perl">
       Visit the home of the  Perl programming language: <a href="http://www.perl.org/">Perl.org</a
    </div>
</div>
<div class="widget-find-out-more widget-archives widget">
    <div class="widget-content">
        <ul>
            <li><a href="http://www.perl.org/get.html">Download</a></li>
            <li><a href="http://perldoc.perl.org/">Documentation</a></li>
            <li><a href="http://blogs.perl.org/">Perl Bloggers</a></li>
            <li><a href="http://news.perlfoundation.org/">Foundation News</a></li>
        </ul>
    </div>
</div><div class="widget-tcpc widget">
<h3 class="widget-header">Sponsored by</h3>
    <div class="widget-content">
        <a href="http://training.perl.com/" alt="Perl Training" target="_blank"><img src="/i/tcpc.png" width="150" height="50"></a>
    </div>
</div>

<div class="widget-syndication widget">
    <div class="widget-content">
        <ul>
            <li><img src="/mt-static/images/status_icons/feed.gif" alt="Subscribe to feed" width="9" height="9" /> <a href="/pub/atom.xml">Subscribe to this website's feed</a></li>

        </ul>
    </div>
</div>
<div class="widget-powered widget">
    <div class="widget-content">
        <a href="http://www.movabletype.com/"><img src="/mt-static/images/bug-pbmt-white.png" alt="Powered by Movable Type 5.02" width="120" height="75" /></a>
    </div>
</div>



    </div>
</div>






                </div>
            </div>


            <div id="footer">
    <div id="footer-inner">
        <div id="footer-content">
            <div class="widget-powered widget">
                <div class="widget-content">
                    Powered by <a href="http://www.movabletype.com/" rel="generator">Movable Type Pro</a>
                </div>
            </div>

        </div>
    </div>
</div>



        </div>
    </div>
</body>
</html>
