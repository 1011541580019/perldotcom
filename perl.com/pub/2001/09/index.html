<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" id="sixapart-standard">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="generator" content="Movable Type Pro 5.13-en" />
<link rel="stylesheet" href="/pub/styles.css" type="text/css" />
<link rel="start" href="/pub/" title="Home" />
<link rel="alternate" type="application/atom+xml" title="Recent Entries" href="/pub/atom.xml" />
<script type="text/javascript" src="/pub/mt.js"></script>
<!--
<rdf:RDF xmlns="http://web.resource.org/cc/"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
<Work rdf:about="/pub/">
<dc:title>Perl.com</dc:title>
<dc:description>news and views of the Perl programming language</dc:description>
<license rdf:resource="http://creativecommons.org/licenses/by-nc-nd/3.0/" />
</Work>
<License rdf:about="http://creativecommons.org/licenses/by-nc-nd/3.0/">
</License>
</rdf:RDF>
-->

<script type="text/javascript">

 var _gaq = _gaq || [];
 _gaq.push(['_setAccount', 'UA-50555-22']);
 _gaq.push(['_trackPageview']);

 (function() {
   var ga = document.createElement('script'); ga.type =
   'text/javascript'; ga.async = true;
   ga.src = ('https:' == document.location.protocol ? 'https://ssl' :
   'http://www') + '.google-analytics.com/ga.js';
   var s = document.getElementsByTagName('script')[0];
   s.parentNode.insertBefore(ga, s);
 })();

</script>
<script type='text/javascript' src='http://partner.googleadservices.com/gampad/google_service.js'></script>
<script type='text/javascript'>
GS_googleAddAdSenseService("ca-pub-4136420132070439");
GS_googleEnableAllServices();
</script>
<script type='text/javascript'>
GA_googleAddSlot("ca-pub-4136420132070439", "Perl_728x90");
</script>
<script type='text/javascript'>GA_googleFetchAds();</script>
    <title>Perl.com: September 2001 Archives</title>


    <link rel="prev" href="/pub/2001/08/" title="August 2001" />
    <link rel="next" href="/pub/2001/10/" title="October 2001" />

</head>
<body id="perl-com" class="mt-archive-listing mt-datebased-monthly-archive layout-wt">
    <div id="container">
        <div id="container-inner">


            <div id="header">
    <div id="header-inner">
        <div id="header-content">
        <span id="top_advert"> 
<!-- Put any landscape advert in here -->
<!-- Perl_728x90 -->
<script type='text/javascript'>
GA_googleFillSlot("Perl_728x90");
</script>
        </span> 



            <div id="header-name"><a href="/pub/" accesskey="1">Perl.com</a></div>
            <div id="header-description">news and views of the Perl programming language</div>




        </div>
    </div>
</div>



            <div id="content">
                <div id="content-inner">


                    <div id="alpha">
                        <div id="alpha-inner">


                            <h1 id="page-title" class="archive-title">September 2001 Archives</h1>





                            
                            <div id="entry-1602" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2001/09/26/crypto1.html" rel="bookmark">Asymmetric Cryptography in Perl</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Benjamin Trott</span> on <abbr class="published" title="2001-09-26T00:00:00-08:00">September 26, 2001 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            

<h3><a name="introduction">Introduction</a></h3>

<p><a href="/pub/a/2001/07/10/crypto.html">Symmetric cryptography</a> allows Alice to exchange secret messages with Bob
over the network, but only after they have shared a secret key. If Alice
and Bob don't live within commutable distance, or are unable to meet in
person for any number of reasons, they have no option other than to share
this key over the network. This, however, poses a problem. The network is
insecure, and Eve, who systematically sniffs traffic between Alice &amp; Bob,
can get hold of any key they share over the network and read all
subsequent communications encrypted with it without having to break the
symmetric cipher.</p>

<p>In the early days of public networks, Witfield Diffie &amp; Martin Hellman,
then researchers at Stanford's mathematics department, were battling
against this fundamental problem - how to enable two complete strangers to
bootstrap secure communications over an insecure network. Their work
culminated in a seminal paper, titled ``New Directions In Cryptography,''
that laid down the foundations of what has come to be known as
<em>asymmetric cryptography</em>. Asymmetric cryptography did not only provide
an elegant solution to the aforementioned bootstrapping problem, it
simultaneously solved several other problems of digital privacy, including
unforgeable signatures and non-repudiation.</p>
<p>In this article we look at the various methods of asymmetric
cryptography and Perl modules that provide ready-to-use implementations
of these methods.</p>


<h3><a name="trapdoor oneway functions">Trapdoor One-Way Functions</a></h3>
<p>Central to asymmetric cryptography, is the notion of trapdoor one-way
functions. One-way functions are easy to compute in one direction but
impossibly hard in the reverse direction. Breaking an egg, for example, is
a one-way function. Trapdoor one-way functions are much like one-way
functions except they are easy to reverse if certain ``trap-door''
information is available.</p>
<p>In an asymmetric cryptosystem, each user has two keys: a public key that
others use to encrypt messages to the user and a secret key for
decrypting messages encrypted with the public key. (For this reason,
asymmetric cryptography is also commonly referred to as public-key
cryptography.) The secret key is zealously guarded by the user while its
public counterpart is indiscriminately distributed to the world. Unlike
symmetric keys, that are usually random numbers of a certain length,
asymmetric keys are numbers with special mathematical properties that are
computed using a key generation algorithm.</p>
<p>To send a private message to Bob using public-key cryptography, Alice
first acquires his public key. Public key exchange can be carried out over
an insecure network because the knowledge of Bob's public key does not enable
Eve to decrypt messages encrypted with it. Alice then encrypts her message
with this key. The encryption operation consists of computing the
trapdoor one-way function on the message (in the easy direction), using
the public key, to generate the ciphertext. Once generated, Alice sends
the ciphertext over to Bob.</p>

<table width="150" border="0" cellspacing="0" cellpadding="4" align="right">
<tr> 
<td width="150" valign="top" height="4" bgcolor="#6699cc"></td></tr> 
<tr>
<td bgcolor="#efefef">
<p class="headline" align="center">Table of Contents
</p>
<p class="smalltext">
&#149; <a href="#trapdoor oneway functions">Trapdoor One-Way Functions</a><br /><br />
&#149; <a href="#rsa">RSA</a><br /><br />
&#149; <a href="#crypt::rsa">Crypt::RSA</a><br /><br />
&#149; <a href="/pub/a/2001/09/26/crypto1.html?page=2#digital signatures and nonrepudiation">Digital Signatures and Non-repudiation</a><br /><br />
&#149; <a href="/pub/a/2001/09/26/crypto1.html?page=2#diffiehellman key agreement">Diffie-Hellman Key Agreement</a><br /><br />
&#149; <a href="/pub/a/2001/09/26/crypto1.html?page=3#digital signature algorithm">Digital Signature Algorithm</a><br /><br />
&#149; <a href="/pub/a/2001/09/26/crypto1.html?page=3#schnorr">Schnorr</a><br /><br />
&#149; <a href="/pub/a/2001/09/26/crypto1.html?page=3#future articles">Future Articles</a><br /><br />
<hr size="1" noshade>
<p><span class="headline"><center>Related Features</center></span>

<p class="smalltext"><a href="/pub/a/2001/07/10/crypto.html">An Introduction to Symmetric Cryptography in Perl</a></p>
</td></tr> <tr><td width="150" valign="top" height="4" bgcolor="#6699cc"> </td></tr></table>

<p>To recover the plaintext, Bob and Eve (who's sniffed a copy of
ciphertext off the wire) must reverse the trapdoor one-way function.
Bob uses the trapdoor information, his private key, to easily decrypt
and read the message. Eve, on the other hand, without the benefit of
trapdoor information, is faced with a task much harder than putting a
broken egg together.</p>
<p>
<h3><a name="rsa">RSA</a></h3>
<p>When Diffie &amp; Hellman proposed their theory of asymmetric cryptography
and trapdoor one-way functions, they did not suggest a particular
trapdoor one-way function. Rivest, Shamir and Aldeman, then-professors
at MIT, were the first to devise such a function around the conjectured
difficulty of factoring prime products. Their cryptosystem, RSA, has
withstood several years of cryptanalysis and is the most widely used
public-key cryptosystem today.</p>

<p>Here's how RSA works: To generate an RSA key pair, Bob chooses two large primes, <code>p</code> &amp; <code>q</code>
(each 1024 bits/308 digits long) and computes their product,</p>
<pre>
    n = pq
</pre>
<p>
Then, he chooses a random number C&lt;e&gt; that is smaller than and relatively
prime to C&lt;(p-1)(q-1)&gt;,</p>
<pre>
    1 &lt; e &lt; (p-1)(q-1)
    gcd(e, ((p-1)(q-1)) = 1</pre>
	
<p>Finally, with the extended euclidean algorithm, he computes,</p>
<pre>
    ed = 1 mod (p-1)(q-1)</pre>
	
<p><code>(n,e)</code> becomes his public key, and <code>d</code> the secret key.</p>

<p>Upon getting Bob's public key, Alice encrypts her message with it. To do
so, she converts her message into a number, <code>m</code>, between <code>1</code> and <code>n</code>,
and computes:</p>
<pre>
    c = (m ^ e) mod n</pre>
<p><code>c</code> is the ciphertext; Alice sends it to Bob, who computes:</p>
<pre>
    m = (c ^ d) mod n</pre>
<p>thereby recovering the original <code>m</code>. He converts <code>m</code> back to text form
and reads the message.</p>

<p>Eve, who has been sniffing the traffic between Alice &amp; Bob all this while,
has Bob's public key, <code>(n,e)</code>, and the encrypted message from Alice,
<code>c</code>. To decrypt <code>c</code>, she must learn the value of <code>d</code>. Eve could compute 
<code>d</code> and decrypt the message if she knew <code>p</code> and <code>q</code>. But to discover
<code>p</code> and <code>q</code>, she has to factorize <code>n</code>, which, given the known 
algorithms for factoring and the current state of computational technology,
is considered intractable.</p>

<h3><a name="crypt::rsa">Crypt::RSA</a></h3>
<p>If you are wondering where Perl comes into all this, then the answer is right
here. Through extension modules on CPAN, Perl provides efficient, secure
and DWIM implementations of several asymmetric cryptosystems. A
comprehensive RSA implementation is provided by the Crypt::RSA package.</p>

<p>Here's how Alice sends an RSA encrypted message to Bob using Crypt::RSA:</p>
<p>Bob generates a 2048-bit key-pair:</p>
<pre>
    $rsa = new Crypt::RSA;
    ($public, $private) = $rsa-&gt;keygen( Size =&gt; 2048 )
</pre>
<p>
He sends $public to Alice, possible by e-mail, who encrypts her message (a
string stored in $message) with it:</p>
<pre>
    my $c = $rsa-&gt;encrypt( Message =&gt; $message, Key =&gt; $public );</pre>
	
<p>Alice sends the ciphertext, <code>$c</code>, to Bob, who decrypts it with his
private key, <code>$private</code>, to recover the original message:</p>

<pre>
    $message = $rsa-&gt;decrypt( Ciphertext =&gt; $c, Key =&gt; $private );</pre>
	
<p>Usually, Alice &amp; Bob don't need more four or so lines of code to carry out a
secure exchange using Crypt::RSA. However, it's instructive to look at
what Crypt::RSA does underneath these four lines and how it can be made to do
things a little differently.</p>



<p>Crypt::RSA is structured as a bundle of modules that encapsulate different
aspects of the RSA cryptosystem. Crypt::RSA itself is a convenient
front-end to other modules in the bundle that sits between the user and
other modules, and pre-processes data to meet expectations of both.</p>

<p>One of Crypt::RSA's responsibilities is to convert text to numbers and
back. Since the RSA algorithm works on numbers smaller than <code>n</code>,
plaintext is first converted into a list of numbers smaller than <code>n</code>,
that are converted back to text after encryption and concatenated to form
the final ciphertext. The same process is carried out at decryption.</p>

<p>The encryption modules of Crypt::RSA additionally carry out a process
called ``padding.'' It has been shown that textbook RSA, as described in the
previous section, is vulnerable to known plaintext attack. That is, if Eve
can force Alice to encrypt certain quantities of known text, then she can
recover <code>p</code> and <code>q</code> without having to factor <code>n</code>. To prevent this
attack, plaintext blocks must be padded with random data in a special way.</p>

<p>Over the years, a padding standard known as PKCS #1 has come into wide
use. Crypt::RSA implements PKCS #1 as well as the newer standard, OAEP.
OAEP provides the notion of plaintext-aware encryption, and is recommended
for applications that don't need to interoperate with with older PKCS #1
applications. Crypt::RSA uses OAEP padding by default. However, it can be
instructed to use PKCS #1 by passing a parameter to new(), like so:</p>
<pre>
    $rsa = new Crypt::RSA ( ES =&gt; 'PKCS1v15 )</pre>
<p>ES stands for ``Encryption Scheme'' and PKCS1v15 means the PKCS #1 standard
version 1.5 as described in the RFC 2437.</p>












<h3><a name="digital signatures and nonrepudiation">Digital Signatures and Non-repudiation</a></h3>

<p>Encryption provides only half of the solution to digital privacy.
Identities in the online world are malleable and can be faked trivially;
this necessitates the use of a signature mechanism to ensure that people
are who they say they are. When you receive a message, how can you really
know that the sender is who he or she purports to be? The message could
have been written by someone else entirely; or it could have been
intercepted in transit, modified and then passed on to you.</p>

<p>Digital signatures provide you with the tools to unequivocally determine
whether a message is legitimate. You can use digital signatures to detect
in-transit message tampering and to determine whether a message is truly
from the advertised sender. Such signatures are unforgeable guarantees of
both a message's true author and of its validity. This concept, known as
non-repudiation, also extends in the opposite direction: Since a digital
signature provides absolute proof that the sender signed a piece of data,
the sender cannot subsequently deny having signed that piece of data.
Taken to its logical extension, once an author has signed his work, he
can deny neither the validity of the signature nor the authorship of the
work.</p>

<p>To digitally sign a message is to apply one's private key to that message.
Digital signatures use the same public and private keys that are used for
encrypting and decrypting messages; in contrast to the sender using the
recipient's public key to encrypt a message, however, when signing the
sender uses her private key to sign the message. This works because
certain trapdoor functions also work as trapdoor permutations. Once the
private key has scrambled the message, the resulting signature can only be
unscrambled by the matching public key. If the recipient of the message
holds a copy of this public key, he/she can then determine absolutely
whether the sender signed it using the private key.</p>

<p>Here is an example:</p>

<p>Alice wishes to send a message to Bob, and wants Bob to be able to verify
that she sent the message, and that it has not been modified in transit.
After composing the message, Alice ``signs'' that message using her private
key, then sends the message and the signature to Bob. This signature is
computed over the data in the message, such that it is unique to Alice's
private key and the message. In other words, this particular signature can
only have been produced by Alice's private key.</p>

<p>To verify the signature, Bob uses his copy of Alice's public key to
unscramble the signature; if he produces the original message, he knows
that the message has not been tampered with. Meanwhile, if Eve is listening
in on the network traffic and sniffs a copy of Alice's message, she can
easily modify it and send it on to Bob; but once she has modified the
original message, the signature no longer matches the message. When Bob
receives the modified message with its original signature, his attempts at
verification will fail, and he will know that the message has been tampered
with. Eve has no way of ``fixing'' the signature such that it matches the
modified message, because doing so requires possession of Alice's private
key -- and only Alice has access to that key. Thus Alice's identity and
authorship can be guaranteed.</p>

<p>Here's how Alice signs her message with Crypt::RSA:</p>
<pre>
    $private = new Crypt::RSA::Key::Private( 
                  Filename =&gt; &quot;keys/alice.private&quot;, 
                  Password =&gt; 'alice's passphrase' 
               );  
    $rsa = new Crypt::RSA; 
    $signature = $rsa-&gt;sign ( Message =&gt; $message, Key =&gt; $private );</pre>

<p>Alice reads her private key from a disk file. Private keys are usually
stored in encrypted form (using a symmetric cipher) for additional
security, so they must be decrypted before use. Alice provides a password
with which the key is decrypted, and reads the key in <code>$private</code>. She
then signs her message with the <code>sign()</code> method of Crypt::RSA, and sends
<code>$signature</code> and <code>$message</code> to Bob. Bob verifies the signature with the
<code>verify()</code> method of Crypt:RSA using Alice's public key:</p>
<pre>
    $public = new Crypt::RSA::Key::Public( 
                  Filename =&gt; &quot;keys/alice.public&quot;, 
              ); 
    $rsa-&gt;verify( Message =&gt; $message, Signature =&gt; $signature,
                  Key =&gt; $public ) || 
                  die &quot;Signature doesn't verify!\n&quot;;</pre>
<p>It should be noted that <code>sign()</code> computes a digest of the message and signs
that instead of the original message. This is typically how real-world
applications generate digital signatures. Signing the entire message is
expensive and doesn't provide any benefit over signing a digest.</p>
<p>
<h3><a name="diffiehellman key agreement">Diffie-Hellman Key Agreement</a></h3>
<p>Key agreement is the process of two parties agreeing on a shared
encryption key without exposing that key to potential intruders. Key
agreement protocols are different from public-key encryption protocols in
that they are not meant for encrypting communications; rather they are
used to agree upon a secret that can be used for encrypting communications
with symmetric ciphers. Shortly after Rivest, Shamir and Aldeman published
their RSA paper, Diffie &amp; Hellman published a key agreement protocol that
has come to be known as Diffie-Hellman Key Agreement.</p>
<p>Here's how it works:</p>
<p>To begin the key exchange, Alice and Bob choose a property <code>p</code> and a
property <code>g</code>; the values for these properties are shared by both parties,
and are often computed by a central authority, rather than be either one
of the parties. Each party then computes a random private-key integer
<code>x</code>, where the length of <code>x</code> is at most <code>(number of bits in p) - 1</code>.
Each party then computes a public key <code>y</code> based on <code>g</code>, <code>x</code>, and <code>p</code>;
the exact value is:</p>
<pre>
    y = g^x mod p</pre>
<p>The parties exchange these public keys.</p>
<p>The shared secret key is generated from the exchanged public key, the
private key, and p. If Bob's public key is denoted <code>y_Bob</code>, then Alice
computes the shared secret using the formula</p>
<pre>
    secret = y_Bob^x mod p</pre>
<p>The mathematical principles involved ensure that both parties will
generate the same shared secret key. Having computed the shared
secret -- again, without that secret ever passing over the insecure
network -- Alice and Bob can use the key to encrypt their communications;
all future messages between the two (during this session) can be
symmetrically encrypted using the shared secret.</p>
<p>More information can be found in PKCS #3 (Diffie-Hellman Key Agreement
Standard).</p>
<p>A Perl implementation of Diffie-Hellman key agreement can be found in
Crypt::DH. To use Crypt::DH, Alice must agree ahead of time with Bob as to
the values for <code>p</code> and <code>g</code>. For example, the SSH-2 protocol, which uses
Diffie-Hellman, uses a value of <code>2</code> for <code>g</code>, and a value of</p>
<pre>
      FFFFFFFF FFFFFFFF C90FDAA2 2168C234 C4C6628B 80DC1CD1
      29024E08 8A67CC74 020BBEA6 3B139B22 514A0879 8E3404DD
      EF9519B3 CD3A431B 302B0A6D F25F1437 4FE1356D 6D51C245
      E485B576 625E7EC6 F44C42E9 A637ED6B 0BFF5CB6 F406B7ED
      EE386BFB 5A899FA5 AE9F2411 7C4B1FE6 49286651 ECE65381
      FFFFFFFF FFFFFFFF</pre>
<p>for <code>p</code>. We begin using Crypt::DH by initializing a Crypt::DH object with
the chosen values for <code>p</code> and <code>g</code>:</p>
<pre>
    use Crypt::DH;
    my $dh = Crypt::DH-&gt;new;
    $dh-&gt;p($p);
    $dh-&gt;g($g);</pre>
<p>Each party then generates a public and a private key:</p>
<pre>
    $dh-&gt;generate_keys;</pre>
<p>After generating the keys, Alice must send her public key to Bob, and Bob
must send his public key to Alice, over the network. Once Alice has
received Bob's public key, she can generate the shared secret using that
public key, and her own private key:</p>
<pre>
    my $shared_secret = $dh-&gt;compute_key( $bob_public_key );</pre>
<p>This shared secret is a big integer. Often this big integer is linearized
into a string of octets to be used as a key for symmetric encryption
between Alice and Bob. Since both parties have generated the same shared
secret, Alice is able to decrypt messages that Bob has encrypted with the
shared secret, and vice versa.</p>












<h3><a name="digital signature algorithm">Digital Signature Algorithm</a></h3>


<p>DSA is the Digital Signature Algorithm, an algorithm developed by the
U.S. government for use as the Digital Signature Standard. At the
time of its creation, RSA was threatening to become a de facto standard:
Microsoft and Lotus, for example, were already including it in their
products. RSA provided both signatures <em>and</em> encryption, and this
frightened the government: A future where regular citizens might secure
their personal communications, preventing government agents from snooping
on networks and phone lines, was terrifying to the NSA (National Security
Agency). With this in mind, the government pushed for the standardization
of the DSA, an algorithm that provided <em>only</em> digital signatures, and
could not encrypt messages.</p>

<p>The government wanted cryptography back in the hands of the NSA rather
than in a private company, RSA Data Security, Inc. For this reason they
pushed DSA as a royalty-free standard, as an alternative to the
license-restricted RSA; DSA was not subject to RSA licensing restrictions
because it is based not on the RSA algorithm but on the digital signature
algorithm published by Tehar Elgamal. DSA is by many opinions an inferior
standard to RSA: It is difficult to implement, more complicated
mathematically and slower than RSA for signature verification (though
faster for signing). More importantly, DSA keys are restricted to a maximum
bitsize of <code>1024</code>. Despite these concerns -- or, perhaps, because of
them -- DSA was chosen as the government standard.</p>

<p>Here's how DSA works:</p>

<p>To begin generating a new DSA key pair, Alice generates a large prime
<code>q</code> (generated either from a user-supplied seed or from a string of
random octets), where</p>
<pre>
    2^159 &lt; q &lt; 2^160</pre>
<p>The same seed is then used to construct a prime <code>p</code> such that <code>q</code>
divides <code>p-1</code> and</p>
<pre>
    2^(bits-1) &lt; p &lt; 2^(bits)</pre>
<p>where <code>bits</code> is the number of bits in the key; the bitsize can range from
512 to 1024.</p>
<p>A number <code>g</code> is then chosen such that</p>
<pre>
    g = h^((p-1)/q) mod p</pre>
<p>where h is any integer greater than <code>1</code>, less than <code>p-1</code>. A typical value
for <code>h</code> is <code>2</code>.</p>
<p>Finally, two numbers <code>x</code> and <code>y</code> are generated that represent the
private and public portions of the key, respectively. <code>x</code> is a randomly
generated integer such that <code>x</code> is greater than <code>0</code> and less than <code>q</code>;
<code>y</code> is derived as follows:</p>
<pre>
    y = g^x mod p</pre>
<p>A DSA public key consists of the values of <code>p</code>, <code>q</code>, <code>g</code> and <code>y</code>; a
private key consists of those values, and the value of <code>x</code>. A DSA
signature consists of two values, <code>r</code> and <code>s</code>, generated by applying the
private DSA key to a <code>SHA-1</code> hash of a message. To verify a message, the
verifier uses the original message and the sender's public key to
mathematically backtrack from the value of <code>s</code> to arrive at a final value
<code>v</code>; if <code>v</code> is equal to <code>r</code>, then the signature is valid. Otherwise, it
is invalid.</p>
<p>Perl and Crypt::DSA, a pure Perl implementation of DSA, make digital
signatures with DSA very simple. Alice generates a new DSA key:</p>
<pre>
    use Crypt::DSA;
    my $dsa = Crypt::DSA-&gt;new;
    my $key = $dsa-&gt;keygen( Size =&gt; 512 );</pre>
<p>After sending the public portion of this key to Bob, she signs her message
(a string stored in <em>$message</em>) with her private key:</p>
<pre>
    my $sig = $dsa-&gt;sign( Message =&gt; $message, Key =&gt; $key );</pre>
<p>She then sends the signature <em>$sig</em> and the message <em>$message</em> to Bob,
who uses Alice's public key to verify the signature:</p>
<pre>
    my $valid = $dsa-&gt;verify( Signature =&gt; $sig, Message =&gt; $message,
                              Key =&gt; $alice_pub_key );</pre>
<p>If <em>$valid</em> is true, then the signature <em>$sig</em> is valid.</p>
<p>Meanwhile, if Eve has sniffed the network traffic to intercept the
message and signature in transit to Bob, then she can modify the message
<em>$message</em>; but in order to regenerate the signature <em>$sig</em>, Eve must
have access to Alice's private key. Since Eve is not in possession of that
key, the signature will not match the message and signature verification
will fail.</p>

<h3><a name="schnorr">Schnorr</a></h3>

<table width="150" border="0" cellspacing="0" cellpadding="4" align="right">
<tr> 
<td width="150" valign="top" height="4" bgcolor="#6699cc"></td></tr> 
<tr>
<td bgcolor="#efefef">
<p class="headline" align="center">Recommended Reading
</p>
<p class="smalltext">
&#149; <a href="http://www.contrib.andrew.cmu.edu/~shadow/crypt.html">The sci.crypt FAQ</a><br /><br />
&#149; <a href="http://citeseer.nj.nec.com/340126.html">Diffie &amp; Hellman, New Directions in Cryptography</a><br /><br />
&#149; <a href="http://www.ietf.org/rfc/rfc2437.txt">Kaliski &amp; Staddon, PCKS #1, RSA Cryptography Specifications</a><br /><br />
&#149; <a href="http://www.rsasecurity.com/rsalabs/pkcs/pkcs-3/">PKCS #3, Diffie-Hellman Key Agreement Standard</a><br /><br />
&#149; <a href="http://csrc.nist.gov/publications/fips/fips186-2/fips186-2.pdf">FIPS 186-2, Digital Signature Standard</a><br /><br />

</td></tr> <tr><td width="150" valign="top" height="4" bgcolor="#6699cc"> </td></tr></table>
<p>Like DH and DSA, Schnorr is another signature algorithm based on the
difficulty of the discrete logarithm problem. Schnorr was specifically
designed in 1991 by Claus-Peter Schnorr for use in smart cards. Schnorr is
both a signature scheme and an interactive identification scheme that
makes extensive use of lookup tables for generating signatures, thereby
minimizing the computational effort on part of the signature computing
device. A Perl implementation of Schnorr is provided by the
Crypt::Schnorr::AuthSign module. For usage information, we refer the
readers to module's POD documentation.</p>
<p>
<h3><a name="future articles">Future Articles</a></h3>
<p>This concludes part one in a series of three articles on Asymmetric
Cryptography in Perl. Part two will discuss asymmetric crypto in the real
world: systems and protocols such as SSH, PGP and SSL that are
applications of asymmetric cryptography you use everyday. Along with a
discussion of these applications, we will also look at the computational
and security contraints that go in the design of real-world cryptography
systems. Part three will discuss the building blocks of asymmetric
cryptography, which will cover several interesting topics such as prime-number generation, bitfield/buffer manipulations, large number
mathematics and number theory, all of which have comprehensive
implementations in Perl.</p>















        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1600" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2001/09/18/parrot.html" rel="bookmark">Parrot : Some Assembly Required</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Simon Cozens</span> on <abbr class="published" title="2001-09-18T00:00:00-08:00">September 18, 2001 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
                
<p>
      Last week, the first public version of Parrot was released. This
      week, we're going to take a close look at what Parrot is, how
      you can get hold of it and play with it, and what we intend for
      Parrot in the future.
    </p>

    <h2>What Is Parrot?</h2>

    <p>
      First, though, what is Parrot, and why are we making such a fuss
      about it? Well, if you haven't been living in a box for the past
      year, you'll know that the Perl community has embarked on the
      design and implementation of a new version of Perl, both the
      language and the interpreter. 
    </p>
<!-- Advanced Perl Programming -->
 
    <p>
      Parrot is strongly related to Perl 6, but it is not Perl 6. To
      find out what it actually is, we need to know a little about how
      Perl works. When you feed your program into <code>perl</code>,
      it is first compiled into an internal representation, or
      bytecode; then this bytecode is fed to almost separate subsystem
      inside <code>perl</code> to be interpreted. So there are two
      distinct phases of <code>perl</code>'s operation: compilation
      to bytecode, and interpretation of bytecode. This is not unique
      to Perl; other languages following this design include Python,
      Ruby, Tcl and, believe it or not, even Java.
    </p>

    <p>
      In previous versions of Perl, this arrangement has been pretty
      <i>ad hoc</i>: There hasn't been any overarching design to the
      interpreter or the compiler, and the interpreter has ended up
      being pretty reliant on certain features of the
      compiler. Nevertheless, the interpreter (some languages call it
      a Virtual Machine) can be thought of as a software CPU - the
      compiler produces "machine code" instructions for the virtual
      machine, which it then executes, much like a C compiler produces
      machine code to be run on a real CPU.
    </p>

    <p>
      Perl 6 plans to separate the design of the compiler and the
      interpreter. This is why we've come up with a subproject, which
      we've called Parrot that has a certain, limited amount of
      independence from Perl 6. Parrot is destined to be the Perl 6
      Virtual Machine, the software CPU on which we will run Perl 6
      bytecode. We're working on Parrot before we work on the Perl 6
      compiler because it's much easier to write a compiler once
      you have a target to compile to!
    </p>

    <p>
      The name "Parrot" was chosen after this year's <a
      HREF="/pub/2001/04/01/parrot.htm">April
      Fool's Joke,</a> which had Perl and Python collaborating on the
      next version of their interpreters. This is meant to reflect the
      idea that we'd eventually like other languages to use Parrot as
      their VM; in a sense, we'd like Parrot to become a "common
      language runtime" for dynamic languages.
    </p>

    <h3>Where We're At</h3>

    <p>
      After the release last Monday, we've seen a huge amount of
      activity on the development list, with more than 100 CVS
      commits in the past week. However, it should be stressed we're
      still in the early stages of development.
    </p>
    
    <p>
      But don't let that put you off! Parrot is still very much
      usable; we've already seen one mini-language emerge that
      compiles down to Parrot bytecode (more on that later) and Leon
      Brocard has been working on automatically converting Java
      bytecode to Parrot.
    </p>

    <p>
      At the moment, it's possible to write simple programs in Parrot
      assembly language, use an assembler to convert them to machine
      code and then execute them on a test interpreter. We have
      support for a wide variety of ordinary and transcendental
      mathematical operations, some rudimentary string support and
      some conditional operators.
    </p>

    <h3>How to Get It</h3>

    <p>
      So let's get ourselves a copy of Parrot, so that we can start
      investigating how to program in the Parrot assembler. 
    </p>

    <p>
      We could get the <A
      HREF="http://www.cpan.org/src/parrot-0.0.1.tar.gz"> initial
      release</A> from CPAN, but an awful lot has changed since
      then. To really keep up to date with Parrot, we should get our
      copy from the <A HREF="http://cvs.perl.org">CVS repository</a>.
      Here's how we do that:
    </p>

    <pre>
% cvs -d :pserver:anonymous@cvs.perl.org:/home/perlcvs login
(Logging in to anonymous@cvs.perl.org)
CVS password: [ and here we just press return ]
% cvs -d :pserver:anonymous@cvs.perl.org:/home/perlcvs co parrot
cvs server: Updating parrot
U parrot/.cvsignore
U parrot/Config_pm.in
....
    </pre>
    
    <p>
      For those of you who can't use CVS, there are CVS snapshots
      built every six hours that you can find <A
      HREF="http://cvs.perl.org/snapshots/parrot">here</a>.
    </p>

    <p>
      Now we have downloaded Parrot, we need to build it; so:
    <pre>
% cd parrot
% perl Configure.pl
Parrot Configure
Copyright (C) 2001 Yet Another Society

Since you're running this script, you obviously have
Perl 5 -- I'll be pulling some defaults from its configuration.
...
    </pre>
    You'll then be asked a series of questions about your local
    configuration; you can almost always hit return for each
    one. Finally, you'll be told to type <code>make test_prog</code>;
    with any luck, Parrot will successfully build the test
    interpreter. (If it doesn't, the address to complain to is at the
    end of the article ...)
  </p>
    <h3>The Test Suite</h3>
    <p>
      Now we should run some tests; so type <code>make test</code> and
      you should see a readout like the following:
    </p>
    <pre>
perl t/harness
t/op/basic.....ok, 1/2 skipped:  label constants unimplemented in
assembler
t/op/string....ok, 1/4 skipped:  I'm unable to write it!
All tests successful, 2 subtests skipped.
Files=2, Tests=6,  2 wallclock secs ( 1.19 cusr +  0.22 csys =  1.41 CPU)
    </pre>
    <p>
      (Of course, by the time you read this, there could be more
      tests, and some of those which skipped might not skip - but
      none of them should fail!)
    </p>
    <h2>Parrot Concepts</h2>
    <p>
      Before we dive into programming Parrot assembly, let's take a
      brief look at some of the concepts involved.
    </p>
    <h3>Types</h3>
    <p>
      The Parrot CPU has four basic data types: 
    </p>
    <dl>
      <dt><code>IV</code></dt>
      <dd>An integer type; guaranteed to be wide enough to hold a pointer.</dd>
      <dt><code>NV</code></dt>
      <dd>An architecture-independent floating-point type.</dd>
      <dt><code>STRING</code></dt>
      <dd>An abstracted, encoding-independent string type.</dd>
      <dt><code>PMC</code></dt>
      <dd>A scalar.</dd>
    </dl>
    <p>
      The first three types are pretty much self-explanatory; the
      final type, Parrot Magic Cookies, are slightly more difficult to
      understand. But that's OK, because they're not actually
      implemented yet! We'll talk more about PMCs at the end of the article.
    </p>
    <h3>Registers</h3>
    <p>
      The current Perl 5 virtual machine is a stack machine - it
      communicates values between operations by keeping them on a
      stack. Operations load values onto the stack, do whatever they
      need to do and put the result back onto the stack. This is 
      easy to work with, but it's slow: To add two numbers
      together, you need to perform three stack pushes and two stack
      pops. Worse, the stack has to grow at runtime, and that means
      allocating memory just when you don't want to be allocating it.
    </p>
    <p>
      So Parrot's going to break with the established tradition for
      virtual machines, and use a register architecture, more akin to
      the architecture of a real hardware CPU. This has another
      advantage: We can use all the existing literature on how to
      write compilers and optimizers for register-based CPUs for our
      software CPU!
    </p>
    <p>
      Parrot has specialist registers for each type: 32 IV registers,
      32 NV registers, 32 string registers and 32 PMC registers. In
      Parrot assembler, these are named
      <CODE>I1</CODE>...<CODE>I32</code>,
      <CODE>N1</code>...<code>N32</code>,
      <code>S1</code>...<code>S32</code>,
      <code>P1</code>...<code>P32</code>.
    </p>
    <p>
      Now let's look at some assembler. We can set these registers
      with the <code>set</code> operator:
    </p>
    <pre>
    set I1, 10
    set N1, 3.1415
    set S1, "Hello, Parrot"
    </pre>
    <p>
      All Parrot ops have the same format: the name of the operator,
      the destination register and then the operands. 
    </p>
    <h3>Operations</h3>
    <p>
      There are a variety of operations you can perform: the file
      <code>docs/parrot_assembler.pod</code> documents them, along
      with a little more about the assembler syntax. For instance, we
      can print out the contents of a register or a constant:
    </p>
    <pre>
    print "The contents of register I1 is: "
    print I1
    print "\n"
    </pre>
    <p>
      Or we can perform mathematical functions on registers:
    </p>
    <pre>
    add I1, I1, I2  # Add the contents of I2 to the contents of I1
    mul I3, I2, I4  # Multiply I2 by I4 and store in I3
    inc I1          # Increment I1 by one
    dec N3, 1.5     # Decrement N3 by 1.5
    </pre>
    <p>
      We can even perform some simple string manipulation:
    </p>
    <pre>
    set S1, "fish"
    set S2, "bone"
    concat S1, S2       # S1 is now "fishbone"
    set S3, "w"
    substr S4, S1, 1, 7
    concat S3, S4       # S3 is now "wishbone"
    length I1, S3       # I1 is now 8
    </pre>

    <h3>Branches</h3>
    <p>
      Code gets a little boring without flow control; for starters,
      Parrot knows about branching and labels. The <code>branch</code>
      op is equivalent to Perl's <code>goto</code>:
    </p>
    <pre> 
         branch TERRY
JOHN:    print "fjords\n"
         branch END
MICHAEL: print " pining"
         branch GRAHAM
TERRY:   print "It's"
         branch MICHAEL
GRAHAM:  print " for the "
         branch JOHN
END:     end
    </pre>
    <p>
      It can also perform simple tests to see whether a register
      contains a true value:
    <pre>
         set I1, 12
         set I2, 5
         mod I3, I2, I2
         if I3, REMAIND, DIVISOR
REMAIND: print "5 divides 12 with remainder "
         print I3
         branch DONE
DIVISOR: print "5 is an integer divisor of 12"
DONE:    print "\n"
         end
    </pre>
    <p>
      Here's what that would look like in Perl, for comparison:
    </p>
    <pre>
    $i1 = 12;
    $i2 = 5;
    $i3 = $i1 % $i2;
    if ($i3) {
      print "5 divides 12 with remainder ";
      print $i3;
    } else {
      print "5 is an integer divisor of 12";
    }
    print "\n";
    exit;
    </pre>
    <p>
      And speaking of comparison, we have the full range of numeric
      comparators: <code>eq</code>, <code>ne</code>, <code>lt</code>,
      <code>gt</code>, <code>le</code> and <code>ge</code>. Note that
      you can't use these operators on arguments of disparate types;
      you may even need to add the suffix <code>_i</code> or
      <code>_n</code> to the op to tell it what type of argument you
      are using - although the assembler ought to divine this for you,
      by the time you read this. 
    </p>









    <h2>Some Parrot Programs</h2>
    <p>
      Now let's look at a few simple Parrot programs to give
      you a feel for the language.
    </p>

    <h3>Displaying the Time</h3>
    <p>
      This little program displays the Unix epoch time every second:
      (or so)
    </p>
    <pre>
        set I3, 3000000
REDO:   time I1
        print I1
        print "\n"
        set I2 0
SPIN:   inc I2
        le I2, I3, SPIN, REDO
</pre>
    <p>
      First, we set integer register 3 to contain 3 million - that's a
      completely arbitrary number, due to the fact that Parrot
      averages a massive 6 million ops per second on my
      machine. Then the program consists of two loops. The outer loop
      stores the current Unix time in integer register 1, prints it
      out, prints a new line and resets register 2 to zero. The inner
      loop increments register 2 until it reaches the 3 million we
      stored in register 3. When it is no longer less than (or equal
      to) 3 million, we go back to the <CODE>REDO</code> of the outer
      loop. In essence, we're just spinning around a busy loop to
      waste some time. This is only because Parrot doesn't currently
      have a "sleep" op; we'll see how to implement one later.
    </p>
    <p>
      How do we run this? First, we need to assemble this into Parrot
      bytecode, with the <code>assemble.pl</code> provided. So, copy
      the assembler to a file <code>showtime.pasm</code>, and inside
      your Parrot directory, run: 
    </p>
<pre>
      perl assemble.pl showtime.pasm > showtime.pbc
    </pre>
    <p>
      (<code>.pbc</code> is the file extension for Parrot bytecode.) 
    </p>
    <h3>Finding a Fibonacci number</h3>
    <p>
      The Fibonnaci series is defined like this: take two numbers, 1
      and 1. Then repeatedly add together the last two numbers in the
      series to make the next one: 1, 1, 2, 3, 5, 8, 13, and so
      on. The Fibonacci number <code>fib(n)</code> is the n'th number
      in the series. Here's a simple Parrot assembler program that
      finds the first 20 Fibonacci numbers:
    </p>
    <pre>
# Some simple code to print some Fibonacci numbers
# Leon Brocard &lt;acme@astray.com&gt;

        print   "The first 20 fibonacci numbers are:\n"
        set     I1, 0
        set     I2, 20
        set     I3, 1
        set     I4, 1
REDO:   eq      I1, I2, DONE, NEXT
NEXT:   set     I5, I4
        add     I4, I3, I4
        set     I3, I5
        print   I3
        print   "\n"
        inc     I1
        branch  REDO
DONE:   end
</pre>
    <p>
      This is the equivalent code in Perl:
    </p>
    <pre>
        print "The first 20 fibonacci numbers are:\n";
        my $i = 0;
        my $target = 20;
        my $a = 1;
        my $b = 1;
        until ($i == $target) {
           my $num = $b;
           $b += $a;
           $a = $num;
           print $a,"\n";
           $i++;
        }
    </pre>
    <p>
      (As a fine point of interest, one of the shortest and certainly
      the most beautiful ways of printing out a Fibonacci series in
      Perl is <code>perl -le '$b=1; print $a+=$b while print $b+=$a'</code>.)
    </p>
    <h3>Jako</h3>
    <p>
      So much for programming in assembler; let's move on and look at
      a medium-level language - Jako. Jako was written by Gregor Purdy
      who obviously got sick (as a parrot) of programming in
      assembler. Jako looks a little bit like C and a little bit like
      Perl, and it can do anything you can do in Parrot assembler, but
      a little tidier. Let's try that Fibonacci program again:
    </p>
    <pre>
        print("The first 20 fibonacci numbers are:\n");
        var int i = 0;
        var int target = 20;
        var int a = 1;
        var int b = 1;
        var int num;
        while (i != target) {
           num = b;
           b += a;
           a = num;
           print("$a\n");
           i++;
        }
</pre>
    <p>
      Notice how similar this is to the Perl version? I stripped away
      the <code>$</code> sigils, replaced the Perlish
      <code>until</code> with a more common <code>while</code>,
      replaced <code>my</code> with <code>var int</code> and I was
      nearly done.
    </p>
    <p>
      The Jako compiler, <code>jakoc</code>, ships with Parrot in the
      <code>little_languages</code> subdirectory:
    </p>
    <pre>
 % perl little_languages/jakoc fib.jako > fib.pasm
 % perl assemble.pl fib.pasm > fib.pbc
 % ./test_prog fib.pbc
The first 20 fibonacci numbers are:
1
2
3
...
</pre>
    <h2>Where Next?</h2>
    <p>
      Parrot is obviously developing very rapidly, and we still have
      a long way to go before we are ready for a compiler to this
      platform. This section is for those who are interested in
      helping us take Parrot further.
    </p>
    <h3>Adding Operations</h3>
    <p>
      The first thing we need is a lot more operations; but this needs
      to be carefully thought out, and all new proposals for
      operations should be checked by Dan Sugalski, the Parrot
      designer.
    </p>
    <p>
      That said, adding operations to Parrot is actually 
      simple. Let's add the <code>sleep</code> operator we were
      complaining about earlier.
    </p>
    <p>
      To add an operator to the Parrot core, we need to edit two
      files: <code>opcode_table</code>, which contains the description
      of operations and their arguments, and
      <code>basic_opcodes.ops</code>, which contains the C
      implementation for our opcodes.
    </p>
    <p>
      Although we've been able to say <code>print "String"</code> and
      <code>print I3</code> to print a register, Parrots ops are
      <B>not</b> polymorphic - this is some trickery carried out by
      the assembler. Those two operations would be implemented by two
      different ops, <code>print_sc</code> to print a string constant,
      and <code>print_i</code> to print an integer register. So we'll
      add two ops <code>sleep_i</code> to sleep for the number of
      seconds determined by the contents of an integer register, and
      <code>sleep_ic</code>, to sleep for a constant number of
      seconds. Each op has one argument. At the top of
      <code>opcode_table</code> there is a list of argument types:
    </p>
    <pre>
# Revised arg types:
#      i       Integer constant
#      I       Integer register
#      n       Numeric constant
#      N       Numeric register
#      s       String constant?
#      S       String register
#      D       Destination
</pre>
    <p>
      So <code>sleep_ic</code> has 1 argument, <code>i</code>, and
      <code>sleep_i</code> has 1 argument, <code>I</code>. Let's add
      these into <code>opcode_table</code> in the "Miscellaneous and
      debugging ops" category:
    </p>
<pre>
 # Miscellaneous and debugging ops
 
 time_i              1                   I
 print_i             1                   I
 print_ic            1                   i
 time_n              1                   N
 print_n             1                   N
 print_nc            1                   n
+sleep_i             1                   I
+sleep_ic            1                   i
    </pre>
    <p>
      And now we need to implement them by adding to
      <code>basic_opcodes.ops</code>. The format of this file is a
      little funny; it's C, which is preprocessed by a Perl
      program. The C functions should be declared
      <code>AUTO_OP</code>, which means that the preprocessor will
      automatically work out the return address of the next op in the
      bytecode stream. (branch operators need special treatment, and as
      such are <code>MANUAL_OP</code>s) Parameters are denoted by
      <code>P1</code>, <code>P2</code> and so on - they aren't actual
      parameters to the C function, but are pulled out of the bytecode
      stream. Finally, we can access register <code>n</code> by saying
      <code>INT_REG(n)</code>, <code>NUM_REG(n)</code> and so on.
    </p>
    <p>
      So let's do the constant sleep op first. We want to take the
      first parameter, <code>P1</code>, and pass it to sleep:
    </p>
    <pre>
AUTO_OP sleep_ic {
     sleep(P1);
}
</pre>
    <p>
      That was easy. The second op is only slightly more complex. We
      have to use <code>INT_REG</code> to retrieve the contents of the
      register:
    </p>
    <pre>
AUTO_OP sleep_i {
     sleep(INT_REG(P1));
}
</pre>
    <p>
      All that's missing is a test suite (see
      <code>t/op/basic.t</code> for an example) and some documentation
      (we need to add entries to
      <code>docs/parrot_assembly.pod</code>) and we've added our
      instructions to the Parrot CPU. The assembler will automatically
      determine whether we're sleeping for a constant time or a
      variable time, and will dispatch the right op when we just say
      <code>sleep</code>. Now we can rewrite the <code>showtime</code>
      code a little more neatly - or rather, <b>you</b> can, as a nice
      little exercise!
    </p>
    <h3>Vtable Datatypes</h3>
    <p>
      The next major thing that Parrot needs to implement is PMCs;
      these are almost like Perl 5's SVs, only more so. A PMC is an
      object of some type, which can be instructed to perform various
      operations. So when we say
    </p>
    <pre>
      inc P1
    </pre>
    <p>
      to increment the value in PMC register 1, the
      <code>increment</code> method is called on the PMC - and it's up
      to the PMC how it handles that method.
    </p>
    <p>
      PMCs are how we plan to make Parrot language-independent - a
      Perl PMC would have different behavior from a Python PMC or a
      Tcl PMC. The individual methods are function pointers held in a
      structure called a <b>vtable</b>, and each PMC has a pointer to
      the vtable which implements the methods of its "class." Hence a
      Perl interpreter would link in a library full of Perl-like
      classes and its PMCs would have Perl-like behavior.
    </p>
    <p>
      We've already designed the vtables and the structure of PMCs,
      but sitting down and implementing them is one of the priorities
      for Parrot development that will make it truly useful.
    </p>
    <h3>More Todos</h3>
    <p>
      There are a huge number of things we want to do with Parrot: We
      need, for instance, to create some I/O operators to make
      programs actually interesting; we want to create a range of
      string functions to deal with various encodings and convert
      between them; we want more documentation; we really, really need
      more tests; we want to check Parrot's portability to various
      platforms; and finally, there are more ops that we need
      to implement.
    </p>
<!-- Mastering Algorithms with Perl -->

    <h3>Getting Involved</h3>
    <p>
      We have a good number of people working on Parrot, but we
      could always use a few more. To help out, you'll need a
      subscription to the <a
      href="mailto:perl6-internals-subscribe@perl.org">perl6-internals
      </a> mailing list, where all the development takes place; you
      should keep up to date with the CVS version of Parrot - if you
      want to be alerted to CVS commits, you can subscribe to the <A
      href="mailto:cvs-parrot-subscribe@perl.org">cvs-parrot</a>
      mailing list. CVS commit access is given to those who taken
      responsibility for a particular area of Parrot, or who often
      commit high-quality patches.
    </p>
    <p>
      A useful Web page is <A
      href="http://cvs.perl.org/">cvs.perl.org</a>, which reminds you
      how to use CVS and allows you to browse the CVS repository; the
      <A HREF="http://dev.perl.org/perl6/code">code</a> page is a
      summary of this information and other resources about Parrot.
    </p>
    <p>
      So don't delay - pick up a Parrot today!
    </p>







        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1598" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2001/09/12/wxtutorial1.html" rel="bookmark">wxPerl: Another GUI for Perl</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Jouke Visser</span> on <abbr class="published" title="2001-09-12T00:00:00-08:00">September 12, 2001 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            <h3><a name="wxperl">wxPerl?</a></h3>
<p>If you don't just use Perl for creating CGI scripts, you'll probably
have to create some kind of front-end for your applications sooner or
later. You might use the Curses library, but if you want a nice GUI, you
will probably use Tk. It's certainly the most stable, best documented
and widest used GUI that's available for Perl. However, more and more
people are using other GUIs, such as Gtk and Win32::GUI. The main reason
for this is probably that Tk does not have the slickest interface that
exactly matches the environment that people use. Tk has a motif-like
interface, while Gnome users will want the Gtk look-and-feel, and
Windows users will want the Windows look-and-feel. Of course, Tk looks
more like Windows when you use it on a Win32 machine and looks more like
Gtk when you run it under Gnome, but still it is a different interface.</p>
<p>Recently, I discovered another GUI for Perl. No, not the unmaintained Qt
and FWTK modules, but wxPerl, which is being developed by Mattia Barbon.
It's not on CPAN yet (he's working on that now) but it is on
Sourceforge (<a href="http://wxperl.sourceforge.net">http://wxperl.sourceforge.net</a>). 
wxPerl is the Perl
binding for wxWindows (<a href="http://www.wxwindows.org">http://www.wxwindows.org</a>), which is a
cross-platform GUI library for C++. When I say cross-platform, I indeed
mean cross-platform: There is wxWindows for Windows, Gtk, Motif and
Macintosh. wxWindows has been developed since 1992 with version 2 (the
current version) being developed since 1997. It's not a GUI that has
been ported from a certain platform where it had its roots: wx stands
for Windows and X -- it has been designed to be cross-platform. Also it
has been around for a while so it has had the chance to become a stable
product.</p>

<p>
<h3><a name="the wxperl approach">The wxPerl approach</a></h3>
<p>wxPerl has a very rich set of standard widgets (called ``controls'' in
Wx-terms), ranging from simple buttons to complex HTML windows and Font
dialogs. This makes it a good GUI to create full-featured applications.
All needed controls are available ``off the shelf,'' and if there is still
a complex control you want to create yourself, then you can do so with 
little effort. This is a particularly big difference from, for example,
Tk, where it is a real pain to define new widgets.</p>
<p>Programming wxPerl is different. It's not better or worse than the Tk or
Gtk interfaces, but it's a totally different approach. The main reason
for this is the source of the library, which is a C++ library. It is
less Perlish - but it's more OO.</p>
<p>When you want to create a new wxPerl application you start creating a
new class that inherits from <code>Wx::App</code>. This subclass has to have at
least one method called <code>OnInit</code> which defines the windows (called
``Frames'' in Wx-terms) the application uses. If you want a default
window, you use the default classes. If you want to add controls to a
window, you subclass a default windowclass and add the controls to it.</p>
<p>This is a much more object-oriented approach than Tk and Gtk use. But
unfortunately it lacks the named parameter approach Tk uses, which makes
Tk look more Perlish.</p>
<p>Currently, there is one big disadvantage to wxPerl: It is very poorly
documented. That is to say: wxWindows has lots of documentation. And if
you try hard enough, then you can use that documentation for wxPerl. That
takes quite a bit of effort, though. But after reading this first wxPerl
tutorial you might become interested and find your own way into wxPerl.</p>
<p>
<h3><a name="hello world!">Hello World!</a></h3>
<p>Like every tutorial, this tutorial has its own ``Hello World!''
application to get started and create the first application. Examine
this script:</p>
<pre>
   =1= #!/usr/bin/perl -w
   =2= use strict;
   =3= use Wx;
   =4= 
   =5= ###########################################################
   =6= #
   =7= # Define our HelloWorld class that extends Wx::App
   =8= #
   =9= package HelloWorld;
  =10= 
  =11= use base qw(Wx::App);   # Inherit from Wx::App
  =12= 
  =13= sub OnInit
  =14= # Every application has its own OnInit method that will
  =15= # be called when the constructor is called.
  =16= {
  =17=    my $self = shift;
  =18=    my $frame = Wx::Frame-&gt;new( undef,         # Parent window
  =19=                                -1,            # Window id
  =20=                                'Hello World', # Title
  =21=                                [1,1],         # position X, Y
  =22=                                [200, 150]     # size X, Y
  =23=                              );
  =24=   $self-&gt;SetTopWindow($frame);    # Define the toplevel window
  =25=   $frame-&gt;Show(1);                # Show the frame
  =26= }
  =27= 
  =28= ###########################################################
  =29= #
  =30= # The main program
  =31= #
  =32= package main;
  =33= 
  =34= my $wxobj = HelloWorld-&gt;new(); # New HelloWorld application
  =35= $wxobj-&gt;MainLoop;</pre>
<p>Like every well-written Perl application, this one also begins with
<code>-w</code> and <code>use strict</code>. After that we <code>use Wx</code>, the main wxPerl
module. On line 9 we start our package HelloWorld, which inherits (line
11) from <code>Wx::App</code>, like all wxPerl applications. This new application
now needs to have an <code>OnInit</code> method that defines the Frames
(line 18) and defines which of the Frames is the TopWindow (line 24).
Finally, we call the <code>Show</code> method (line 25), which makes the created
<code>$frame</code> visible.</p>
<p>The frame is created using a few parameters. The first is the parent
window. If we were creating two frames, then the second one could be
appointed as a child of the first by using <code>$frame</code> as the first
parameter of the constructor of the second frame. But in our example we
have only one window, so the parent window is <code>undef</code>.</p>
<p>At this moment we don't care about the second parameter (the window id,
-1 means the default value), but the third and fourth are more
interesting. They define the position on the screen and the size
respectively. These parameters are passed as array references, and could
also be the predefined <code>wxDefaultPosition</code> and <code>wxDefaultSize</code>
respectively.</p>
<p>After defining the HelloWorld package, we have to create the main
program by defining the main package (line 32). This package creates a
new Wx object (line 34) out of our defined HelloWorld package and then
calls the <code>MainLoop</code> method on it (line 35).</p>
<p>The MainLoop is the only thing that resembles to the Tk and Gtk GUIs.
The whole approach of defining a new subclass of <code>Wx::App</code> is totally
different.</p>
<p>When you execute this first example, it will look like this:</p>
<img src="/pub/2001/09/12/graphics/helloworld.gif" alt="Hello World" width="200" height="150" /><p>
<h3><a name="fill the empty window.">Fill the empty window.</a></h3>
<p>So this was a simple example that creates an empty window with a
title named ``Hello World!'' Not really exciting, huh? Now we want to see
more controls in the window. Let's see how we can add a useless button
that does nothing and a piece of text on the screen.</p>
<p>We need to have a bit of background information on how wxPerl
applications (and wxWindows applications) work in general, before we can
create something inside the window. As you saw in the previous example,
to create an application, we need to subclass <code>Wx::App</code>. To create our
own contents <strong>in</strong> a frame, we first need to subclass <code>Wx::Frame</code> and
create an instance of that subclassed frame in the OnInit method of the
newly created subclass of <code>Wx::App</code>.</p>
<p>To put controls in our subclassed frame, you first have to create a
Panel inside that frame, since controls can only be placed on an
instance of <code>Wx::Panel</code>. To be able to access and modify properties of
the Panel and other things that you want to put inside a Frame, you will
have make those items objects of the Frame.</p>
<p>That's a lot of (potentially) confusing information. Let's take this example:</p>
<pre>
   =1= #!/usr/bin/perl -w
   =2= use strict;
   =3= use Wx;
   =4= 
   =5= ###########################################################
   =6= #
   =7= # Extend the Frame class to our needs
   =8= #
   =9= package MyFrame;
  =10= 
  =11= use base qw(Wx::Frame); # Inherit from Wx::Frame
  =12= 
  =13= sub new
  =14= {
  =15=     my $class = shift;
  =16=     my $self = $class-&gt;SUPER::new(@_); # call the superclass' constructor
  =17= 
  =18=     # Then define a Panel to put the button on
  =19=     my $panel = Wx::Panel-&gt;new( $self,  # parent
  =20=                                 -1      # id
  =21=                               );
  =22=     $self-&gt;{txt} = Wx::StaticText-&gt;new( $panel,             # parent
  =23=                                         1,                  # id
  =24=                                         &quot;A buttonexample.&quot;, # label
  =25=                                         [50, 15]            # position
  =26=                                        );
  =27=     $self-&gt;{btn} = Wx::Button-&gt;new(     $panel,             # parent
  =28=                                         1,                  # id
  =29=                                         &quot;&gt;&gt;&gt; Press me &lt;&lt;&lt;&quot;, # label
  =30=                                         [50,50]             # position
  =31=                                        );
  =32=     return $self;
  =33= }
  =34= 
  =35= ###########################################################
  =36= #
  =37= # Define our ButtonApp class that extends Wx::App
  =38= #
  =39= package ButtonApp;
  =40= 
  =41= use base qw(Wx::App);   # Inherit from Wx::App
  =42= 
  =43= sub OnInit
  =44= {
  =45=     my $self = shift;
  =46=     my $frame = MyFrame-&gt;new(    undef,         # Parent window
  =47=                                  -1,            # Window id
  =48=                                  'Button example', # Title
  =49=                                  [1,1],         # position X, Y
  =50=                                  [200, 150]     # size X, Y
  =51=                                );
  =52=     $self-&gt;SetTopWindow($frame);    # Define the toplevel window
  =53=     $frame-&gt;Show(1);                # Show the frame
  =54= }
  =55= 
  =56= ###########################################################
  =57= #
  =58= # The main program
  =59= #
  =60= package main;
  =61= 
  =62= my $wxobj = ButtonApp-&gt;new(); # New ButtonApp application
  =63= $wxobj-&gt;MainLoop;</pre>
<p>You can see here that again we define a subclass of <code>Wx::App</code> called
ButtonApp (line 39). Only this time the created frame is not a
<code>Wx::Frame</code> instance, but a <code>MyFrame</code> instance. This <code>MyFrame</code> is a
new subclass of <code>Wx::Frame</code> that we define in line 9.</p>
<p>Basically we only have to override the <code>new</code> constructor of
<code>Wx::Frame</code>. We want to extend the <code>Wx::Frame</code> class, so our
constructor first calls its <code>SUPER</code>class' constructor, and defines its
extensions after that. Our extensions consist of a new <code>Panel</code> (line
19), which has a <code>StaticText</code> (line 22) and a <code>Button</code> (line 27) on
it. Just like the original <code>Wx::Frame</code> class would do, our constructor
also returns <code>$self</code> (line 32), which finishes the definition of
<code>MyFrame</code>.</p>
<p>As you can see, we've defined the <code>Button</code> and the <code>StaticText</code> objects
as attributes of <code>MyFrame</code>. This is not strictly neccesary now, but if
we want to add some interaction to this script, which we will do in the
next example, we want to access those objects. Since they're now stored
as attributes of <code>MyFrame</code> we can access the <code>Button</code> and
<code>StaticText</code> everywhere we have access to the <code>MyFrame</code> object. So
it's just a matter of style that it's stored this way here, because we
don't actually do anything with it in this example.</p>
<p>When you execute this example it will look like this:</p>
<img src="/pub/2001/09/12/graphics/button.gif" alt="Button example" width="200" height="150" /><p>
<h3><a name="adding interaction">Adding interaction</a></h3>
<p>But what does it do? Err ... it does nothing - yet. But a GUI application
without interaction is useless. So we're going to implement some
interaction. I already explained in the previous example: If you want to
change the properties of the defined objects, then you will have to define
them as attributes of the Frame object. That way you can always access
any attribute of the object, be it a StaticText, a Button or a Menu.</p>
<p>Consider the following code:</p>
<pre>
   =1= #!/usr/bin/perl -w
   =2= use strict;
   =3= use Wx;
   =4= 
   =5= ###########################################################
   =6= #
   =7= # Extend the Frame class to our needs
   =8= #
   =9= package MyFrame;
  =10= 
  =11= use Wx::Event qw( EVT_BUTTON );
  =12= 
  =13= use base qw/Wx::Frame/; # Inherit from Wx::Frame
  =14= 
  =15= sub new
  =16= {
  =17=  my $class = shift;
  =18=  
  =19=  my $self = $class-&gt;SUPER::new(@_);  # call the superclass' constructor
  =20= 
  =21=     # Then define a Panel to put the button on
  =22=  my $panel = Wx::Panel-&gt;new( $self,  # parent
  =23=                              -1      # id
  =24=                            );
  =25= 
  =26=  $self-&gt;{txt} = Wx::StaticText-&gt;new( $panel,             # parent
  =27=                                      1,                  # id
  =28=                                      &quot;A buttonexample.&quot;, # label
  =29=                                      [50, 15]            # position
  =30=                                     );
  =31=  
  =32=  my $BTNID = 1;  # store the id of the button in $BTNID
  =33=  
  =34=  $self-&gt;{btn} = Wx::Button-&gt;new(     $panel,             # parent
  =35=                                      $BTNID,             # ButtonID
  =36=                                      &quot;&gt;&gt;&gt; Press me &lt;&lt;&lt;&quot;, # label
  =37=                                      [50,50]             # position
  =38=                                     );
  =39= 
  =40=  EVT_BUTTON( $self,          # Object to bind to
  =41=              $BTNID,         # ButtonID
  =42=              \&amp;ButtonClicked # Subroutine to execute
  =43=             );
  =44= 
  =45=  return $self;
  =46= }
  =47= 
  =48= sub ButtonClicked 
  =49= { 
  =50=  my( $self, $event ) = @_; 
  =51=  # Change the contents of $self-&gt;{txt}
  =52=  $self-&gt;{txt}-&gt;SetLabel(&quot;The button was clicked!&quot;); 
  =53= } 
  =54= 
  =55= ###########################################################
  =56= #
  =57= # Define our ButtonApp2 class that extends Wx::App
  =58= #
  =59= package ButtonApp2;
  =60= 
  =61= use base qw(Wx::App);   # Inherit from Wx::App
  =62= 
  =63= sub OnInit
  =64= {
  =65=     my $self = shift;
  =66=     my $frame = MyFrame-&gt;new(   undef,         # Parent window
  =67=                                 -1,            # Window id
  =68=                                 'Button interaction example', # Title
  =69=                                 [1,1],         # position X, Y
  =70=                                 [200, 150]     # size X, Y
  =71=                                );
  =72=     $self-&gt;SetTopWindow($frame);    # Define the toplevel window
  =73=     $frame-&gt;Show(1);                # Show the frame
  =74= }
  =75= 
  =76= ###########################################################
  =77= #
  =78= # The main program
  =79= #
  =80= package main;
  =81= 
  =82= my $wxobj = ButtonApp2-&gt;new(); # New ButtonApp application
  =83= $wxobj-&gt;MainLoop;</pre>
<p>This example is basically the same as the previous one, but the main
difference here is the addition of some interaction. In the previous
example, nothing happened when you tried to click the button. This time
clicking the button will alter the text of the <code>StaticText</code> object.
Let's see what has been changed in the code:</p>
<p>First of all, we use <code>Wx::Event</code> and import <code>EVT_BUTTON</code>. <code>EVT_BUTTON</code>
is the event handling subroutine for button-events. There are many more
event handlers available, but we only need this one now.</p>
<p>On line 31 I'm introducing a variable to hold the button id called
<code>$BTNID</code>. I could still have used the hard-coded <code>1</code> I used in the
previous example, but by using this variable it will be clearer to see
where I'm referring to it. For example, it's needed for the
<code>EVT_BUTTON</code> we call at line 40. This is where we define what to do
when the button is clicked. It takes the <code>$self</code> object, the <code>$BTNID</code>
and a subroutine reference as parameters. On line 48 we define that
subroutine.</p>

<p>An event callback in wxPerl always takes two parameters: the first is
the object to which it belongs (which caused the event to happen) and
the second is the event object itself. In our case we don't need that
second parameter, but we do need the first, because we want to change
the text of the <code>StaticText</code> object. This is the place where we see the
use of defining the <code>StaticText</code> object as attribute of the <code>MyFrame</code>
object. We can now simply call the <code>SetLabel</code> method on that attribute
(line 52).</p>
<p>Before we press the button, the window will look like the one in the
previous example. After we press the button, the application window will
look like this:</p>
<img src="/pub/2001/09/12/graphics/button2.gif" alt="Button interaction" width="200" height="150" /><p>
<h3><a name="conclusion">Conclusion</a></h3>
<p>I've shown a bit of the way wxPerl works. More precisely, I've shown how
you can work with wxPerl. It's obvious that this is a different approach
from other GUIs. I admit that at first I myself thought this was an
unnatural way of programming Perl, not to mention programming Perl GUIs.
But having done some exercises, I get the feeling this is in fact a more
natural approach than Tk or Gtk use. Of course, it all comes down to a
matter of taste. And there's no accounting for taste.</p>
<p>In the next wxPerl tutorial, I will show you how to create menus, show
some more event handling and I'll even add some more advanced controls.
But the goal will be the same: to show you the hidden beauties of
wxPerl!</p>








        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1606" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2001/09/p6pdigest/20010908.html" rel="bookmark">This Week on Perl 6 (2 - 8 September 2001)</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Bryan Warnock</span> on <abbr class="published" title="2001-09-08T00:00:00-08:00">September  8, 2001 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            <h3><a name="Notes">Notes</a></h3>

<table width="150" border="0" cellspacing="0" cellpadding="4" align="right">
<tr> 
<td width="150" valign="top" height="4" bgcolor="#6699cc"></td></tr> 
<tr>
<td bgcolor="#efefef">
<p class="headline" align="center">This Week in Perl 6 News
</p>
<p class="smalltext">
&#149; <a href="#MY_Goodness"><code>%MY::</code> Goodness</a><br /><br />
&#149; <a href="#Prototypes">Prototypes</a><br /><br />
&#149; <a href="#Documents_Released">Documents Released</a><br /><br />
&#149; <a href="#Math_Functions_To_Add">Math Functions To Add</a><br /><br />
&#149; <a href="#Parroty_Bits">Parroty Bits</a><br />
</td></tr> <tr><td width="150" valign="top" height="4" bgcolor="#6699cc"> </td></tr></table>


<p>

You can subscribe to an email version of this summary by sending an empty
message to 
<a href="mailto:perl6-digest-subscribe@netthink.co.uk">perl6-digest-subscribe@netthink.co.uk</a>.
</p>

<p>
Please send corrections and additions to 
<a href="mailto:bwarnock@capita.com">bwarnock@capita.com</a>.
</p>

<p>
It was a busy week in the Perl 6 community with 363 messages contributed by
42 authors across 32 threads.  A fourth of the threads comprised over
three-fourths of the traffic.
<h3><a name="MY_Goodness"><code>%MY::</code> Goodness</a></h3>



<p>

There were two huge discussions on the new 
<code>%MY::</code> interface to the lexical symbol table.
</p>

<p>
(70 posts) The major thread,
<a href="http://archive.develooper.com/perl6-language@perl.org/msg08203.html">started</a> by Ken Fox, centered around 
<code>%MY::</code> as a language feature to be used and abused.
<blockquote></p>

<p>
Is stuff like:
</p>

<p>
<code>%MY::{'$lexical_var'} = \$other_var;</code>
</p>

<p>
supposed to be a compile-time or run-time feature?
</p>

<p>
Modifying the caller's environment:
</p>

<p>
  <code>$lexscope = caller().{MY};</code>
</p>

<p>
  <code>$lexscope{'&amp;die'} = &amp;die_hard;</code>
</p>

<p>
is especially annoying because it means that I can't
trust lexical variables anymore. The one good thing
about Damian's caller() example is that it appears
in an import() function. That implies compile-time,
but isn't as clear as Larry's Apocalypse.
</p>

<p>
This feature has significant impact on all parts of
the implementation, so it would be nice if a little
more was known. A basic question: how much performance
is this feature worth?
</blockquote></p>

<p>
Most of the discussions addressed adjusting lexical variables during
runtime, and what semantics that would change with what is currently Perl
5's lexical variables.  Of particular concern, how runtime adjustment of
lexical variables could defeat the current compile-time optimizations for
variable resolution that Perl 5 currently enjoys, and whether
<code>%MY::</code> symbol resolution is confined to a physical scope, whereas a lexical
<code>$x</code> may refer to a lexical in an outer scope.  These issues are being mulled
over.
</p>

<p>
(45 posts) Brent Dax also
<a href="http://archive.develooper.com/perl6-internals@perl.org/msg03501.html">asked</a> whether 
<code>%MY::</code> should be a real symbol table instead of the current scratchpad structure
currently used by Perl 5.  There was a lot of debate on the
differences between lexical and local global variables, and whether that
distinction would help or hinder a transition to a true symbol table.
Much of this decision will be affected by the linguistic questions
discussed above.
<h3><a name="Prototypes">Prototypes</a></h3>



<p>

(20 posts) I 
<a href="http://archive.develooper.com/perl6-language@perl.org/msg08188.html">proposed </a> a method for runtime prototype checking and value assignment that was
generally accepted.
<h3><a name="Documents_Released">Documents Released</a></h3>





<p>

(71 posts) Simon Cozens
<a href="http://archive.develooper.com/perl6-internals@perl.org/msg03519.html">released</a> an overview of the Parrot interpreter.  This is mostly codifying and 
coalescing much of the information that has been presented before.
Feedback has been rolled into the docs that will be provided with the
first Parrot release, so you can catch the updated info there.
</p>

<p>

<a href="http://archive.develooper.com/perl6-internals@perl.org/msg03574.html">Later stages </a> of the thread turned into a debate between Paolo Molaro and Dan Sugalski,
centered once again around the decision to do a register-based virtual
machine.
</p>

<p>
(5 posts) Dan Sugalski 
<a href="http://archive.develooper.com/perl6-internals@perl.org/msg03666.html">re-released</a> the second version of PDD 6: Parrot Assembly Language.
</p>

<p>
(3 posts) Dave Storrs
<a href="http://archive.develooper.com/perl6-language@perl.org/msg08250.html">released</a> the next version of his Perl 6 Debugger API PDD.
</p>

<p>
(16 posts) I released versions
<a href="http://archive.develooper.com/perl6-language@perl.org/msg08165.html">one</a> and
<a href="http://archive.develooper.com/perl6-language@perl.org/msg08269.html">two</a> of my &quot;Statements and Blocks&quot; language specification.
<h3><a name="Math_Functions_To_Add">Math Functions To Add</a></h3>



<p>

(30 posts) Dan Sugalski 
<a href="http://archive.develooper.com/perl6-internals@perl.org/msg03681.html">queried</a> the Perl community for math functions to add to Parrot.
<h3><a name="Parroty_Bits">Parroty Bits</a></h3>


<p>

By the time you read this, the initial Parrot baseline should be available 
via anonymous CVS.  You may find details
<a href="http://dev.perl.org/cvs">here</a>.  Simon Cozens holds the source pumpkin.
</p>

<hr>

<a href="mailto:bwarnock@capita.com">Bryan C. Warnock</a>





        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1596" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2001/09/04/tiedhash.html" rel="bookmark">Changing Hash Behaviour with tie</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                <abbr class="published" title="2001-09-04T00:00:00-08:00">September  4, 2001 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            

<h3><a name="introduction">Introduction</a></h3>



<p>In my experience, hashes are just about the most useful built-in datatype

that Perl has. They are useful for so many things - from

simple lookup tables to complex data structures. And, of course, most

Perl Objects have a blessed hash as their underlying implementation.</p>



<p>The fact that they have so many uses must mean the Larry and the Perl5



Porters must have got the functionality of hashes pretty much right when



designing them - it's simple, instinctive and effective. But have you ever



come across a situation where you wanted to change the way that hashes



worked? Perhaps you wanted hashes that only had a fixed set of keys. Faced



with this requirement, it's tempting to move away from the hash interface



completely and use an object. The downside to this decision is that you lose



the easy-to-understand hash interface. But using <em>tied variables</em> it is



possible to create an object and still use it like a hash.</p>





<h3><a name="tied objects">Tied Objects</a></h3>



<p>Tied objects are, in my opinion, an underused feature of Perl. The details



(together with some very good examples) are in <em>perltie</em> and there are



some extended examples in the ``Tied variables'' chapter of <em>Programming



Perl</em>. Despite all of this great documentation, most people seem to believe



that <code>tie</code>ing is only used to <code>tie</code> a hash to a DBM file. The truth is



that any type of Perl data structure can be <code>tie</code>d to just about anything.



It's simply a case of writing an object that includes certain pre-defined



methods. If you want to create a <code>tie</code>d object that emulates a standard



Perl object most of the time, then it's even easier, as the Perl



distribution contains modules that define objects that mimic the behavior



of that standard data types. For example, there is a class called



<code>Tie::StdHash</code> (in the file Tie::Hash) that mimics the behavior of a



real hash. To alter that behavior we simply have to subclass <code>Tie::StdHash</code>



and override the methods that we're interested in.</p>





<h3><a name="using tied objects">Using Tied Objects</a></h3>







<p>In your Perl program, you make use of a <code>tie</code>d object by calling the



<code>tie</code> function. <code>tie</code> takes two mandatory parameters: the variable that



you are <code>tie</code>ing and the name of the class to <code>tie</code> it to, followed by



any number of optional paramters. For example, if we had written the hash



with fixed keys discussed earlier (which we will do soon), we could use



the class in our program like this:</p>



<pre>

  use Tie::Hash::FixedKey;

  my %person;

  my @keys = qw(forename surname date_of_birth gender);

  tie %person, 'Tie::Hash::FixedWidth', @keys;</pre>



<p>After running this code, <code>%person</code> can still be used like a



hash, but its behavior will have been changed. Any attempt to assign a



value to a key outside the list that we used in the call to <code>tie</code> will



fail in some way that we get to specify when we write the module.</p>



<p>If for some reason we wanted to get to the underlying object that is tied



to the hash, then we can use the <code>tied</code> function. For example,</p>



<pre>

  my $obj = tied(%person);</pre>



<p>will give us back the Tie::Hash::FixedKeys object that is tied to our



<code>%person</code> hash. This is sometimes used to extend the functionality in



ways that aren't available through the standard hash interface. In our fixed



keys example, we might want the user to be able to extend or reduce the



list of valid keys. There is no way to do this in the standard hash



interface so we would need to add new methods called, say, <code>add_keys</code> and



<code>del_keys</code>, which can be called like this:</p>



<pre>

  tied(%person)-&gt;add_keys('weight', 'height');</pre>



<p>When you have finished with the tied object and want to return it to



being an ordinary hash, you can use the <code>untie</code> function. For example,</p>



<pre>

  untie %person;</pre>



<p>returns <code>%person</code> to being an ordinary hash.</p>



<p>To tie an object to a Perl hash, your object needs to define the following



set of methods. Notice that they are all named in upper case. This is



the standard for function names that Perl is going to call for you.</p>



<dl>



<dt><strong><a name="item_TIEHASH">TIEHASH</a></strong><br>



<dd>



This is the constructor function. It is called when the user calls the



<code>tie</code> function. It is passed the name of the class and the list of



parameters that were passed to <code>tie</code>. It should return a reference to



the new tied object.







<dt><strong><a name="item_FETCH">FETCH</a></strong><br>



<dd>



This is the method that is called when the user accesses a value from



the hash. The method is passed a reference to the tied object and the



key that the user is trying to access. It should return the value



associated with the given key (or <code>undef</code> if the key isn't found).







<dt><strong><a name="item_STORE">STORE</a></strong><br>



<dd>



This method is called when the user tries to store a value against a



key in the tied hash. It is passed a reference to the object, together



with the key and value pair.







<dt><strong><a name="item_DELETE">DELETE</a></strong><br>



<dd>



This method is called when the user calls the <code>delete</code> function to



remove one of the key/value pairs in the tied hash. It is passed a



reference to the tied object and the key that the user wishes to



remove. The return value becomes the return value from the <code>delete</code>



call. To emulate the 'real' <code>delete</code> function, this should be the



value that was stored in the hash before it was deleted.







<dt><strong><a name="item_CLEAR">CLEAR</a></strong><br>



<dd>



This method is called when the user clears the whole hash (usually



by asigning an empty list to the hash). It is passed a reference to



the tied object.







<dt><strong><a name="item_EXISTS">EXISTS</a></strong><br>



<dd>



This method is called when the user calls the <code>exists</code> function to



see whether a given key exists in the hash. It is passed a reference to



the tied object and the key to search for. It should return a true



value if the key is found and false otherwise.







<dt><strong><a name="item_FIRSTKEY">FIRSTKEY</a></strong><br>



<dd>



This method is called when one of the hash iterator functions



(<code>each</code> or <code>keys</code>) is called for the first time. It is passed a



reference to the tied object and should return the first key in the



hash.







<dt><strong><a name="item_NEXTKEY">NEXTKEY</a></strong><br>



<dd>



This method is called when one of the iterator functions is called.



It is passed a reference to the tied object and the name of the last



key that was processed. It should return the name of the next key



or <code>undef</code> if there are no more keys.







<dt><strong><a name="item_UNTIE">UNTIE</a></strong><br>



<dd>



This method is called when the <code>untie</code> function is called. It is



passed a reference to the tied object.







<dt><strong><a name="item_DESTROY">DESTROY</a></strong><br>



<dd>



This method is called when the tied variable goes out of scope.



It is passed a reference to the tied object.



</dl>



<p>As you can see, there are a large number of methods to implement, but



in the next section we'll see how you can get away with only



implementing some of them.</p>































<h3><a name="a first example: tie::hash::fixedkeys">A First Example: Tie::Hash::FixedKeys</a></h3>



<p>Let's take a look at the implementation of Tie::Hash::FixedKeys. This



module is available on CPAN if you want to take a closer look.</p>



<p>Writing the module is made far easier for use by the existence of a



package called Tie::StdHash. This is a tied hash that mirrors



the behavior of a standard Perl hash. This package is stored in the



module Tie::Hash. This means that if you wrote code like the following



example, then you would have a tied hash that acts the same way as a



'real' hash.</p>



<pre>

    use Tie::Hash;

    my %hash;

    tie %hash, 'Tie::StdHash';</pre>







<p>So far, so good. But it hasn't really achieved much. The hash <code>%hash</code>



is now a tied object, but we haven't changed any of its functionalities.



Tie::StdHash works much better if it is used as a base class from which



you inherit behavior. For example, the start of the Tie::Hash::FixedKeys



class looks like this:</p>



<pre>

    package Tie::Hash::FixedKeys;

    use strict;

    use Tie::Hash;

    use Carp;

    use vars qw(@ISA);

    @ISA = qw(Tie::StdHash);</pre>



<p>This is standard for a Perl object, but notice that we've loaded the



Tie::Hash module (with <code>use Tie::Hash</code>) and have told our package



to inherit behavior from Tie::StdHash by putting Tie::StdHash in



the <code>@ISA</code> package variable.</p>



<p>If we stopped there, our Tie::Hash::FixedKeys package would have the



same behavior as a standard Perl hash. This is because each time Perl



tried to find one of the tie interface methods (like <a href="/pub/a/2001/09/04/tiedhash.html#item_FETCH"><code>FETCH</code></a> or



<a href="/pub/a/2001/09/04/tiedhash.html#item_STORE"><code>STORE</code></a>) in our package it would fail and would call the version found



in our parent class, Tie::StdHash.</p>



<p>At this point we can start to change the standard hash



behavior by simply overriding the methods that we want to change.



We'll start by implementing the <a href="/pub/a/2001/09/04/tiedhash.html#item_TIEHASH"><code>TIEHASH</code></a> method differently.</p>



<pre>

    sub TIEHASH {

      my $class = shift;

      my %hash;

      @hash{@_} = (undef) x @_;

	  

      bless \%hash, $class;

    }</pre>



<p>The <a href="/pub/a/2001/09/04/tiedhash.html#item_TIEHASH"><code>TIEHASH</code></a> function is passed the name of the class as its first



parameter, so we <code>shift</code> that into <code>$class</code> in the first line. The



rest of the parameters in <code>@_</code> are whatever extra parameters have been



passed into the <code>tie</code> call. In the example of how to use our



proposed class at the start of this article, we passed it the list



of valid keys. Therefore, we take this list of keys and (using a hash



slice) we initialize a hash so that it has <code>undef</code> as the value for



each of these keys. Finally, we take a reference to this hash, bless



it into the required class and return the reference.</p>



<p>It's worth pointing out here, the one caveat about using Tie::StdHash.



In order to use the default behavior, your new class <em>must</em> be based



on a hash reference and this hash must contain <em>only</em> real hash data.



We couldn't, for example, invent a key called <code>_keys</code> that would



contain a list of valid key names as, for example, this key would be



shown if the user called the <code>keys</code> method.</p>



<p>At this point we have a hash that has values (of <code>undef</code>) for each



of the allowed keys. This doesn't yet prevent us from adding new keys.



For that we need to override the STORE method.</p>



<pre>

    sub STORE {

      my ($self, $key, $val) = @_;



      unless (exists $self-&gt;{$key}) {

        croak &quot;invalid key [$key] in hash\n&quot;;

        return;

      }

      $self-&gt;{$key} = $val;

    }</pre>



<p>The three parameters passed to the <a href="/pub/a/2001/09/04/tiedhash.html#item_STORE"><code>STORE</code></a> method are a reference to



the tied object, and a new key/value pair. We need the <a href="/pub/a/2001/09/04/tiedhash.html#item_STORE"><code>STORE</code></a> method



to prevent new keys being added to the underlying hash, and we achieve



that by checking that the given key exists before setting the value.



Note that as our underlying object is a real hash, we can check this



simply by using the <code>exists</code> function. If the key doesn't exist we



give the user a friendly warning and return from the method without



changing the hash.</p>



<p>We have now prevented the hash from growing by adding keys, but it is



still possible to remove keys from the hash (and our <a href="/pub/a/2001/09/04/tiedhash.html#item_STORE"><code>STORE</code></a>



implementation would prevent them from being set once they had been



removed), so we also need to override the implementation of <a href="/pub/a/2001/09/04/tiedhash.html#item_DELETE"><code>DELETE</code></a>.</p>



<pre>

    sub DELETE {

      my ($self, $key) = @_;

      return unless exists $self-&gt;{$key};

	  

      my $ret = $self-&gt;{$key};



      $self-&gt;{$key} = undef;

      return $ret;

    }</pre>



<p>Once again, we don't actually want to change the existing set of keys in



the hash, so we check to see whether the key already exists and return immediately if



it doesn't. If the key <em>does</em> exist, then we don't want to actually delete it,



so we simply set the value back to <code>undef</code>. Notice that we note the



value before deleting it so that we can return it from the method, thus



mimicking the behavior of the real <code>delete</code> function.</p>



<p>There's one other way to affect the keys in our hash. Code like this:</p>



<pre>

    %hash = ();</pre>



<p>will cause the <a href="/pub/a/2001/09/04/tiedhash.html#item_CLEAR"><code>CLEAR</code></a> method to be called. The default behavior for



this method is to remove all of the data from the hash. We need to



replace this with a method that will reset all of the values to



<code>undef</code> without changing the keys in any way.</p>



<pre>

    sub CLEAR {

      my $self = shift;



      $self-&gt;{$_} = undef foreach keys %$self;

    }</pre>



<p>And that's all that we need to do. All of the other functionality of a



standard hash is inherited from Tie::StdHash. You can fetch values from



our hash as normal without us writing any more lines of code. Built-in



Perl functions like <code>each</code> and <code>keys</code> also work as expected.</p>



























<h3><a name="another example: tie::hash::regex">Another Example: Tie::Hash::Regex</a></h3>



<p>Let's look at another example. This module came about from a discussion



on Perlmonks a couple of months ago. Someone asked whether it was possible to



match hash keys approximately. I suggested that a hash that matched



keys as regular expressions might solve their problem and wrote the



first draft of this module. I'm grateful to Jeff Pinyan, who made some



suggestions for improvements to the module.</p>



<p>In order to make this change to the behavior of the hash, we need to



override the behavior of the <a href="/pub/a/2001/09/04/tiedhash.html#item_FETCH"><code>FETCH</code></a>, <a href="/pub/a/2001/09/04/tiedhash.html#item_EXISTS"><code>EXISTS</code></a> and <a href="/pub/a/2001/09/04/tiedhash.html#item_DELETE"><code>DELETE</code></a> methods.



Here's the <a href="/pub/a/2001/09/04/tiedhash.html#item_FETCH"><code>FETCH</code></a> method.</p>



<pre>

  sub FETCH {

    my $self = shift;

    my $key = shift;	

    my $is_re = (ref $key eq 'Regexp');

	

    return $self-&gt;{$key} if !$is_re &amp;&amp; exists $self-&gt;{$key};

	

    $key = qr/$key/ unless $is_re;



    /$key/ and return $self-&gt;{$_} for keys %$self;

	

    return;



  }</pre>







<p>Knowing what we know about tied objects, this is pretty simple to follow.



We start by getting the reference to the tied object (which will be a hash



reference) and the required key. We then check to see whether the



key is a reference to a precompiled regular expression (which would have



been compiled with <code>qr//</code>. If the key <em>isn't</em> a regex, then we start



by checking whether the key exists in the hash. If it does, we return the



associated value. If the key isn't found, then we assume that it is a



regex to search for. At this point we compile the regex as if it isn't



already precompiled (this gives us a preforamnce boost as we could



potentially need to match the regex against all of the keys in the



hash). Finally, we check each key in the hash in turn against the regex



and if it matches, then we return the associated value. If there are no matches



we simply <code>return</code>.</p>



<p>At this point you may realize that it's possible for more than one key to



match a regex and you may suggest that it would be nice for <a href="/pub/a/2001/09/04/tiedhash.html#item_FETCH"><code>FETCH</code></a> to



return <em>all</em> matches as if it was called in scalar context. This is a nice



idea, but in current versions of Perl the syntax <code>$hash{$key}</code> <em>always</em>



calls <a href="/pub/a/2001/09/04/tiedhash.html#item_FETCH"><code>FETCH</code></a> in scalar context (and the syntax <code>@hash{@keys}</code> calls



<a href="/pub/a/2001/09/04/tiedhash.html#item_FETCH"><code>FETCH</code></a> once in scalar context for each element of <code>@keys</code>) so this



won't work. To get round this, you can use the slightly kludgey syntax



<code>@vals = tied(%hash)-</code>FETCH($pattern)&gt; and the version of the module



on CPAN supports this.</p>



<p>The <a href="/pub/a/2001/09/04/tiedhash.html#item_EXISTS"><code>EXISTS</code></a> method uses similar processing, but in this case we



return 1 if the key is found instead of the associated value.</p>



<pre>

  sub EXISTS {

    my $self = shift;

    my $key = shift;

    my $is_re = (ref $key eq 'Regexp');



    return 1 if !$is_re &amp;&amp; exists $self-&gt;{$key};



    $key = qr/$key/ unless $is_re;



    /$key/ &amp;&amp; return 1 for keys %$key;



    return;

  }</pre>



<p>The <a href="/pub/a/2001/09/04/tiedhash.html#item_DELETE"><code>DELETE</code></a> method is somewhat different. In this case, we can delete



<em>all</em> matching key/value pairs, which we do with the following code:</p>



<pre>



  sub DELETE {

    my $self = shift;

    my $key = shift;

    my $is_re = (ref $key eq 'Regexp');



    return delete $self-&gt;{$key} if !$is_re &amp;&amp; exists $self-&gt;{$key};



    $key = qr/$key/ unless $is_re;



    for (keys %$self) {

      if (/$key/) {

        delete $self-&gt;{$_};

      }

    }

  }</pre>



<p>I should point out that there is another similar module on CPAN called



Tie::RegexpHash written by robert Rothenberg. Tie::RegexpHash actually does



the opposite to Tie::Hash::Regex. When you store a value in it, the key is



a regular expression and any time you look up a value with a key, you will



get the value associated with the first regex key that matches your string.



It's interesting to note that Tie::RegexpHash <em>isn't</em> based on Tie::StdHash



and, as a result, contains a lot more code than Tie::Hash::Regex.</p>



<p>Another recent addition to CPAN is Tie::Hash::Approx, which was written



by Briac Pilpr�. This addresses a similar problem, but instead of



using regex matching, it uses Jarkko Hietaniemi's String::Approx module.</p>





<h3><a name="conclusion: tie::hash::cannabinol">Conclusion: Tie::Hash::Cannabinol</a></h3>



<p>As a final example, here's something that isn't quite so useful. This



is a hash that forgets just about everything that you tell it. Its <code>exists</code>



function isn't exactly to be trusted either.</p>



<pre>

    package Tie::Hash::Cannabinol;

    use strict;

    use vars qw(@ISA);

    use Tie::Hash;

	

    $VERSION = '0.01';

    @ISA = qw(Tie::StdHash);



    sub STORE {

      my ($self, $key, $val) = @_;

	  

      return if rand &gt; .75;



      $self-&gt;{$key} = $val;

    }



    sub FETCH {

      my ($self, $key) = @_;



      return if rand &gt; .75;



      return $self-&gt;{rand keys %$self};

    }



    sub EXISTS {

      return rand &gt; .5;

    }</pre>

	
<p>As you can see, it's simple to make some radical alterations



to the behavior of Perl hashes using <code>tie</code> and the Tie::StdHash base



class. As I said at the start of the article, this often enables you to



create new ``objects'' without having to make the leap to full object



orientation in you programs.</p>



<p>And it isn't just hashes that you can do it for. The standard Perl



distribution also comes with packages called Tie::StdArray,



Tie::StdHandle and Tie::StdScalar.</p>



<p>Have fun with them.</p>

















        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1586" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2001/08/p5pdigest/20010903.html" rel="bookmark">This Week on p5p 2001/09/03</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Simon Cozens</span> on <abbr class="published" title="2001-09-03T00:00:00-08:00">September  3, 2001 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            <h3><a name="Notes">Notes</a></h3>

<table width="150" border="0" cellspacing="0" cellpadding="4" align="right">
<tr> 
<td width="150" valign="top" height="4" bgcolor="#6699cc"></td></tr> 
<tr>
<td bgcolor="#efefef">
<p class="headline" align="center">This Week on P5P
</p>
<p class="smalltext">
&#149; <a href="#Testing_testing">Testing, testing</a><br /><br />
&#149; <a href="#Coderef_in_INC">Coderef-in-@INC</a><br /><br />
&#149; <a href="#Default_random_seed">Default random seed</a><br /><br />
&#149; <a href="#local_chdir">local chdir()</a><br /><br />
&#149; <a href="#FileSpec">File::Spec</a><br /><br />
&#149; <a href="#Smoking">Smoking!</a><br /><br />
&#149; <a href="#Various">Various</a>
</td></tr> <tr><td width="150" valign="top" height="4" bgcolor="#6699cc"> </td></tr></table>



</p>



<p>



Please send corrections and additions to perl-thisweek-YYYYMM@simon-cozens.org

where YYYYMM is the current year and month. Changes and additions to the

perl5-porters biographies are particularly welcome.

<h3><a name="Testing_testing">Testing, testing</a></h3>



</p>



<p>



The focus this week has very definitely been on testing, with the great

Michael Schwern providing all sorts of QA advice, tests and patches. He

patched:

<code>t/op/rand.t</code>,

<code>t/op/time.t</code>,

<code>t/op/srand.t</code>,

<code>t/op/local.t</code>,

<code>t/op/concat.t</code>,

<code>t/op/misc.t</code>,

<code>t/run/segfault.t</code>,

<code>pod/perlhack.pod</code>,

<code>t/op/pack.t</code>,

<code>lib/Cwd.pm</code>,

<code>lib/File/Find.pm</code>, and

<code>lib/File/Find/taint.t</code>, in an earnest attempt to deprive himself of $500.

</p>



<p>

He also wrote a

<a href="http://www.pobox.com/~schwern/src/CPAN-Smoke-0.02.tar.gz">CPAN.pm testing module</a>, and passed on tests from Andrew Wilson (thanks, Andrew!) for

<code>CGI::Switch</code>,

<code>CGI::Apache</code> and

<code>CGI::Cookie</code>.

</p>



<p>

Uhm. Wow.

</p>



<p>

Jonathan Stowe wrote a test suite for

<code>Shell.pm</code> (Yes, honest) and Rafael Garcia-Suarez, who seems to have taken

 responsibility for the coderef-in-

<code>@INC</code> feature, wrote some tests for that. Rafael also wins the prize for the

funniest JAPH I've seen in a long time, but I'm going to make you hunt

through the archives to find that. :)

<h3><a name="Coderef_in_INC">Coderef-in-@INC</a></h3>



</p>



<p>



Rafael also sought to make the information in

<code>%INC</code> useful for modules loaded via the coderef-in-

<code>@INC</code>. Now, for instance, you could see entries in

<code>%INC</code> such as

</p>


<pre>
     /loader/0x81095c8/Foo.pm - CODE(0x81095c8)
</pre>



<p>

The address in the &quot;loader&quot; section matches the address of the coderef.

</p>



<p>

Artur complained that the tests would only work on PerlIO, and could be

rewritten to be more general; Rafael knew about this and tried to find a

cleaner solution.

</p>



<p>

Gisle, on the other hand, was more concerned about the nature of what

was going in

<code>%INC</code>:

<blockquote></p>



<p>



What is still missing is to make sure

<code>pp_require()</code> invokes the hook

again when an absolute filename starting with things like

<code>"/loader/0x81095c8/"</code> is used.  Currently this bypass the

<code>@INC</code> search which is quite likely to make the require fail.

</p>



<p>

If you for instance try to serve up the Tk modules via a hook like

this you will discover that it has a special AUTOLOAD function that

construct absolute file names based on the

<code>%INC</code> value.  It will then

load its .al files like this:

</p>

<pre>
    require '/loader/0x81095c8/auto/Tk/Frame/scrollbars.al';
</blockquote></pre>



<p>

Rafael said that

<code>AutoLoader</code> falls back to a relative path if it has problems, and also discussed

the possibility of having

<code>DynaLoader</code> serve up binaries via a

<code>@INC</code> hook. (Blugh.)

</p>



<p>

Nick Clark, who's one of the evil minds behind this whole thing, wanted

something less plausible than

<code>/loader/whatever</code> which could conceivably be a path if someone's really out to get us,

and so Rafael counter-proposed

<code>&(0x...)</code>. Nick also expressed suitable disgust at the

getting-binaries-from-a-coderef idea.

<h3><a name="Default_random_seed">Default random seed</a></h3>




<p>



Michael Schwern (Yes, him again) noticed that in certain circumstances,

calling

<code>srand</code> twice with no argument can produce the same set of random numbers. He

asked for more pseudo-random data that we can use to perturb the seed of

<code>srand</code> on machines that don't have

<code>/dev/urandom</code>. Merijn suggested

<code>times</code>, but Jarkko said that the usual granularity for that was only a jiffy,

which might not be enough. Jarkko and Mike Guy both pointed out that

running

<code>srand</code> twice was generally speaking a Don't Do That, Then error. Mike Guy's

 comments on

<code>srand</code> bear repeating:

<blockquote></p>



<p>

You shouldn't ever use srand() (i.e. without argument) more

than once in a script.   The internal state of the RNG should contain

more entropy than can be provided by any seed, so calling srand() again

actually *loses* randomness.   And you shouldn't use srand() at all

unless you need backward compatibility with *very* old Perls.

</p>



<p>

Of course, srand($x) with an explicit argument is a quite different

kettle of fish.    But you should only be doing that if you know

what you are doing ...

</blockquote></p>



<p>

Jarkko pointed out that

</p>



</p><pre>
    srand(31337);
    @first_run  = mk_rand;

    srand(1138);
    @second_run = mk_rand;
</pre>



<p>

might fail if we have really, really, really bad luck. But with 100

numbers in each array, it would have to be cosmically significantly

bad luck. And Mike Guy pointed out that if we do get the same sequence

back, then our

<code>rand</code> isn't sufficiently random and this could be considered a bug.

<h3><a name="local_chdir">local chdir()</a></h3>




<p>



Michael Schwern (Yes, him again) expressed his deep-seated longing for

</p>

<pre>
    local chdir($foo);
</pre>



<p>

which changed directory back once the scope is over. Kurt Starsinic said

that we wouldn't always be able to go back, and so you might as well

<code>fork</code> if that's what you want. (Amazingly, Artur didn't suggest using

threads.) Jeremy Zawodny got really excited by the idea, and suggested

being able to

<code>local</code> an entire block of code and have the effects rolled back at the end of

the scope. Yeah, right. However, he did suggest writing a little

<code>pushdir/popdir</code> module, which was a little more sensible than hacking core for fun and

profit. Schwern wrote something using Abigail's

<code>DESTROY</code> trick, and Abigail showed a nicer variant by using a tied scalar which

changed directory when you assigned to it.

</p>



<p>

Abhijit Menon-Sen got in a particularly silly mood and actually

implemented

<code>local chdir($foo)</code> (with a bit of help from you're truly, who's always in a particularly

silly mood) which caused Schwern to ask for more, more, more...

<code>select</code>,

<code>umask</code>,

<code>chmod</code> and so on were now on the table. Sarathy expressed some dismay at the

waste of precious

<code>op_private</code> bits, as well as the &quot;semantic complexity&quot; of the idea itself. Abhijit

himself summed up the opinions of several of us:

<blockquote></p>



<p>

I'm not convinced that we should allow localizing actions (as opposed to

values), and adding destructors piecemeal for random ops would make me

very uncomfortable.

</p>



<p>

That said, I wouldn't object to a module which -- with suitable hooks in

the core -- allowed arbitrary leave_scope() actions to be registered. I

might even write it sometime.

</blockquote></p>



<p>

That'd be worth seeing.

<h3><a name="FileSpec">File::Spec</a></h3>




<p>



Michael Schwern - oh no, it was Chris Nandor - had a problem with

<code>File::Spec</code>:

<blockquote></p>



<p>

In Mac OS, you can tell it to be relative by making the first argument a

leading empty string.  So

<code>catfile("a", "b")</code> is absolute, while

<code>catfile("", "a", "b")</code> is relative.  In Unix/Windows, it is exactly the opposite: the

default is relative, but adding a leading empty string makes it

absolute!

</blockquote></p>



<p>

As Chris rightly pointed out, &quot;Yikes!&quot; If

<code>File::Spec</code> is supposed to make things more portable, we have a problem. Chris

suggested making relative paths the default and breaking MacPerl in the

interests of sanity. Barrie Slaymaker, who owns

<code>File::Spec</code> said that he'd be willing to accept patches if he thought the MacPerl

community could cope with the breakage. Peter Prymmer said that the

required change on VMS probably wouldn't break that much and he was more

interested in making the API cross-platform. Tim Jenness asked whether

or not

<code>catdir</code> ought to support volumes, such as on DOS or VMS. Phillip Newton  reminded us that there is a difference between

<code>A:b\c</code> and

<code>A:\b\c</code>, and that he expected

<code>catdir('a:', 'b', 'c')</code> to do the former rather than the latter. Yup, each drive has its own

 idea of the current working directory.

</p>



<p>

Anyway, it looks like the consensus was that Chris's suggestion will be

adopted once Barrie gets Mac and VMS patches,

<code>File::Spec</code> will be truly portable again, and all the world will rejoice.

<h3><a name="Smoking">Smoking!</a></h3>


<p>



The daily build project is great! Quite a few interesting bug reports

have come out of the fact that we have Perl being tested almost

continuously now on different platforms and architectures with all

manner of different build options. I started smoke testing my desktop

this week and confirmed some bugs that other people were seeing on AIX

and FreeBSD, probably saving Merijn from a lot of unpleasant AIX

and pains. If you want to get involved and donate some of your

processing power, subscribe to the

<a href="mailto:daily-build-subscribe@cpan.org">daily-build</a> mailing list.

</p>



<p>

Paul Marquess found a potential

<code>DB_File</code> bug with the help of Merijn's smoke results, and Artur got to track

 down a bizarre segfault in the

<code>File::Taint</code> tests. Will Coleda broke Cygwin, but Gerrit Hasse thinks that was his

 own fault. Nick Clark found a bug in

<code>MANIFEST</code> of all places, but this was explained as being a bad time to resync.

<h3><a name="Various">Various</a></h3>


<p>



Ed Peschko asked why we don't have

<code>$SIG{__EXIT__}</code> and was told by various people to use an

<code>END</code> block.

</p>



<p>

Paul Johnson produced the useful but perhaps dangerous

<code>coretest</code> make target, which only runs a subset of the testing suite, allowing

you to dash off your latest patch without completely testing you

haven't broken anything subtle. (I know, because I did it last week.)

</p>



<p>

Nicholas Clark silently went on making more and more of Perl able to

preserve

<code>IV</code>s where possible. Nobody cared. He also found lots and lots of

interesting bugs.

</p>



<p>

Artur, pumpkinging madly, found a lovely bug in HP-UX which we can

probably blame on gcc:

<code>inet_ntoa</code> always returns 0.0.0.0. This is obviously not useful. He also found a

bug in the tests of

<code>Time::Hires</code> where every so often the test fails due to rounding error between the

ordinary integer version of

<code>time</code> and the floating-point hi-res version.

</p>



<p>

Yusuf Goolamabbas asked whether something (lack of support for large

files) was a Perl problem or a RedHat packaging problem. Two people

took the opportunity to pass the buck. Amusingly, Chip Turner from

RedHat turned up to pass it back:

<blockquote></p>



<p>

I believe Large files are supported only with 2.4 kernels and certain

glibcs.  Which basically means for proper large file support, you will

need Red Hat 7.1.  Even then, some utilities don't work, Perl being

one.

</blockquote></p>



<p>

Ouch.

</p>



<p>

Daniel Lewart picked up a few miscellaneous bugs in

<code>Time::Local</code>, and Rafael fixed up the example of an array shuffle in

<code>perlfaq4</code> to be less confusing to the learner. (It used the same variable name for

an array and an array reference!)

</p>



<p>

Jarkko is now back, and rapidly catching up on his P5P backlog, so it's

time for me to go and generate some more for him, and

until next week I remain, your humble and obedient servant,

</p>



<hr>



<a href="mailto:simon.co.uk">Simon Cozens</a>










        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1604" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2001/09/p6pdigest/20010901.html" rel="bookmark">This Week on Perl 6 (26 August - 1 September 2001)</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Bryan Warnock</span> on <abbr class="published" title="2001-09-01T00:00:00-08:00">September  1, 2001 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            
      <h3><a name="Notes">Notes</a></h3>
	  
<table width="150" border="0" cellspacing="0" cellpadding="4" align="right">
<tr> 
<td width="150" valign="top" height="4" bgcolor="#6699cc"></td></tr> 
<tr>
<td bgcolor="#efefef">
<p class="headline" align="center">This Week in Perl 6 News
</p>
<p class="smalltext">
&#149; <a href="#Notes">Notes</a><br /><br />
&#149; <a href="#Expunge_Implicit___Passing">Expunge Implicit <code>@_</code> Passing</a><br /><br />
&#149; <a href="#Finalization_and_Deterministic_Destruction">Finalization and Deterministic Destruction</a><br /><br />
&#149; <a href="#Multiple_Dispatch_on_Objects">Multiple Dispatch on Objects</a><br /><br />
&#149; <a href="#Program_Metadata">Program Metadata</a><br /><br />
&#149; <a href="#_versus_"><code>!<</code> versus <code>>=</code></a><br /><br />
&#149; <a href="#Parroty_Bits">Parroty Bits</a><br /><br />
&#149; <a href="#Last_Words">Last Words</a><br /><br />
</td></tr> <tr><td width="150" valign="top" height="4" bgcolor="#6699cc"> </td></tr></table>

<p>

You can subscribe to an email version of this summary by sending an empty
message to 
<a href="mailto:perl6-digest-subscribe@netthink.co.uk">perl6-digest-subscribe@netthink.co.uk</a>.
</p>

<p>
Please send corrections and additions to 
<a href="mailto:bwarnock@capita.com">bwarnock@capita.com</a>.
</p>

<p>
The Perl 6 lists saw a little more traffic during this week: 137 messages
across 19 threads, with 40 authors contributing.

<h3><a name="Expunge_Implicit___Passing">Expunge Implicit <code>@_</code> Passing</a></h3>

<p>

(22 posts) This topic from 
<a href="/pub/a/2001/08/p6pdigest/20010818.html#Perl_6_Language">two weeks ago</a> came up again, as Ken Fox
<a href="http://archive.develooper.com/perl6-language@perl.org/msg08070.html">mentioned</a> its use in redirectors.  Michael Schwern suggested using 
<code>goto &code</code> instead, and provided this final justification:
<blockquote></p>

<p>
Why not just $method-&gt;(@_); or &amp;{$method}(@_); or goto $method?
</p>

<p>
Any time you want to implicitly pass @_, you can just as easily
*explicitly* pass it or use goto.  As we're not doing pass-throughs
all over the place, it's not the sort of thing you want implicit, as
opposed to, say $_.
</blockquote></p>

<p>
(This thread then
<a href="http://archive.develooper.com/perl6-language@perl.org/msg08082.html">devolved</a> into a general debate on the usefulness of Java final classes.)
<h3><a name="Finalization_and_Deterministic_Destruction">Finalization and Deterministic Destruction</a></h3>



<p>

(11 posts) Hong Zhang, however, did
<a href="http://archive.develooper.com/perl6-language@perl.org/msg08089.html">branch off</a> and talk about the differentiation between finalization and 
destruction.  There were then quite a few posts lamenting the
demise of deterministic destruction with the move away from ref counting 
towards a more complex garbage collection scheme.
</p>

<p>
Dan Sugalski
<a href="http://archive.develooper.com/perl6-language@perl.org/msg08106.html">pointed out</a>:
<blockquote></p>

<p>
GC has nothing to do with finalization. Many people want it to, and seem
to conflate the two, but they're separate. Dead object detection and
cleanup doesn't have to be tied to memory GC. It won't be in perl 6. The
perl 6 engine will guarantee whatever cleanup/finalization order and
timliness that Larry puts into the language definition. That's not a
problem.
</blockquote><h3><a name="Multiple_Dispatch_on_Objects">Multiple Dispatch on Objects</a></h3>

</p>

<p>

(11 posts) The first of two threads on multiple dispatch started
<a href="http://archive.develooper.com/perl6-language@perl.org/msg08110.html">here</a>, with two examples 
<a href="http://archive.develooper.com/perl6-language@perl.org/msg08113.html">here</a> and
<a href="http://archive.develooper.com/perl6-language@perl.org/msg08114.html">here</a>.
</p>

<p>
There was talk about whether it was an OO technique, how it should work with
the dynamicness of Perl, and what the best, most efficient manner of
implementing multimethod dispatch is.  In the end, Perl will support 
some form of pluggable multimethod dispatcher, although that was about all
that was agreed upon.
</p>

<p>
(10 posts) The 
<a href="http://archive.develooper.com/perl6-language@perl.org/msg08127.html">second thread</a> decoupled multiple dispatch from objects, creating what it essentially
subroutine overloading (by signature).
<h3><a name="Program_Metadata">Program Metadata</a></h3>

</p>

<p>

(15 posts) I 
<a href="http://archive.develooper.com/perl6-language@perl.org/msg08129.html">mentioned </a> a few pieces of metadata that I would like access to
from within a Perl 6 program.  The bulk of the thread was about how to
<a href="http://archive.develooper.com/perl6-language@perl.org/msg08132.html">access</a> the source of a script from within a script in Perl 5.
<h3><a name="_versus_"><code>!<</code> versus <code>>=</code></a></h3>

</p>

<p>

(7 posts) Raptor
<a href="http://archive.develooper.com/perl6-language@perl.org/msg08151.html">suggested</a> adding 
<code>!></code> and
<code>!<</code> to the logical operators as Another Way To Do It.  Reactions were mixed,
but no technical reason was given why it couldn't be.  (It should be noted 
that in tri-state logic, where he saw this, 
<code>!<</code> is not the same as
<code>>=</code>.)
<h3><a name="Parroty_Bits">Parroty Bits</a></h3>


<p>

Simon Cozens and Dan Sugalski are finishing up the seed code for the 
Parrot interpreter base.  
</p>

<p>
Dan:
<blockquote></p>

<p>
The broad design of the Parrot internals is sufficiently complete to start
implementing parts, and we are. We've the first cut core of an interpreter
and, while I figure we'll probably rewrite the thing at least once before
final release, it runs. You can now write code in Parrot assembler,
assemble it, and run the results.
</p>

<p>
Most of the defined opcodes don't have corresponding code for them, so
it's limited at the moment to integer and float operations with some
control flow (branch, jump, and if) but more will be on the way soon.
</blockquote></p>

<p>
Simon:
<blockquote></p>

<p>
I've been sitting down and writing bits of Perl 6 (I'm working primarily 
on the string functions at the moment, because I can do that without 
getting in Dan's hair too much) and also collecting our thoughts on the 
interpreter into documents that will specify the API and as much of the 
Grand Design as people need to know to be able to start helping.
</blockquote></p>

<p>
The next phase of Parrot will be a code review - for the Perl internals 
community to poke and prod and make sense of what Dan and Simon have done.
The community will provide feedback, and Dan and Simon will disappear for 
a brief period, before the code is opened up for development.
</p>

<p>
After going public, work will mostly progress according to Dan's To Do list.
<h3><a name="Last_Words">Last Words</a></h3>


<p>

The last I heard, the next pair of stone tablets from Larry Wall and Damian
Conway are coming down the mountain.  That's my story, and I'm sticking to
it.
</p>

<hr>

<a href="mailto:bwarnock@capita.com">Bryan C. Warnock</a>


        </div>



    </div>
    <div class="asset-footer"></div>
</div>




                            <div class="content-nav">
                                <a href="/pub/2001/08/">&laquo; August 2001</a> |
                                <a href="/pub/">Main Index</a> |
                                <a href="/pub/archives.html">Archives</a>
                                | <a href="/pub/2001/10/">October 2001 &raquo;</a>
                            </div>


                        </div>
                    </div>


                    <div id="beta">
    <div id="beta-inner">


    
    <div class="widget-what-is-perl widget">
    <div class="widget-content widget-content-what-is-perl">
       Visit the home of the  Perl programming language: <a href="http://www.perl.org/">Perl.org</a
    </div>
</div>
<div class="widget-find-out-more widget-archives widget">
    <div class="widget-content">
        <ul>
            <li><a href="http://www.perl.org/get.html">Download</a></li>
            <li><a href="http://perldoc.perl.org/">Documentation</a></li>
            <li><a href="http://blogs.perl.org/">Perl Bloggers</a></li>
            <li><a href="http://news.perlfoundation.org/">Foundation News</a></li>
        </ul>
    </div>
</div><div class="widget-tcpc widget">
<h3 class="widget-header">Sponsored by</h3>
    <div class="widget-content">
        <a href="http://training.perl.com/" alt="Perl Training" target="_blank"><img src="/i/tcpc.png" width="150" height="50"></a>
    </div>
</div>

<div class="widget-syndication widget">
    <div class="widget-content">
        <ul>
            <li><img src="/mt-static/images/status_icons/feed.gif" alt="Subscribe to feed" width="9" height="9" /> <a href="/pub/atom.xml">Subscribe to this website's feed</a></li>

        </ul>
    </div>
</div>
<div class="widget-archive-monthly widget-archive widget">
    <h3 class="widget-header">Monthly <a href="/pub/archives.html">Archives</a></h3>
    <div class="widget-content">
        <ul>
        
            <li><a href="/pub/2014/02/">February 2014 (1)</a></li>
        
    
        
            <li><a href="/pub/2014/01/">January 2014 (1)</a></li>
        
    
        
            <li><a href="/pub/2013/10/">October 2013 (1)</a></li>
        
    
        
            <li><a href="/pub/2013/01/">January 2013 (1)</a></li>
        
    
        
            <li><a href="/pub/2012/12/">December 2012 (1)</a></li>
        
    
        
            <li><a href="/pub/2012/11/">November 2012 (1)</a></li>
        
    
        
            <li><a href="/pub/2012/10/">October 2012 (2)</a></li>
        
    
        
            <li><a href="/pub/2012/08/">August 2012 (2)</a></li>
        
    
        
            <li><a href="/pub/2012/06/">June 2012 (11)</a></li>
        
    
        
            <li><a href="/pub/2012/05/">May 2012 (18)</a></li>
        
    
        
            <li><a href="/pub/2012/04/">April 2012 (17)</a></li>
        
    
        
            <li><a href="/pub/2012/02/">February 2012 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/12/">December 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/09/">September 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/08/">August 2011 (2)</a></li>
        
    
        
            <li><a href="/pub/2011/06/">June 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/05/">May 2011 (3)</a></li>
        
    
        
            <li><a href="/pub/2011/04/">April 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/03/">March 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/02/">February 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/01/">January 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2010/11/">November 2010 (1)</a></li>
        
    
        
            <li><a href="/pub/2010/10/">October 2010 (2)</a></li>
        
    
        
            <li><a href="/pub/2010/09/">September 2010 (1)</a></li>
        
    
        
            <li><a href="/pub/2010/08/">August 2010 (3)</a></li>
        
    
        
            <li><a href="/pub/2010/07/">July 2010 (2)</a></li>
        
    
        
            <li><a href="/pub/2010/04/">April 2010 (2)</a></li>
        
    
        
            <li><a href="/pub/2010/03/">March 2010 (4)</a></li>
        
    
        
            <li><a href="/pub/2008/05/">May 2008 (1)</a></li>
        
    
        
            <li><a href="/pub/2008/04/">April 2008 (2)</a></li>
        
    
        
            <li><a href="/pub/2008/03/">March 2008 (1)</a></li>
        
    
        
            <li><a href="/pub/2008/02/">February 2008 (1)</a></li>
        
    
        
            <li><a href="/pub/2008/01/">January 2008 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/12/">December 2007 (2)</a></li>
        
    
        
            <li><a href="/pub/2007/09/">September 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/08/">August 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/07/">July 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/06/">June 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/05/">May 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/04/">April 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/03/">March 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/02/">February 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/01/">January 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/12/">December 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/11/">November 2006 (2)</a></li>
        
    
        
            <li><a href="/pub/2006/10/">October 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/09/">September 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/08/">August 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/07/">July 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/06/">June 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/05/">May 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/04/">April 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/03/">March 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/02/">February 2006 (4)</a></li>
        
    
        
            <li><a href="/pub/2006/01/">January 2006 (4)</a></li>
        
    
        
            <li><a href="/pub/2005/12/">December 2005 (4)</a></li>
        
    
        
            <li><a href="/pub/2005/11/">November 2005 (3)</a></li>
        
    
        
            <li><a href="/pub/2005/10/">October 2005 (2)</a></li>
        
    
        
            <li><a href="/pub/2005/09/">September 2005 (2)</a></li>
        
    
        
            <li><a href="/pub/2005/08/">August 2005 (9)</a></li>
        
    
        
            <li><a href="/pub/2005/07/">July 2005 (8)</a></li>
        
    
        
            <li><a href="/pub/2005/06/">June 2005 (9)</a></li>
        
    
        
            <li><a href="/pub/2005/05/">May 2005 (8)</a></li>
        
    
        
            <li><a href="/pub/2005/04/">April 2005 (7)</a></li>
        
    
        
            <li><a href="/pub/2005/03/">March 2005 (6)</a></li>
        
    
        
            <li><a href="/pub/2005/02/">February 2005 (7)</a></li>
        
    
        
            <li><a href="/pub/2005/01/">January 2005 (6)</a></li>
        
    
        
            <li><a href="/pub/2004/12/">December 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/11/">November 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/10/">October 2004 (5)</a></li>
        
    
        
            <li><a href="/pub/2004/09/">September 2004 (9)</a></li>
        
    
        
            <li><a href="/pub/2004/08/">August 2004 (6)</a></li>
        
    
        
            <li><a href="/pub/2004/07/">July 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/06/">June 2004 (6)</a></li>
        
    
        
            <li><a href="/pub/2004/05/">May 2004 (7)</a></li>
        
    
        
            <li><a href="/pub/2004/04/">April 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/03/">March 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/02/">February 2004 (9)</a></li>
        
    
        
            <li><a href="/pub/2004/01/">January 2004 (7)</a></li>
        
    
        
            <li><a href="/pub/2003/12/">December 2003 (4)</a></li>
        
    
        
            <li><a href="/pub/2003/11/">November 2003 (7)</a></li>
        
    
        
            <li><a href="/pub/2003/10/">October 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2003/09/">September 2003 (6)</a></li>
        
    
        
            <li><a href="/pub/2003/08/">August 2003 (7)</a></li>
        
    
        
            <li><a href="/pub/2003/07/">July 2003 (9)</a></li>
        
    
        
            <li><a href="/pub/2003/06/">June 2003 (9)</a></li>
        
    
        
            <li><a href="/pub/2003/05/">May 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2003/04/">April 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2003/03/">March 2003 (10)</a></li>
        
    
        
            <li><a href="/pub/2003/02/">February 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2003/01/">January 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2002/12/">December 2002 (5)</a></li>
        
    
        
            <li><a href="/pub/2002/11/">November 2002 (9)</a></li>
        
    
        
            <li><a href="/pub/2002/10/">October 2002 (7)</a></li>
        
    
        
            <li><a href="/pub/2002/09/">September 2002 (11)</a></li>
        
    
        
            <li><a href="/pub/2002/08/">August 2002 (8)</a></li>
        
    
        
            <li><a href="/pub/2002/07/">July 2002 (8)</a></li>
        
    
        
            <li><a href="/pub/2002/06/">June 2002 (4)</a></li>
        
    
        
            <li><a href="/pub/2002/05/">May 2002 (6)</a></li>
        
    
        
            <li><a href="/pub/2002/04/">April 2002 (6)</a></li>
        
    
        
            <li><a href="/pub/2002/03/">March 2002 (7)</a></li>
        
    
        
            <li><a href="/pub/2002/02/">February 2002 (5)</a></li>
        
    
        
            <li><a href="/pub/2002/01/">January 2002 (8)</a></li>
        
    
        
            <li><a href="/pub/2001/12/">December 2001 (7)</a></li>
        
    
        
            <li><a href="/pub/2001/11/">November 2001 (5)</a></li>
        
    
        
            <li><a href="/pub/2001/10/">October 2001 (9)</a></li>
        
    
        
            <li><a href="/pub/2001/09/">September 2001 (7)</a></li>
        
    
        
            <li><a href="/pub/2001/08/">August 2001 (13)</a></li>
        
    
        
            <li><a href="/pub/2001/07/">July 2001 (8)</a></li>
        
    
        
            <li><a href="/pub/2001/06/">June 2001 (13)</a></li>
        
    
        
            <li><a href="/pub/2001/05/">May 2001 (11)</a></li>
        
    
        
            <li><a href="/pub/2001/04/">April 2001 (9)</a></li>
        
    
        
            <li><a href="/pub/2001/03/">March 2001 (8)</a></li>
        
    
        
            <li><a href="/pub/2001/02/">February 2001 (8)</a></li>
        
    
        
            <li><a href="/pub/2001/01/">January 2001 (8)</a></li>
        
    
        
            <li><a href="/pub/2000/12/">December 2000 (6)</a></li>
        
    
        
            <li><a href="/pub/2000/11/">November 2000 (10)</a></li>
        
    
        
            <li><a href="/pub/2000/10/">October 2000 (10)</a></li>
        
    
        
            <li><a href="/pub/2000/09/">September 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/2000/08/">August 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/2000/07/">July 2000 (5)</a></li>
        
    
        
            <li><a href="/pub/2000/06/">June 2000 (7)</a></li>
        
    
        
            <li><a href="/pub/2000/05/">May 2000 (7)</a></li>
        
    
        
            <li><a href="/pub/2000/04/">April 2000 (3)</a></li>
        
    
        
            <li><a href="/pub/2000/03/">March 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/2000/02/">February 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/2000/01/">January 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/1999/12/">December 1999 (6)</a></li>
        
    
        
            <li><a href="/pub/1999/11/">November 1999 (6)</a></li>
        
    
        
            <li><a href="/pub/1999/10/">October 1999 (5)</a></li>
        
    
        
            <li><a href="/pub/1999/09/">September 1999 (4)</a></li>
        
    
        
            <li><a href="/pub/1999/08/">August 1999 (3)</a></li>
        
    
        
            <li><a href="/pub/1999/07/">July 1999 (2)</a></li>
        
    
        
            <li><a href="/pub/1999/06/">June 1999 (3)</a></li>
        
    
        
            <li><a href="/pub/1999/04/">April 1999 (1)</a></li>
        
    
        
            <li><a href="/pub/1999/03/">March 1999 (1)</a></li>
        
    
        
            <li><a href="/pub/1999/01/">January 1999 (1)</a></li>
        
    
        
            <li><a href="/pub/1998/12/">December 1998 (1)</a></li>
        
    
        
            <li><a href="/pub/1998/11/">November 1998 (1)</a></li>
        
    
        
            <li><a href="/pub/1998/07/">July 1998 (2)</a></li>
        
    
        
            <li><a href="/pub/1998/06/">June 1998 (1)</a></li>
        
    
        
            <li><a href="/pub/1998/03/">March 1998 (1)</a></li>
        
        </ul>
    </div>
</div>
        
    

<div class="widget-powered widget">
    <div class="widget-content">
        <a href="http://www.movabletype.com/"><img src="/mt-static/images/bug-pbmt-white.png" alt="Powered by Movable Type 5.13-en" width="120" height="75" /></a>
    </div>
</div>



    </div>
</div>






                </div>
            </div>


            <div id="footer">
    <div id="footer-inner">
        <div id="footer-content">
            <div class="widget-powered widget">
                <div class="widget-content">
                    Powered by <a href="http://www.movabletype.com/" rel="generator">Movable Type Pro</a>
                </div>
            </div>

            <div class="widget-creative-commons widget">
                <div class="widget-content">
                    This blog is licensed under a <a href="http://creativecommons.org/licenses/by-nc-nd/3.0/">Creative Commons License</a>.
                </div>
            </div>

        </div>
    </div>
</div>



        </div>
    </div>
</body>
</html>
