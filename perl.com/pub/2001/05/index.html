<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" id="sixapart-standard">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="generator" content="Movable Type Pro 5.13-en" />
<link rel="stylesheet" href="/pub/styles.css" type="text/css" />
<link rel="start" href="/pub/" title="Home" />
<link rel="alternate" type="application/atom+xml" title="Recent Entries" href="/pub/atom.xml" />
<script type="text/javascript" src="/pub/mt.js"></script>
<!--
<rdf:RDF xmlns="http://web.resource.org/cc/"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
<Work rdf:about="/pub/">
<dc:title>Perl.com</dc:title>
<dc:description>news and views of the Perl programming language</dc:description>
<license rdf:resource="http://creativecommons.org/licenses/by-nc-nd/3.0/" />
</Work>
<License rdf:about="http://creativecommons.org/licenses/by-nc-nd/3.0/">
</License>
</rdf:RDF>
-->

<script type="text/javascript">

 var _gaq = _gaq || [];
 _gaq.push(['_setAccount', 'UA-50555-22']);
 _gaq.push(['_trackPageview']);

 (function() {
   var ga = document.createElement('script'); ga.type =
   'text/javascript'; ga.async = true;
   ga.src = ('https:' == document.location.protocol ? 'https://ssl' :
   'http://www') + '.google-analytics.com/ga.js';
   var s = document.getElementsByTagName('script')[0];
   s.parentNode.insertBefore(ga, s);
 })();

</script>
<script type='text/javascript' src='http://partner.googleadservices.com/gampad/google_service.js'></script>
<script type='text/javascript'>
GS_googleAddAdSenseService("ca-pub-4136420132070439");
GS_googleEnableAllServices();
</script>
<script type='text/javascript'>
GA_googleAddSlot("ca-pub-4136420132070439", "Perl_728x90");
</script>
<script type='text/javascript'>GA_googleFetchAds();</script>
    <title>Perl.com: May 2001 Archives</title>


    <link rel="prev" href="/pub/2001/04/" title="April 2001" />
    <link rel="next" href="/pub/2001/06/" title="June 2001" />

</head>
<body id="perl-com" class="mt-archive-listing mt-datebased-monthly-archive layout-wt">
    <div id="container">
        <div id="container-inner">


            <div id="header">
    <div id="header-inner">
        <div id="header-content">
        <span id="top_advert"> 
<!-- Put any landscape advert in here -->
<!-- Perl_728x90 -->
<script type='text/javascript'>
GA_googleFillSlot("Perl_728x90");
</script>
        </span> 



            <div id="header-name"><a href="/pub/" accesskey="1">Perl.com</a></div>
            <div id="header-description">news and views of the Perl programming language</div>




        </div>
    </div>
</div>



            <div id="content">
                <div id="content-inner">


                    <div id="alpha">
                        <div id="alpha-inner">


                            <h1 id="page-title" class="archive-title">May 2001 Archives</h1>





                            
                            <div id="entry-1504" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2001/05/29/tides.html" rel="bookmark">Turning the Tides on Perl's Attitude Toward Beginners</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Casey West</span> on <abbr class="published" title="2001-05-28T00:00:00-08:00">May 28, 2001 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            <!-- <a name="Turning_the_Tides_on_Perl_s_Atti">Turning the Tide on Perl's Attitude Toward Beginners</a> -->

<br />

<p>
The Perl community has held tight to a "zero tolerance" policy for
beginners. The transition to a more accepting, responsible community has
begun. The past is behind us and the future looks brighter.</p>


<h3><a name="The_Way_We_Were">The Way We Were</a></h3>
<p>
As far back as I can remember, asking a question that has been answered
before is one of the many deadly sins of the Perl community. The general
attitude revolved around, "If the docs are good enough for me, they're good
enough for you. RTFM." One first-time programmer could easily accumulate
10 flames in his inbox after asking a question about why this code didn't
print anything out:

<pre>  my $input    = &lt;STDIN&gt;;
  my $username = chop( $input );
  print &quot;$username&quot;;
</pre>
<p>
After said programmer has been flambe'ed to perfection they have to endure
five more messages concerning the use of <code>chop()</code> and its evils, not to mention a handful of warnings about why putting
double quotes around <code>$username</code> will cause famine in the land. Granted, these last few messages contain
good information, but it's unlikely the
beginner will even read these messages. Why would anyone want to subject
themselves to more abuse when it's easier to delete the messages and move on to another programming language?</p>

<p>
It seems that the very thing we want to have happen, adding number to our
ranks, is the first thing we fight against when beginners show their faces.
Wielding our swords of "RTFM" and shields of "killfile" we smite the
very programmers that will carry this language into the future. I have a
co-worker who is known for saying, "It's a good thing Perl is so powerful
and cool, it barely makes up for the collective, childish 'elitism'
displayed by its community." Collectively, this is a sad truth.</p>

<p>
Many programmers end up turning to alternate languages and communities,
ones that don't require them to carry fire trucks in their back pocket. For
instance, Python has a mailing list designed to be a "Help Desk." It
doesn't get much better than that for a beginner.</p>

<p>
Another path to travel is the pay software route. If I pay Microsoft for
their software, developer resources and customer support, they'll be nice
to me. They won't call me a newbie. They won't prepare the clue stick,
they'll give me all the answers I need. Believe it or not, folks, this is
our competition, too. Forget about a single programmer turned away, this
affects whole companies. A corporation has the wallet to turn away from
Perl if it feels the support is "lacking."</p>

<p>
One would figure that, with Perl's age, the community would have fostered a
powerful, useful medium to ease the newcomer into our world. When a child
is born, it requires extreme amounts of care, attention and guidance for
several years. Most children aren't told to sit in the corner and RTFM
until they get it; that's cruel and unusual punishment. Why then, must we
be any different? We all have the ability to help programmers grow and
mature, to shape their views and opinions. It's time for us to open up and
give back to our trade. All of us have received gentle guidance; we are all
capable of giving some back.</p>

<p>
In short, no good has come of this.</p>

<h3><a name="A_Step_In_the_Right_Direction">A Step in the Right Direction</a></h3>
<p>
Last month, a few folks on the Perl Porters list decided enough was enough.
Casey West set out in search of a new mailing list for Perl beginners. Some
concerns were raised regarding the validity of the list but, overall, there
was acceptance. Out of the blue, Ask Bjoern Hansen came barreling through
the crowd announcing that the list had been created -- three days before. <code>;-)</code></p>



<p>
It was time to find out if the Perl community needed a friendly, fire-free
environment to foster growth and knowledge in the masses. It was time to
find out if there <em>were</em> any masses. It was also time to find out if the Perl community would be
willing to jump in and help. Don't you just love the suspense? On with the
show!</p>


<h3><a name="beginners_perl_org">beginners@perl.org</a></h3>
<p>
It has been one month and statistics speak for themselves. Thirteen hundred messages
were sent last month, sending my mbox to more than 3.5 MB. As far as Perl lists
are concerned, this is near the highest-trafficked list. Of course, the
Python "Help Desk" list generates a solid 4000+ messages a month, with
excellence.</p>

<p>
Under normal circumstances, generating that much beginner traffic would
cause the list to combust, sending fireballs as far as the eye can see. Not
this time. Established folks in the Perl community have made an effort to put the gloves on and play nice. As list baby-sitter, I have only
had to slap a handful of wrists, and the people attached to them have
responded honorably. Nearly all questions have been answered at least once
and every customer seems to be satisfied.</p>

<P>
<H2><A NAME="beginnerscgi@perl.org"><A HREF="mailto:beginners-cgi@perl.org">beginners-cgi@perl.org</A></A></H2>
<P>The <CODE>beginners</CODE> list recently split in two.  The <CODE>beginners-cgi</CODE>
list was created as a means to cut back on the amount of traffic.
Many people were finding it hard to keep up with the flow of just one
list.  This is understandable considering we have over 1000
subscribers to the <CODE>beginners</CODE> list.</P>
<P>
<H2><A NAME="dailytips@perl.org"><A HREF="mailto:daily-tips@perl.org">daily-tips@perl.org</A></A></H2>
<P>Ask and I started the <CODE>daily-tips</CODE> mailing list.  This list will be
sending our daily mailings with simple tips for beginners.  The tips
will cover a wide range of topics, in the form of ``Questions and
Answer''.  We won't be mailing from the standard Perl FAQ, there's
already a list for that.  Instead, we'll be taking submissions from
the community and mailing them (That means you!).  More information on
this list can be found at <A HREF="http://learn.perl.org/">http://learn.perl.org/</A>.</P>
<P>
<H2><A NAME="beginnersworkers@perl.org">beginners-workers</A></H2>
<P>The <CODE>beginners-workers</CODE> mailing list is the place to send your
<CODE>daily-tips</CODE> submissions, as well as your thoughts on how the Perl
community should be helping beginners.  Ask, Adam Turoff, Kevin
Meltzer and I (and others) will be reading this list and responding if
necessary.  The Beginners Team is working hard on this list to get a
number of initiatives rolling.  Thanks to the people mentioned above,
and many other folks for your continued help and support.</P>
<h3><a name="_perl_help">#perl-help</a></h3>
<p>
Another fine member of the Perl community, Kevin Lenzo, followed up the
mailing list announcement with one of his own. He created an IRC channel
named <code>#perl-help</code> on <code>irc.rhizomatic.net</code> and even attached the lovable purl bot to it. Kevin reports moderate and
friendly traffic on this channel.</p>

<p>
This is an exciting move, because it provides real-time results. The ability
to interact with someone in real time makes this a complete win. Believe
me, you won't go away disappointed from this channel: the people there are
fast and fun to work with.</p>


<h3><a name="Code_Review_BOF_at_The_Perl_Conf">Code Review BOF at the Perl Conference</a></h3>
<p>
Peter Scott and I have teamed up to make the second TPC Code Review bigger
and better than ever. A number of the top Perl people have volunteered to
review code, free of charge. The format will be similar to last years BOF.
This is your opportunity to get advice from Perl's best without having to
pay their rates.</p>

<p>
If you are attending this year's TPC and you have some questions about your
code, please stop by. It doesn't matter what your question is, all subjects
are open. We are putting an emphasis on answering beginners' questions but,
please, don't hesitate to bring your latest regex engine patch for review,
we have people who can do that, too.</p>

<h3><a name="Onward_and_Upward">Onward and Upward</a></h3>
<p>
The Perl community has had a taste of success with the beginners list and
IRC channels. We will hopefully solidify our new found stance at the Perl
Conference with the Code Review BOF. So what happens next? Are we finished?
Not by a long shot.</p>

<p>
Ask and I have begun work on <em>http:</em>, a modest site dedicated to helping people learn Perl. At the moment it is
slightly bare, hosting only the beginners list FAQ, which is maintained by
Kevin Meltzer. This is all about to change.</p>

<p>
<em>learn.perl.org</em> will become a beginners documentation project. We are asking for
contributions from the Perl community for tutorials. The topics of these
tutorials may be broad, covering everything from text editors with Perl
syntax highlighting to in-depth research on why one should use <code>while</code> to loop over files. We hope, with time, that <em>learn.perl.org</em> can mature into a central, community-lead documentation project: the Perl
Documentation Project.</p>


<h3><a name="Pioneering_the_Status_Quo_Revolu">Pioneering the Status Quo Revolution</a></h3>
<p>
It has been the general opinion of the open-source community that, if you
can't find the answers yourself, you're lost. Read the documentation, if
there is no documentation, read the source. If there is no source, you've
stepped out of the world as we know it. If you're a greenhorn and you can't
figure it out from the docs or the source, goodbye. And not just goodbye,
but a plague on your house as well.</p>

<p>
This attitude is just not good enough any more. Frankly, it's a terrible
way to behave. Any child can play the "I'm not telling you, figure it out
yourself" game, complete with fingers wiggling from the ears and a stuck
out tongue. It's time for us to collectively grow up. As a community, we
need to mature. We need to get up and help each other.</p>

<p>
I admit, I have been on the giving end of the flamethrower serveral times
in the past. It seemed like a fun idea at first, but it really isn't. After
I sent flames, I felt terrible, often going back to the recipient and asking
forgiveness. That's just what it did to me, I hate to think about how it
made the other guy feel. What kind of impression did I give him about me,
about the Perl community, about open source? What we do in public really
does reach that far: We are responsible for the people we represent, like
it or not. So let's all grow up and represent them well.</p>

<p>
This reaches far beyond the walls of Perl ( no pun... ). I am beginning to
see the awareness all around the open-source community. We are in need of a
change and the challenge is here. The Perl community has begun its journey,
let's be the ones to carry it through the rest of open source, and beyond.</p>


<h3><a name="Closing_Thoughts">Closing Thoughts</a></h3>
<p>
My dream is for a Perl community that stands together with kindess and open
arms. Many may feel this is a goal too lofty for us. I couldn't disagree
more. We have shown the world that we can do just about anything; this
should be easy. I know I'm not the only one who shares this opinion.</p>

<p>
<em>"But, paradoxically, the way in which Perl helps you the most has
almost nothing to do with Perl, and everything to do with the people
who use Perl. Perl folks are, frankly, some of the most helpful folks
on earth. If there's a religious quality to the Perl movement, then
this is at the heart of it. Larry wanted the Perl community to
function like a little bit of heaven, and he seems to have gotten his
wish, so far. Please do your part to keep it that way."</em>
  -- Preface, Programming Perl 2nd Edition
</p>

        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1514" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2001/05/p5pdigest/THISWEEK-20010527.html" rel="bookmark">This Week on p5p 2001/05/27</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Leon Brocard</span> on <abbr class="published" title="2001-05-27T00:00:00-08:00">May 27, 2001 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            <!-- This week on perl5-porters (21 May-27 May 2001) -->

<br />
<br />
      <H3><a name="Notes">Notes</a></H3>

</P>

<P>

You can subscribe to an email version of this summary by sending an
empty message to 
<a href="mailto:perl5-porters-digest-subscribe@netthink.co.uk"><tt>perl5-porters-digest-subscribe@netthink.co.uk</tt>.</a></P>

<P>
Please send corrections and additions to 
<CODE>perl-thisweek-YYYYMM@simon-cozens.org</CODE> where 
<CODE>YYYYMM</CODE> is the current year and month.  Changes and additions to the 
<a href="http://simon-cozens.org/writings/whos-who.html">perl5-porters</a> biographies are particularly welcome.
</P>

<P>
This was a week of many little threads consisting of bug reports and
fixes, with 360 messages.
<H3><a name="Attribute_tieing">Attribute tieing</a></H3>

</P>

<P>

Artur Bergman, while working on the new iThreads threading model, has
reported that variable attributes are not usable for 
<CODE>tie</CODE>ing.
</P>

<P>
Variable attributes are an experimental feature of Perl that are a
means of associating &quot;out of band&quot; information with a variable. The
problem is that, as 
<a href="http://simon-cozens.org/writings/whos-who.html#ING-SIMMONS">Nick Ing-Simmons</a> pointed out, in the current
implementation, the attribute code is called at compile time (this is
also where the 
<CODE>tie</CODE> happens), but that the scope cleanup removes the
&quot;magic&quot; from the variable.
</P>

<P>
Some discussion ensued on the fact that the code was working as
designed, but that the design needed to be expanded slightly, by
removing the restriction that the attribute callbacks were designed to
be called at compile time.
<a href="http://simon-cozens.org/writings/whos-who.html#GURUSAMY">Gurusamy Sarathy</a> provided a possible
solution by adding another hook, and I documented the brokeness.
<H3><a name="When_is_a_bug_a_bug">When is a bug a bug?</a></H3>

</P>

<P>

Michael Stevens and Larry Virden submitted bug reports via the perlbug
interface for a bug which was only present in
perl-current. Perl-current (also known as bleadperl) is the absolute
latest development version of Perl, and (as 
<CODE>perlhack</CODE> mentions, &quot;is usually in a perpetual state of evolution.  You should
expect it to be very buggy&quot;.
<a href="http://simon-cozens.org/writings/whos-who.html#HIETANIEMI">Jarkko</a> mentioned that he didn't think
submitting perlbugs on bleadperl was a good idea:
<blockquote>Also, I don't think submitting perlbugs on rsynced snapshots is a good
plan.  If one is playing with the snapshots, one is playing with the
bleeding edge, and one should directly send a report to p5p, not as a
full perlbug report.
</P>

<P>
The rationale: the perlbug database is already working &quot;too well&quot; :-)
by being too full of bugs that strictly speaking aren't.  I don't want
the database to clutter up with noise from volatile snapshots.
I cannot and will not guarantee that every check-in I make is free
from test failures.  For the announced snapshots I try harder.
</blockquote><a href="http://simon-cozens.org/writings/whos-who.html#NEWTON">Philip Newton</a> reminded us that the point of development releases is to
find and fix bugs. 
<a href="http://simon-cozens.org/writings/whos-who.html#BRAND">Merijn Brand</a> provided a patch to include the
patch snapshot level into perlbug reports. Jarkko releases snapshots
of bleadperl a couple of times a week, the latest being called 10210,
and including the level will help find the bug being reported.
<H3><a name="TestHarness_cleanup">Test::Harness cleanup</a></H3>

</P>

<P>

<a href="http://simon-cozens.org/writings/whos-who.html#ZAKHAREVICH">Ilya Zakharevich</a> provided a patch to clean up output of the test
harness, fixing the alignment of the fields making it easier to read
reports with failures. Michael Schwern disagreed on the patches
necessary, leading to a small tug of war. As Jarkko pointed out &quot;the
suggested patches are not converging&quot;.
<H3><a name="TimeLocal">Time::Local</a></H3>

</P>

<P>

Uros Juvan reported a bug about 
<CODE>Time::Local</CODE> and invalid dates: it would return different dates in that case. For
example, asking for February 30th would return March 2nd without
giving a warning. It contains tests which are a little too primitive,
and a patch was supplied by Stephen Potter.
<H3><a name="Various">Various</a></H3>

</P>

<P>

John Peacock submitted a patch to make sure magic is removed at scope
exit.
<a href="http://simon-cozens.org/writings/whos-who.html#GUY">Mike Guy </a> supplied a patch to support qualified variables in &quot;use
vars&quot;, somewhat controversially (a similar patch for
<CODE>our</CODE> by Mark-Jason Dominus last year was rejected). He also supplied a
patch to remove the long deprecated uppercase aliases for the string
comparison operators EQ, NE, LT, LE, GE, GT etc. This led to the most
amusing idea of the week: Jarkko suggested testing the Perl parser
with some some Markov chain (n-characters) generated Perl-like
gibberish: &quot;That way we get a lot of data that constantly begins to
look like valid Perl but then switches back to not being Perl&quot;. No-one
provided such a Markov chain, unfortunately.
</P>

<P>
Michael Schwern submitted some more minor patches, including trying to
get Perl to compile cleanly under
<CODE>-Wall</CODE>.
</P>

<P>
Hugo proposed removing 
[$*] (
<CODE>PL_multiline</CODE>), which has been deprecated
since at least as far back as 5.003_97.
</P>

<P>
Gisle Aas patched Perl to allow overriding of 
<CODE>require</CODE> to be delayed slightly to increase its usefulness.
</P>

<P>
Colin P McMillen asked if Perl's 
<CODE>sort</CODE> function was intended to be stable, which resulted in a documentation
patch by John P. Linderman stating &quot;Perl does not guarantee that
sort is stable&quot;.
</P>

<P>
Richard Soderberg patched a bug found by Mark-Jason Dominus where
a localized glob loses its value when it is assigned to.
</P>

<P>
There were various other minor patches, but I think most people have
been relaxing in the sun this week. Until next week I remain, your
temporarily-replaced humble and obedient servant,
</P>

<P>
<a href="mailto:leon@iterative-software.com">Leon Brocard</a>
</P>

<hr>


<ul>
  <li><a href="#Notes">Notes</a>
  <li><a href="#Attribute_tieing">Attribute tieing</a>
  <li><a href="#When_is_a_bug_a_bug">When is a bug a bug?</a>
  <li><a href="#TestHarness_cleanup">Test::Harness cleanup</a>
  <li><a href="#TimeLocal">Time::Local</a>
  <li><a href="#Various">Various</a>
</ul>

        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1518" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2001/05/p6pdigest/THISWEEK-20010526.html" rel="bookmark">This Week in Perl 6 (20 May - 26 May 2001)</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Bryan Warnock</span> on <abbr class="published" title="2001-05-26T00:00:00-08:00">May 26, 2001 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            
<!-- This Week in Perl 6 (20 May - 26 May 2001) -->

<br />
<br />
<H3><a name="Notes">Notes</a></H3>

</P>

<P>

You can subscribe to an email version of this summary by sending an empty 
message to
<a href="mailto:perl6-digest-subscribe@netthink.co.uk">perl6-digest-subscribe@netthink.co.uk</a>.
</P>

<P>
Please send corrections and additions to 
<CODE>perl6-thisweek-YYYYMM@simon-cozens.org</CODE>, where 
<CODE>YYYYMM</CODE> is the current year and month.
<H3><a name="Perl_Assembly_Language_Standard">Perl "Assembly Language Standard"</a></H3>

</P>

<P>

A.C. Yardley 
<a href="http://archive.develooper.com/perl6-internals@perl.org/msg02940.html">submitted </a> a proposal for documenting PDDs with the very-low-level operations of the 
 Perl Virtual Machine itself.  (This is a separate idea from the assembly 
language that
<a href="http://archive.develooper.com/perl6-internals@perl.org/msg02946.html">will also be written</a>.)  A.C. will continue to work on it.
<H3><a name="The_Perl_Apprenticeship_Program_Revisted">The "Perl Apprenticeship Program" Revisted</a></H3>

</P>

<P>

A.C. Yardley also
<a href="http://archive.develooper.com/perl6-internals@perl.org/msg02941.html">revisited</a> an 
<a href="http://archive.develooper.com/perl6-meta@perl.org/msg00584.html">old thread</a> about a Perl Apprenticeship Program.  
</P>

<P>
Nat Torkington:
<blockquote>Not to speak for Dan, but there's no code yet to review or learn from.
I'd love to see someone set up a perl *5* apprentice program, and
Mark-Jason Dominus has some ideas on how it might work.  For perl6,
though, we're not yet at a place where I think it makes sense.  Right
now there's so little defined in the way of implementation, that
questions can be asked and answered on the mailing list.
</blockquote></P>

<P>
Simon, however,
<a href="http://archive.develooper.com/perl6-internals@perl.org/msg02943">felt</a> that the group was almost at the point where some coding could start, and
suggested that folks whisk through the 
<CODE>sv.c</CODE>, 
<CODE>av.c</CODE>, and 
<CODE>hv.c</CODE> Perl 5 code (describing scalar, array, and hash functionalities,
respectively) to summarize what actually needs to be implemented.
</P>

<P>
Dave Mitchell and A.C. Yardley accepted the challenge.
<H3><a name="Perl_Virtual_Registers">Perl Virtual Registers</a></H3>

</P>

<P>

Dan Sugalski
<a href="http://archive.develooper.com/perl6-internals@perl.org/msg02948">pushed for</a> a register-based Virtual Machine, vice a stack-based machine, with little
real dissention on that point.  Dan, however, wanted typed and linked
registers, but opinions were mixed on having typed registers, and generally
opposed to having them linked.
</P>

<P>
Uri Guttman and Nick Ing-Simmons then took over the thread to banter about
dealing with the stack/register window that will be necessary with threads
and register overflows.
</P>

<P>
Here's a snippet from 
<a href="http://archive.develooper.com/perl6-internals@perl.org/msg02976.html">Uri's last response</a>:
<blockquote><pre>NI&gt; That makes sense if (and only if) virtual machine registers are real 
NI&gt; machine registers. If virtual machine registers are in memory then 
NI&gt; accessing them &quot;on the stack&quot; is just as efficient (perhaps more so)
NI&gt; than at some other &quot;special&quot; location. And it avoids need for 
NI&gt; memory-to-memory moves to push/pop them when we do &quot;spill&quot;.
</pre></P>

<P>
no, the idea is the VM compiler keeps track of IL register use for the
purpose of code generating N-tuple op codes and their register
arguments. this is a pure IL design thing and has nothing to do with
machine registers. at this level, register windows don't win IMO.
</blockquote></P>

<P>
And a snippet from 
<a href="http://archive.develooper.com/perl6-internals@perl.org/msg02977.html">Nick's</a>:
<blockquote>... My point is that UNLESS machine (real) machine registers are involved 
then all IL &quot;Registers&quot; are in memory. Given that they are in memory they 
should be grouped with and addressed-via-same-base-as other &quot;memory&quot; that 
a sub is accessing. (The sub will be accessing the stack (or its PAD if 
you like), and the op-stream for sure, and possibly a few hot globals.)
</P>

<P>
The IL is going to be CISC-ish - so treat it like an x86 where 
you operate on things where-they-are (e.g. &quot;on the stack&quot;) 
<pre>   add 4,BP[4]
</pre></P>

<P>
rather than RISC where you 
<pre>   ld BP[4],X
   add 4,X
   ST X,BP[4]
</pre></P>

<P>
If &quot;registers&quot; are really memory the extra &quot;moves&quot; of a RISC scheme
are expensive.
</blockquote><H3><a name="Slices">Slices</a></H3>

</P>

<P>

Raul Miller 
<a href="http://archive.develooper.com/perl6-language@perl.org/msg07368.html">threw out</a> some ideas about slice syntax.  There was some minor discussion centered
around whether an array index in the new syntax is in scalar or list
context by default.
</P>

<P>
This led to David Whipp
<a href="http://archive.develooper.com/perl6-language@perl.org/msg07374.html">proposing</a> a new index context, to parallel the other contexts that Perl is aware of.
<H3><a name="Slice_References">Slice References</a></H3>

</P>

<P>

Peter Scott 
<a href="http://archive.develooper.com/perl6-language@perl.org/msg07333.html">bridged</a> a posting from the 
<a href="http://archive.develooper.com/beginners@perl.org/">perl beginners</a> list, asking if it would be possible to allow non-copying slice references
in Perl 6.
</P>

<P>
Damian Conway, of course, said, of course, &quot;Of course&quot;:
<blockquote><pre>@A = (1..10);   # array
sub sliceref
 {my($i,$o,$k)=(0,0,pop);$i+$o-$k-&gt;[$i]?++$o&amp;&amp;splice@_,$i,1:$i++while$i&lt;@_;\@_}
my $ref = sliceref @A, [3..5,9];        # reference to slice
print &quot;@A\n&quot;;
print &quot;@$ref\n&quot;;
$ref-&gt;[1] = 99;
print &quot;@A\n&quot;;
print &quot;@$ref\n&quot;;
</pre></blockquote><H3><a name="Properties_Continued">Properties Continued</a></H3>

</P>

<P>

The head-wrapping continued on the new properties feature of Perl 6. 
Although Damian gave
<a href="http://archive.develooper.com/perl6-language@perl.org/msg07352.html">some encouraging answers</a>, he eventually 
<a href="http://archive.develooper.com/perl6-language@perl.org/msg07354.html">posted</a>:
<blockquote>I have already been discussing this with Larry and have privately sent
him a complete proposal that, I believe, addresses all these issues.
Let's wait and see what he makes of that proposal.
</blockquote><H3><a name="The_Parrot_Squawks">The Parrot Squawks</a></H3>

</P>

<P>

There has long been confusion between Perl (the community), Perl (the
language), and 
<CODE>perl</CODE> (the program).  This is only exacerbated on the inside
with various bits and pieces of Perl's (and 
<CODE>perl</CODE>'s) guts.  Add the
complexity that Perl 6 is promising to add, and you've got a maze of twisty
little passages, all named &quot;Perl.&quot;  
</P>

<P>
Now, a while back, Larry countered a suggestion to use
<CODE>Parrot</CODE> as the project name for Perl 6 with a 
<a href="http://archive.develooper.com/perl6-language@perl.org/msg06846.html">list of codenames</a> for various pieces, but it seems that Dan has been
<a href="http://archive.develooper.com/perl6-internals@perl.org/msg02948.html">slipping it in</a> anyway.  (The name
<CODE>Parrot</CODE>, of course, is from Simon's
<a href="/pub/2001/04/01/parrot.htm">tomfoolery</a> earlier this year.)  So it seems that at least the Perl 6 internals has a new moniker.
</P>

<P>
 Until next week...
</P>

<hr>

      <a href="mailto:bwarnock@capita.com">Bryan C. Warnock</a>

<ul>
  <li><a href="#Notes">Notes</a>
  <li><a href="#Perl_Assembly_Language_Standard">Perl "Assembly Language Standard"</a>
  <li><a href="#The_Perl_Apprenticeship_Program_Revisted">The "Perl Apprenticeship Program" Revisted</a>
  <li><a href="#Perl_Virtual_Registers">Perl Virtual Registers</a>
  <li><a href="#Slices">Slices</a>
  <li><a href="#Slice_References">Slice References</a>
  <li><a href="#Properties_Continued">Properties Continued</a>
  <li><a href="#The_Parrot_Squawks">The Parrot Squawks</a>
</ul>

        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1502" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2001/05/22/trafficlights.html" rel="bookmark">Taking Lessons From Traffic Lights</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Michael Schwern</span> on <abbr class="published" title="2001-05-22T00:00:00-08:00">May 22, 2001 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            <a href="http://conferences.oreilly.com/oscon/"><img src="/images/conf/confchrome.jpg" width="252" height="77" border="0" alt="O'Reilly Open Source Convention" /></a>


<!-- Taking Lessons From Traffic Lights -->

<br />

<p><i>Michael Schwern will be speaking at the <a href="http://conferences.oreilly.com/oscon/">O'Reilly Open Source Convention</a> in San Diego, CA, July 23-27, 2001.</i></p>


<p>Excuse me, I'm going to ramble a bit about traffic lights as they
relate to language design to see whether something interesting falls out.
</p>




<p>I was riding my bike to work today and started thinking about the trouble we
were having with string concatenation in Perl 6 <a href="#1">[1]</a> and how the basic
problem is that we've run out of ASCII characters.  I briefly thought
about Unicode, but it's not nearly well-supported.</p>


<p>Then I stopped at a traffic light (the police in Belfast get annoyed
by bikes blowing through lights, even at 2a.m. on an otherwise empty
road.  And they drive unmarked cars).  Traffic lights convey their
signals through color.  I briefly thought it would be neat to convey
Perl grammar via color, but that can't be done for similar reasons to
Unicode.</p>

<h3>Color Coding vs. Position</h3>

<p>The interesting thing about traffic lights is that the color is just for
clarification.  The real communication is through position.  Stop on
top, caution in middle, go at the bottom (some communities do this a
bit differently, but it's all locally consistent).  This is important,
because a large section of the population is color blind, but even if
you saw a traffic light in black-and-white you could still make out
the signals by their position.</p>


<p>If you ask anyone on the street what "stop" and "go" are on a traffic
light, they'll probably say 'red' and 'green' without even thinking.
But if you asked them to draw a traffic light they'd be sure to put
the red on top and green on bottom.  It's interesting that
although we respond strongly to color cues, we subconsciously remember
the positional cues.  It's especially interesting given that we're
never actually taught "go is on the bottom".</p>


<p>There's a thin analogy to syntax highlighting of code, where the color
is just there to highlight and position conveys the actual meaning.</p>


<p>This idea of having redundant syntax that exists to merely make
something easier to remember is perhaps one we can explore.</p>

<h3>Sequence</h3>

<table width="187" border="0" cellspacing="8" cellpadding="4" align="right">
<tr>
<td width="187" valign="top" bgcolor="#ffffff">
<hr size="2" color="#660000" noshade />
<img src="/images/conf/sidebar-chrome.jpg" alt="O'Reilly Open Source Convention Featured Speaker" width="187" height="73" /></td>
</tr>
<tr>
<td valign="top">
<p class="secondary"><font color="#660000"><b>
<a href="http://conferences.oreillynet.com/cs/os2001/view/e_spkr/324">Michael Schwern</a> will be presenting four sessions at the <a href="http://conferences.oreilly.com/oscon/">O'Reilly Open Source Convention</a> in San Diego, CA, July 23-27, 2001. Rub elbows with Open Source leaders while relaxing on the beautiful Sheraton San Diego Hotel and Marina waterfront. For more information, visit our <a href="http://conferences.oreilly.com/oscon/">conference home page</a>.</b></font></p>
<hr size="2" color="#660000" noshade /></td>
</tr>
</table>


<p>Now, color and position aren't the only tools a traffic light has.
Order is another.  Stop, Go, Caution, Stop, Go, Caution ... that's the
way it goes.  Again, most people know this subconsciously even if
they've never been taught it or ever thought about it.  It's a pattern
that's picked up on and expected.  Go follows Stop.  Caution precedes
Stop.  If a light were to suddenly jump from Go to Stop, drivers
would be momentarily confused and indecisive.</p>


<p>The lesson there is simple: be consistent.</p>


<p>So while order doesn't convey any extra information, its consistency
can be important.  I experienced this when I came to Belfast.  The
lights here go: Stop, Caution, Get Ready, Go where "Get Ready" is
conveyed by a combination of red and yellow.  Very useful (especially
if you drive a stick or have toe-clips on your bike and need a moment
to get ready) but a bit confusing the first few times.</p>


<p>This directly contradicts the above lesson, eschew consistency if it's
going to add a useful feature.  People may be taken back the first few
times, but the utility will shine through in the long run.  This could
be considered a learning curve.</p>

<h3> Combinations </h3>

<p>Which brings us to another tool: combinations.  Although rarely done,
you can squeeze more meaning out a set of lights by combining them.
Just like a three-bit number.  The red-yellow combination is the only one
I can think of, and probably rightly so.  While there's still three
more combinations available, they would rapidly get confusing if used.</p>


<p>Perhaps the lesson is: Just because you can wedge more meaning
in doesn't mean you should.</p>



<p>The final method of communication is flashing.  Flashing red is like a
stop sign.  Flashing yellow, proceed with caution.  I don't think
flashing green is ever used or what it could mean <a href="#2">[2]</a>.  Most flashing
lights are there to draw attention.  Emergency vehicles, gaudy
advertisements, navigation lights.  Flashing signals are deliberately
jarring.  They're also rarely used in combination with the normal
signals.  This is very important.  The normal confusion associated
with a break in the pattern isn't there since the normal pattern is
totally absent.  The meaning of the flashing signals is close to their normal solid meaning, which allows most drivers to
know what they mean without thinking about it.</p>


<p>Flashing signals are also rather rare.  They're used at times when
there's few cars on the road (late at night) or on roads that
carry little traffic.</p>


<p>The lesson there, if you're going to be inconsistent, is make sure you
don't do it in a way that will mix with the normal pattern of things.
Think about how the inconsistent feature will be used and make sure it
will be used in spots that are distanced from normal use.  Also, the
potential uses of the inconsistent feature should be relatively rare.</p>


<p>As an aside, when I was young and on vacation with my family, we visited my uncle in the middle of the Mohave Desert.  He worked
at a borax mine (yep, mining for soap).  Aside from the 40-foot-high
dump trucks, the thing I remember most is the speed-limit signs.  Has
to be 15 years ago and I still remember this.  The speed limit was "12
1/2 MPH."  Why?  Not because you'll get pulled over if you go 13 MPH,
but so you'll take notice.  Consistency can ease understanding, but it
can also encourage complacency.</p>



<p>Back to flashing.  Although it will vary from light to light, a single
light will only use one frequency.  They could use more.  In fact, an
almost infinite amount of information could be conveyed by various
frequencies of flashing.  This technique is in active use today by
most Navies of the world as a method of secure, short-range
ship-to-ship communication.  Powerful signal lamps with shutters are
used to flash Morse code between ships.  More commonly, FM (Frequency
Modulation) radio is essentially just a big flashing traffic light.</p>


<p>Traffic lights chose to use only one frequency.  Why?  Simplicity.
There is flashing and there is not flashing.  That's it.  Easy to
remember, but more importantly, easy (and quick) to recognize.  Very
important when a car is approaching at 65 mph.</p>


<p>There comes a point when you're cutting the syntax too fine.  When the
distinctions between one meaning and another take too much careful
examination to distinguish.  A good example being the string concat
proposals that wanted to use certain whitespace combinations to
distinguish, or special uses of quotes.  Perl 6 must be careful
of this sort of thing as we strive to shove more and more information
into just 95 lights (the set of printable ASCII characters).  There's
a reason the Navy employs highly trained men on those signal lamps.</p>

<h3>Sound as Syntax or Grammar</h3>

<p>Finally, there's sound.  I lived in Pittsburgh for a while near a
school for blind children and a clinic for the blind.  The major
intersections for a few blocks around all had the normal walk-don't-walk pedestrian signals, but these are a bit different.  Rather than
the usual Walk with the green, Don't Walk with the red, it would be
Don't Walk in all directions.  When Walk came on, all lights would go
red and pedestrians could cross in any direction.</p>


<p>This was accompanied by a distinct, very loud "koo-koo" sound to
let the blind know it was time to cross.  Also, there was a speaker at
each corner to give them something to walk toward.</p>


<p>Sound as syntax.  It would be interesting to use sound as grammar,
especially since we already have a grammar to represent sound
(i.e. sheet music).  However, I don't know about you, but I'm not about
to start dragging around a Moog with me to code Perl ... though playing
chords to represent code would be neat.  Imagine the twisted
noises coding a particularly nasty regex might produce.</p>


<p>Rambling along this thread, it has been reported that London.pm recently
attempted to encode DeCSS as an interpretive dance.  Perhaps DeCSS
will surpass the Tarentella as the "Forbidden Dance".</p>


<p>There are also some attempts at translating Perl code to music.  I
think someone hooked Perl code run through the DNA module into
something that generates music from genetic code. But I digress.
</p>

<h3>The Function of Traffic Lights</h3>

<p>Let's think about what traffic lights are used for.  Well, they're
there to control the flow of traffic.  Theoretically, you'd want to
use them to maximize use of the available roads and get the most cars
to their destinations as quickly and efficiently as possible.  You'd
do things like time the lights down a stretch of road so someone going
the speed limit never hit a red light.  You'd want to keep the lights
green as long as possible on the major roads at intersections.  You'll
want sensors to detect when no car is waiting for a red so it can keep
the other side green longer.  By doing this you'll get everyone
coordinated and moving about quickly.</p>


<p>But then traffic lights can be used for the exact opposite.  They can
be used to deliberately slow and minimize traffic, say around a school
or in a shopping district with lots of pedestrians.  Lights will be
deliberately set to prevent drivers from going continuously down a
road, making them stop often and keeping their awareness up (but
perhaps their frustration and gasoline consumption as well).  All
sides of an intersection can be stopped at once to allow pedestrians
to pass safely.  Flashing yellows can be employed to warn of a school
zone.  Lights can be placed at dangerous intersections (or ones where
children are known to be about) even though drivers should be able to
self-regulate.</p>


<p>So the same device and features can be combined and used in different ways to produce contradictory effects.  Perl 6 must
have this nature, as is clearly evident from the wildly differing and
contradictory RFCs presented, often in direct opposition to each
other.  We should design Perl features to be like traffic lights.  The
same feature can be used for different and contradictory effects.  This
will ease the pressure to squeeze more and more grammar out of our
limited syntax possibilities.</p>



<p>Oddly enough, varying the number of traffic lights can effect
efficiency.  By over-regulating you can choke off traffic.  Constant
fiddling with the setups and timings, trying to control each and every
intersection to maximize throughput leads to grid lock, zero
throughput.  The exact opposite of what was intended.</p>


<p>We are in danger of doing just that.  By wanting to correct,
streamline and optimize each bump and snag in Perl we may cross some
imaginary line and have syntactical grid lock where the language design
descends into a morass of continual minor adjustment.  By backing off
we can often find a much more sweeping solution than just putting up
lights on each corner.  A perfect example is Larry's "module"
solution to the Perl 6 vs. Perl 5 interpretation (although it still
needs a few extra lights here and there to make it really work).</p>

<h3>Life without Traffic Lights</h3>

<p>There is an alternative to all this.  I've been working in Ireland for
the past three months, and like most Americans I have met that
peculiar English invention, the roundabout. <a href="#3">[3]</a> Three, four, five,
even six-way intersections are handled seamlessly by this apparently
anarchistic piece of the transportation landscape.  All without any
traffic lights.

<p>First few times, I fearfully creeped across, pushing my bike along as
a pedestrian, too frightened to try and enter the unending flow of
traffic.  After a while, and asking around a bit, the underlying rule
became obvious: yield to traffic in the circle.  With this revelation
I was able to zip through confidently.  I rather like them now and
appreciate how they keep the traffic flowing even for the most
complicated intersections.  The apparent complexity of the details
(lots of cars zipping about, merging and leaving from many points) all
stems from a single rule.</p>


<p>Contrast this with the typical American four-way intersection.  Roads
placed at right angles, traffic lights poised in each direction.  Cars
jerk forward hesitantly and the system rapidly breaks down under heavy
traffic.  Initially easier to learn, anyone can understand a traffic
light, but the devilish complexity of right-of-way and subtleties of
making a proper left turn betray that what seems at first simple,
might actually be clunky in the long run.  And that which seems
complex and frightening will yield its underlying simplicity with time
and experience.</p>


<p>So the lesson there, aside from "roundabouts are neat" is about
learning curves and the wisdom of focusing design on "beginners."
While effort must be made to flatten the learning curve, don't
short-change the ultimate goal just to make it easier initially.
After all, we are only beginners for so long. <a href="#4">[4]</a></p>

<h3>Foot Notes</h3>



<p><a name="1">[1]</a> It has been decided that <code>.</code> will be used instead of <code>-></code> for method
calls in Perl 6.  This leaves the problem of how to concatenate
strings.  Everyone and their dog seemed to have a proposal on the
perl6-language mailing list, all of them a bit contrived as we've run 
out of characters.

<p><a name="2">[2]</a> It has been reported by two sources that there is a flashing green
light outside of Boston that meant "this light will rarely go red."

<p><a name="3">[3]</a> Some may call them "traffic circles."  Most Americans know them
best from "National Lampoon's European Vacation" ("Look kids!  Big
Ben, Parliament!")  They're used in a couple places in the U.S.: Oregon,
Florida, New England.  "<a href="http://www.engr.orst.edu/~taekrtha/round.html
">
Modern Roundabouts</a>"
gives a nice explanation
and visualization from an American point-of-view (i.e. the right side
of the road).

<p><a name="4">[4]</a> Of course, this can get a little out of hand:  "<a href="http://www.swindonweb.com/life/lifemagi0.htm
">Swindon's Magic
Roundabout"</a>

        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1516" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2001/05/p6pdigest/THISWEEK-20010501.html" rel="bookmark">This Month on Perl6 (1 May - 20 May 2001)</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Bryan Warnock</span> on <abbr class="published" title="2001-05-21T00:00:00-08:00">May 21, 2001 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            <!-- This week x 3 on perl6 (1 May - 20 May 2001) -->

<br />

<H3><a name="Notes">Notes</a></H3>

</P>

<P>

You can subscribe to an email version of this summary by sending an empty 
message to
<a href="mailto:perl6-digest-subscribe@netthink.co.uk">perl6-digest-subscribe@netthink.co.uk</a>.
</P>

<P>
Please send corrections and additions to 
<CODE>perl6-thisweek-YYYYMM@simon-cozens.org</CODE>, where 
<CODE>YYYYMM</CODE> is the current year and month.
</P>

<P>
It's been two months since we've seen a Perl 6 Summary, but it's certainly not 
for lack of activity.  Instead, Simon's been very busy, er, being Simon, so 
I'm going to be hacking the summaries for a while.  Since there's been a lot of 
traffic flowing since we last aired, we're going to skip April, and give a 
glossy on what's gone on so far in May.  The weekly summaries should 
resume next week. 
<H3><a name="Perl_6_Internals">Perl 6 Internals</a></H3>

</P>

<P>

All was fairly quiet with the 
<CODE>-internals</CODE> list, so I'm going to dip back into 
the tail end of April for some significant events.  Dan Sugalski pointed 
everyone to an updated preview of the upcoming Garbage Collection PDD.  
Dave Storrs also released a first rough cut on a 
<a href="http://archive.develooper.com/perl6-internals@perl.org/msg02895.html">debugger PDD</a>.  After feedback from Jarkko and Dan on some scope tweaks to the PDD, 
Dave went back to work on it.  Dave Mitchell proposed 
<a href="http://archive.develooper.com/perl6-internals@perl.org/msg02922.html">"PDD: Conventions and Guidelines for Perl Source Code"</a> to try to establish some coding standards for Perl 6.  Reaction was mostly 
silent assent (we presume), except for a peripheral discussion centered 
around where macros fall on the scale from Good to Bad.    
<H3><a name="Perl_6_Meta">Perl 6 Meta</a></H3>

</P>

<P>

It was much louder on the 
<CODE>-meta</CODE> side of the house.  Peter Scott 
<a href="http://archive.develooper.com/perl6-meta@perl.org/msg00802.html">wondered aloud </a> whether Perl 6 was enough of a name change to reflect the apparent differences 
between Perl 5 and the new language.  After some half-digested suggestions on 
version numbers, code names, and even a departure from the Perl name itself, 
Nathan Torkington 
<a href="http://archive.develooper.com/perl6-meta@perl.org/msg00821.html">dropped a teaser </a> for Damian Conway's soon-to-be 
<a href="/pub/2001/05/08/exegesis2.html">Exegesis 2</a>, and Larry 
<a href="http://archive.develooper.com/perl6-meta@perl.org/msg00823.html">expressed </a> that he didn't feel the language was going to look all that different.
</P>

<P>
Adam Turoff later opined:
<blockquote></P>

<P>
I don't think backwards compatibility is the point here.
</P>

<P>
I picked up Camel 1 recently, and it was quite amazing how different
Perl4 *felt*.  It's like Perl was being pitched as a good language
for writing standalone programs or utilities of standalone programs
(the type a sysadmin would use).  It didn't feel like it was being
offered as the kind of language to write things like Class::Contract,
Inline::C, AxKit, SOAP::Lite or the all-singing-all-dancing CGI.pm.
</blockquote></P>

<P>
The ensuing discussion attempted to answer the $64,000 question:  In the 
effort to &quot;make the hard things easy,&quot; were the easy things becoming harder?  
Was the entry barrier to Perl being raised too high as a side-effect of the 
sheer capabilities of the complexity of the language?  There were plenty of 
arguments on all five sides of the coin.
</P>

<P>
Michael Schwern attempted to clarify some of the concerns by pointing out that 
<a href="http://archive.develooper.com/perl6-meta@perl.org/msg00834.html">"you will not have to rewrite your Perl 5 programs"</a>, since Larry had apocalyzed Perl 5 syntax handling for Perl 6, as well.  
</P>

<P>
Nathan then 
<a href="http://archive.develooper.com/perl6-meta@perl.org/msg00844.html">posted some sample code</a> to show exactly how unchanged common Perl will be.
<H3><a name="Perl_6_Language">Perl 6 Language</a></H3>

</P>

<P>

The -language list saw the bulk of the activity, with over 500 messages during
the three week period.  
<H4><a name="Apocalypse_2">Apocalypse 2</a></H4>

</P>

<P>

As expected, Larry's
<a href="/pub/2001/05/03/wall.html">Apocalypse 2</a> generated a lot of response.  Most of it was Q&amp;A and general water cooler talk,
but there are a couple things to bubble to the top.
</P>

<P>
Richard Proctor
<a href="http://archive.develooper.com/perl6-language@perl.org/msg06882.html">pointed out</a> an ambiguity between the new and old uses of 
<CODE>\Q</CODE>.  At the thread's end,
it looked as though Larry was in the process of consolidating all quoting
constructs into one meta-syntax, although nothing specific was put forth.
</P>

<P>
Nathan Wiger was the first to 
<a href="http://archive.develooper.com/perl6-language@perl.org/msg06896.html">express concerns</a> about the new syntax for the 
<CODE>I</CODE> in 
<CODE>I/O</CODE>.  (One of the basic issues of several
folks was the verbiage needed to accomplish something as common as reading input.)
Larry proffered some musings 
<a href="http://archive.develooper.com/perl6-language@perl.org/msg06938.html">here</a>,
<a href="http://archive.develooper.com/perl6-language@perl.org/msg06997.html">here</a>, and
<a href="http://archive.develooper.com/perl6-language@perl.org/msg07191.html">here</a>.
</P>

<P>
Nathan also asked for clarification on 
<a href="http://archive.develooper.com/perl6-language@perl.org/msg06916.html">context and variables</a>, which both
<a href="http://archive.develooper.com/perl6-language@perl.org/msg07001.html">Larry</a> and 
<a href="http://archive.develooper.com/perl6-language@perl.org/msg06917.html">Damian</a> provided.
<H4><a name="Exegesis_2">Exegesis 2</a></H4>

</P>

<P>

Damian Conway's
<a href="/pub/2001/05/08/exegesis2.html">Exegesis 2</a> also spawned a lot of traffic.  With few exceptions, however, the discussion
was completely focused on properties and the new 
<CODE>is</CODE> keyword.  Responses were
varied as to what level of confusion the author was in, but the overall trend
was fairly static - properties on values versus variables, and how it all comes
together.  Damian posted one last
<a href="http://archive.develooper.com/perl6-language@perl.org/msg07298.html">explanation</a>.
<H4><a name="Sandboxing">Sandboxing</a></H4>

</P>

<P>

David Nicol
<a href="http://archive.develooper.com/perl6-language@perl.org/msg06850.html">asked</a> whether Perl 6 should support sandboxing, or if it should rely on the
underlying OS.
</P>

<P>
After some minor debate, the general consensus was that Perl should support its
own sandboxing, which should be (relatively) trivial, at least for security
concerns.  There was some expressed worry, however, as to how to handle resource
limitations.
<H4><a name="Undecorated_References">Undecorated References</a></H4>

</P>

<P>

David Nicol also
<a href="http://archive.develooper.com/perl6-language@perl.org/msg07066.html">suggested</a> that references be undecorated, in an effort to reclaim 
<CODE>$</CODE> as a content hint, as
well as a contextual one.  After a fairly meandering discussion on Perl 5, Perl 6,
and Hungarian notation, Larry
<a href="http://archive.develooper.com/perl6-language@perl.org/msg07095.html">said</a>:
<blockquote></P>

<P>
I happen to like $ and @.  They're not going away in standard Perl as
long as I have anything to do with it.  Nevertheless, my vision for Perl
is that it enable people to do what *they* want, not what I want.
</blockquote><H4><a name="Lexing_and_Pushdown_Expressions">Lexing and Pushdown Expressions</a></H4>

</P>

<P>

Daniel Wilkerson 
<a href="http://archive.develooper.com/perl6-language@perl.org/msg07176.html">requested</a> better parsing capabilities to be built into Perl.  There was general
agreement that Perl had some weaknesses in these areas, but some trepidation
on solving it beyond how current Perl modules do.
<H4><a name="Miscellaneous">Miscellaneous</a></H4>

</P>

<P>

Alexander Farber 
<a href="http://archive.develooper.com/perl6-language@perl.org/msg06798.html">asked</a> for 
<CODE>last</CODE> to work in 
<CODE>grep</CODE>.  After a couple demonstrations on how this was
possible in Perl 5, the thread shifted to talking about compiler optimizations.
</P>

<P>
David Grove 
<a href="http://archive.develooper.com/perl6-language@perl.org/msg06804.html">queried</a> about the similarities between Perl 6 and .NET.  After a couple responses on how
<a href="http://archive.develooper.com/perl6-language@perl.org/msg06808.html">this makes sense</a>, the thread shifted to talking about data serialization.
<H3><a name="Perl_6_Docs_Released">Perl 6 Docs Released</a></H3>

</P>

<P>

Here are some of the major documents released during this period:
</P>

<P>
Apocalypse
<a href="/pub/2001/05/03/wall.html">Two</a>, Larry Wall.
</P>

<P>
Exegesis
<a href="/pub/2001/05/08/exegesis2.html">Two</a>, Damian Conway.
</P>

<P>
PDD
<a href="http://archive.develooper.com/perl6-internals@perl.org/msg02895.html">Debugger</a>, Dave Storrs (rough draft, v1)
</P>

<P>
PDD
<a href="http://archive.develooper.com/perl6-internals@perl.org/msg02922.html">Conventions and Guidelines for Perl Source Code</a>, Dave Mitchell (Proposed, v1)
</P>

<P>

Until next week, I remain Simon's humble, and (mostly) obedient, servant,
</P>

<hr>

<a href="mailto:bwarnock@capita.com">Bryan C. Warnock</a>

<ul>
  <li><a href="#Notes">Notes</a>
  <li><a href="#Perl_6_Internals">Perl 6 Internals</a>
  <li><a href="#Perl_6_Meta">Perl 6 Meta</a>
  <li><a href="#Perl_6_Language">Perl 6 Language</a>
  <li><a href="#Apocalypse_2">Apocalypse 2</a>
  <li><a href="#Exegesis_2">Exegesis 2</a>
  <li><a href="#Sandboxing">Sandboxing</a>
  <li><a href="#Undecorated_References">Undecorated References</a>
  <li><a href="#Lexing_and_Pushdown_Expressions">Lexing and Pushdown Expressions</a>
  <li><a href="#Miscellaneous">Miscellaneous</a>
  <li><a href="#Perl_6_Docs_Released">Perl 6 Docs Released</a>
</ul>

        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1500" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2001/05/08/exegesis2.html" rel="bookmark">Exegesis 2</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Damian Conway</span> on <abbr class="published" title="2001-05-15T00:00:00-08:00">May 15, 2001 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            <!-- <a name="exegesis 2">Exegesis 2</a> -->

<p><em>Editor's note: this document is out of date and remains here for historic interest.  See <a href="http://dev.perl.org/perl6/doc/design/syn/S02.html">Synopsis 2</a> for the current design information.</p>

<br />

<p><em>exegesis: n. an interpretation and explanation of a text, esp. Holy Writ</em></p>
<p>This is the first of a series of articles paralleling Larry's ``Apocalypse''
encyclicals (it's numbered 2 to keep it in sync with those Revelations).
These articles will take each unveiled piece of the design for Perl 6 
and demonstrate the new syntax and semantics in an annotated program.</p>
<p>So, without further ado, let's write some Perl 6:</p>
<pre>
        # bintree - binary tree demo program 
        # adapted from &quot;Perl Cookbook&quot;, Recipe 11.15</pre>
<pre>
        use strict;
        use warnings;
        my ($root, $n);</pre>
<pre>
        while ($n++ &lt; 20) { insert($root, int rand 1000) }</pre>
<pre>
        my int ($pre, $in, $post) is constant = (0..2);</pre>
<pre>
        print &quot;Pre order:  &quot;; show($root,$pre);  print &quot;\n&quot;;
        print &quot;In order:   &quot;; show($root,$in);   print &quot;\n&quot;;
        print &quot;Post order: &quot;; show($root,$post); print &quot;\n&quot;;</pre>
<pre>
        $*ARGS is chomped;
        $ARGS prompts(&quot;Search? &quot;);
        while (&lt;$ARGS&gt;) {
            if (my $node = search($root, $_)) {
                print &quot;Found $_ at $node: $node{VALUE}\n&quot;;
                print &quot;(again!)\n&quot; if $node{VALUE}.Found &gt; 1;
            }
            else {
                print &quot;No $_ in tree\n&quot;;
            }
        }</pre>
<pre>
        exit;</pre>
<pre>
        #########################################</pre>
<pre>
        sub insert (HASH $tree is rw, int $val) {
            unless ($tree) {
                my %node;
                %node{LEFT}   = undef;
                %node{RIGHT}  = undef;
                %node{VALUE}  = $val is Found(0);
                $tree = %node;
                return;
            }
            if    ($tree{VALUE} &gt; $val) { insert($tree{LEFT},  $val) }
            elsif ($tree{VALUE} &lt; $val) { insert($tree{RIGHT}, $val) }
            else                        { warn &quot;dup insert of $val\n&quot; }
        }</pre>
<pre>
        sub show {
            return unless @_[0];
            show(@_[0]{LEFT}, @_[1]) unless @_[1] == $post;
            show(@_[0]{RIGHT},@_[1])     if @_[1] == $pre;
            print @_[0]{VALUE};
            show(@_[0]{LEFT}, @_[1])     if @_[1] == $post;
            show(@_[0]{RIGHT},@_[1]) unless @_[1] == $pre;
        }</pre>
<pre>
        sub search (HASH $tree is rw, *@_) {
            return unless $tree;
            return search($tree{@_[0]&lt;$tree{VALUE} &amp;&amp; &quot;LEFT&quot; || &quot;RIGHT&quot;}, @_[0])
                unless $tree{VALUE} == @_[0];
            $tree{VALUE} is Found($tree{VALUE}.Found+1);
            return $tree;
        }</pre>
<p>
<h3><a name="it's perl, jim, and quite like we know it">It's Perl, Jim, and quite like we know it</a></h3>
<p>The program gets off to a familiar start:</p>
<pre>
        use strict;
        use warnings;
        my ($root, $n);</pre>
<pre>
        while ($n++ &lt; 20) { insert($root, int rand 1000) }</pre>
<p>Nothing new here. And, in fact, despite the many new features it
illustrates, overall this program looks and feels a great deal like
Perl 5 code.</p>
<p>That shouldn't really be surprising, given that Perl 6 is growing out
the of suggestions of hundreds of devoted Perl 5 programmers, filtered
through the mind that invented Perl 5.</p>
<p>As <a href="#http://dev.perl.org/rfc/28.html">RFC 28</a> suggested, Perl is
definitely going to stay Perl.</p>
<p>
<h3><a name="any variables to declare">Any variables to declare?</a></h3>
<p>Variable declarations in Perl 6 can be as simple as those for <code>$root</code> and
<code>$n</code> above, but they can also be much more sophisticated:</p>
<pre>
        my int ($pre, $in, $post) is constant = (0..2);</pre>
<p>Here we declare three variables that share a common type (<code>int</code>) and
a common property (<code>constant</code>). Typed lexicals are a feature of Perl 5
too, but having names for Perl's built-in types is new.</p>
<p>The type specification tells the compiler that <code>$pre</code>, <code>$in</code>, and
<code>$post</code> will only ever be used to store integer values. And because <code>int</code>
is in lower-case, the specification also tells the compiler that it's
okay to optimize the implementation of the variables, because we promise
not to <code>bless</code> them or ascribe any run-time properties to them. Making
this promise and then breaking the rules later in the program will get
you a compile-time or run-time error (depending on whether the compiler
can detect the malfeasance statically).</p>
<p>If we had not been willing to live without the blessing of
<code>bless</code>-ing or the useful run-time properties of run-time properties, we
would have written:</p>
<pre>
        my INT ($pre, $in, $post) is constant = (0..2);</pre>
<p>in which case we'd get three less-optimized, but fully-functional,
Perl scalars.</p>
<p>In this particular case, the <code>int</code>/<code>INT</code> distinction makes very
little practical difference. However, there's a significant advantage
to writing:</p>
<pre>
        my int @hit_count is dim(100,366,24);</pre>
<p>compared to:</p>
<pre>
        my INT @hit_count is dim(100,366,24);</pre>
<p>and thereby replacing nearly a million chunky scalars with svelte raw integers.</p>
<p>
<h3><a name="la proprit c'est le vol">La propri&eacute;t&eacute; c'est le vol</a></h3>
<p>The <code>is constant</code> and <code>is dim</code> bits of the above declarations are
compile-time property specifications. These particular properties are
standard to Perl 6, but you can also <a href="#haven't we met before (part 1)">roll-your-own</a>. The <code>is dim</code> property tells Perl the (fixed!)
dimensions of the array in question. The <code>is constant</code> property
specifies that the preceding variables cannot be assigned to, nor have
their values otherwise modified, once they're initialized.</p>
<p>Moreover, the <code>constant</code> property is a hint to the compiler that it
may be able to optimize the variables right out of existence, by
inlining their values directly. Of course, that's only feasible if we
don't ever treat them like a real variable (e.g. take a reference to
them, or bless them).</p>
<p>The <code>is</code> keyword is optional where its absence is unambiguous, so
we could have written:</p>
<pre>
        my int ($pre, $in, $post) constant = (0..2);</pre>
<p>Larry's also still mulling over a suggestion that <code>are</code> be
provided as a synonym for <code>is</code>, so you might even be able to write
the declaration as:</p>
<pre>
        my int ($pre, $in, $post) are constant = (0..2);</pre>
<p>An important feature of the <code>is</code> operator that we'll make use of
shortly, is that it returns its <em>left</em> operand. So:</p>
<pre>
        $submarine is Colour('yellow')</pre>
<p>evaluates to <code>$submarine</code>, not <code>'yellow'</code>.</p>
<p>
<h3><a name="more of the same">More of the same</a></h3>
<p>The three calls to <code>show</code> are also exactly as they were in Perl 5:</p>
<pre>
        print &quot;Pre order:  &quot;; show($root,$pre);  print &quot;\n&quot;;
        print &quot;In order:   &quot;; show($root,$in);   print &quot;\n&quot;;
        print &quot;Post order: &quot;; show($root,$post); print &quot;\n&quot;;</pre>
<p>Happily, we're going to see that a lot throughout this series of articles.</p>
<p>
<h3><a name="biting off less so you can chew">Biting off less so you can chew</a></h3>
<p>Do you ever get tired of writing:</p>
<pre>
        while (&lt;&gt;) {            # Common Perl 5 idiom
                chomp;
                ...</pre>
<p>Wouldn't it be nice if input lines were automatically chomped? In Perl 6,
they can be. We just set the <code>chomped</code> property on the input handle referred
to by the global variable <code>$*ARGS</code>:</p>
<pre>
        $*ARGS is chomped;</pre>
<p>This causes any normal read on the handle (see <a href="#inputs that output">Inputs that output</a>)
to automatically pre-<code>chomp</code> the string it returns. Of course, like
most other global punctuation variables, <code>$/</code> has been banished from
Perl 6, so the trailing character sequence to be chomped is specified by the
handle's own <code>insep</code> (<strong>in</strong>put <strong>sep</strong>arator) property instead.</p>
<p>The asterisk in <code>$*ARGS</code> indicates that the variable is the one from
the special global namespace. If the asterisk is omitted, it's
probably <em>still</em> the one from the special global namespace -- unless you
declared a lexical or package variable of the same name. You can pronounce
<code>*</code> as ``standard'', if that helps.</p>
<p>By the way, it's called <code>$*ARGS</code> because it lets us access the files passed
as a Perl 6 program's <em>arguments</em> (just as the Perl 5 <code>ARGV</code> filehandle 
provides access to the program's...err...<em>argumentv</em>).</p>
<p>
<h3><a name="inputs that output">Inputs that output</a></h3>
<p>In the original <a href="http://www.oreilly.com/catalog/cookbook/"><em>Cookbook</em></a>
version of this program, the next line was:</p>
<pre>
        for (print &quot;Search? &quot;; &lt;&gt;; print &quot;Search? &quot;) {</pre>
<p>This highlights a common situation for which there is no satisfactory
solution in Perl 5. Namely: repeatedly prompting for input and reading
it into <code>$_</code>, until EOF. In Perl 6, there's finally a clean way to do
this -- with another property:</p>
<pre>
        $ARGS prompts(&quot;Search? &quot;);
        while (&lt;$ARGS&gt;) {</pre>
<p>The first thing you'll notice is that reports of the diamond operator's
death have been greatly exaggerated. Yes, even though the Second
Apocalypse foretold its demise, Rule #2 has since been applied and the
angle brackets live!</p>
<p>Of course, they're slightly different in Perl 6, in that they <em>require</em> a
handle object inside them (normally stored in a variable), but that's
already possible in Perl 5 too.</p>
<p>Meanwhile, what about that prompt? Well, the Perl 6 solution is to allow
input handles to have an associated character string that they print out
just before they attempt to read in data.</p>
<p><em>Wait a minute!</em>, I hear you object, <em>Input handles that do output???</em>
Actually, you've been using handles like that for decades. In most
languages, every time you do a read from standard input, the first thing
the input operation does is flush the standard output buffer. That's why
something like:</p>
<pre>
        print &quot;nuqneH? &quot;;
        $request = &lt;&gt;;</pre>
<p>pre-prints the prompt correctly, even though it doesn't end in a newline.</p>
<p>So input and output mechanisms are already carrying on a secret relationship.
The only change here is that now you're allowed to have the input
handle add a little something to the output before it flushes the buffer.
That's done with the <code>prompts</code> property. If an input handle has that property,
its value is written to <code>$*OUT</code> just before the input handle reads. So
we can replace:</p>
<pre>
        for (print &quot;Search? &quot;; &lt;&gt;; print &quot;Search? &quot;;) {         # Perl 5 (or 6)</pre>
<p>with</p>
<pre>
        $ARGS prompts(&quot;Search? &quot;);                              # Perl 6
        while (&lt;$ARGS&gt;) {</pre>
<p>Technically, that should of course be:</p>
<pre>
        $ARGS is prompts(&quot;Search? &quot;);</pre>
<p>but that grates unbearably. Fortunately the <code>is</code> is optional in
contexts -- such as this one -- where it can be inferred.</p>
<p>Note that, because the <code>is</code> operation returns its <code>left</code> operand (even
when the <code>is</code> is invisible!), we could also use the rather elegant:</p>
<pre>
        while (&lt;$ARGS prompts(&quot;Search? &quot;)&gt;) {</pre>
<p>In fact, this one-line version may often be preferable, since the value
of the <code>prompts</code> property might be changed somewhere inside the loop
and this resets it on each iteration.</p>
<p>The exact semantics of the prompting mechanism aren't nailed down yet, so it
may also be possible to use a subroutine reference as a dynamic prompt (the
handle would call the subroutine before each read and pre-print the return
value).</p>
<p>
<h3><a name="haven't we met before (part 1)">Haven't we met before? (part 1)</a></h3>
<p>Having requested and read in a value, the search-and-report code is almost
entirely familiar:</p>
<pre>
            if (my $node = search($root, $_)) {
                print &quot;Found $_ at $node: $node{VALUE}\n&quot;
                print &quot;(again!)\n&quot; if $node{VALUE}.Found &gt; 1;
            }
            else {
                print &quot;No $_ in tree\n&quot;
            }
        }</pre>
<p>The only lurking Perl6ism is the use of the user-defined <code>Found</code>
property to report repeated searches.</p>
<p>The call to <code>$node{VALUE}.Found</code> would normally be a method call (in Perl 6
<code>-&gt;</code> is spelled <code>.</code>). But since <code>$node{VALUE}</code> is just a regular
unblessed int, there is no <code>Found</code> method to call. So Perl treats the request
as a property query instead and returns (an alias to) the
corresponding property.</p>
<p>
<h3><a name="take that! and that!">Take that! And that!</a></h3>
<p>In Perl 6, subroutines can -- optionally -- specify proper parameter
lists (as opposed to the not-evil-just-misunderstood argument context
prototypes that Perl 5 allows).</p>
<p>For instance the <code>insert</code> subroutine, declares itself to take two
parameters:</p>
<pre>
        sub insert (HASH $tree is rw, int $val) {</pre>
<p>The first parameter specifies that the first argument must be a
reference to a hash and is to be assigned to the lexical variable
<code>$tree</code>. Defining the first parameter to be a hash reference means that
any attempt to use it in some other way (e.g. trying to do an subroutine
call through it, trying to pass it an explicit array reference, etc.)
can be caught and punished -- at compile-time.</p>
<p>It's important to understand that, by default, named parameters are
<em>not</em> like the elements of <code>@_</code>. Specifically, even though each
argument is passed to its corresponding parameter by reference (for
efficiency), the parameter variable itself is automatically declared
<code>constant</code>, so any attempt to assign to it results in a compile-time
error. This is intended to reduce the incidence of people accidentally
people shooting themselves in the foot.</p>
<p>Of course, this being Perl, when we really do need to draw a bead on
those metatarsals, we can. To allow assignments to a named parameter --
assignments that <em>will</em> propagate back to the original argument -- we
need to to declare the parameter with the standard <code>rw</code> (<strong>r</strong>ead-<strong>w</strong>rite)
property. It then becomes an fully assignable alias for the original
argument, which in this example allows us to autovivify it (see <a href="#we don't need no stinking backslashes">We don't need no stinking backslashes</a>).</p>
<p>The <code>@_</code> argument array <em>is</em> still available in Perl 6, but only when
we declare subroutines in the Perl 5 manner -- without a parameter list.
See <a href="#a good, oldfashioned show">A good, old-fashioned show</a>).</p>
<p>The second parameter of <code>insert</code> is defined to take an integer value.
By using the type <code>int</code> instead of <code>INT</code>, we're once again explicitly
promising not to do bizarre things with the referent (at
least, not within the body of <code>insert</code>). The compiler might be able to
use this information to optimize the subroutine's code in some way.</p>
<p>
<h3><a name="a sigil is for life, not just for value type">A sigil is for life, not just for value type</a></h3>
<p>Long ago, when the Earth was new and Perl was young and clean, the type of
sigil (<code>$</code>, <code>@</code>, or <code>%</code>) that was associated with a variable
described what it evaluated to. For example:</p>
<pre>
        print $x;                       # $x evaluates to scalar
        print $y[1];                    # $y[1] evaluates to scalar
        print $z{a};                    # $z{a} evaluates to scalar
        print $yref-&gt;[1];               # $yref-&gt;[1] evaluates to scalar
        print $zref-&gt;{a};               # $zref-&gt;{a} evaluates to scalar
        print @y;                       # @y evaluates to list
        print @y[2,3];                  # @y[2,3] evaluates to list
        print @z{'b','c'};              # @z{'b','c'} evaluates to list
        print @{$yref}[2,3];            # @{$yref}[2,3] evaluates to list
        print @{$zref}{'b','c'};        # @{zyref}{'b','c'} evaluates to list
        print %z;                       # %z evaluates to hash</pre>
<p>Regardless of the actual type of the variable being referred to, a leading
<code>$</code> on the access meant the result would be a scalar; a leading <code>@</code> meant
a list; a leading <code>%</code>, a hash.</p>
<p>But then the serpent of OO entered the garden, and offered Perlkind the
bitter fruit of subroutine and method calls:</p>
<pre>
        print $subref-&gt;();
        print $objref-&gt;method();</pre>
<p>Now the leading <code>$</code> no longer indicated the type of value returned.
And in beginners' Perl classes across the land there arose a great
wailing and a gnashing of teeth.</p>
<p>Perl 6 returns us to a state of grace -- albeit a state of <em>different</em>
grace --in which each variable type has One True Sigil, from which it
never strays.</p>
<p>In Perl 6, a scalar <em>always</em> has a leading <code>$</code>, an array <em>always</em> has
a leading <code>@</code> (even when accessing its elements or slicing it), and a
hash <em>always</em> has a leading <code>%</code> (even when accessing its entries or
slicing it).</p>
<p>In other words, the sigil no longer (sometimes) indicates the type of
the resulting value. Instead, it (always) tells you exactly what kind
of variable you're messing about with, regardless of what 
kind of messing about you're doing.</p>
<p>The <code>insert</code> subroutine has several examples of this new syntax. The most
obvious are in the autovivification of an empty subtree at the start of the
subroutine:</p>
<pre>
            unless ($tree) {
                my %node;
                %node{LEFT}   = undef;
                %node{RIGHT}  = undef;
                %node{VALUE}  = $val</pre>
<p>Even though we're accessing the <code>%node</code> hash's entries, the variable
retains its <code>%</code> sigil and the hash access braces are simply appended to
the complete variable name.</p>
<p>Likewise, to access the element of an array, we simply append the
array-access square brackets to the variable name: <code>@array[1]</code>. This is
a significant departure from Perl 5 syntax. In Perl 5, <code>@array[1]</code> is a
one-element slice of the <code>@array</code> array; in Perl 6, it's a direct single
element access (no slicing involved).</p>
<p>This means, of course, that Perl 6 will require some revised
array-slicing semantics. Larry's planning to take that opportunity to
beef up Perl's slicing facilities and provide for arbitrary slicing and
dicing of multidimensional arrays. But that's for a future Apocalypse.</p>
<p>For the time being, it's enough to know that, if you put a single scalar 
in the square brackets, you get a single element look-up; if you
put a list in the brackets, you get a slice.</p>
<p>
<h3><a name="haven't we met before (part 2)">Haven't we met before? (part 2)</a></h3>
<p>The last assignment to a <code>%node</code> entry has one other little twist.
The (copy of the) value being assigned is also ascribed a <code>Found</code> property,
initialized to the value zero:</p>
<pre>
                %node{VALUE}  = $val is Found(0);</pre>
<p>Once again, that works because, when a property is set using <code>is</code>, the
result of the operation is the left operand (in this case <code>$val</code>),
<em>not</em> the new value of the property.</p>
<p>Indeed, although we glossed over it at the time, that's the only reason the:</p>
<pre>
        while (&lt;$ARGS prompts(&quot;Search? &quot;)&gt;) {</pre>
<p>syntax actually worked. The expression <code>$ARGS prompts(&quot;Search? &quot;)</code> set
the handle's prompt, and then returned <code>$ARGS</code>, which became the
operand of the diamond operator, resulting in a prompt-and-read
operation through that handle.</p>
<p>
<h3><a name="we don't need no stinking backslashes">We don't need no stinking backslashes</a></h3>
<p>Once the new <code>%node</code> is initialized, a reference to it needs to be
assigned to the variable that was passed as the first argument (if it's
not clear why, see section 12.3.2 of
<a href="http://www.manning.com/conway/"><em>Object Oriented Perl</em></a> for a
detailed explanation of this tree-manipulation technique).</p>
<p>In Perl 5, modifying an original argument would require an
assignment to <code>$_[0]</code> (i.e. <code>@_[0]</code> in Perl 6), but because we
declared <code>$tree</code> to be <code>rw</code>, we can assign directly to it and have the
original argument change appropriately:</p>
<pre>
                $tree = %node;</pre>
<p><em>Oops,</em> (you're probably thinking), <em>he just fell victim to one of the
Classic Blunders: In a scalar context, a hash evaluates to the ratio of 
used buckets to allocated buckets!</em></p>
<p>In Perl 5 maybe, but in Perl 6 that near-useless behaviour has gone the
way of the powdered wigs, buggy whips, and DSL providers. Instead, when
evaluated in a scalar context, a hash (or an array) returns a reference to
itself. So the above line of code works correctly.</p>
<p><em>Okay,</em> (you're now wondering), <em>if arrays do that too, how do I get
the length of an array???</em> The answer is that in a numeric context an
array reference now evaluates to the length of the array. So the
translation of the Perl 5 code:</p>
<pre>
        while (@queue &gt; 0) {    # scalar eval of @queue yields length</pre>
<p>is:</p>
<pre>
        while (@queue &gt; 0) {    # scalar eval of @queue yields ref to array
                                # ref to array in numeric context yields length</pre>
<p>Similarly, in a boolean context, an array evaluates true if it contains any
elements, so the translation of the Perl 5 code:</p>
<pre>
        while (@queue) {    # scalar eval of @queue yields length</pre>
<p>is:</p>
<pre>
        while (@queue) {    # boolean eval of @queue yields true if not empty</pre>
<p>Cunning, huh?</p>
<p>
<h3><a name="you say %node{value}, but i say $tree{value}">You say <code>%node{VALUE}</code>, but I say <code>$tree{VALUE}</code></a></h3>
<p>When we were loading up the new node, we wrote <code>%node{VALUE}</code> to access
its <code>'VALUE'</code> entry. Now that <code>$tree</code> holds a reference to <code>%node</code>,
we need some way of accessing the same entry.</p>
<p>In Perl 5 that would be:</p>
<pre>
        $tree-&gt;{VALUE}        # Perl 5 entry access through hash ref in $tree</pre>
<p>And since <code>-&gt;</code> is spelled <code>.</code> in Perl 6, that becomes:</p>
<pre>
        $tree.{VALUE}         # Perl 6 entry access through hash ref in $tree</pre>
<p>However, since the direct hash access syntax now uses a completely different
sigil -- <code>%node{VALUE}</code> -- the <code>.</code> isn't needed for disambiguation there
and hence can be made optional:</p>
<pre>
        $tree{VALUE}          # Perl 6 entry access through hash ref in $tree</pre>
<p>And that's the usual way accesses to hash references will be written:</p>
<pre>
            if    ($tree{VALUE} &gt; $val) { insert($tree{LEFT},  $val) }
            elsif ($tree{VALUE} &lt; $val) { insert($tree{RIGHT}, $val) }
            else                        { warn &quot;dup insert of $val\n&quot; }
        }</pre>
<p>This is actually far <em>less</em> confusing than it might at first seem.
For example, back in <a href="#haven't we met before (part 1)">Haven't we met before? (part 1)</a>, did you
notice that:</p>
<pre>
        if (my $node = search($root, $_)) {
            print &quot;Found $_ at $node: $node{VALUE}\n&quot;</pre>
<p>already used this new syntax?</p>
<p>In Perl 5 that would have been a (very common) error -- the second line
would print an entry of <code>%node</code>, when we actually wanted an entry of
<code>%{$node}</code>.  But in Perl 6, it just Does What We Mean.</p>
<p>And, of course, access through other kinds of references will also allow
the <code>.</code> to be omitted: <code>$arr_ref[$index]</code> and <code>$sub_ref(@args)</code>.</p>
<p>Here's a handy conversion table:</p>
<pre>
        Access through...       Perl 5          Perl 6
        =================       ======          ======
        Scalar variable         $foo            $foo
        Array variable          $foo[$n]        @foo[$n]
        Hash variable           $foo{$k}        %foo{$k}
        Array reference         $foo-&gt;[$n]      $foo[$n] (or $foo.[$n])
        Hash reference          $foo-&gt;{$k}      $foo{$k} (or $foo.{$k})
        Code reference          $foo-&gt;(@a)      $foo(@a) (or $foo.(@a))
        Array slice             @foo[@ns]       @foo[@ns]
        Hash slice              @foo{@ks}       %foo{@ks}</pre>
<p>
<h3><a name="a good, oldfashioned show">A good, old-fashioned show</a></h3>
<p>The <code>show</code> subroutine illustrates the optional nature of parameter
lists. Here we omit the parameter specifications entirely, and get the
good old familiar
``take-any-number-of-arguments-and-stick-them-all-in-<code>@_</code>'' semantics.</p>
<p>Indeed, apart from its DWIM-ier array access syntax, the <code>show</code> subroutine
is vanilla Perl 5:</p>
<pre>
        sub show {
            return unless @_[0];
            show(@_[0]{LEFT}, @_[1]) unless @_[1] == $post;
            show(@_[0]{RIGHT},@_[1])     if @_[1] == $pre;
            print @_[0]{VALUE};
            show(@_[0]{LEFT}, @_[1])     if @_[1] == $post;
            show(@_[0]{RIGHT},@_[1]) unless @_[1] == $pre;
        }</pre>
<p>And that, we believe, will be the normal experience when moving from 5 to 6:
Perl will still be Perl...only slightly more so.</p>
<p>Of course, the <code>show</code> subroutine is moderately funky Perl anyway,
so if symmetrically guarded repetitions of the left- and right-
subtree traversals aren't your maintenance dream, this would also be the
ideal place to use Perl's new <em>case</em> statement.</p>
<p>But that won't be unveiled until Apocalypse 4, so if you could just look
at this <a href="#http://www.meninblack.com/media/kay08.html">little red light</a>....&lt;FLASH&gt;...Thank-you.</p>
<p>
<h3><a name="search me">Search me</a></h3>
<p>The parameter list of the <code>search</code> subroutine is interesting because it's
a hybrid of the old and new Perl semantics:</p>
<pre>
        sub search (HASH $tree is rw, *@_) {</pre>
<p>Both parameter's are explicitly declared, but the second declaration
(<code>*@_</code>) causes the remaining parameters to be collected in <code>@_</code>.
There's nothing <em>magical</em> about <code>@_</code> there: if the second declaration
had been <code>*@others</code>, the rest of the arguments would have turned up in
<code>@others</code>.</p>
<p>The asterisk in the second parameter tells Perl 6 that the corresponding
argument position is a plain ol' list context, so that any arguments there (or
thereafter) should be treated as a single list and assigned to the
corresponding parameter variable. It's the equivalent of the Perl 5 <code>@</code>
prototype.</p>
<p>In contrast, a parameter declaration of <code>@param</code>, is the equivalent of
Perl 5's <code>\@</code> prototype -- and explicitly requires an array variable as
the corresponding argument.</p>
<p>Notice that, because we started collecting arguments in <code>@_</code> from the
<em>second</em> parameter, the value we're looking for (i.e. the second argument)
is referred to as <code>@_[0]</code>, not <code>@_[1]</code>:</p>
<pre>
            return search($tree{@_[0]&lt;$tree{VALUE} &amp;&amp; &quot;LEFT&quot; || &quot;RIGHT&quot;}, @_[0])
                unless $tree{VALUE} == @_[0];</pre>
<p>
<h3><a name="haven't we met before (part 3)">Haven't we met before? (part 3)</a></h3>
<p>The second last line of <code>search</code> is where all the Perl 6 action is. Having
worked out that we're already at the desired node, we're going to return it.
But we also need to increment its <code>Found</code> property, which we do like so:</p>
<pre>
            $tree{VALUE} is Found($tree{VALUE}.Found+1);</pre>
<p>This highlights two of the three ways of accessing a property:
the read-write <code>.</code> syntax, and the write-only <code>is</code> operator.</p>
<p>If a property is accessed as if it were a method,
its value can be set by passing the new value as an argument. Whether
such a value is passed or not, the result of the operation is an alias
(i.e. an lvalue) for the property itself. So we could also increment the
values's <code>Found</code> property like this:</p>
<pre>
        $tree{VALUE}.Found($tree{VALUE}.Found+1);</pre>
<p>or, like this:
</p>
<pre>

        $tree{VALUE}.Found++;</pre>
<p>The <code>is</code> syntax, on the other hand, can only set a property,
because the <code>is</code> operation returns its left operand (the referent that owns
the property), not the value of property itself. This is often highly useful,
however, for last-minute property setting in a <code>return</code> statement:</p>
<pre>
        return $result is Verified;</pre>
<p>Another very common usage is expected to be in returning zero-but-true and
non-zero-but-false values:</p>
<pre>
        sub my_system ($shell_command) {
                ...
                return $error is false if $error;
                return 0 is true;
        }</pre>
<p>The <em>third</em> way of accessing a property is via the <code>prop</code>
meta-property, which returns a reference to a hash containing all the
properties of a referent:</p>
<pre>
        $tree{VALUE}.prop{Found}++;</pre>
<p>You can also use this feature to list <em>all</em> the properties that
a referent has been ascribed:</p>
<pre>
        for (keys %{$tree.prop}) {
            print &quot;$_: $tree{VALUE}.prop{$key}\n&quot;;
        }</pre>
<p>By the way, in Apocalypse 2, Larry waggishly referred to the <code>prop</code>
meta-property as <code>btw</code>, but with the help of
<a href="#http://www.meninblack.com/media/kay08.html">modern therapeutic techniques</a>,
he's now gotten over the idea.</p>
<p>
<h3><a name="coda on an earlier theme">Coda on an earlier theme</a></h3>
<p>This article has illustrated several important new features that Perl 6
will provide. But don't let all that newness scare you. Perl has always
offered the ability to code at your own level and in the style that
suits you best. That's not going to change, even if the style that suits
you best is Perl 5.</p>
<p>Almost every new feature covered here will be <em>optional</em>, and if you
choose not to use them, you can still write the same program
in a manner that is <em>very</em> close to Perl 5. Like so:</p>
<pre>
        use strict;
        use warnings;
        my ($root, $n);</pre>
<pre>
        while ($n++ &lt; 20) { insert($root, int rand 1000) }</pre>
<pre>
        my ($pre, $in, $post) = (0..2);</pre>
<pre>
        print &quot;Pre order:  &quot;; show($root,$pre);  print &quot; \n&quot;;
        print &quot;In order:   &quot;; show($root,$in);   print &quot; \n&quot;;
        print &quot;Post order: &quot;; show($root,$post); print &quot; \n&quot;;</pre>
<pre>
        for (print &quot;Search? &quot;; &lt;$ARGS&gt;; print &quot;Search? &quot;) {
            chomp;
            if (my $node = search($root, $_)) {
                print &quot;Found $_ at $node: $node{VALUE}\n&quot;;
                print &quot;(again!)\n&quot; if $node{FOUND} &gt; 1;
            }
            else {
                print &quot;No $_ in tree\n&quot;;
            }
        }</pre>
<pre>
        exit;</pre>
<pre>
        #########################################</pre>
<pre>
        sub insert {
            unless (@_[0]) {
                @_[0] = { LEFT  =&gt; undef, RIGHT =&gt; undef,
                          VALUE =&gt; @_[1], FOUND =&gt; 0,
                        };
                return;
            }
            if    (@_[0]{VALUE} &gt; @_[1]) { insert(@_[0]{LEFT},  @_[1]) }
            elsif (@_[0]{VALUE} &lt; @_[1]) { insert(@_[0]{RIGHT}, @_[1]) }
            else                         { warn &quot;dup insert of @_[1]\n&quot;  }
        }</pre>
<pre>
        sub show  {
            return unless @_[0];
            show(@_[0]{LEFT}, @_[1]) unless @_[1] == $post;
            show(@_[0]{RIGHT},@_[1])     if @_[1] == $pre;
            print @_[0]{VALUE};
            show(@_[0]{LEFT}, @_[1])     if @_[1] == $post;
            show(@_[0]{RIGHT},@_[1]) unless @_[1] == $pre;
        }</pre>
<pre>
        sub search {
            return unless @_[0];
            return search(@_[0]{@_[1]&lt;@_[0]{VALUE} &amp;&amp; &quot;LEFT&quot; || &quot;RIGHT&quot;}, @_[1])
                unless @_[0]{VALUE} == @_[1];
            @_[0]{FOUND}++;
            return @_[0];
        }</pre>
<p>In fact, that's only 40 characters (out of 1779) from being pure Perl 5.
And almost all of those differences are <code>@</code>'s instead of <code>$</code>'s at the
start of array element look-ups.</p>
<p>98% backwards compatibility even without an automatic p52p6
translator...pretty slick!</p>

</body>

</html>

        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1510" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2001/05/p5pdigest/THISWEEK-20010513.html" rel="bookmark">This Week on p5p 2001/05/13</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Simon Cozens</span> on <abbr class="published" title="2001-05-13T00:00:00-08:00">May 13, 2001 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            </P>

<P>


<!-- This week on perl5-porters (07-13 May 2001) -->

<br />
<br />
      <H3><a name="Notes">Notes</a></H3>

</P>

<P>

You can subscribe to an email version of this summary by sending an
empty message to 
<a href="mailto:perl5-porters-digest-subscribe@netthink.co.uk"><tt>perl5-porters-digest-subscribe@netthink.co.uk</tt>.</a></P>

<P>
Please send corrections and additions to 
<CODE>perl-thisweek-YYYYMM@simon-cozens.org</CODE> where 
<CODE>YYYYMM</CODE> is the current year and month.  Changes and additions to the 
<a href="http://simon-cozens.org/writings/whos-who.html">perl5-porters</a> biographies are particularly welcome.
</P>

<P>
This week was slightly more busy than average, but was mainly little
bitty threads that didn't really go everywhere; part of the problem may
be that the bug reporting system's been playing up recently, and dumped
a bunch of old bugs onto the list toward the end of the week.
<H4><a name="Help_wanted">Help wanted</a></H4>

</P>

<P>

Very soon, I will have some rather important exams; in order for me to
concentrate on these, I'd appreciate it if someone could help out by
taking the P5P summary off my hands for a couple of weeks. If you want
to do that, email me at the above address.
<H3><a name="Cleaning_up_the_Todo_list">Cleaning up the Todo list</a></H3>

</P>

<P>

I started the week by posting a commentary on the three todo files, 
<CODE>perltodo.pod</CODE>, 
<CODE>Todo</CODE> and 
<CODE>Todo-5.6</CODE>. The ensuing discussion helped to weed out the items that had already
been done, or that people didn't actually want anyway, or were no longer
appropriate. It also raised the possibility of some kind of regexp
engine BOF at TPC: either a tag-team bug-fixing effort, or a talk by
people such as Jarkko and Hugo.
</P>

<P>
The important outcome of this is that we now have a 
<a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2001-05/msg01108.html">Grand Unified Todo List</a>, which means there are a lot of things that you can do! And, of course,
we found out where the phrase &quot;Danger, Will Robinson!&quot; comes from,
thanks to Walt Mankowski:
<blockquote>Lost in Space was a campy 1960's American scifi series about a family
which was, umm, lost in space.  At least once an episode the family's
young son Will would get into some sort of trouble (usually due to his
friendship with the evil stow-away Dr. Smith) and the family's robot
would flail his arms about and yell &quot;Danger, Will Robinson!  Danger!&quot;
</blockquote><H3><a name="Perl_Power_Tools">Perl Power Tools</a></H3>

</P>

<P>

The discussion on what's left to do and the discussion on Perl website
updates (see &quot;Various&quot;) both touched on the 
<a href="http://language.perl.com/">Perl Power Tools project</a>. This was one of Tom's ideas - a set of standard Unix utilities, 
rewritten in Perl. The tools are very useful, and I can personally
testify to their utility when I'm stuck out in the big, bad non-Unix
world. Unfortunately, Tom had a hard disk crash a while ago, wiping out
the mailing list for the project and some contributions; with one thing
(Camel 3) or another, (a rather nasty accident recently) he's not found
time to keep the project up to date.
</P>

<P>
Both Casey West and Sean Dague made offers to take over the project,
with Sean also proposing a CPAN-style &quot;Bundle&quot; of the tools. 
There's been no response from Tom yet.
<H3><a name="Safe_signals">Safe signals</a></H3>

</P>

<P>

<a href="http://simon-cozens.org/writings/whos-who.html#ING-SIMMONS">Nick Ing-Simmons</a> quietly sneaked safe signal handling into Perl. Benjamin Sugars seemed
 to understand it, and produced the following summary:
<blockquote>1. The new signal model calls out to Perl-level signal handlers only when
it's safe: either between opcodes or at certain points within certain
opcodes where it's known the callout can be done safely.
</P>

<P>
2. Delaying the callout has been shown to effect code that relies on the
Perl-level handler being called immediately.
</P>

<P>
3. It was demonstrated by Nick I-S that the best (IMO) way to deal with
these side effects is to update those ops most likely to be affected such
that they perform callout at a safe time (Nick I-S has already done this
for pp_wait and pp_waitpid, and for perlio).
</P>

<P>
4. Likely candidates for the aforementioned changes are those opcodes that
involve syscalls and looping opcodes.  The syscall opcodes may need to be
further modified to restart the syscall if need be.
</P>

<P>
5. This fix does not help those people that rely on an immediate callout
to a Perl-level signal handler that gets dispatched by C code outside of
the perl distribution.  An example of this is code that relies on the
handler being called from within stdio.
</P>

<P>
6. The old signal model is always available if compiled with
PERL_OLD_SIGNALS.
</P>

<P>
At this point we can either
</P>

<P>
A. Go ahead and implement #3 for those opcodes identified in #4.  We can
also see if anything can be done about #5.
</P>

<P>
B. Leave the code as is, wait for bug reports, and address on an as needed
basis following approach #3.
</P>

<P>
C. Do nothing more.  Tell people who complain &quot;Well, you shouldn't have
relied on %SIG in the first place...&quot; and ask them to recompile with
PERL_OLD_SIGNALS.
</blockquote></P>

<P>
This means for internals watchers that the long-dormant 
<CODE>PERL_ASYNC_CHECK</CODE> now actually does something: it now catches the signals and diverts
the flow of execution if needed. This means that long-running operations,
the regular expression and system calls 
may need a few more 
<CODE>PERL_ASYNC_CHECK</CODE>s dotted around them. Identifying the right places to put the checks will
be the critical battle in the fight for safer signals.
</P>

<P>
Almost immediately, 
<a href="http://simon-cozens.org/writings/whos-who.html#ABIGAIL">Abi</a> found a bug in the signal handling, which turned out to be because the
new system calls model was waiting until a 
<CODE>wait</CODE> had completed before despatching a signal, and also because system calls
are no longer restarted. Benjamin posted an analysis, and started working
on a pragma to select how signals should be despatched: immediately, when
safe, with restarted system calls, and so on. Abigail objected, saying
that would place too much emphasis on the user being familiar with signal
handling implementation. Jarkko agreed, and said that system calls should
always be restarted, without any need for a pragma. This caused Nick and
Benjamin some consternation:
<blockquote>Safe signals means we cannot call a handler written in perl at
arbitrary points, having system restart signals means we don't get
a chance to despatch the perl handler unless we do it from the C handler
which is not &quot;safe&quot;.
</P>

<P>
We could have dynamically scoped pragma which messed with the function
pointer, or the C code could advertise that it was okay to call perl handler
or ...
</blockquote></P>

<P>
Nick also pointed out that PerlIO did manage to arrange the signal despatch
at the right times, because it had 
<CODE>PERL_ASYNC_CHECK</CODE> in the right places. I don't know if system call restarting has been 
implemented, but I do know that Nick quietly fixed Abigail's bug as well.
</P>

<P>

<H3><a name="Release_Numbering">Release Numbering</a></H3>

<a href="http://simon-cozens.org/writings/whos-who.html#BURLISON">Alan</a> asked what the release numbering policy for Perl was; his intuitions in
 fact turned out to be correct:
<blockquote></P>

<P>
Perl release numbering is composed of a dotted &lt;Language Version&gt; &lt;Major
Version&gt; &lt;Minor Version&gt; tuple.
</P>

<P>
Major releases may break both source and binary compatibility, although they
are more likely to preserve source compatibility and break binary
compatibility.
</P>

<P>
Sometimes binary compatibility is possible over a major release boundary,
e.g. by use of the -Dbincompat5005 to Configure.
</P>

<P>
Minor releases should not break either source or binary compatibility, i.e.
XSUBs compiled against 5.6.0 should still work on 5.6.1.
</P>

<P>
Binary compatibility will be broken if you change the 'bitness' of perl,
e.g. by switching from 32 to 64 bit integer support or vice-versa.
</P>

<P>
The transition from 5.005_03 to 5.6.0 was a Major release
The transition from 5.6.0 to 5.6.1 was a Minor release
The current development track is the 5.7.X series
The next Major release will be 5.8.0
</blockquote><a href="http://simon-cozens.org/writings/whos-who.html#DOUGHERTY">Andy Dougherty</a> explained that Perl uses the 
<CODE>xs_apiversion</CODE> config variable to find modules which are &quot;binary compatible&quot; with
the current Perl. Alan noted that Perl's &quot;binary compatibility&quot; assumes
that everyone has the source and a compiler, whereas Solaris' &quot;binary
compatibility&quot; means that SunOS 4 executables run on 64-bit Solaris.
</P>

<P>
Andy also explained how to 
<a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2001-05/msg00841.html">distribute non-core modules with Perl</a> without getting fried by upgrades.
</P>

<P>
Alan also bemoaned the problem that if Sun ships a Perl compiled with
its own compilers, users who only have 
<CODE>gcc</CODE> won't be able to build external modules properly; he hacked up a
solution whereby &quot;
<CODE>gccperl</CODE>&quot; would see the right configuration.
<H3><a name="Various">Various</a></H3>

</P>

<P>

I started fiddling with 
<CODE>roffitall</CODE>, and then got sidetracked into making 
<CODE>roffitall</CODE>, 
<CODE>installperl</CODE> and 
<CODE>installman</CODE> all use a separate data file for identifying utilities that ship with
 Perl; 
<a href="http://simon-cozens.org/writings/whos-who.html#GUY">Mike Guy</a> fixed up a bug which caused 
<CODE>AutoSplit</CODE> to generate bogus line numbers.
</P>

<P>
Benjamin Sugars documented the 
<CODE>our $foo :shared</CODE> attribute. 
<a href="http://simon-cozens.org/writings/whos-who.html#SCHWARTZ">Randal</a> and I cleaned up the book, magazine and website links
 in the Perl FAQ. 
</P>

<P>
There was a long and drawn-out campaign to make 
</P>

</P><PRE>
    1 while unlink $filename
</PRE>

<P>
the official way to delete files in the core: this is supposed to help
VMS and other versioning filesystems really delete a file instead of just
taking a swipe at it.
<a href="http://simon-cozens.org/writings/whos-who.html#PRYMMER">Peter Prymmer</a> chimed in some EBCDIC fixes. 
<a href="http://simon-cozens.org/writings/whos-who.html#HOUSTON">Robin Houston</a>.... oh, you can guess the rest.
</P>

<P>
Until next week, or longer if I can persuade someone to take my place, 
I remain, your humble and obedient servant,
</P>

<hr>

<a href="mailto:simon@brecon.co.uk">Simon Cozens</a>


<ul>
  <li><a href="#Notes">Notes</a>
  <li><a href="#Help_wanted">Help wanted</a>
  <li><a href="#Cleaning_up_the_Todo_list">Cleaning up the Todo list</a>
  <li><a href="#Perl_Power_Tools">Perl Power Tools</a>
  <li><a href="#Safe_signals">Safe signals</a>
  <li><a href="#Release_Numbering">Release Numbering</a>
  <li><a href="#Various">Various</a>
</ul>

        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1512" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2001/05/p5pdigest/THISWEEK-20010520.html" rel="bookmark">This Week on p5p 2001/05/20</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Simon Cozens</span> on <abbr class="published" title="2001-05-06T00:00:00-08:00">May  6, 2001 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            <!-- This week on perl5-porters (14 May-20 May 2001) -->

<br />
<br />
      <H3><a name="Notes">Notes</a></H3>

</P>

<P>

You can subscribe to an email version of this summary by sending an
empty message to 
<a href="mailto:perl5-porters-digest-subscribe@netthink.co.uk"><tt>perl5-porters-digest-subscribe@netthink.co.uk</tt>.</a></P>

<P>
Please send corrections and additions to 
<CODE>perl-thisweek-YYYYMM@simon-cozens.org</CODE> where 
<CODE>YYYYMM</CODE> is the current year and month.  Changes and additions to the 
<a href="http://simon-cozens.org/writings/whos-who.html">perl5-porters</a> biographies are particularly welcome.
</P>

<P>
This was a fairly typical week with some large threads.
<H3><a name="Help_found">Help found</a></H3>

</P>

<P>

Simon Cozens, the usual summarizer, is currently having rather
important exams. Leon Brocard has stepped in to take the P5P
summary off his hands for a bit. Good luck, Simon!
<H3><a name="Internationalisation">Internationalisation</a></H3>

</P>

<P>

<a href="http://simon-cozens.org/writings/whos-who.html#BURLISON">Alan Burlison</a> started off by asking:
<blockquote>In amongst all the Unicode work, has any thought been given to
internationalising the perl interpreter itself?  At the moment all the error
and warning messages are english-only, AFAIK. This also applies to the
standard modules.
</blockquote></P>

<P>
A small thread discussed the huge amount of work involved in
translating every English part of the Perl source into multiple
languages, and the fact that the typical method of achieving this was
message catalogues which are, as
<a href="http://simon-cozens.org/writings/whos-who.html#HIETANIEMI">Jarkko</a> understatedly pointed out &quot;messy&quot;. Sean Burke's 
<CODE>Locale::Maketext</CODE> module was mentioned as a solution. The thread went dead, although it
 looks like at least the
<CODE>perldiag</CODE> documentation will be worked upon.
<H3><a name="Must_pseudo_hashes_die">Must pseudo-hashes die?</a></H3>

</P>

<P>

Pseudohashes are a long-lived and yet not much loved experimental
feature of Perl which aims to optimise a hash reference to an array
reference at compile time, helping speed and efficiency.
<a href="http://simon-cozens.org/writings/whos-who.html#SCHWERN">Michael Schwern</a> asked that pseudo-hashes should be removed from Perl 5.8 and onwards.
</P>

<P>
He found that pseudohashes are about 15% faster than hashes, but that
the current implementation is layered over the hash code so that:
<blockquote>Tearing out the pseudohash code gives an across the board 10-15% gain
in speed in basic benchmarks.  That means if we didn't have
pseudohashes, normal hashes would be just as fast as fully declared
pseudohashes!
</blockquote></P>

<P>
Removal of pseudohashes would need a clean implementation of 
<CODE>fields</CODE>. 
<a href="http://simon-cozens.org/writings/whos-who.html#BARR">Graham Barr</a> suggested moving the pseudohash code out of the hash code and making a
new PSEUDOHASH type.
</P>

<P>
In summary: it looks like current user-visible implementation of
pseudo-hashes (the weird use of the first array element) will be
deprecated starting from Perl 5.8.0 and will be removed in Perl 5.10.0. 
<a href="http://simon-cozens.org/writings/whos-who.html#HIETANIEMI">Jarkko</a> complained: &quot;Instead of too much implementation hand-waving how about some
real implementations, followed by some real benchmarks, and
discussion on some real tradeoffs?&quot;.
</P>

<P>
This brought upon another point: making experimental features Perl
compile time configuration options which default to OFF. Little
discussion ensued.
<H3><a name="More_Magic">More Magic</a></H3>

</P>

<P>

<a href="http://simon-cozens.org/writings/whos-who.html#COZENS">Simon Cozens</a> attempted to convince us of the utility of a generalised
magic for arrays and hashes:
<blockquote>The idea is simple. When you use a special scalar in Perl, like, say,
$/, (but not $_, because that's not only special, it's extra special)
Perl looks up the scalar in the symbol table and finds that it has
magic attached to it. This magic, called &quot;\0&quot; magic, means that
instead of getting the value from the SV structure, Perl calls a
function magic_get and returns the value from there. (It doesn't have
to be magic_get - there are lots of different types of magic, which
fire off different functions. Anyway, &quot;\0&quot; magic fires off magic_get.)
magic_get looks at the name of the scalar, and basically does a big
case statement to perform code appropriate for that scalar.
</P>

<P>
The end result is that if I want to add a new special variable - let's
say $} - then I can tell gv.c that it should have &quot;\0&quot; magic, and
insert the appropriate code to deal with it in magic_get.
</P>

<P>
For arrays and hashes, it's not that easy. Unfortunately, every single
special array and hash has its own magic - and not just its own, but
also a different type of magic that should be copied to the elements
of the array or hash. So if you want to add more special variables,
you have to cook up a new kind of magic and more virtual tables and
functions and it's just horrid.
</blockquote></P>

<P>
Simon and Sarathy want to make it easier to add magic to aggregates,
but suggested different approaches. Simon wants to introduce a new
once-and-for-all generic magic for aggregates and their elements
scalars; Sarathy wants to collapse everything into the &quot;P&quot; magic
which handles tied arrays and hashes.
<H3><a name="Legal_FAQ">Legal FAQ</a></H3>

</P>

<P>

A. C. Yardley proposed to develop a Legal FAQ to hopefully address
most of the important legal issues concerning Perl, the Perl
community, and Perl's Open Source efforts. This is a wonderful thing
to undertake, for as Jarkko pointed out: &quot;it's about time we get
something a little bit more than just educated guesses.&quot;
</P>

<P>
Proposed topics include: general discussion about lawyers and the
American legal system, copyright and trademark law and international
conventions, a review of the so-called Digital Millennium Copyright
Act, licensing issues about code on CPAN and names, liability issues,
and much more.
</P>

<P>
He also notes (unfortunately, but quite understandably) for a
distributed, world-wide development effort such as Perl:
<blockquote>Unfortunately, other the rather general remarks and
references, I must limit my review and analysis of the relevant
legal issues contained within the proposed FAQ to the domestic laws
of the United States.  It is unfortunate, but a review of the  
domestic laws of all of the applicable Nation States would be a
significantly, non-trivial undertaking.
</blockquote></P>

<P>

<H3><a name="Various">Various</a></H3>

<a href="http://simon-cozens.org/writings/whos-who.html#SUGALSKI">Dan Sugalski</a> dropped in a patch to speed up threaded perl
 on Alpha VMS systems by about 2-3 percent.
</P>

<P>
Doug MacEachern asked about optimising hash lookups with a constant
key by pre-calculating the hash of the key. Turns out this was already
in bleadperl, but disabled under ithreads.
</P>

<P>

<a href="http://simon-cozens.org/writings/whos-who.html#AAS">Gisle Aas</a> contributed a patch to stop
<CODE>chomp</CODE> always stringifying its argument (even if it leaves it alone) as well as a 
patch to fix 
<CODE>require $mod</CODE> where 
<CODE>$mod</CODE> has touched numeric context.
</P>

<P>

<a href="http://simon-cozens.org/writings/whos-who.html#ZAKHAREVICH">Ilya Zakharevich</a> provided 5 patches, including cleanups, both low- and
high-level API additions, and more convenient client-server debugging
in the Perl debugger, along with some OS/2 work.
</P>

<P>

<a href="http://simon-cozens.org/writings/whos-who.html#HOUSTON">Robin Houston</a> asked about
<CODE>CvFILE()</CODE> corruption under ithreads. 
<CODE>CvFILE()</CODE> returns the name of the
 file that the CV (sub, xsub or format) was declared in, and isn't
 used in core Perl but rather used by compiler backends such as
<CODE>B::C</CODE> and
<CODE>B::Deparse</CODE>. Robin supplied a patch but will rework it.
</P>

<P>
Dave Mitchell supplied a large patch that replaced magic char
constants with symbolic values.
</P>

<P>
Some bugs in pp_concat were noticed by Hugo and Jarkko took the blame
for previously cleaning it up rather too severely.
</P>

<P>
Until next week I remain, your temporarily-replaced humble and
obedient servant,
</P>

<a href="mailto:leon@iterative-software.com">Leon Brocard</a><br />
<a href="http://www.astray.com/">http://www.astray.com/
</a><br />
<a href="http://www.iterative-software.com/">Iterative Software</a>


<P>
... All things are green unless they are not
</P>

<hr>




<ul>
  <li><a href="#Notes">Notes</a>
  <li><a href="#Help_found">Help found</a>
  <li><a href="#Internationalisation">Internationalisation</a>
  <li><a href="#Must_pseudo_hashes_die">Must pseudo-hashes die?</a>
  <li><a href="#More_Magic">More Magic</a>
  <li><a href="#Legal_FAQ">Legal FAQ</a>
  <li><a href="#Various">Various</a>
</ul>

        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1508" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2001/05/p5pdigest/THISWEEK-20010506.html" rel="bookmark">This Week on p5p 2001/05/06</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Simon Cozens</span> on <abbr class="published" title="2001-05-06T00:00:00-08:00">May  6, 2001 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            </P>

<P>


<!-- This week on perl5-porters (30 Apr-06 May 2001) -->

<br />
<br />
      <H3><a name="Notes">Notes</a></H3>

</P>

<P>

You can subscribe to an email version of this summary by sending an
empty message to 
<a href="mailto:perl5-porters-digest-subscribe@netthink.co.uk"><tt>perl5-porters-digest-subscribe@netthink.co.uk</tt>.</a></P>

<P>
Please send corrections and additions to 
<CODE>perl-thisweek-YYYYMM@simon-cozens.org</CODE> where 
<CODE>YYYYMM</CODE> is the current year and month.  Changes and additions to the 
<a href="http://simon-cozens.org/writings/whos-who.html">perl5-porters</a> biographies are particularly welcome.
</P>

<P>
Thanks to the gigantic ithreads, uh, thread, this week saw nearly 600
messages, and guess who has to sit and read them all?
<H3><a name="iThreads">iThreads</a></H3>

</P>

<P>

The first rumblings came when 
<a href="http://simon-cozens.org/writings/whos-who.html#SUGALSKI">Dan Sugalski</a>, without any warning, dropped in an 87K patch to make threads and
multiplicity work on VMS - a veritable feat. 
</P>

<P>
Then the thread started last week when Artur talked about his work on
the 
<CODE>iThreads.pm</CODE> module, which we looked at a little
<a href="/pub/2001/04/p5pdigest/THISWEEK-20010422.html#iThreads">Read about it.</a> two weeks ago. 
<a href="http://simon-cozens.org/writings/whos-who.html#GURUSAMY">Sarathy</a> said it was great that someone was working on it, and gave a few
suggestions; primarily that magic was probably the best way to implement
shared data access, and how we would implement 
<CODE>:shared</CODE>. Doug explained that we already have 
<CODE>:shared</CODE>, but it does something else, what Dick Hardt calls solar variables. 
(See below) Artur asked if we could turn solars into fully shared
variables by using a mutex when one wants to write to them. Dan
explained that it was non-threadsafe to upgrade a readonly scalar,
(which Perl will do if it needs to stringify or numify it.) which could
be seen as a bug in Perl's implementation of 
<CODE>:shared</CODE> GVs. Doug said it wasn't a bug - if you're marking data as 
<CODE>:shared</CODE> it shouldn't be upgraded at runtime. This is true from Doug's point of
view - solar variables - but not from Artur's desire for true shared
variables.
</P>

<P>
Benjamin Sugars asked if Sarathy expected Perl to do the locking
transparently:
</P>

</P><PRE>
    our $sv : shared = "foo";
    # Start some threads here, then...
    print $sv;         # read-only, no lock according to above?
    $sv = "bar";       # locks $sv for read/write
</PRE>

<P>
He quite rightly pointed out that this would mean that every op would
need to test for sharedness and locking. 
<a href="http://simon-cozens.org/writings/whos-who.html#HIETANIEMI">Jarkko</a> agreed, saying that
locking should be implemented manually by the programmer; Sarathy said
that should only be the case for locks to avoid deadlock in user space:
&quot;Any and all locking needed to avoid coredumps and memory corruption
should be the sole province of the perl guts.&quot; He also said that he
thinks that his idea could work and even be suitable for Perl 5.6.x.
(And also took the opportunity to attempt to throw the pumpkin away
again, but nobody took the hint.)
</P>

<P>
Dan brought up the vexed question of non-reentrant libraries, and
whether or not XS authors will properly protect their code. 
<a href="http://simon-cozens.org/writings/whos-who.html#CLARK">Nick Clark</a>suggested that CPAN authors should have to declare whether or not their
code is threadsafe. Chris Stith asked if there could be a way for
modules to tell perl itself that they were threadsafe. Benjamin Sugars
asked if this would actually help: &quot;Simply serializing calls into a
non-thread-safe library doesn't make it thread-safe.&quot; 
<a href="http://simon-cozens.org/writings/whos-who.html#BURLISON">Alan</a> produced a 
<a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2001-05/msg00296.html">Sun manpage</a> all about what &quot;thread-safe&quot; means.
</P>

<P>
This naturally took us on to using reentrant versions of C library
calls: unfortunately, this would take a lot of work at the Configure
end, and is especially tricky because the interfaces to reentrant
functions aren't necessarily standard. Jarkko suggested that we have
more important thread problems to look at, specifically the regular
expression engine. 
</P>

<P>
Dan said that serializing calls to a non-thread-safe library will
work most of the time, but Alan said that only works if they have no
stored state. Artur asked why we couldn't use thread local storage - the
answer, of course, being that external libraries are black boxes; we
don't know what state they're storing or where they're storing it.
</P>

<P>
Alan pointed at some bits of Java that had locking wrong, even though
Java has a well-defined thread support model, and mentioned that we
would be better off putting a proper event loop in Perl. Artur mentioned
<a href="http://search.cpan.org/search?dist=POE">POE</a>, and that he was writing the threads module to make POE multithreaded.
</P>

<P>
Alan then began his impression of Eeyore:
<blockquote>SETJMP AND LONGJMP ARE USED EXTENSIVELY IN PERL5.  SETJMP AND LONGJMP ARE
NOT MT-SAFE.  YOU ARE WASTING YOUR TIME TRYING TO PUT MULTITHREADING INTO
PERL5 AS IT STANDS.  EVEN IF IT WORKS MOST OF THE TIME ON YOUR UNIPROCESSOR
MACHINE IT WILL EXPLODE IN YOUR FACE ON A MULTIPROCESSOR MACHINE.  THREADS
IN PERL5 ARE DOOMED TO FAILURE WITHOUT SIGNIFICANT REARCHITECTING.
</P>

<P>
AND NO, PUTTING A WHACKING GREAT GLOBAL LOCK AROUND EVERYTHING DOES NOT MAKE
PERL5 MULTITHREADED.
</P>

<P>
I hope that is clear.
</blockquote></P>

<P>
Dan concurred, but a lot more mildly: &quot;Perl 5 won't ever be properly
thread safe, I think. The best we can hope for is for it to be safe
except for exceptional cases. Which isn't good enough, but isn't that
bad.&quot; He also explained that if you do any 
<CODE>malloc</CODE>s with Perl's own 
<CODE>malloc</CODE> you really really need to protect it with a mutex. (Sarathy picked a
 nit - it actually protects itself.) 
</P>

<P>
Sarathy disagreed, and said that it was a priority to make sure that
Perl built-ins always call &quot;safe&quot; library functions under ithreads. 
He also said that there was no shared state between interpreters in
ithreads, so a build which uses multiplicity and 
<CODE>libpthread</CODE> should be perfectly safe, barring external libraries: ithreads are
going to be as safe as your system's thread-safe C library. Jarkko came up
with two old P5P postings detailing the interfaces to &quot;safe&quot; library
 functions: 
<a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/1998-01/msg00021.html">here</a> and 
<a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/1998-01/msg00095.html">here</a>.
</P>

<P>
Jarkko called a halt to the discussion as it started getting out of
order (which was a bit of a shame as the major players had just agreed
to stop mudslinging and discuss how to help Artur; oh well.) He also
said that he wasn't too impressed by the idea of adding Configure probes
for a maze of twisty syscalls, all different. This, bizarrely, fell into
a discussion about how 
<CODE>h2xs</CODE> is broken for constants. But I suspect that's another story for another
time. 
</P>

<P>
Here are Artur's conclusions on ithreads:
<blockquote>a) We have ithreads today, they exist in the core,
</P>

<P>
b) they are used on win32, now, and they will possibly be used on a larger
amount of platforms with mod_perl 2.0 (assume non forking mpm)
</P>

<P>
c) my belief is that the mod_perl usage, is reason enough to work on this
</P>

<P>
d) there are no changes to the core suggested (if we are not to add
configure probes and *_r)
</P>

<P>
e) modules that want to work under mod_perl 2.0 should be threadsafe, same
with psuedo forking on windows
</P>

<P>
f) call me a bigot but I believe that supporting Win32, Linux and Solaris is
good for a starter (mainly because I use those systems, but sounds like
Tru64 shouldn't be a problem either, nor *bsd)
</P>

<P>
g) an event loop is not a replacment for threads, threads are not an
replacment for event loops, there are event loops avaible to perl, Event.pm,
POE, Tk, there are no threads avaible even if the support is there in the C
layer
</blockquote></P>

<P>

In the meantime, you can read more about what Artur's doing by looking at his
<a href="http://use.perl.org/~sky/">use.perl journal</a>. (A few of the Perl porters have journals on use.perl.org - have you?)
<H3><a name="Relocatable_Perl">Relocatable Perl</a></H3>

</P>

<P>

Alan has been trying to get Perl relocatable on Solaris. As
anyone who's administered a Unix system with Perl on will know, one
major downer is that the paths in
<CODE>@INC</CODE> are hard-coded into the 
<CODE>perl</CODE> binary. This makes it nearly impossible to pick up Perl and move the
installation somewhere else. 
</P>

<P>
Alan noticed two new things that will help him in his quest: &quot;The first
of these is the ability to refer to a library with a path that is
relative to the executable (removing the need for LD_LIBRARY_PATH
hackery) and the second is the ability to find out the path of the
executable from inside the executable (removing the need for PERL5LIB
hackery).&quot; He then asked what would need changing before it would all
just work.
</P>

<P>
Dan emphatically did not want to point out that he'd had a relocatable Perl
 on VMS for many years now. He explained how he would do it
<a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2001-04/msg01874.html">here</a>, moving the 
<CODE>#define</CODE>s into global strings and instanciating them at run-time. Nick
Ing-Simmons pointed out that ActiveState's Win32 Perl already does this.
Surprisingly, everyone agreed about how it should be done. Steve Fink
asked if we could generalise it to other Unices with 
<CODE>procfs</CODE> by calling
<CODE>readlink("/proc/self/exe",...)</CODE>. Jarkko also gave us some useful tips about how programs ought to find
themselves on Unix: 
<a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2001-05/msg00188.html">Read about it.</a></P>

<P>
Quote of the week from Dan: &quot;Remember, any design flaw you're
sufficiently snide about becomes a feature.&quot; 
<H3><a name="Change_10000">Change 10,000</a></H3>

</P>

<P>

After four years in Perforce version control, Perl has finally seen
its 10,000th registered patch. Jarkko has this to say about it:
<blockquote>The 10000th patch was courtesy of Andreas K&oumlaut;nig.  Yes, I made itso by selective patch ordering :-) -- but it doesn't diminish the
significance of the choice.
</P>

<P>
Andreas does deserve all the possible glory for keeping the PAUSE
running.  The PAUSE is the major part of CPAN and I always feel bad
when people talk of me as &quot;the CPAN guy&quot;.  CPAN wouldn't exist without
Andreas.  Also the wondrous CPAN.pm is his handiwork.  Remember him
everytime you are using CPAN.pm and a module, including all its
prerequisites, installs like magic.  I know Andreas wants you to
remember him also when the installation doesn't work *quite* that
magically :-), send him the bug report and you can be certain that
Andreas will fix the problem amazingly fast.
</blockquote></P>

<P>
What Jarkko didn't say, however, is that over the past four years,
nearly 50% of the patches in the repository have been due to him. 
<H3><a name="perl__devrandom">perl < /dev/random</a></H3>

</P>

<P>

<a href="http://simon-cozens.org/writings/whos-who.html#ZAKHEREVICH">Ilya </a> found, unsurprisingly, that you can break Perl by feeding it random
crud:
<blockquote> As shipped: it can survive circa 10000 evals
of random input (of length 1000 each), i.e., I see a failure in the
rate 1 per minute (athlon 850).  The failure mode I see is an infinite
loop.  The debugging indicates that the actual failure rate may be
much larger, but the corruption is not visible for some time, since
the code executed in the script is so short, and (random?) memory
corruption misses it for some time.
</blockquote></P>

<P>
He produced a little patch to fix up an input overflow; Jarkko mentioned a
neat idea relating to deliberately &quot;poisoning&quot; various parts of Perl - 
the allocation arena, for instance - and seeing how it coped. After
checking Ilya's methodology, we found that the problem was that Perl got
slowly more brain-damaged by more and more failed 
<CODE>eval</CODE>s. The input overflow patch was applied, but nobody seems to know how
Perl can read in too much input in the first place...
<H3><a name="Module_License_Registration">Module License Registration</a></H3>

</P>

<P>

After a brief and surprisingly sane debate about licensing, Andreas came
up with his list of suggestions for the new &quot;License&quot; category of the
CPAN module classification system. 
</P>

<P>
His 
<a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2001-05/msg00256.html">message on the subject</a> explains it far better than I could; however, the categories he's
chosen are:
</P>

</P><PRE>
     p   - Standard-Perl: user may choose between GPL and Artistic
     g   - GPL: GNU General Public License
     l   - LPGL: GNU Library or "Lesser" Public License,
     b   - BSD: The BSD License
     a   - Artistic license alone
     o   - Any other Open Source licenses listed at http://www.opensource.org/licenses/
     d   - Not approved by www.opensource.org, but distribution allowed without restrictions
     r   - Some restriction on distribution
     n   - No license given
<H3><a name="Various">Various</a></H3>

</PRE>

<P>

<a href="http://simon-cozens.org/writings/whos-who.html#HANSEN">Ask </a> complained that the Perl Builder people were spamming - it turned
out that they were actually just incompetent about handling other
people's email addresses.
</P>

<P>
Andreas complained the bleadperl wasn't installing properly any more -
 the new version of 
<CODE>s2p</CODE> can also be used as a complete implementation of 
<CODE>sed</CODE> in Perl, so we've called it 
<CODE>psed</CODE>. Unfortunately, someone forgot to add code to make the symlink between
<CODE>s2p</CODE> and 
<CODE>psed</CODE>.
</P>

<P>
Benjamin Sugars did some work to fix up the new
</P>

</P><PRE>
    open $fh, ">", \$scalar;
</PRE>

<P>
semantics, allowing Unix-like appending and seeking. He also asked what
<CODE>stat</CODE> should do on a scalar-file; Jarkko warned against taking the metaphor
 too far: &quot;And... 
<CODE>link()</CODE> should do alias-via-typeglob and 
<CODE>symlink()</CODE> should create a weak reference? :-)&quot;
<a href="http://simon-cozens.org/writings/whos-who.html#SANDEN">Hugo</a> noticed that the output of 
<CODE>-Dt</CODE> was occasionally incorrect, producing the wrong lexical variables;
 Benjamin took a look into this, with some help from Sarathy.
</P>

<P>
Benjamin also patched 
<CODE>sv_dump</CODE> to notice the 
<CODE>GvSHARED</CODE> flag, which prompted a short discussion of what 
<CODE>GvSHARED</CODE> means. Doug explained: &quot;for example, 
<CODE>our @EXPORT : shared</CODE> makes the variables shared across interpreters and read-only. This is
useful for things that take up lots of space, e.g. 
<CODE>*POSIX::*EXPORT*</CODE>w ithout the shared attribute, they are copied. For POSIX.pm thats 132k
* say 20 interpreters, 
[shared] gives savings there of about 2.6Mb. It's  useful for any app
where 
<CODE>perl_clone()</CODE> would be called, which at the moment includes embedded apps, Win32 
<CODE>fork()</CODE> and anything that uses 
<CODE>iThreads</CODE>.&quot;
</P>

<P>
Tels found that building Perl was, for some reason, taking up a
semi-infinite amount of disk space at the 
<CODE>make depend</CODE> stage; nobody knew why, since that code hadn't been touched for a long
time. Jarkko told him to use 5.7.1 and the problem seems to have gone
away.
</P>

<P>
As usual, 
<a href="http://simon-cozens.org/writings/whos-who.html#HOUSTON">Robin </a>made 
<CODE>B::Deparse</CODE> sing, dance and do new tricks, and
 until next week I remain, your humble and obedient servant,
</P>

<hr>

<a href="mailto:simon@brecon.co.uk">Simon Cozens</a>


<ul>
  <li><a href="#Notes">Notes</a>
  <li><a href="#iThreads">iThreads</a>
  <li><a href="#Relocatable_Perl">Relocatable Perl</a>
  <li><a href="#Change_10000">Change 10,000</a>
  <li><a href="#perl__devrandom">perl < /dev/random</a>
  <li><a href="#Module_License_Registration">Module License Registration</a>
  <li><a href="#Various">Various</a>
</ul>

        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1498" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2001/05/03/wall.html" rel="bookmark">Larry Wall: Apocalypse Two</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Larry Wall</span> on <abbr class="published" title="2001-05-03T00:00:00-08:00">May  3, 2001 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            
<!-- <a name="apocalypse 2">Apocalypse 2</a> -->

<br />

<p><em>Editor's Note: this Apocalypse is out of date and remains here for histor
ic reasons.  See <a href="http://dev.perl.org/perl6/doc/design/syn/S02.html">Syn
opsis 02</a> for the latest information.</em></p>

<p><table width="180" cellspacing="0" cellpadding="4" align="right" border="1">
<tr>
<td align="center" valign="top" bgcolor="#6699cc">
<font color="#ffffff">Perl 6 Apocalypse</td>
</tr>

<tr>
<td>
<p class="fine">The rest of the "Apocalypse" series is available on <a href="/pub/au/Wall_Larry">Larry Wall's author page</a>.</p>
</td>
</tr>
</p>
</table>
<h3>Table Of Contents</h3>
<p class="fine">
<ul>

	<li><a href="#atoms">Atoms</a></li>
	<li><a href="#molecules">Molecules</a></li>
	<ul>

		<li><a href="#rfc005">RFC 005: Multiline Comments for Perl</a></li>
		<li><a href="#rfc102">RFC 102: Inline Comments for Perl</a></li>
	</ul>

	<li><a href="#builtindatatypes">Built-in Data Types</a></li>
	<ul>

		<li><a href="#rfc161">RFC 161: Everything in Perl Becomes
 an Object.</a></li>
		<li><a href="#rfc038">RFC 038
: Standardise Handling of Abnormal Numbers Like Infinities and NaNs</a></li>
		<li><a href="#rfc043">RF
C 043: Integrate BigInts (and BigRats) Support Tightly With the Basic Scalars</a></li>
		<li><a href="#rfc192">RFC 192: Undef Values ne Value</a></li>
		<li><a href="#rfc212">RFC 212: Make <code>length(@array)</code> work</
a></li>
		<li><a href="#rfc218">RFC 218: <code>my Dog $spot</code> Is J
ust an Assertion</a></li>
		<li><a href="#otherdecisionsabouttypes">Other Decisions About Types</a></li>
	</ul>

	<li><a href="#variables">Variables</a></li>
	<ul>

		<li><a href="#rfc071">RFC 071: Legacy Perl $pkg'var Should Die<
/a></li>
		<li><a href="#rfc009">RFC 009: Highlander Variable Types</a></li>
		<li><a href="#rfc133">RFC 133: Alternate Syntax for Variabl
e Names</a></li>
		<li><a href="#rfc134">RFC 134: Alternative Array and Hash Sl
icing</a></li>
		<li><a href="#rfc196">RFC 196: More Direct Syntax for Hashes</a><
/li>
		<li><a href="#rfc201">RFC 201: Hash Slicing</a></li>
		<li><a href="#otherdecisionsaboutvariables">Other Decisions About Variables</a></li>
	</ul>

	<li><a href="#names">Names</a></li>
	<li><a href="#literals">Literals</a></li>
	<ul>

		<li><a href="#underscoresinnumericliterals">Underscores in Numeric Literals</a></li>
		<li><a href="#rfc105">RFC 105: Remove ``In string @ m
ust be \@'' Fatal Error</a></li>
		<li><a href="#rfc111">RFC 111: Here Docs T
erminators (Was Whitespace and Here Docs)</a></li>
		<li><a href="#rfc162">RFC 162: Heredoc Contents</a></li>
		<li><a href="#rfc139">RFC 139: Allow Calling
 Any Function With a Syntax Like s///</a></li>
		<li><a href="#rfc222">RFC 222: Interpolation of Object Met
hod Calls</a></li>
		<li><a href="#rfc226">RFC 226: Selective Int
erpolation in Single Quotish Context.</a></li>
		<li><a href="#rfc237">RFC 237: Hashes Should 
Interpolate in Double-Quoted Strings</a></li>
		<li><a href="#rfc251">RFC 251: Interpolation of Class Metho
d Calls</a></li>
		<li><a href="#rfc252">RFC 252: Interpolation of Cubroutines</a></l
i>
		<li><a href="#rfc327">RFC 327: <code>\v</code> for Vertical Tab</a></li>
		<li><a href="#rfc328">RFC 328: Single Quotes Don't 
Interpolate \' and \\</a></li>
		<li><a href="#otherdecisionsaboutliterals">Other Decisions About Literals</a></li>
		<ul>

			<li><a href="#scopingofletal">Scoping of \L et al.</a></li>
			<li><a href="#barewordpolicy">Bareword Policy</a></li>
			<li><a href="#weirdbrackets">Weird Brackets</a></li>
			<li><a href="#specialtokens">Special Tokens</a></li>
			<li><a href="#heredocsyntax">Heredoc Syntax</a></li>
		</ul>

	</ul>

	<li><a href="#context">Context</a></li>
	<ul>

		<li><a href="#referencesarenowtransparenttobooleancontext">References Are Now Transparent t
o Boolean Context</a></li>
	</ul>

	<li><a href="#lists">Lists</a></li>
	<ul>

		<li><a href="#rfc175">RFC 175: Add <code>l
ist</code> Keyword to Force List Context (like <code>scalar</code>)</a></li>
		<li><a href="#otherdecisionsaboutlists">Other Decisions About Lists</a></li>
	</ul>

	<li><a href="#files">Files</a></li>
	<ul>

		<li><a href="#rfc034">RFC 034: Angle Bracke
ts Should Not Be Used for File Globbing</a></li>
		<li><a href="#rfc051">RFC 051: Angle Brackets 
Should Accept Filenames and Lists</a></li>
	</ul>

	<li><a href="#properties">Properties</a></li>
</ul>

<!-- INDEX END -->
<hr size="1" noshade>

<!-- sidebar begins -->
<table width="170" border="0" cellspacing="12" cellpadding="6" align="right">
<tr> 
<td width="170" valign="top" height="4" bgcolor="#6699cc"></td></tr> 
<tr>
<td><font color="6699cc" size="-1"><b>Larry Wall will give his annual entertaining talk on the
     state of the Perl world, covering both Perl 5 and
     Perl 6 at this Year's <a href="http://conferences.oreilly.com/perl/">Open Source Convention</a>.
     Don't miss this rare opportunity to hear the creator of
     Perl, patch, and run share his insights.</b>

 </td></tr> <tr><td width="170" valign="top" height="4" bgcolor="#6699cc"> </td></tr></table>
<!-- sidebar ends -->


<p>Here's Apocalypse 2, meant to be read in conjunction with Chapter 2
of the Camel Book.  The basic assumption is that if Chapter 2 talks
about something that I don't discuss here, it doesn't change in Perl 6.
(Of course, it could always just be an oversight.  One might say that
people who oversee things have a gift of oversight.)</p>
<p>Before I go further, I would like to thank all the victims, er,
participants in the RFC process.  (I beg special forgiveness from
those whose brains I haven't been able to get inside well enough to
incorporate their ideas).  I would also like to particularly thank
Damian Conway, who will recognize many of his systematic ideas here,
including some that have been less than improved by my meddling.</p>
<p>Here are the RFCs covered:</p>
<pre>
    RFC  PSA  Title
    ---  ---  -----
      Textual
    005  cdr  Multiline Comments for Perl
    102  dcr  Inline Comments for Perl</pre>
<pre>
      Types
    161  adb  Everything in Perl Becomes an Object
    038  bdb  Standardise Handling of Abnormal Numbers Like Infinities and NaNs
    043  bcb  Integrate BigInts (and BigRats) Support Tightly With the Basic Scalars
    192  ddr  Undef Values ne Value
    212  rrb  Make Length(@array) Work
    218  bcc  C&lt;my Dog $spot&gt; Is Just an Assertion</pre>
<pre>
      Variables
    071  aaa  Legacy Perl $pkg'var Should Die
    009  bfr  Highlander Variable Types
    133  bcr  Alternate Syntax for Variable Names
    134  bcc  Alternative Array and Hash Slicing
    196  bcb  More Direct Syntax for Hashes
    201  bcr  Hash Slicing</pre>
<pre>
      Strings
    105  aaa  Remove &quot;In string @ must be \@&quot; Fatal Error
    111  aaa  Here Docs Terminators (Was Whitespace and Here Docs)
    162  abb  Heredoc Contents
    139  cfr  Allow Calling Any Function With a Syntax Like s///
    222  abb  Interpolation of Object Method Calls
    226  acr  Selective Interpolation in Single Quotish Context
    237  adc  Hashes Should Interpolate in Double-Quoted Strings
    251  acr  Interpolation of Class Method Calls
    252  abb  Interpolation of Subroutines
    327  dbr  C&lt;\v&gt; for Vertical Tab
    328  bcr  Single Quotes Don't Interpolate \' and \\</pre>
<pre>
      Files
    034  aaa  Angle Brackets Should Not Be Used for File Globbing
    051  ccr  Angle Brackets Should Accept Filenames and Lists</pre>
<pre>
      Lists
    175  rrb  Add C&lt;list&gt; Keyword to Force List Context (like C&lt;scalar&gt;)</pre>
<pre>
      Retracted
    010  rr  Filehandles Should Use C&lt;*&gt; as a Type Prefix If Typeglobs Are Eliminated
    103  rr  Fix C&lt;$pkg::$var&gt; Precedence Issues With Parsing of C&lt;::&gt;
    109  rr  Less Line Noise - Let's Get Rid of @%
    245  rr  Add New C&lt;empty&gt; Keyword to DWIM for Clearing Values
    263  rr  Add Null() Keyword and Fundamental Data Type</pre>

<h3><a name="atoms">Atoms</a></h3>
<p>Perl 6 programs are notionally written in Unicode, and assume Unicode
semantics by default even when they happen to be processing other
character sets behind the scenes.  Note that when we say that Perl is
written in Unicode, we're speaking of an abstract character set, not
any particular encoding.  (The typical program will likely be written
in UTF-8 in the West, and in some 16-bit character set in the East.)</p>
<p>
<hr>
<h3><a name="molecules">Molecules</a></h3>
<p>
<h3><a href="http://dev.perl.org/rfc/5.html" name="rfc005">RFC 005: M
ultiline Comments for Perl</a></h3>
<p>I admit to being prejudiced on this one -- I was unduly influenced
at a tender age by the rationale for the design of Ada, which made
a good case, I thought, for leaving multiline comments out of the
language.</p>
<p>But even if I weren't blindly prejudiced, I suspect I'd look at the
psychology of the thing, and notice that much of the time, even in languages
that have multiline comments, people nevertheless tend to use them like this:</p>
<pre>
    /*
     *  Natter, natter, natter.
     *  Gromish, gromish, gromish.
     */</pre>
<p>The counterargument to that is, of course, that people don't <em>always</em> do
that in C, so why should they have to do it in Perl?  And if there were
no other way to do multiline comments in Perl, they'd have a stronger
case.  But there already is another way, albeit one rejected by this RFC
as ``a workaround.''</p>
<p>But it seems to me that, rather than adding another kind of comment or
trying to make something that looks like code behave like a comment,
the solution is simply to fix whatever is wrong with POD so
that its use for commenting can no longer be considered a workaround.
Actual design of POD can be put off till Apocalypse 26, but we can
speculate at this point that the rules for switching back and forth
between POD and Perl are suboptimal for use in comments.  If so, then
it's likely that in Perl 6 we'll have a rule like this:  If a <code>=begin
MUMBLE</code> transitions from Perl to POD mode then the corresponding
<code>=end MUMBLE</code> should transition back (without a <code>=cut</code> directive).</p>
<p>Note that we haven't defined our <code>MUMBLE</code>s yet, but they can be set
up to let our program have any sort of programmatic access to the
data that we desire.  For instance, it is likely that comments of
this kind could be tied in with some sort of literate (or at least,
semiliterate) programming framework.</p>
<p>
<h3><a href="http://dev.perl.org/rfc/102.html" name="rfc102">RFC 102: Inline Comments for Perl</a></h3>
<p>I have never much liked inline comments -- as commonly practiced they
tend to obfuscate the code as much as they clarify it.  That being
said, ``All is fair if you predeclare.''  So there should be nothing
preventing someone from writing a lexer regex that handles them,
provided we make the lexer sufficiently mutable.  Which we will.
(As it happens, the character sequence ``<code>/*</code>'' will be unlikely to
occur in standard Perl 6.  Which I guess means it <em>is</em> likely to
occur in nonstandard Perl 6.  <code>:-)</code></p>
<p>A pragma declaring nonstandard commenting would also allow people to use
<code>/* */</code> for multiline comments, if they like.  (But I still think
it'd be better to use POD directives for that, just to keep the text
accessible to the program.)</p>
<p>
<hr>
<h3><a name="builtindatatypes">Built-In Data Types</a></h3>
<p>The basic change here is that, rather than just supporting scalars,
arrays and hashes, Perl 6 supports opaque objects as a fourth
fundamental data type.  (You might think of them as pseudo-hashes
done right.)  While a class can access its object attributes any way it
likes, all external access to opaque objects occurs through methods,
even for attributes.  (This guarantees that attribute inheritance
works correctly.)</p>
<p>While Perl 6 still defaults to typeless scalars, Perl will be able
to give you more performance and safety as you give it more type
information to work with.  The basic assumption is that homogenous
data structures will be in arrays and hashes, so you can declare the
type of the scalars held in an array or hash.  Heterogenous structures
can still be put into typeless arrays and hashes, but in general Perl 6
will encourage you to use classes for such data, much as C encourages
you to use structs rather than arrays for such data.</p>
<p>One thing we'll be mentioning before we discuss it in detail is
the notion of ``properties.''  (In Perl 5, we called these ``attributes,''
but we're reserving that term for actual object attributes these days,
so we'll call these things ``properties.'')  Variables and values can
have additional data associated with them that is ``out of band'' with
respect to the ordinary typology of the variable or value.  For now,
just think of properties as a way of adding ad hoc attributes to a
class that doesn't support them.  You could also think of it as a
form of class derivation at the granularity of the individual object, without
having to declare a complete new class.</p>
<p>
<h3><a href="http://dev.perl.org/rfc/161.html" name="rfc161">RFC 161: Everything in Perl Becomes an Object.</a></h3>
<p>This is essentially a philosophical RFC that is rather short on detail.
Nonetheless, I agree with the premise that all Perl objects should
act like objects if you choose to treat them that way.  If you
choose not to treat them as objects, then Perl will try to go along
with that, too.  (You may use hash subscripting and slicing syntax
to call attribute accessors, for instance, even if the attributes
themselves are not stored in a hash.)  Just because Perl 6 is more
object-oriented internally, does not mean you'll be forced to
think in object-oriented terms when you don't want to.  (By and large, there will be a few places where OO-think is more required in Perl
6 than in Perl 5.  Filehandles are more object-oriented in Perl 6,
for instance, and the special variables that used to be magically
associated with the currently selected output handle are better
specified by association with a specific filehandle.)</p>
<p>
<h3><a href="http://dev.perl.org/rfc/38.html" name="rfc038">RFC 038: Standardise Handling Of Abnormal Numbers Like Infinities and 
NaNs</a></h3>
<p>This is likely to slow down numeric processing in some locations.  Perhaps
it could be turned off when desirable.  We need to be careful not to
invent something that is guaranteed to run slower than IEEE floating
point.  We should also try to avoid defining a type system that makes
translation of numeric types to Java or C# types problematic.</p>
<p>That being said, standard semantics are a good thing, and should be
the default behavior.</p>
<p>
<h3><a href="http://dev.perl.org/rfc/43.html" name="rfc043">RFC 043: Integrate BigInts (and BigRats) Support Tightly With the
 Basic Scalars</a></h3>
<p>This RFC suggests that a pragma enables the feature, but I think it
should probably be tied to the run-time type system, which means it's
driven more by how the data is created than by where it happens to
be stored or processed.  I don't see how we can make it a
pragma, except perhaps to influence the meaning of ``int'' and ``num''
in actual declarations further on in the lexical scope:</p>
<pre>
    use bigint;
    my int $i;</pre>
<p>might really mean</p>
<pre>
    my bigint $i;</pre>
<p>or maybe just</p>
<pre>
    my int $i is bigint;</pre>
<p>since representation specifications might just be considered part
of the ``fine print.''  But the whole subject of lexically scoped
variable properties specifying the nature of the objects they contain
is a bit problematic.  A variable is a sort of mini-interface, a
contract if you will, between the program and the object in question.
Properties that merely influence how the program sees the object
are not a problem -- when you declare a variable to be constant,
you're promising not to modify the object through that variable,
rather than saying something intrinsically true about the object.
(Not that there aren't objects that are intrinsically constant.)</p>
<p>Other property declarations might need to have some say in how
constructors are called in order to guarantee consistency between the
variable's view of the object, and the nature of the object itself.
In the worst case we could try to enforce consistency at run time,
but that's apt to be slow.  If every assignment of a <code>Dog</code> object to a
<code>Mammal</code> variable has to check to see whether <code>Dog</code> is a <code>Mammal</code>, then 
the assignment
is going to be a dog.</p>
<p>So we'll have to revisit this when we're defining the relationship between
variable declarations and constructors.  In any event, if we don't make
Perl's numeric types automatically promote to big representations, we
should at least make it easy to specify it when you <em>want</em> that to happen.</p>
<p>
<h3><a href="http://dev.perl.org/rfc/192.html" name="rfc192">RFC 192: Undef
 Values ne Value</a></h3>
<p>I've rejected this one, because I think something that's undefined should
be considered just that, undefined.  I think the standard semantics are useful for catching many kinds of errors.</p>
<p>That being said, it'll hopefully be easy to modify the standard
operators within a particular scope, so I don't think we need to think
that our way to think is the only way to think, I think.</p>
<p>
<h3><a href="http://dev.perl.org/rfc/212.html" name="rfc212">RFC 212: Make <code>length(@array)</code> Work</a></h3>
<p>Here's an oddity, an RFC that the author retracted, but that I accept,
more or less.  I think <code>length(@array)</code> should be equivalent to
<code>@array.length()</code>, so if there's a <code>length</code> method available, it
should be called.</p>
<p>The question is whether there should be a <code>length</code> method at all,
for strings or arrays.  It almost makes more sense for arrays than it
does for strings these days, because when you talk about the length
of a string, you need to know whether you're talking about
byte length or character length.  So we may split up the traditional
length function into two, in which case we might end up with:</p>
<pre>
    $foo.chars
    $foo.bytes
    @foo.elems</pre>
<p>Or some such.  Whatever the method names we choose, differentiating
them would be more powerful in supplying context.  For instance,
one could envision calling <code>@foo.bytes</code> to return the byte length of
all the strings.  That wouldn't fly if we overloaded the method name.</p>
<p>Even <code>chars($foo)</code> might not be sufficiently precise, since, depending on
how you're processing Unicode, you might want to know how long the string
is in actual characters, not counting combining characters that don't
take extra space.  But that's a topic for later.</p>
<p>
<h3><a href="http://dev.perl.org/rfc/218.html" name="rfc218">RF
C 218: <code>my Dog $spot</code> Is Just an Assertion</a></h3>
<p>I expect that a declaration of the form:</p>
<pre>
    my Dog $spot;</pre>
<p>is merely an assertion that you will not use <code>$spot</code> inconsistently with
it being a <code>Dog</code>.  (But I mean something different by ``assertion'' than this
RFC does.)  This assertion may or may not be tested at every assignment
to <code>$spot</code>, depending on pragmatic context.  This bare declaration does
not call a constructor; however, there may be forms of declaration that
do.  This may be necessary so that the variable and the object can pass
properties back and forth, and in general, make sure they're consistent
with each other.  For example, you might declare an array with
a multidimensional shape, and this shape property needs to be visible
to the constructor, if we don't want to have to specify it redundantly.</p>
<p>On the other hand, we might be able to get assignment sufficiently
overloaded to accomplish the same goal, so I'm deferring judgment
on that.  All I'm deciding here is that a bare declaration without
arguments as above does not invoke a constructor, but merely tells
the compiler something.</p>
<p>
<h3><a name="otherdecisionsabouttypes">Other Decisions About Types</a></h3>
<p>Built-in object types will be in all uppercase: <code>INTEGER</code>, <code>NUMBER</code>,
<code>STRING</code>, <code>REF</code>, <code>SCALAR</code>, <code>ARRAY</code>, <code>HASH</code>, 
<code>REGEX</code> and <code>CODE</code>.
Corresponding to at least some of these, there will also be lowercase
intrinsic types, such as <code>int</code>, <code>num</code>, <code>str</code> and <code>ref</code>.  Use of
the lowercase typename implies you aren't intending to do anything fancy
OO-wise with the values, or store any run-time properties, and thus
Perl should feel free to store them compactly.  (As a limiting case,
objects of type <code>bit</code> can be stored in one bit.) This distinction
corresponds roughly to the boxed/unboxed distinction of other computer
languages, but it is likely that Perl 6 will attempt to erase the
distinction for you to the extent possible.  So, for instance, an <code>int</code>
may still be used in a string context, and Perl will convert it for
you, but it won't cache it, so the next time you use it as a string,
it will have to convert again.</p>
<p>The declared type of an array or hash specifies the type of each
element, not the type of an array or hash as a whole.  This is
justified by the notion that an array or hash is really just a strange
kind of function that (typically) takes a subscript as an argument
and returns a value of a particular type.  If you wish to associate
a type with the array or hash as a whole, that involves setting a
<code>tie</code> property.  If you find yourself wishing to declare different
types on different elements, it probably means that you should either
be using a class for the whole heterogenous thing, or at least declare
the type of array or hash that will be a base class of all the objects
it will contain.</p>
<p>Of course, untyped arrays and hashes will be just as acceptable as
they are currently.  But a language can only run so fast when you
force it to defer all type checking and method lookup till run time.</p>
<p>The intent is to make use of type information where it's useful, and
not require it where it's not.  Besides performance and safety, one other place
where type information is useful is in writing interfaces to other
languages.  It is postulated that Perl 6 will provide enough optional
type declaration syntax that it will be unnecessary to write XS-style
glue in most cases.</p>
<p>
<hr>
<h3><a name="variables">Variables</a></h3>
<p>
<h3><a href="http://dev.perl.org/rfc/71.html" name="rfc071">RFC 0
71: Legacy Perl $pkg'var Should Die</a></h3>
<p>I agree.  I was unduly influenced by Ada syntax here, and it was
a mistake.  And although we're adding a properties feature into Perl 6
that is much like Ada's attribute feature, we won't make the mistake
of reintroducing a syntax that drives highlighting editors nuts.
We'll try to make different mistakes this time.</p>
<p>
<h3><a href="http://dev.perl.org/rfc/9.html" name="rfc009">RFC 009: Hig
hlander Variable Types</a></h3>
<p>I basically agree with the problem this RFC is trying to solve, but I
disagree with the proposed solution.  The basic problem is that,
while the idiomatic association of <code>$foo[$bar]</code> with <code>@foo</code> rather
than <code>$foo</code> worked fine in Perl 4,
when we added recursive data structures to Perl 5, it started getting
in the way notationally, so that initial funny character was trying to
do too much in both introducing the ``root'' of the reference, as well as
the context to apply to the final subscript.  This necessitated odd
looking constructions like:</p>
<pre>
    $foo-&gt;[1][2][3]</pre>
<p>This RFC proposes to solve the dilemma by unifying scalar variables
with arrays and hashes at the name level.  But I think people like
to think of <code>$foo</code>, <code>@foo</code> and <code>%foo</code> as separate variables, so 

I don't want to break that.  Plus, the RFC doesn't unify <code>&amp;foo</code>,
while it's perfectly possible to have a reference to a function as
well as a reference to the more ordinary data structures.</p>
<p>So rather than unifying the names, I believe all we have to do is
unify the treatment of variables with respect to references.  That is,
all variables may be thought of as references, not just scalars.
And in that case, subscripts always dereference the reference implicit
in the array or hash named on the left.</p>
<p>This has two major implications, however.  It means that Perl
programmers must learn to write <code>@foo[1]</code> where they used to write
<code>$foo[1]</code>.  I think most Perl 5 people will be able to get used to
this, since many of them found the current syntax a bit weird in the
first place.</p>
<p>The second implication is that slicing needs a new notation, because
subscripts no longer have their scalar/list context controlled by the
initial funny character.  Instead, the context of the subscript will
need to be controlled by some combination of:</p>
<ol>
<li>
Context of the entire term.
<p></p>
<li>
Appearance of known list operators in the subscript, such as comma or range.
<p></p>
<li>
Explicit syntax casting the inside of the subscript to list or scalar context.
<p></p>
<li>
Explicit declaration of default behavior.
<p></p></ol>
<p>One thing that probably shouldn't enter into it is the run-time type
of the array object, because context really needs to be calculated
at compile time if at all possible.</p>
<p>In any event, it's likely that some people will want subscripts to default
to scalars, and other people will want them to default to lists.  There are
good arguments for either default, depending on whether you think more like
an APL programmer or a mere mortal.</p>
<p>There are other larger implications.  If composite variables are
thought of as scalar references, then the names <code>@foo</code> and <code>%foo</code> are
really scalar variables unless explicitly dereferenced.  That means
that when you mention them in a scalar context, you get the equivalent
of Perl 5's <code>\@foo</code> and <code>\%foo</code>.  This simplifies the prototyping system
greatly, in that an operator like <code>push</code> no longer needs to specify
some kind of special reference context for its first argument -- it
can merely specify a scalar context, and that's good enough to
assume the reference generation on its first argument.  (Of course,
the function signature can always be more specific if it wants to.
More about that in future installments.)</p>
<p>There are also implications for the assignment operator, in that it has
to be possible to assign array references to array variables without accidentally
invoking list context and copying the list instead of the reference to
the list.  We could invent another assignment operator to distinguish the
two cases, but at the moment it looks as though bare variables and slices
will behave as lvalues just as they do in Perl 5, while lists in parentheses
will change to a binding of the right-hand arguments more closely
resembling the way Perl 6 will bind formal arguments to actual arguments
for function calls.  That is to say,</p>
<pre>
    @foo = (1,2,3);</pre>
<p>will supply an unbounded list context to the right side, but</p>
<pre>
    (@foo, @bar) = (@bar, @foo)</pre>
<p>will supply a context to the right side that requests two scalar
values that are array references.  This will be the default for
unmarked variables in an lvalue list, but there will be an easy
way to mark formal array and hash parameters to slurp the rest of
the arguments with list context, as they do by default in Perl 5.</p>
<p>(Alternately, we might end up leaving the ordinary list assignment
operator with Perl 5 semantics, and define a new assignment operator
such as <code>:=</code> that does signatured assignment.  I can argue that one
both ways.)</p>
<p>Just as arrays and hashes are explicitly dereferenced via subscripting
(or implicitly dereferenced in list context), so too functions are
merely named but not called by <code>&amp;foo</code>, and explicitly dereferenced
with parentheses (or by use as a bare name without the ampersand
(or both)).  The Perl 5 meanings of the ampersand are no longer in
effect, in that ampersand will no longer imply that signature matching
is suppressed -- there will be a different mechanism for that.  And since
<code>&amp;foo</code> without parens doesn't do a call, it is no longer possible to
use that syntax to automatically pass the <code>@_</code> array -- you'll have to
do that explicitly now with <code>foo(@_)</code>.</p>
<p>Scalar variables are special, in that they may hold either references
or actual ``native'' values, and there is no special dereference
syntax as there is for other types.  Perl 6 will attempt to hide the distinction
as much as possible.  That is, if <code>$foo</code> contains a native integer,
calling the <code>$foo.bar</code> method will call a method on the built-in type.
But if <code>$foo</code> contains a reference to some other object, it will call the
method on that object.  This is consistent with the way we think about
overloading in Perl 5, so you shouldn't find this behavior surprising.
It may take special syntax to get at any methods of the reference
variable itself in this case, but it's OK if special cases are special.</p>
<p>
<h3><a href="http://dev.perl.org/rfc/133.html" name="rfc133">
RFC 133: Alternate Syntax for Variable Names</a></h3>
<p>This RFC has a valid point, but in fact we're going to do just the
opposite of what it suggests.  That is, we'll consider the funny
characters to be part of the name, and use the subscripts for context.
This works out better, because there's only one funny character, but
many possible forms of dereferencing.</p>
<p>
<h3><a href="http://dev.perl.org/rfc/134.html" name="rfc134">R
FC 134: Alternative Array and Hash Slicing</a></h3>
<p>We're definitely killing Perl 5's slice syntax, at least as far
as relying on the initial character to determine the context of the
subscript.  There are many ways we could reintroduce a slicing syntax,
some of which are mentioned in this RFC, but we'll defer the decision
on that till Apocalypse 9 on Data Structures, since the interesting
parts of designing slice syntax will be driven by the need to slice
multidimensional arrays.</p>
<p>For now we'll just say that arrays can have subscript signatures much
like functions have parameter signatures.  Ordinary one-dimensional
arrays (and hashes) can then support some kind of simple slicing syntax
that can be extended for more complicated arrays, while allowing
multidimensional arrays to distinguish between simple slicing and
complicated mappings of lists and functions onto subscripts in a
manner more conducive to numerical programming.</p>
<p>On the subject of hash slices returning pairs rather than values, we could
distinguish this with special slice syntax, or we could establish the
notion of a hashlist context that tells the slice to return pairs rather
than just values.  (We may not need a special slice syntax for that if
it's possible to typecast back and forth between pair lists and ordinary
lists.)</p>
<p>
<h3><a href="http://dev.perl.org/rfc/196.html" name="rfc196">RFC 19
6: More Direct Syntax for Hashes</a></h3>
<p>This RFC makes three proposals, which we'll consider separately.</p>
<p>Proposal 1 is ``that a hash in scalar context evaluate to the number
of keys in the hash.''  (You can find that out now, but only by using
the <code>keys()</code> function in scalar context.)  Proposal 1 is OK if we change ``scalar context'' to ``numeric context,'' since in scalar
context a hash will produce a reference to the hash, which just
happens to numify to the number of entries.</p>
<p>We must also realize that some implementations of hash might have
to go through and count all the entries to return the actual number.
Fortunately, in boolean context, it suffices to find a single entry
to determine whether the hash contains anything.  However, on hashes
that don't keep track of the number of entries, finding even one entry
might reset any active iterator on the hash, since some implementations
of hash (in particular, the ones that don't keep track of the
number of entries) may only supply a single iterator.</p>
<p>Proposal 2 is ``that the iterator in a hash be reset through an
explicit call to the <code>reset()</code> function.''  That's fine, with the
proviso that it won't be a function, but rather a <em>method</em>
on the HASH class.</p>
<p>Proposal 3 is really about <code>sort</code> recognizing pairs and doing the
right thing.  Defaulting to sorting on <code>$^a[0] cmp $^b[0]</code> is
likely to be reasonable, and that's where a pair's key would be found.
However, it's probable that the correct solution is simply to provide a
default string method for anonymous lists that happens to produce
a decent key to sort on when <code>cmp</code> requests a string representation
of either of its arguments.  The <code>sort</code> itself should probably just
concentrate on memoizing the returned strings so they don't have to
be recalculated.</p>
<p>
<h3><a href="http://dev.perl.org/rfc/201.html" name="rfc201">RFC 201: Hash Slicing</a></h3>
<p>This RFC proposes to use <code>%</code> as a marker for special hash slicing
in the subscript.  Unfortunately, the <code>%</code> funny character will not
be available for this use, since all hash refs will start with <code>%</code>.
Concise list comprehensions will require some other syntax within
the subscript, which will hopefully generalize to arrays as well.</p>
<p>
<h3><a name="otherdecisionsaboutvariables">Other Decisions About Variables</a></h3>
<p>Various special punctuation variables are gone in Perl 6,
including all the deprecated ones.  (Non-deprecated variables will be
replaced by some kind of similar functionality that is likely to be
invoked through some kind of method call on the appropriate object.
If there is no appropriate object, then a named global variable
might provide similar functionality.)</p>
<p>Freeing up the various bracketing characters allows us to use them
for other purposes, such as interpolation of expressions:</p>
<pre>
    &quot;$(expr)&quot;           # interpolate a scalar expression
    &quot;@(expr)&quot;           # interpolate a list expression</pre>
<p><code>$#foo</code> is gone.  If you want the final subscript of an array, and <code>[-1]</code>

isn't good enough, use <code>@foo.end</code> instead.</p>
<p>Other special variables (such as the regex variables) will change from
dynamic scoping to lexical scoping.  It is likely that even <code>$_</code>
and <code>@_</code> will be lexically scoped in Perl 6.</p>
<p>
<hr>
<h3><a name="names">Names</a></h3>
<p>In Perl 5, lexical scopes are unnamed and unnameable.  In Perl 6,
the current lexical scope will have a name that is visible within the
lexical scope as the pseudo class <code>MY</code>, so that such a scope can, if
it so chooses, delegate management of its lexical scope to some other
module at compile time.  In normal terms, that means that when you use
a module, you can let it import things lexically as well as packagely.</p>
<p>Typeglobs are gone.  Instead, you can get at a variable object through
the symbol table hashes that are structured much like Perl 5's.  The
variable object for <code>$MyPackage::foo</code> is stored in:</p>
<pre>
    %MyPackage::{'$foo'}</pre>
<p>Note that the funny character is part of the name.  There is no longer
any structure in Perl that associates everything with the name ``<code>foo</code>''.</p>
<p>Perl's special global names are stored in a special package named
``<code>*</code>'' because they're logically in every scope that does not hide them.
So the unambiguous name of the standard input filehandle is <code>$*STDIN</code>,
but a package may just refer to <code>$STDIN</code>, and it will default to
<code>$*STDIN</code> if no package or lexical variable of that name has been
declared.</p>
<p>Some of these special variables may actually be cloned for each lexical
scope or each thread, so just because a name is in the special global
symbol table doesn't mean it always behaves as a global across all
modules.  In particular, changes to the symbol table that affect how
the parser works must be lexically scoped.  Just because I install
a special rule for my cool new hyperquoting construct doesn't mean
everyone else should have to put up with it.  In the limiting case,
just because I install a Python parser, it shouldn't force other modules
into a maze of twisty little whitespace, all alike.</p>
<p>Another way to look at it is that all names in the ``<code>*</code>'' package are
automatically exported to every package and/or outer lexical scope.</p>
<p>
<hr>
<h3><a name="literals">Literals</a></h3>
<p>
<h3><a name="underscoresinnumericliterals">Underscores in Numeric Literals</a></h3>
<p>Underscores will be allowed between any two digits within a number.</p>
<p>
<h3><a href="http://dev.perl.org/rfc/105.html" name="rfc105">RFC 105: Remove ``In string @ must be \@'' Fatal Error</a></h3>
<p>Fine.</p>
<p>
<h3><a href="http://dev.perl.org/rfc/111.html" name="rfc111">RFC 111: Here Docs Terminators (Was Whitespace and Here Docs)</a></h3>
<p>Fine.</p>
<p>
<h3><a href="http://dev.perl.org/rfc/162.html" name="rfc162">RFC 162: Heredoc co
ntents</a></h3>
<p>I think I like option (e) the best: remove whitespace equivalent to the terminator.</p>
<p>By default, if it has to dwim, it should dwim assuming that hard tabs
are 8 spaces wide.  This should not generally pose a problem, since
most of the time the tabbing will be consistent throughout anyway, and
no dwimming will be necessary.  This puts the onus on people using
nonstandard tabs to make sure they're consistent so that Perl doesn't
have to guess.</p>
<p>Any additional mangling can easily be accomplished by a user-defined operator.</p>
<p>
<h3><a href="http://dev.perl.org/rfc/139.html" name="rfc139">RFC 139: Allow Calling Any Function With a Syntax Like s///</a></h3>
<p>Creative quoting will be allowed with lexical mutataion, but we can't
parse <code>foo(bar)</code> two different ways simultaneously, and I'm unwilling to
prevent people from using parens as quote characters.  I don't see how we
can reasonably have new quote operators without explicit declaration.
And if the utility of a quote-like operator is sufficient, there should
be little relative burden in requiring such a declaration.</p>
<p>The form of such a declaration is left to the reader as an exercise
in function property definition.  We may revisit the question later
in this series.  It's also possible that a quote operator such as
<code>qx//</code> could have a corresponding function name like <code>quote:qx</code>
that could be invoked as a function.</p>
<p>
<h3><a href="http://dev.perl.org/rfc/222.html" name="rfc222">RFC 222: Interpolation of Object Method Calls</a></h3>
<p>I've been hankering for methods to interpolate for a long time,
so I'm in favor of this RFC.  And it'll become doubly important as
we move toward encouraging people to use accessor methods to refer to
object attributes outside the class itself.</p>
<p>I have one ``but,'' however.  Since we'll switch to using <code>.</code> instead
of <code>-&gt;</code>, I think for sanity's sake we may have to require the parentheses,
or ``<code>$file.$ext</code>'' is going to give people fits.  Not to mention
``<code>$file.ext</code>''.</p>
<p>
<h3><a href="http://dev.perl.org/rfc/226.html" name="rfc226">RFC 226: Selective Interpolation in Single Quotish Context.</a></h3>
<p>This proposal has much going for it, but there are also difficulties,
and I've come close to rejecting it outright simply because the
single-quoting policy of Perl 5 has been successful.  And I
think the proposal in this RFC for <code>\I</code>...<code>\E</code> is ugly.
(And I'd like to kill <code>\E</code> anyway, and use bracketed scopings.)</p>
<p>However, I think there is a major ``can't get there from here'' that we
could solve by treating interpolation into single quotes as something
hard, not something easy.  The basic problem is that it's too easy
to run into a <code>\$</code> or <code>\@</code> (or a <code>\I</code> for that matter) that wants
to be taken literally.  I think we could allow the interpolation of
arbitrary expressions into single-quoted strings, but only if we limit
it to an unlikely sequence where three or more characters are necessary
for recognition.  The most efficient mental model would seem to
be the idea of embedding one kind of quote in another, so I think this:</p>
<pre>
    \q{stuff}</pre>
<p>will embed single-quoted stuff, while this:</p>
<pre>
    \qq{stuff}</pre>
<p>will embed double-quoted stuff.  A variable
could then be interpolated into a single-quoted string by saying:</p>
<pre>
    \qq{$foo}</pre>
<p>
<h3><a href="http://dev.perl.org/rfc/237.html" name="rfc237">RFC 237: Hashes Should Interpolate in Double-Quoted Strings</a></h3>
<p>I agree with this RFC in principle, but we can't define the default
hash stringifier in terms of variables that are going away in Perl 6,
so the RFC's proposal of using <code>$&quot;</code> is right out.</p>
<p>All objects should have a method by which they produce readable
output.  How this may be overridden by user preference is open to debate.
Certainly, dynamic scoping has its problems.  But lexical override
of an object's preferences is also problematic.  Individual object properties
appear to give a decent way out of this.  More on that below.</p>
<p>On <code>printf</code> formats, I don't see any way to dwim that <code>%d</code> isn't an
array, so we'll just have to put formats into single quotes in general.
Those format strings that also interpolate variables will be able to use
the new <code>\qq{$var}</code> feature.</p>
<p>Note for those who are thinking we should just stick with
Perl 5 interpolation rules:  We have to allow <code>%</code> to introduce
interpolation now because individual hash values are no longer named
with <code>$foo{$bar}</code>, but rather <code>%foo{$bar}</code>.  So we might as well
allow interpolation of complete hashes.</p>
<p>
<h3><a href="http://dev.perl.org/rfc/251.html" name="rfc251">
RFC 251: Interpolation of Class Method Calls</a></h3>
<p>Class method calls are relatively rare (except for constructors, which
will be rarely interpolated).  So rather than scanning for identifiers
that might introduce a class, I think we should just depend on expression
interpolation instead:</p>
<pre>
    &quot;There are $(Dog.numdogs) dogs.&quot;</pre>
<p>
<h3><a href="http://dev.perl.org/rfc/252.html" name="rfc252">RFC 252
: Interpolation of Subroutines</a></h3>
<p>I think subroutines should interpolate, provided they're introduced
with the funny character.  (On the other hand, how hard is <code>$(sunset
$date)</code> or <code>@(sunset $date)</code>?  On the gripping hand, I like the
consistency of <code>&amp;</code> with <code>$</code>, <code>@</code> and <code>%</code>.)</p>
<p>I think the parens are required, since in Perl 6,
scalar <code>&amp;sub</code> will just return a reference, and require parens if you
really want to deref the sub ref.  (It's true that a subroutine can be called
without parens when used as a list operator, but you can't interpolate
those without a funny character.)</p>
<p>For those worried about the use of <code>&amp;</code> for signature checking suppression, we
should point out that <code>&amp;</code> will no longer be the way to suppress
signature checking in Perl 6, so it doesn't matter.</p>
<p>
<h3><a href="http://dev.perl.org/rfc/327.html" name="rfc327">RFC 327: <code>\
v</code> for Vertical Tab</a></h3>
<p>I think the opportunity cost of not reserving <code>\v</code> for future use is
too high to justify the small utility of retaining compatibility with
a feature virtually nobody uses anymore.  For instance, I almost used
<code>\v</code> and <code>\V</code> for switching into and out of verbatim (single-quote)
mode, until I decided to unify that with quoting syntax and use
<code>\qq{}</code> and <code>\q{}</code> instead.</p>
<p>
<h3><a href="http://dev.perl.org/rfc/328.html" name="rfc328">RFC 328: Single quotes don't interpolate \' and \\</a></h3>
<p>I think hyperquotes will be possible with a declaration of your quoting
rules, so we're not going to change the basic single-quote rules (except
for supporting <code>\q</code>).</p>
<p>
<h3><a name="otherdecisionsaboutliterals">Other Decisions About Literals</a></h3>
<p>
<h3><a name="scopingofletal">Scoping of \L et al.</a></h3>
<p>I'd like to get rid of the gratuitously ugly <code>\E</code> as an end-of-scope
marker.  Instead, if any sequence such as <code>\L</code>, <code>\U</code> or <code>\Q</code>
wishes to impose a scope, then it must use curlies around that scope:
<code>\L{</code><em>stuff</em><code>}</code>, <code>\U{</code><em>stuff</em><code>}</code> or 
<code>\Q{</code><em>stuff</em><code>}</code>.
Any literal curlies contained in <em>stuff</em> must be backslashed.
(Curlies as syntax (such as for subscripts) should nest correctly.)</p>
<p>
<h3><a name="barewordpolicy">Bareword Policy</a></h3>
<p>There will be no barewords in Perl 6.  Any bare name that is a
declared package name will be interpreted as a class object that
happens to stringify to the package name.  All other bare names
will be interpreted as subroutine or method calls.  For nonstrict
applications, undefined subroutines will autodefine themselves to
return their own name.  Note that in <code>${name}</code> and friends, the name
is considered autoquoted, not a bareword.</p>
<p>
<h3><a name="weirdbrackets">Weird brackets</a></h3>
<p>Use of brackets to disambiguate</p>
<pre>
    &quot;${foo[bar]}&quot;</pre>
<p>from</p>
<pre>
    &quot;${foo}[bar]&quot;</pre>
<p>will no longer be supported.  Instead, the expression parser will always
grab as much as it can, and you can make it quit at a particular point
by interpolating a null string, specified by <code>\Q</code>:</p>
<pre>
    &quot;$foo\Q[bar]&quot;</pre>
<p>
<h3><a name="specialtokens">Special tokens</a></h3>
<p>Special tokens will turn into either POD directives or lexically
scoped OO methods under the <code>MY</code> pseudo-package:</p>
<pre>
    Old                 New
    ---                 ---
    __LINE__            MY.line
    __FILE__            MY.file
    __PACKAGE__         MY.package
    __END__             =begin END      (or remove)
    __DATA__            =begin DATA</pre>
<p>
<h3><a name="heredocsyntax">Heredoc Syntax</a></h3>
<p>I think heredocs will require quotes around any identifier, and we
need to be sure to support <code> &lt;&lt; qq(END) </code> style quotes.  Space is now
allowed before the (required) quoted token.  Note that custom quoting
is now possible, so if you define a fancy <code>qh</code> operator for your
fancy hyperquoting algorithm, then you could say <code> &lt;&lt;qh(END) </code>.</p>
<p>It is still the case that you can say <code> &lt;&lt;&quot;&quot; </code> to grab everything
up to the next blank line.  However, Perl 6 will consider any line
containing only spaces, tabs, etc., to be blank, not just the ones that
immediately terminate with newline.</p>
<p>
<hr>
<h3><a name="context">Context</a></h3>
<p>In Perl 5, a lot of contextual processing was done at run-time,
and even then, a given function could only discover whether it was in
void, scalar or list context.  In Perl 6, we will extend the notion of
context to be more amenable to both compile-time and run-time analysis.
In particular, a function or method can know (theoretically even at
compile time) when it is being called in:</p>
<pre>
    Void context
    Scalar context
        Boolean context
        Integer context
        Numeric context
        String context
        Object context
    List context
        Flattening list context (true list context).
        Non-flattening list context (list of scalars/objects)
        Lazy list context (list of closures)
        Hash list context (list of pairs)</pre>
<p>(This list isn't necessarily exhaustive.)</p>
<p>Each of these contexts (except maybe void) corresponds to a way in
which you might declare the parameters of a function (or the left side
of a list assignment) to supply context to the actual argument list
(or right side of a list assignment).  By default, parameters will
supply object context, meaning individual parameters expect to be
aliases to the actual parameters, and even arrays and hashes don't do
list context unless you explicitly declare them to.  These aren't cast
in stone yet (or even Jello), but here are some ideas for possible
parameter declarations corresponding to those contexts:</p>
<pre>
    Scalar context
        Boolean context                 bit $arg
        Integer context                 int $arg
        Numeric context                 num $arg
        String context                  str $arg
        Object context                  $scalar, %hash, Dog @canines, &amp;foo
    List context
        Flattening list context         *@args
        Non-flattening list context     $@args
        Lazy list context               &amp;@args
        Hash list context               *%args</pre>
<p>(I also expect unary * to force flattening of arrays in rvalue contexts.
This is how we defeat the type signature in Perl 6, instead of relying on the
initial ampersand.  So instead of Perl 5's <code>&amp;push(@list)</code>, you could just
say <code>push *@list</code>, and it wouldn't matter what <code>push</code>'s parameter signature
said.)</p>
<p>It's also possible to define properties to modify formal arguments,
though that can get clunky pretty quickly, and I'd like to have
a concise syntax for the common cases, such as the last parameter
slurping a list in the customary fashion.  So the signature for the
built-in <code>push</code> could be</p>
<pre>
    sub push (@array, *@pushees);</pre>
<p>Actually, the signature might just be <code>(*@pushees)</code>, if <code>push</code> is really
a method in the <code>ARRAY</code> class, and the object is passed implicitly:</p>
<pre>
    class ARRAY;
    sub .push (*@pushees);
    sub .pop (;int $numtopop);
    sub .splice (int $offset, int $len, *@repl);</pre>
<p>But we're getting ahead of ourselves.</p>
<p>By the way, all function and method parameters (other than the object
itself) will be considered read-only unless declared with the <code>rw</code>
property.  (List assignments will default the other way.)  This will
prevent a great deal of the wasted motion current Perl implementations
have to go through to make sure all function arguments are valid
lvalues, when most of them are in fact never modified.</p>
<p>Hmm, we're still getting ahead of ourselves.  Back to contexts.</p>
<p>
<h3><a name="referencesarenowtransparenttobooleancontext">References are now transparent to b
oolean context</a></h3>
<p>References are no longer considered to be ``always true'' in Perl 6.
Any type can overload its <code>bit()</code> casting operator, and any type that
hasn't got a <code>bit()</code> of its own inherits one from somewhere else, if
only from class UNIVERSAL.  The built-in bit methods have the expected
boolean semantics for built-in types, so arrays are still true if
they have something in them, strings are true if they aren't <code>&quot;&quot;</code> or <code>&qu
ot;0&quot;</code>, 
etc.</p>
<p>
<hr>
<h3><a name="lists">Lists</a></h3>
<p>
<h3><a href="http://dev.perl.org/rfc/175.html" name="rfc175">RFC 175: Add <code>list</code> keyword to force list context (like <code>scalar</code>)</a></h3>
<p>Another RFC rescued from the compost pile.  In Perl 6, type names will
identify casting functions in general.  (A casting function merely forces
context -- it's a no-op unless the actual context is different.)  In Perl 6,
a list used in a scalar context will automatically turn itself into a
reference to the list rather than returning the last element.  (A subscript
of <code>[-1]</code> can always be used to get the last element explicitly, if that's
actually desired.  But that's a rarity, in practice.)  So it works out
that the explicit list composer:</p>
<pre>
    [1,2,3]</pre>
<p>is syntactic sugar for something like:</p>
<pre>
    scalar(list(1,2,3));</pre>
<p>Depending on whether we continue to make a big deal of the list/array
distinction, that might actually be spelled:</p>
<pre>
    scalar(array(1,2,3));</pre>
<p>Other casts might be words like <code>hash</code> (supplying a pairlist context)
and <code>objlist</code> (supplying a scalar context to a list of expressions).
Maybe even the optional <code>sub</code> keyword could be considered a cast on
a following block that might not otherwise be considered a closure in
context.  Perhaps <code>sub</code> is really spelled <code>lazy</code>.  In which case, we
might even have a <code>lazylist</code> context to supply a lazy context to a list
of expressions.</p>
<p>And of course, you could use standard casts like <code>int()</code>, <code>num()</code>,
and <code>str()</code>, when you want to be explicit about such contexts at
compile time.  (Perl 5 already has these contexts, but only at run
time.)  Note also that, due to the relationship between unary functions
and methods, <code>$foo.int</code>, <code>$foo.num</code>, and <code>$foo.str</code> will be just
a different way to write the same casts.</p>
<p>Lest you worry that your code is going to be full of casts, I should
point out that you won't need to use these casts terribly often
because each of these contexts will typically be implied by the
signature of the function or method you're calling.  (And Perl will
still be autoconverting for you whenever it makes sense.)  More on
that in Apocalypse 6, Subroutines.  If not sooner.</p>
<p>So, while boolean context might be explicitly specified by writing:</p>
<pre>
    if (bit $foo)</pre>
<p>or</p>
<pre>
    if ($foo.bit)</pre>
<p>you'd usually just write it as in Perl 5:</p>
<pre>
    if ($foo)</pre>
<p>
<h3><a name="otherdecisionsaboutlists">Other Decisions about Lists</a></h3>
<p>Based on some of what we've said, you can see that we'll have
the ability to define various kinds of lazily generated lists.
The specific design of these operators is left for subsequent
Apocalypses, however.  I will make one observation here, that I think
some of the proposals for how array subscripts are generated should
be generalized to work outside of subscripts as well.  This may place
some constraints on the general use of the <code>:</code> character in places
where an operator is expected, for instance.</p>
<p>As mentioned above, we'll be having several different kinds of list
context.  In particular, there will be a hash list context that assumes
you're feeding it pairs, and if you don't feed it pairs, it will
assume the value you feed it is a key, and supply a default value.
There will likely be ways to get hashes to default to interesting
values such as 0 or 1.</p>
<p>In order to do this, the <code>=&gt;</code> operator has to at least mark its
left operand as a key.  More likely, it actually constructs a pair object
in Perl 6.  And the <code>{ foo =&gt; $bar }</code> list composer will be required to
use <code>=&gt;</code> (or be in a hashlist context), or it will instead be interpreted
as a closure without a <code>sub</code>.  (You can always use an explicit <code>sub</code> or
<code>hash</code> to cast the brackets to the proper interpretation.)</p>
<p>I've noticed how many programs use <code>qw()</code> all over the place (much
more frequently than the input operator, for instance), and I've
always thought <code>qw()</code> was kind of ugly, so I'd like to replace it with
something prettier.  Since the input operator is using up a pair
of perfectly good bracketing characters for little syntactic gain,
we're going to steal those and make them into a qw-like list composer.
In ordinary list context, the following would be identical:</p>
<pre>
    @list = &lt; foo $bar %baz blurch($x) &gt;;
    @list = qw/ foo $bar %baz blurch($x) /;                     # same as this
    @list = ('foo', '$bar', '%baz', 'blurch($x)');              # same as this</pre>
<p>But in hashlist context, it might be equivalent to this:</p>
<pre>
    %list = &lt; foo $bar %baz blurch($x) &gt;;
    %list = (foo =&gt; 1, '$bar' =&gt; 1, '%baz' = 1, blurch =&gt; $x);  # same as this</pre>
<p>
<hr>
<h3><a name="files">Files</a></h3>
<p>Basically, file handles are just objects that can be used as iterators,
and don't belong in this chapter anymore.</p>
<p>
<h3><a href="http://dev.perl.org/rfc/34.html" name="rfc034">RFC 034: Angle Brackets Should Not Be Used for File Globbing</a></h3>
<p>Indeed, they won't be.  In fact, angle brackets won't be used for input
at all, I suspect.  See below.  Er, above.</p>
<p>
<h3><a href="http://dev.perl.org/rfc/51.html" name="rfc051">RFC 051: Angle Brackets Should Accept Filenames and Lists</a></h3>
<p>There is likely to be no need for an explicit input operator in Perl 6,
and I want the angles for something else.  I/O handles are a subclass
of iterators, and I think general iterator variables will serve the purpose
formerly served by the input operator, particularly since they can be
made to do the right Thing in context.  For instance, to read from
standard input, it will suffice to say</p>
<pre>
    while ($STDIN) { ... }</pre>
<p>and the iterator will know it should assign to <code>$_</code>, because it's in a Boolean
context.</p>
<p>I read this RFC more as requesting a generic way to initialize an iterator
according to the type of the iterator.  The trick in this case is to
prevent the re-evaluation of the spec every time -- you don't want
to reopen the file every time you read a line from it, for instance.  There
will be standard ways to suppress evaluation in Perl 6, both from the
standpoint of the caller and the callee.  In any case, the model is that
an anonymous subroutine is passed in, and called only when appropriate.
So an iterator syntax might prototype its argument to be an anonymous sub,
or the user might explicitly pass an anonymous sub, or both.  In any event,
the <code>sub</code> keyword will be optional in Perl 6, so things like:</p>
<pre>
    while (file {LIST}) { ... }</pre>
<p>can be made to defer evaluation of LIST to the appropriate moment (or moments,
if LIST is in turn generating itself on the fly).  For appropriate parameter
declarations I suppose even the brackets could be scrapped.</p>
<p>
<hr>
<h3><a name="properties">Properties</a></h3>
<p>Variables and values of various types have various kinds of data
attributes that are naturally associated with them by virtue of their type.
You know a dog comes equipped with a wag, hopefully attached to a tail.
That's just part of doghood.</p>
<p>Many times, however, you want the equivalent of a Post-It(r) note, so
you can temporarily attach bits of arbitrary information to some unsuspecting
appliance that (though it wasn't designed for it) is nevertheless the
right place to put the note.  Similarly, variables and values in Perl 6
allow you to attach arbitrary pieces of information known as ``properties.''
In essence, any object in Perl can have an associated hash containing
these properties, which are named by the hash key.</p>
<p>Some of these properties are known at compile time, and don't actually
need to be stored with the object in question, but can actually be stored instead
in the symbol table entry for the variable in question.   (Perl still makes it
appear as though these values are attached to the object.)  Compile-time
properties can therefore be attached to variables of any type.</p>
<p>Run-time properties really are associated with the object in question,
which implies some amount of overhead.  For that reason, intrinsic data
types like <code>int</code> and <code>num</code> may or may not allow run-time properties.
In cases where it is allowed, the intrinsic type must generally be
promoted to its corresponding object type (or wrapped in an object
that delegates back to the original intrinsic for the actual value).
But you really don't want to promote an array of a million bits to an
array of a million objects just because you had the hankering to put a
sticky note on one of those bits, so in those cases it's likely to be
disallowed, or the bit is likely to be cloned instead of referenced,
or some such thing.</p>
<p>Properties may also be attached to subroutines.</p>
<p>In general, you don't set or clear properties directly -- instead you
call an accessor method to do it for you.  If there is no method of
that name, Perl will assume there was one that just sets or clears a
property with the same name as the method.  However, using accessor
methods to set or clear properties allows us to define synthetic
properties.  For instance, there might be a real <code>constant</code> property
that you could attach to a variable.  Certain variables (such as
those in a function prototype) might have <code>constant</code> set by default.
In that case, setting a synthetic property such as <code>rw</code> might clear
the underlying <code>constant</code> property.</p>
<p>A property may be attached to the foregoing expression by means of the ``is''
keyword.  Here's a compile-time property set on a variable:</p>
<pre>
    my int $pi is constant = 3;</pre>
<p>Here's a run-time property set on a return value:</p>
<pre>
    return 0 is true;</pre>
<p>Whether a property is applied to a variable at compile time or a value
at run-time depends on whether it's in lvalue or rvalue context.
(Variable declarations are always in lvalue context even when you
don't assign anything to them.)</p>
<p>The ``<code>is</code>'' works just like the ``<code>.</code>'' of a method call, except that
the return value is the object on the left, not the return value of
the method, which is discarded.</p>
<p>As it happens, the ``<code>is</code>'' is optional in cases where an operator is already
expected.  So you might see things like:</p>
<pre>
    my int $pi constant = 3;
    return 0 true;</pre>
<p>In this case, the methods are actually being parsed as postfix
operators.  (However, we may make it a stricture that you may omit the
<code>is</code> only for predeclared property methods.)</p>
<p>Since these actually are method calls, you can pass arguments in addition
to the object in question:</p>
<pre>
    my int @table is dim(366,24,60);</pre>
<p>Our examples above are assuming an argument of <code>(1)</code>:</p>
<pre>
    my int $pi is constant(1) = 3;
    return 0 is true(1);</pre>
<p>Since the ``<code>is</code>'' is optional in the common cases, you can stack
multiple properties without repeating the ``<code>is</code>.''</p>
<pre>
    my int $pi is shared locked constant optimize($optlevel) = 3;</pre>
<p>(Note that these methods are called on the <code>$pi</code> variable at compile
time, so it behooves you to make sure everything you call is defined.
For instance, <code>$optlevel</code> needs to be known at compile-time.)</p>
<p>Here are a list of property ideas stolen from Damian.  (I guess that
makes it intellectual property theft.)  Some of the names have been
changed to protect the (CS) innocent.</p>
<pre>
    # Subroutine attributes...
    sub name is rw { ... }                      # was lvalue</pre>
<pre>
    my sub rank is same { ... }                 # was memoized</pre>
<pre>
    $snum = sub is optimize(1) { ... };         # &quot;is&quot; required here</pre>
<pre>
    # Variable attributes...
    our $age is constant = 21;                  # was const</pre>
<pre>
    my %stats is private;
    my int @table is dim(366,24,60);</pre>
<pre>
    $arrayref = [1..1000000] is computed Purpose('demo of anon var attrs');</pre>
<pre>
    sub choose_rand (@list is lazy) { return $list[rand @list] }
                                                # &amp;@list notation is likely</pre>
<pre>
    $self = $class.bless( {name=&gt;$name, age=&gt;$age} is Initialized );</pre>
<pre>
    # Reference attributes...
    $circular = \$head is weak;</pre>
<pre>
    # Literal attributes...
    $name = &quot;Damian&quot; is Note(&quot;test data only&quot;);
    $iohandle = open $filename is dis(qw/para crlf uni/) or die;
    $default = 42 is Meaning(&lt;&lt;OfLife);
                             The Answer
                             OfLife</pre>
<pre>
    package Pet is interface;</pre>
<pre>
    class Dog inherits('Canine') { ... }</pre>
<pre>
    print $data{key is NoteToSelf('gotta get a better name for this key')};</pre>
<p>(I don't agree with using properties for all of these things, but it's
pretty amazing how far into the ground you can drive it.)</p>
<p>Property names should start with an identifier letter (which includes
Unicode letters and ideographs).  The parsing of the arguments (if any)
is controlled by the signature of the method in question.  Property
method calls without a ``.'' always modify their underlying property.</p>
<p>If called as an ordinary method (with a ``.''), the property value
is returned without being modified.  That value could then be modified by a run-time property.  For instance, <code>$pi.constant</code>
would return <code>1</code> rather than the value of <code>$pi</code>, so we get:</p>
<pre>
    return $pi.constant is false;       # &quot;1 but false&quot; (not possible in Perl 5)</pre>
<p>On the other hand, if you omit the dot, something else happens:</p>
<pre>
    return $pi constant is false;       # 3 but false (and 3 is now very constant)</pre>
<p>Here are some more munged Damian examples:</p>
<pre>
    if (&amp;name.rw) { ... }</pre>
<pre>
    $age++ unless $age.constant;</pre>
<pre>
    $elements = return reduce $^ * $^, *@table.dim;</pre>
<pre>
    last if ${self}.Initialized;</pre>
<pre>
    print &quot;$arrayref.Purpose() is not $default.Meaning()\n&quot;;
</pre>
<pre>
    print %{$self.X};    # print hash referred to by X attribute of $self
    print %{$self}.X;    # print X attribute of hash referred to by $self
    print %$self.X;      # print X attribute of hash referred to by $self</pre>
<p>As with the dotless form, if there is no actual method corresponding to
the property, Perl pretends there's a rudimentary one returning the actual
property.</p>
<p>Since these methods return the properties (except when overridden by
dotless syntax), you can temporize a property just as you can any method,
provided the method itself allows writing:</p>
<pre>
    temp $self.X = 0;</pre>
<p>Note that</p>
<pre>
    temp $self is X = 0;</pre>
<p>would assign to 0 to <code>$self</code> instead.  (Whether it actually makes sense to set the
compile-time X property at run time on the <code>$self</code> variable is anybody's guess.)</p>
<p>Note that by virtue of their syntax, properties cannot be set by
interpolation into a string.  So, happily:</p>
<pre>
    print &quot;My $variable is foobar\n&quot;;</pre>
<p>does not attempt to set the <code>foobar</code> property on <code>$variable</code>.</p>
<p>The ``<code>is</code>'' keyword binds with the same precedence as ``.'', even when it's
not actually there.</p>
<p>Note that when you say <code>$foo.bar</code>, you get <code>$foo</code>'s compile-time
property if there is one (which is known at compile time, duh).
Otherwise it's an ordinary method call on the value (which looks for
a run-time property only if a method can't be found, so it shouldn't
impact ordinary method call overhead.)</p>
<p>To get to the properties directly without going through the method interface,
use the special <code>btw</code> method, which returns a hash ref to the properties
hash.</p>
<pre>
    $foo.btw{constant}</pre>
<p>Note that synthetic properties won't show up there!</p>
<p>None of the property names in this Apocalypse should be taken as final.
We will decide on actual property names as we proceed through the series.</p>
<p>Well, that's it for Apocalypse 2.  Doubtless there are some things I
should have decided here that I didn't yet, but at least we're making
progress.  Well, at least we're moving in some direction or other.
Now it's time for us to dance the Apocalypso, in honor of Jon Orwant and
his new wife.</p>

        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1496" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2001/05/01/expressions.html" rel="bookmark">Reversing Regular Expressions</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Pete Sergeant</span> on <abbr class="published" title="2001-05-01T00:00:00-08:00">May  1, 2001 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            <!-- Using Regular Expressions -->

<br />


<p>Regular Expressions are arguably one of Perl's most useful and powerful
tools. The ability to match complex strings is one of the things that makes
Perl the effective "Practical Extraction and Reporting Language" that it is.
The regular expression engine is highly optimised and thus very fast,
although in some situations people fail to use it in the most effective
manner.

<p>For example, imagine a case where you have a collection of very long
lines
from a log file, that each have a four digit year (starting with 19)
somewhere near the end.

<p>One would normally say something like:
<pre>
# Match any occurrence of 19xx that's not followed by another one
if ($string =~ /(19\d\d)(?!.*19\d\d)/) {$date = $1}

or, better:

if ($string =~ /.*(19\d\d)/) {$date = $1}
</pre>

<p>However, in this situation, the regular expression engine has to go
through
all the string, remembering any matches it finds and discarding them any
time it finds a new match, until it reaches the end of the string. If you
have long log lines, this can be highly inefficient, and comparatively slow.
But is there another way to do it? (Hint: With Perl, There's Always More
Than One Way To Do It)

<p>Unless you're a regular on IRC or <A
HREF="www.perlmonks.com">perlmonks.com </A>, or attended <A
HREF="http://yapc.org/Europe/">YAPC::Europe</A>, it's quite possible
that you've never heard of (a) Jeff Pinyan (aka Japhy) and (b) his
simple and elegant solution to getting around this problem. He dubbed
these solutions reversed regular expressions, or sexeger.

<p>Instead of going through the whole string looking for the last match,
wouldn't it be a better idea to work from the back of the string and take
the first match that is found? At the moment, Perl doesn't provide a built
in method for doing this, but it's surprisingly easy to emulate one. To
quote the lightning talk Mr Pinyan wrote for me to give at YAPC::E "Reverse
the input! Reverse the regex! Reverse the match!".

<p>And so that's exactly what we'll do:
<pre>
sub get_date {
    $_ = scalar reverse($_[0]); # Reverse whatever string we were passed
    /(\d\d91)/;                 # Look for the first occurrence of a xx91 (19xx reversed)
    return scalar reverse $1;   # Reverse back whatever we found and return it
}
</pre>
<p>Obviously, we're performing two more functions in this example, two
calls of reverse. Reverse however appears to be very efficient, and in
benchmarks that were run (details below), this seemed not to be a problem.
To test if this really would be significantly faster, I used a 10,000
character string, and ran the regex 10000 times on it. Here's the code
used to test it:
<pre>
$la = [our 10000 character string]
...
use Benchmark;
$t = timeit("10000",  sub { $_ = $la; /.*(19\d\d)/; });
print "Greedy took:",timestr($t), "\n";
$t = timeit("10000",  sub { $_ = $la; /(19\d\d)(?!.*19\d\d)/;});
print "Lookahead took:",timestr($t), "\n";
$t = timeit("10000",  sub { $_ = reverse($la); /(\d\d91)/;  });
print "Sexeger took:",timestr($t), "\n";
</pre>
<p>
The first example,
with its look ahead assertion, took four hundred seconds, as the look ahead
assertion is a major time sink. The second example took 1.5 seconds. The
reversed method managed however to shave three quarters of a second off
that, and become 0.75 seconds. To summarise:
<table>
<tr><th>Method</th><th>Time</th></tr>
<tr><td><code>/(19\d\d)(?!.*19\d\d)/</code></td><td>400</td></tr>
<tr><td><code>/.*(19\d\d)/</code></td><td>1.5</td></tr>
<tr><td>sexeger</td><td>0.75</td></tr>
</table>

<p>However, performance gains are not the only good use for reversed
regular expression, as one can also use them to solve a few other
common problems that Perl doesn't handle easily. If you've all read
the Frequently Asked Questions included with Perl, which I'm <B>sure</B>
you have, then you'll have seen a particularly good example in Section
5 (perldoc perlfaq5) by Andrew Johnson - "How can I output my numbers
with commas added?".
<pre>
sub commify {
my $input = shift;
$input = reverse $input;
$input =~ s<(\d\d\d)(?=\d)(?!\d*\.)><$1,>g;
return scalar reverse $input;
}
</pre>
<p>One of my personal favourite regex tools is zero-width look ahead
assertions, as in the very first example (it's worth noting that that's a
<B>negative</B> zero-width look ahead assertion). For people who haven't scoured
<I>perldoc perlre</I>, this allows you to state that a pattern has to exist in
front of your position, without actually matching it. Perhaps an example
would help illustrate: <code> /ab(?=.+e)cd/ </code>
 will match <code>"abcde"</code> but not <code>"abecd"</code> or <code>"abcd"</code>. 
 Sadly, it's not possible
to do variable length zero-width look behind assertions with the
current Regular Expression Engine. However, if we apply sexeger
principles to it, as suggested by Anthony Guselnikov, it suddenly
becomes easy. If we want to match the string <code>"def"</code>, as long as it was
preceded by the letter 'a', we can say:
<pre>
sub nlba {
$_ = scalar reverse $_[0];
print "Success\n" if /fed(?=.*a)/;
}
</pre>
<p>Reversing Regular Expressions is a powerful and effective tool in any
programmers arsenal. I hope that I've managed to illustrate the utility that
this simple and elegant solution offers. Some overhead in programmer time,
and in processing time is required to use them, and so I'd suggest that you
evaluate using them on a case by case basis.

<p>For more information, visit the homepage at <a
href="http://www.pobox.com/~japhy/sexeger">http://www.pobox.com/~japhy/sexeg
er</a>

        </div>



    </div>
    <div class="asset-footer"></div>
</div>




                            <div class="content-nav">
                                <a href="/pub/2001/04/">&laquo; April 2001</a> |
                                <a href="/pub/">Main Index</a> |
                                <a href="/pub/archives.html">Archives</a>
                                | <a href="/pub/2001/06/">June 2001 &raquo;</a>
                            </div>


                        </div>
                    </div>


                    <div id="beta">
    <div id="beta-inner">


    
    <div class="widget-what-is-perl widget">
    <div class="widget-content widget-content-what-is-perl">
       Visit the home of the  Perl programming language: <a href="http://www.perl.org/">Perl.org</a
    </div>
</div>
<div class="widget-find-out-more widget-archives widget">
    <div class="widget-content">
        <ul>
            <li><a href="http://www.perl.org/get.html">Download</a></li>
            <li><a href="http://perldoc.perl.org/">Documentation</a></li>
            <li><a href="http://blogs.perl.org/">Perl Bloggers</a></li>
            <li><a href="http://news.perlfoundation.org/">Foundation News</a></li>
        </ul>
    </div>
</div><div class="widget-tcpc widget">
<h3 class="widget-header">Sponsored by</h3>
    <div class="widget-content">
        <a href="http://training.perl.com/" alt="Perl Training" target="_blank"><img src="/i/tcpc.png" width="150" height="50"></a>
    </div>
</div>

<div class="widget-syndication widget">
    <div class="widget-content">
        <ul>
            <li><img src="/mt-static/images/status_icons/feed.gif" alt="Subscribe to feed" width="9" height="9" /> <a href="/pub/atom.xml">Subscribe to this website's feed</a></li>

        </ul>
    </div>
</div>
<div class="widget-archive-monthly widget-archive widget">
    <h3 class="widget-header">Monthly <a href="/pub/archives.html">Archives</a></h3>
    <div class="widget-content">
        <ul>
        
            <li><a href="/pub/2014/02/">February 2014 (1)</a></li>
        
    
        
            <li><a href="/pub/2014/01/">January 2014 (1)</a></li>
        
    
        
            <li><a href="/pub/2013/10/">October 2013 (1)</a></li>
        
    
        
            <li><a href="/pub/2013/01/">January 2013 (1)</a></li>
        
    
        
            <li><a href="/pub/2012/12/">December 2012 (1)</a></li>
        
    
        
            <li><a href="/pub/2012/11/">November 2012 (1)</a></li>
        
    
        
            <li><a href="/pub/2012/10/">October 2012 (2)</a></li>
        
    
        
            <li><a href="/pub/2012/08/">August 2012 (2)</a></li>
        
    
        
            <li><a href="/pub/2012/06/">June 2012 (11)</a></li>
        
    
        
            <li><a href="/pub/2012/05/">May 2012 (18)</a></li>
        
    
        
            <li><a href="/pub/2012/04/">April 2012 (17)</a></li>
        
    
        
            <li><a href="/pub/2012/02/">February 2012 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/12/">December 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/09/">September 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/08/">August 2011 (2)</a></li>
        
    
        
            <li><a href="/pub/2011/06/">June 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/05/">May 2011 (3)</a></li>
        
    
        
            <li><a href="/pub/2011/04/">April 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/03/">March 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/02/">February 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/01/">January 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2010/11/">November 2010 (1)</a></li>
        
    
        
            <li><a href="/pub/2010/10/">October 2010 (2)</a></li>
        
    
        
            <li><a href="/pub/2010/09/">September 2010 (1)</a></li>
        
    
        
            <li><a href="/pub/2010/08/">August 2010 (3)</a></li>
        
    
        
            <li><a href="/pub/2010/07/">July 2010 (2)</a></li>
        
    
        
            <li><a href="/pub/2010/04/">April 2010 (2)</a></li>
        
    
        
            <li><a href="/pub/2010/03/">March 2010 (4)</a></li>
        
    
        
            <li><a href="/pub/2008/05/">May 2008 (1)</a></li>
        
    
        
            <li><a href="/pub/2008/04/">April 2008 (2)</a></li>
        
    
        
            <li><a href="/pub/2008/03/">March 2008 (1)</a></li>
        
    
        
            <li><a href="/pub/2008/02/">February 2008 (1)</a></li>
        
    
        
            <li><a href="/pub/2008/01/">January 2008 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/12/">December 2007 (2)</a></li>
        
    
        
            <li><a href="/pub/2007/09/">September 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/08/">August 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/07/">July 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/06/">June 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/05/">May 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/04/">April 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/03/">March 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/02/">February 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/01/">January 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/12/">December 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/11/">November 2006 (2)</a></li>
        
    
        
            <li><a href="/pub/2006/10/">October 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/09/">September 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/08/">August 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/07/">July 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/06/">June 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/05/">May 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/04/">April 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/03/">March 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/02/">February 2006 (4)</a></li>
        
    
        
            <li><a href="/pub/2006/01/">January 2006 (4)</a></li>
        
    
        
            <li><a href="/pub/2005/12/">December 2005 (4)</a></li>
        
    
        
            <li><a href="/pub/2005/11/">November 2005 (3)</a></li>
        
    
        
            <li><a href="/pub/2005/10/">October 2005 (2)</a></li>
        
    
        
            <li><a href="/pub/2005/09/">September 2005 (2)</a></li>
        
    
        
            <li><a href="/pub/2005/08/">August 2005 (9)</a></li>
        
    
        
            <li><a href="/pub/2005/07/">July 2005 (8)</a></li>
        
    
        
            <li><a href="/pub/2005/06/">June 2005 (9)</a></li>
        
    
        
            <li><a href="/pub/2005/05/">May 2005 (8)</a></li>
        
    
        
            <li><a href="/pub/2005/04/">April 2005 (7)</a></li>
        
    
        
            <li><a href="/pub/2005/03/">March 2005 (6)</a></li>
        
    
        
            <li><a href="/pub/2005/02/">February 2005 (7)</a></li>
        
    
        
            <li><a href="/pub/2005/01/">January 2005 (6)</a></li>
        
    
        
            <li><a href="/pub/2004/12/">December 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/11/">November 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/10/">October 2004 (5)</a></li>
        
    
        
            <li><a href="/pub/2004/09/">September 2004 (9)</a></li>
        
    
        
            <li><a href="/pub/2004/08/">August 2004 (6)</a></li>
        
    
        
            <li><a href="/pub/2004/07/">July 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/06/">June 2004 (6)</a></li>
        
    
        
            <li><a href="/pub/2004/05/">May 2004 (7)</a></li>
        
    
        
            <li><a href="/pub/2004/04/">April 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/03/">March 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/02/">February 2004 (9)</a></li>
        
    
        
            <li><a href="/pub/2004/01/">January 2004 (7)</a></li>
        
    
        
            <li><a href="/pub/2003/12/">December 2003 (4)</a></li>
        
    
        
            <li><a href="/pub/2003/11/">November 2003 (7)</a></li>
        
    
        
            <li><a href="/pub/2003/10/">October 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2003/09/">September 2003 (6)</a></li>
        
    
        
            <li><a href="/pub/2003/08/">August 2003 (7)</a></li>
        
    
        
            <li><a href="/pub/2003/07/">July 2003 (9)</a></li>
        
    
        
            <li><a href="/pub/2003/06/">June 2003 (9)</a></li>
        
    
        
            <li><a href="/pub/2003/05/">May 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2003/04/">April 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2003/03/">March 2003 (10)</a></li>
        
    
        
            <li><a href="/pub/2003/02/">February 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2003/01/">January 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2002/12/">December 2002 (5)</a></li>
        
    
        
            <li><a href="/pub/2002/11/">November 2002 (9)</a></li>
        
    
        
            <li><a href="/pub/2002/10/">October 2002 (7)</a></li>
        
    
        
            <li><a href="/pub/2002/09/">September 2002 (11)</a></li>
        
    
        
            <li><a href="/pub/2002/08/">August 2002 (8)</a></li>
        
    
        
            <li><a href="/pub/2002/07/">July 2002 (8)</a></li>
        
    
        
            <li><a href="/pub/2002/06/">June 2002 (4)</a></li>
        
    
        
            <li><a href="/pub/2002/05/">May 2002 (6)</a></li>
        
    
        
            <li><a href="/pub/2002/04/">April 2002 (6)</a></li>
        
    
        
            <li><a href="/pub/2002/03/">March 2002 (7)</a></li>
        
    
        
            <li><a href="/pub/2002/02/">February 2002 (5)</a></li>
        
    
        
            <li><a href="/pub/2002/01/">January 2002 (8)</a></li>
        
    
        
            <li><a href="/pub/2001/12/">December 2001 (7)</a></li>
        
    
        
            <li><a href="/pub/2001/11/">November 2001 (5)</a></li>
        
    
        
            <li><a href="/pub/2001/10/">October 2001 (9)</a></li>
        
    
        
            <li><a href="/pub/2001/09/">September 2001 (7)</a></li>
        
    
        
            <li><a href="/pub/2001/08/">August 2001 (13)</a></li>
        
    
        
            <li><a href="/pub/2001/07/">July 2001 (8)</a></li>
        
    
        
            <li><a href="/pub/2001/06/">June 2001 (13)</a></li>
        
    
        
            <li><a href="/pub/2001/05/">May 2001 (11)</a></li>
        
    
        
            <li><a href="/pub/2001/04/">April 2001 (9)</a></li>
        
    
        
            <li><a href="/pub/2001/03/">March 2001 (8)</a></li>
        
    
        
            <li><a href="/pub/2001/02/">February 2001 (8)</a></li>
        
    
        
            <li><a href="/pub/2001/01/">January 2001 (8)</a></li>
        
    
        
            <li><a href="/pub/2000/12/">December 2000 (6)</a></li>
        
    
        
            <li><a href="/pub/2000/11/">November 2000 (10)</a></li>
        
    
        
            <li><a href="/pub/2000/10/">October 2000 (10)</a></li>
        
    
        
            <li><a href="/pub/2000/09/">September 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/2000/08/">August 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/2000/07/">July 2000 (5)</a></li>
        
    
        
            <li><a href="/pub/2000/06/">June 2000 (7)</a></li>
        
    
        
            <li><a href="/pub/2000/05/">May 2000 (7)</a></li>
        
    
        
            <li><a href="/pub/2000/04/">April 2000 (3)</a></li>
        
    
        
            <li><a href="/pub/2000/03/">March 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/2000/02/">February 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/2000/01/">January 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/1999/12/">December 1999 (6)</a></li>
        
    
        
            <li><a href="/pub/1999/11/">November 1999 (6)</a></li>
        
    
        
            <li><a href="/pub/1999/10/">October 1999 (5)</a></li>
        
    
        
            <li><a href="/pub/1999/09/">September 1999 (4)</a></li>
        
    
        
            <li><a href="/pub/1999/08/">August 1999 (3)</a></li>
        
    
        
            <li><a href="/pub/1999/07/">July 1999 (2)</a></li>
        
    
        
            <li><a href="/pub/1999/06/">June 1999 (3)</a></li>
        
    
        
            <li><a href="/pub/1999/04/">April 1999 (1)</a></li>
        
    
        
            <li><a href="/pub/1999/03/">March 1999 (1)</a></li>
        
    
        
            <li><a href="/pub/1999/01/">January 1999 (1)</a></li>
        
    
        
            <li><a href="/pub/1998/12/">December 1998 (1)</a></li>
        
    
        
            <li><a href="/pub/1998/11/">November 1998 (1)</a></li>
        
    
        
            <li><a href="/pub/1998/07/">July 1998 (2)</a></li>
        
    
        
            <li><a href="/pub/1998/06/">June 1998 (1)</a></li>
        
    
        
            <li><a href="/pub/1998/03/">March 1998 (1)</a></li>
        
        </ul>
    </div>
</div>
        
    

<div class="widget-powered widget">
    <div class="widget-content">
        <a href="http://www.movabletype.com/"><img src="/mt-static/images/bug-pbmt-white.png" alt="Powered by Movable Type 5.13-en" width="120" height="75" /></a>
    </div>
</div>



    </div>
</div>






                </div>
            </div>


            <div id="footer">
    <div id="footer-inner">
        <div id="footer-content">
            <div class="widget-powered widget">
                <div class="widget-content">
                    Powered by <a href="http://www.movabletype.com/" rel="generator">Movable Type Pro</a>
                </div>
            </div>

            <div class="widget-creative-commons widget">
                <div class="widget-content">
                    This blog is licensed under a <a href="http://creativecommons.org/licenses/by-nc-nd/3.0/">Creative Commons License</a>.
                </div>
            </div>

        </div>
    </div>
</div>



        </div>
    </div>
</body>
</html>
