<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" id="sixapart-standard">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="generator" content="Movable Type Pro 5.13-en" />
<link rel="stylesheet" href="/pub/styles.css" type="text/css" />
<link rel="start" href="/pub/" title="Home" />
<link rel="alternate" type="application/atom+xml" title="Recent Entries" href="/pub/atom.xml" />
<script type="text/javascript" src="/pub/mt.js"></script>
<!--
<rdf:RDF xmlns="http://web.resource.org/cc/"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
<Work rdf:about="/pub/">
<dc:title>Perl.com</dc:title>
<dc:description>news and views of the Perl programming language</dc:description>
<license rdf:resource="http://creativecommons.org/licenses/by-nc-nd/3.0/" />
</Work>
<License rdf:about="http://creativecommons.org/licenses/by-nc-nd/3.0/">
</License>
</rdf:RDF>
-->

<script type="text/javascript">

 var _gaq = _gaq || [];
 _gaq.push(['_setAccount', 'UA-50555-22']);
 _gaq.push(['_trackPageview']);

 (function() {
   var ga = document.createElement('script'); ga.type =
   'text/javascript'; ga.async = true;
   ga.src = ('https:' == document.location.protocol ? 'https://ssl' :
   'http://www') + '.google-analytics.com/ga.js';
   var s = document.getElementsByTagName('script')[0];
   s.parentNode.insertBefore(ga, s);
 })();

</script>
<script type='text/javascript' src='http://partner.googleadservices.com/gampad/google_service.js'></script>
<script type='text/javascript'>
GS_googleAddAdSenseService("ca-pub-4136420132070439");
GS_googleEnableAllServices();
</script>
<script type='text/javascript'>
GA_googleAddSlot("ca-pub-4136420132070439", "Perl_728x90");
</script>
<script type='text/javascript'>GA_googleFetchAds();</script>
    <title>Perl.com: December 2001 Archives</title>


    <link rel="prev" href="/pub/2001/11/" title="November 2001" />
    <link rel="next" href="/pub/2002/01/" title="January 2002" />

</head>
<body id="perl-com" class="mt-archive-listing mt-datebased-monthly-archive layout-wt">
    <div id="container">
        <div id="container-inner">


            <div id="header">
    <div id="header-inner">
        <div id="header-content">
        <span id="top_advert"> 
<!-- Put any landscape advert in here -->
<!-- Perl_728x90 -->
<script type='text/javascript'>
GA_googleFillSlot("Perl_728x90");
</script>
        </span> 



            <div id="header-name"><a href="/pub/" accesskey="1">Perl.com</a></div>
            <div id="header-description">news and views of the Perl programming language</div>




        </div>
    </div>
</div>



            <div id="content">
                <div id="content-inner">


                    <div id="alpha">
                        <div id="alpha-inner">


                            <h1 id="page-title" class="archive-title">December 2001 Archives</h1>





                            
                            <div id="entry-1650" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2001/12/p6pdigest/20011229.html" rel="bookmark">This Week on Perl 6 (23 - 29 December 2001)</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Bryan Warnock</span> on <abbr class="published" title="2001-12-29T00:00:00-08:00">December 29, 2001 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            
<h3><a name="Notes">Notes</a></h3>


<p>

You can subscribe to an email version of this summary by sending an empty
message to 
<a href="mailto:perl6-digest-subscribe@netthink.co.uk">perl6-digest-subscribe@netthink.co.uk</a>.
</p>

<p>
This summary, as with past summaries, can be found in
<a href="http://members.home.com/bcwarno/Perl6/digests/">here</a>.  Please send additions, submissions, corrections, kudos, and complaints to 
<a href="mailto:bwarnock@capita.com">bwarnock@capita.com</a>.
</p>

<p>
For more information on the Perl 6 and Parrot development efforts, visit
<a href="http://dev.perl.org/perl6/">dev.perl.org</a> and
<a href="http://www.parrotcode.org/">parrotcode.org</a>.
</p>

<p>
It was a light week due to the holidays.  There were 52 messages across 26 
threads, with 14 authors contributing.  About half were directly related to
patch submission. </p>
<h3><a name="JIT">JIT</a></h3>

<p>

The bulk of the non-patch postings this week centered around the JIT.
Nothing earth-shattering, although problems with gcc 2.96 under Red Hat
Linux have 
<a href="http://archive.develooper.com/perl6-internals@perl.org/msg07165.html">shut things down </a> for that configuration.</p>
<h3><a name="Output">Output</a></h3>

<p>

Dan Sugalski 
<a href="http://archive.develooper.com/perl6-internals@perl.org/msg07164.html">provided</a> primitives for output.</p>
<h3><a name="Parroty_Bits">Parroty Bits</a></h3>
<p>

The 
<a href="http://donate.perl-foundation.org">Perl Development Grant Fund </a> crested 25%.
</p>

<hr>

<a href="http://members.home.com/bcwarno/Perl6/">Bryan C. Warnock</a>



        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1648" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2001/12/p6pdigest/20011222.html" rel="bookmark">This Week on Perl 6 (16 - 22 December 2001)</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Bryan Warnock</span> on <abbr class="published" title="2001-12-29T00:00:00-08:00">December 29, 2001 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            <h3><a name="Notes">Notes</a></h3>

<p>

You can subscribe to an email version of this summary by sending an empty
message to 
<a href="mailto:perl6-digest-subscribe@netthink.co.uk">perl6-digest-subscribe@netthink.co.uk</a>.
</p>

<p>
This summary, as with past summaries, can be found in
<a href="http://members.home.com/bcwarno/Perl6/digests/">here</a>.  Please send additions, submissions, corrections, kudos, and complaints to 
<a href="mailto:bwarnock@capita.com">bwarnock@capita.com</a>.
</p>

<p>
For more information on the Perl 6 and Parrot development efforts, visit
<a href="http://dev.perl.org/perl6/">dev.perl.org</a> and
<a href="http://www.parrotcode.org/">parrotcode.org</a>.
</p>

<p>
There were 110 messages across 32 threads, with 32 authors contributing. </p>
 
<h3><a name="The_Perl_Development_Grant_Fund">The Perl Development Grant Fund</a></h3>

<p>
The 
<a href="http://www.perl-foundation.org/">Perl Foundation</a> is raising money to sponsor Damian &quot;Mr. Language&quot; Conway and Dan &quot;Mr. 
Internals&quot; Sugalski.  We're about a 
<a href="https://donate.perl-foundation.org/index.pl?node_id=305">quarter of the way </a> there, so if you don't know what to do with the $25 you received from Aunt
Bertha for Christmas, now you do.
</p>

<h3><a name="A_JIT_Compiler_for_Parrot">A JIT Compiler for Parrot</a></h3>

<p>
Daniel Grunblatt has an 
<a href="http://archive.develooper.com/perl6-internals@perl.org/msg07089.html">early JIT compiler</a> in CVS now.  Although it currently works only under Linux x86, it's certainly
an impressive demonstration.  
<h3><a name="Perl_IO">Perl I/O</a></h3>

</p>

<p>

Melvin Smith
<a href="http://archive.develooper.com/perl6-internals@perl.org/msg07060.html">asked</a> whether Nick Ing-Simmons Perl I/O layer was going to be used for Parrot.  Given
Dan's desire to support asynchronous I/O, there were several conflicting
opinions.  The final result, however, was that Melvin was going to
<a href="http://archive.develooper.com/perl6-internals@perl.org/msg07081.html">start from scratch</a>, using Nick's Perl I/O code as a basis.
<h3><a name="MiniPerl">MiniPerl</a></h3>


<p>

Jeff Goff has been 
<a href="http://archive.develooper.com/perl6-internals@perl.org/msg07048.html">busy</a> with MiniPerl, one of the languages distributed with Parrot.
<h3><a name="Setline">Setline</a></h3>

</p>

<p>

There was a brief 
<a href="http://archive.develooper.com/perl6-internals@perl.org/msg07083.html">debate</a> about whether to inline or offline 
<code>setline</code> operations .  An out-of-band index seems to be the current direction.
<h3><a name="Exporter">Exporter</a></h3>

</p>

<p>

Brent Dax 
<a href="http://archive.develooper.com/perl6-language@perl.org/msg08824.html">posted</a> his thoughts on Perl 6's 
<code>Exporter</code> module.  Michael Schwern 
<a href="http://archive.develooper.com/perl6-language@perl.org/msg08831.html">pitched in</a> his objections.
<h3><a name="Parroty_Bits">Parroty Bits</a></h3>

</p>

<p>

The Perl and Parrot communities wish you and yours a happy and safe holiday
season.
</p>

<hr>

<a href="http://members.home.com/bcwarno/Perl6/">Bryan C. Warnock</a>




        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1646" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2001/12/p6pdigest/20011215.html" rel="bookmark">This Week on Perl 6 (9 - 15 December 2001)</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Bryan Warnock</span> on <abbr class="published" title="2001-12-19T00:00:00-08:00">December 19, 2001 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
                  <h3><a name="Notes">Notes</a></h3>

</p>

<p>

You can subscribe to an email version of this summary by sending an empty
message to 
<a href="mailto:perl6-digest-subscribe@netthink.co.uk">perl6-digest-subscribe@netthink.co.uk</a>.
</p>

<p>
This summary, as with past summaries, can be found in
<a href="http://members.home.com/bcwarno/Perl6/digests/">here</a>.  Please send additions, submissions, corrections, kudos, and complaints to 
<a href="mailto:bwarnock@capita.com">bwarnock@capita.com</a>.
</p>

<p>
For more information on the Perl 6 and Parrot development efforts, visit
<a href="http://dev.perl.org/perl6/">dev.perl.org</a> and
<a href="http://www.parrotcode.org/">parrotcode.org</a>.
</p>

<p>
There were 137 messages across 44 threads, with 41 authors contributing.  
<h3><a name="Slice_Context">Slice Context</a></h3>

</p>

<p>

(10 posts) Piers Cawley 
<a href="http://archive.develooper.com/perl6-language@perl.org/msg08814.html">gave</a> a huge list of slice examples, wondering what the expected context would be.
</p>

<p>
Damian Conway's 
<a href="http://archive.develooper.com/perl6-language@perl.org/msg08815.html">first</a>,
<a href="http://archive.develooper.com/perl6-language@perl.org/msg08810.html">second</a>, and
<a href="http://archive.develooper.com/perl6-language@perl.org/msg08813.html">third</a> answers and explanations.
<h3><a name="Make_make_Make">Make <code>make</code> Make</a></h3>

</p>

<p>

(33 posts) There were several threads centered around getting 
<code>make</code> to work everywhere - with
<code>nmake</code> being the most problematic.
</p>

<p>
Jaen Saul had not 
<a href="http://archive.develooper.com/perl6-internals@perl.org/msg06952.html">one</a>, but
<a href="http://archive.develooper.com/perl6-internals@perl.org/msg06969.html">two</a> major threads on 
<code>nmake</code> incompatibilities in the Parrot makefile, causing a failed build on Win32.
Both Jeff Goff and Robert Spier are working on a complete Perl replacement
for the build process.  (With Jeff having already committed a
<a href="http://archive.develooper.com/perl6-internals@perl.org/msg06989.html">preliminary</a> one.)
</p>

<p>

<ul><li>Jaen Saul 
<a href="http://archive.develooper.com/perl6-internals@perl.org/msg06966.html">provided</a> a temporary solution one of his problems.
</li><li>Andy Dougherty and Garrett Goebel both tentatively 
<a href="http://archive.develooper.com/perl6-internals@perl.org/msg07006.html">fixed</a> some of the other Win32 problems.
</li><li>Robert Spier 
<a href="http://archive.develooper.com/perl6-internals@perl.org/msg07039.html">patched</a><code> distclean</code> to keep any CVS-related files.
</li></ul><h3><a name="Performance_Patches">Performance Patches</a></h3>

</p>

<p>
(5 posts) Jeff Goff 
<a href="http://archive.develooper.com/perl6-internals@perl.org/msg07017.html">committed </a> an early version of a Parrot optimizer, while Gregor Purdy 
<a href="http://archive.develooper.com/perl6-internals@perl.org/msg06941.html">submitted</a> a simple JIT runtime loop for experimentation.
<h3><a name="Aggregates">Aggregates</a></h3>

</p>

<p>

(1 post) Jeff Goff also 
<a href="http://archive.develooper.com/perl6-internals@perl.org/msg06939.html">turned in</a> the aggregate keys code, leading the way for development on arrays and hashes.
<h3><a name="Bytecode_Portability">Bytecode Portability</a></h3>

</p>

<p>

(7 posts) Bryan C. Warnock 
<a href="http://archive.develooper.com/perl6-internals@perl.org/msg06918.html">posted</a> his thoughts on Parrot bytecode.
<h3><a name="Parroty_Bits">Parroty Bits</a></h3>

</p>

<p>

Dave Mitchell has finally been given a PDD number (7) for the coding standards,
so they should be up on 
<a href="http://dev.perl.org/perl6/pdd/">dev.perl.org</a> soon.
</p>

<hr>

<a href="http://members.home.com/bcwarno/Perl6/">Bryan C. Warnock</a>

        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1642" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2001/12/19/xmlrpc.html" rel="bookmark">Building a Bridge to the Active Directory</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Kelvin Param</span> on <abbr class="published" title="2001-12-19T00:00:00-08:00">December 19, 2001 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            


<h3><a name="introduction">Introduction</a></h3>

<p>Active Directory of Windows 2000's directory service, allowing
organizations to keep and share information about networked resources
and users. One significant feature of the Active Directory is that it
is LDAP-compliant. Unfortunately, it is still very difficult to access
the Active Directory without using the Active Directory Services
Interface (ADSI). As a COM component, ADSI is very partial to the
Windows operating system.</p>
<p>What if you want to access information in your organization's Active
Directory from a host that is not running Windows? One option is to
build a piece of middleware (a daemon) to bridge a non-Windows host to
the Active Directory. This article describes how to build such a
daemon, and how to build a simple client would communicate with that
daemon.</p>

<h3><a name="xmlrpc and active perl to the rescue">XML-RPC and Active Perl to the Rescue</a></h3>
<p>XML-RPC is a mechanism that enables platform-independent and
language-independent distributed computing. It serializes function
calls and their associated arguments into an XML stream, and transports
the stream via the ubiquitous HTTP protocol. Although it might be an
over-simplification, XML-RPC provides some of the power of CORBA
without the associated pain.</p>
<p>The aim of this article is to walk you through the construction of a
daemon that accesses data from the Active Directory using ADSI and
passes on this data to other non-Windows clients via XML-RPC. This
daemon must, of necessity, run on a Windows host.</p>
<p>A daemon isn't much good unless there is a client with which to
communicate. As such, I will also walk you through the construction of
a simple client application.</p>
<p>Since Visual Basic is the de facto standard for writing Windows
applications, it would seem natural to build the daemon in Visual
Basic. However, I'm just not comfortable with Visual Basic, even though
I had used it on several projects. Fortunately, ActivePerl from
ActiveState has a very well developed COM interface that can be used to
interact with ADSI.</p>
<p>Before we get into the details of our Active Directory Daemon and
Active Directory Client, here are the links to the source code, so that
you can refer to it as we discuss the code and the logic behind it.</p>

<p>Active Directory Daemon: <a href="/2001/12/19/examples/activedirectory_daemon.pl">activedirectory_daemon.pl</a><br />
Active Directory Client: <a href="/2001/12/19/examples/activedirectory_client.pl">activedirectory_client.pl</a></p>

<h3><a name="the active directory daemon">The Active Directory Daemon</a></h3>



<p>Our daemon will be able to do the following:</p>
<p>a. Authenticate a user against the Active Directory using the user ID
and password. A successful login will result in the salient data (e.g.
surname, given name and email address) associated with the user ID
being returned.</p>

<p>b. Return the chain of command (the user's immediate boss, the
immediate boss's immediate boss, etc).</p>

<p>First, we need to load the modules below, and we also invoke the strict
pragma.</p>
<pre>
  use strict;
  use Win32::OLE;
  use Win32::OLE::Const 'Microsoft ActiveX Data Objects';
  use Frontier::Daemon;</pre>
<p>The first two are part of Active Perl, while the third module is
available from CPAN.</p>
<p>The <code>AuthenticateUser</code> subroutine authenticates the user against the
active directory.</p>
<pre>
  sub AuthenticateUser {
        my $strUserID       = shift || &quot;someuserid&quot;; 
        my $strUserPassword = shift || &quot;Somepassword1&quot;;
        my $strADsPath      = shift || 
           'LDAP://OU=somedivision,OU=somedepartment,DC=someuniversity,DC=edu';
        my $strDomain       = shift || &quot;\@someuniversity.edu&quot;;
        my $strAttributeName = &quot;userPrincipalName&quot;;
        my $strAttributeValue = $strUserID;</pre>
<p>We've assigned default values to some of the scalars above to provide
an example of how arguments will be used at various points in the
process of querying the Active Directory. There are several ways of
interacting with ADSI. In this bit of code, we bind directly to ADSI.
Later on, we will show how we can use ADO to bind to ADSI. It is
important to note that each method of interacting with ADSI has its own
peculiarities.</p>
<pre>
         my $objNameSpace = Win32::OLE-&gt;GetObject ('LDAP:') 
                or die (&quot;Cannot create LDAP object&quot;);.
         my $objObjSec = $objNameSpace-&gt;OpenDSObject($strADsPath, $strUserID,
   $strUserPassword, 1);
         my %hashAdRecord;</pre>
<p>We use <code>Win32::OLE-&gt;GetObject('LDAP:')</code> to utilize the LDAP
services of ADSI. ADSI supports several directory services such as
Novell NDS, and Windows NT4 amongst others. Next we try to access the
Active Directory record associated with our user ID and password. The
$strADsPath variable specifies what is roughly the domain name of the
Windows 2000 forest, and how far down the forest one wants to begin
searching. The DC=someuniversity,DC=edu is the LDAP analog of a DNS
style domain name i.e. someuniversity.edu. In this example, we want to
access the Active Directory starting at the organizational unit
somedepartment that is a child of the organization unit somedivision.</p>

<p>We use <code>$objNameSpace-&gt;OpenDSObject($strADsPath, $strUserID, $strUserPassword, 1)</code> to access the Active Directory and retrieve the
relevant record. The last argument in this subroutine is set to 1. It
indicates that we are using an unencryted password.</p>
<pre>
    if (Win32::OLE-&gt;LastError()==0) {
        $refAdRecord =
            GetUserData($strAttributeName,$strAttributeValue,$strADsPath,$strDomain);
    } else {
        %hashAdRecord =('result' =&gt; 'failed');
        $refAdRecord = \%hashAdRecord;
    }</pre>
<p>We use <code>Win32::OLE-&gt;LastError()</code> to ascertain if we have a valid
user. <code>Win32::OLE-&gt;LastError()</code> is ActivePerl's implementation of
Visual Basic's <code>Err.Number</code>. Up to now, everything is pretty
straightforward. Deciphering the error codes is a little tricky. Here's
how the error logic works. <code>Win32::OLE-&gt;LastError()</code> returns a
non-zero only if the password is invalid. However, supplying a
non-existent user ID will result in zero being returned. As such this
bit of code is only good for detecting an invalid password. So, how do
we detect a non-existent user ID? Our <code>GetUserData</code> subroutine serves a
dual purpose. It not only detects a non-existent user ID, but also
returns data from the Active Directory object that is associated with a
valid user ID.</p>

<p>We can only return references to the XML-RPC client, so we need to
define a scalar variable to which we can assign a reference of the
return value. Furthermore, the scalar variable has to be global to the
XML-RPC daemon program. In our case, the scalar variable is
<code>$refAdRecord</code>. If the user id and password are valid, the reference to
the hash returned by the subroutine <code>GetUserData</code> is assigned to the
scalar <code>$refAdRecord</code>. On the other hand, if the user id and password are
not valid, we insert the <code>'result' =&gt; 'failed'</code> key-value pair to the
<code>%hashAdRecord</code> hash variable, and subsequently assign the reference of
that hash variable to <code>$refAdRecord</code>.</p>
<pre>
    $objObjSec-&gt;Close;
    $objNameSpace-&gt;Close;
    return $refAdRecord;
    }</pre>
<p>And, it's time to destroy the ADSI objects that we created earlier.</p>
<p>Now, we move on to the XML-RPC specific bits of the daemon program.</p>
<pre>
    my $methods = {
    'activedirectory_daemon1.GetUserData' =&gt; \&amp;GetUserData,
    'activedirectory_daemon1.GetCommandChain' =&gt; \&amp;GetCommandChain,
    'activedirectory_daemon1.AuthenticateUser' =&gt; \&amp;AuthenticateUser</pre>
<pre>
    };</pre>
<p>We declare a hash of subroutines that are accessible to the XML-RPC
client. The key of each entry is the name of the method prefixed by an
identifier using the dot convention. In our case, we arbitrarily use
the name of the daemon file as the identifier. The value part of each
hash entry is the de-referenced pointer to the corresponding method.
This hash serves as a sort of look up table for requests to methods
made at the XML-RPC client. The subroutines besides <code>AuthenticateUser</code>
will be discussed later in this article.</p>
<pre>
    Frontier::Daemon-&gt;new(LocalPort =&gt; 8080, methods =&gt; $methods) 
           or die (&quot;Cannot start HTTP daemon: $!&quot;);</pre>
<p>At this juncture, we insert the code that fires up the XML-RPC daemon.
We do so creating a new <code>Frontier::Daemon</code> instance. The constructor
subroutine takes two arguments, each as a key-value pair. The first
argument is the port used by the daemon. Since the host may already be
running a web server, we'll use port 8080. The second argument is the
set of subroutines to be published for use by the XML-RPC client (see
above).</p>
<p>Besides the <code>AuthenticateUser</code> subroutine, we've also included a couple
of subroutines that retrieve useful information about a user.
<code>GetUserData</code> retrieves data like the user's email address, telephone
number, etc. Although we call <code>GetUserData</code> from other subroutines
(<code>AuthenticateUser</code> and <code>GetCommandChain</code>) within the daemon program,
<code>GetUserData</code> may also be called from an XML-RPC client to retrieve data
in the Active Directory about any user whose record is accessible.
Instead of binding directly with ADSI, in this case, we use ADO to bind
with the Active Directory, just so that the retreived data is presented
as a record like if the data was retrieved from a relational database.</p>
<pre>
    sub GetUserData {
        my $strAttributeName  = shift; #could be userPrincipalName, cn etc
        my $strAttributeValue = shift; #could be user ID, cn value etc
        my $strADsPath        = shift; #could be
        # &quot;LDAP://OU=somedivision,OU=somedepartment,DC=someuniversity,DC=edu&quot;
		
        my $strDomain         = shift; #could be &quot;someuniversity.edu&quot;

        if ($strAttributeName eq &quot;userPrincipalName&quot;) { 
            $strAttributeValue = $strAttributeValue . $strDomain; s
        }

        my $strProvider = &quot;Active Directory Provider&quot;;

        my $strConnectionString = $strProvider;

        my $strFilter = &quot;(&quot; . $strAttributeName . &quot;=&quot; . $strAttributeValue . &quot;)&quot;;

        my $strAttribs =
             &quot;userPrincipalName,sn,givenName,cn,department,telephoneNumber,mail,title,manager&quot;;

        my $strScope = &quot;subtree&quot;;

        my $strCommandText = &quot;&lt;&quot; . $strADsPath . &quot;E&gt;;&quot; . $strFilter . &quot;
        ;&quot; . $strAttribs . &quot;;&quot; . $strScope;

        my $objConnection = Win32::OLE-&gt;new (&quot;ADODB.Connection&quot;) 
             or die (&quot;Cannot create ADODB object!&quot;);

        my $objRecordset = Win32::OLE-&gt;new (&quot;ADODB.Recordset&quot;)
             or die (&quot;Cannot create ADODB recordset!&quot;);

        my $objCommand = Win32::OLE-E&lt;gt&gt;new (&quot;ADODB.Command&quot;) 
             or die (&quot;Cannot create ADODB command!&quot;);

        my %hashAdRecord;</pre>
<p>The above code snippet from the <code>GetUserData</code> subroutine shows what
values are assigned to varaibles. This subroutine has four arguments:</p>
<p>a. $strAttributeName</p>
<p>b. $strAttributeValue</p>
<p>c. $strADsPath</p>
<p>d. $strDomain</p>
<p>At this juncture, I'll try to explain how the above variables are used.
In our case, we will search the Active Directory for the record that
contains a given value for the userPrincipalName. As such,
<code>$strAttributeName = &quot;userPrincipalName&quot;</code>. If the user ID is <em>jsmith12</em>,
then <code>$strAttributeValue = &quot;jsmith12&quot;</code>. Alternatively, if we call the
<code>GetUserData</code> subroutine from inside the AuthenticateUser subroutine, we
declare <code>$strAttributeValue = $strUserID</code> in the AuthenticateUser
subroutine.</p>















<p>Since we have used the user ID instead of the full <code>userPrincipalName</code>,
we need to append <em>@somedomain</em> to the user ID. Hence we get,</p>
<pre>
    if ($strAttributeName eq &quot;userPrincipalName&quot;) { 
        $strAttributeValue = $strAttributeValue . $strDomain; 
    }</pre>
<p>The remainder of the above variable declarations with the exception of
<code>%hashAdRecord</code> are required to enable ADO to bind with ADSI. I'll try to
explain what's happening there. First we create the following objects:</p>
<p>a. ADODB connection object</p>
<p>b. ADODB Recordset object</p>
<p>c. ADODB Command object</p>
<p>Once these objects have been created, we assign values to selected
properties of the ADODB Connection object.</p>
<pre>
    $objConnection-&gt;{Provider} = (&quot;ADsDSOObject&quot;);
    $objConnection-&gt;{ConnectionString} = ($strConnectionString);</pre>
<pre>
    $objConnection-&gt;Open();
    $objCommand-&gt;{ActiveConnection} = ($objConnection);</pre>
<p>We open the ADODB connection, and assign the ADODB Connection object to
the ActiveConnection property of the ADODB Command object.</p>
<pre>
    $objCommand-&gt;{CommandText} = ($strCommandText);</pre>
<pre>
    $objRecordset = $objCommand-&gt;Execute($strCommandText) 
        or die (&quot;Cannot execute!&quot;);</pre>
<p>We assign $strCommandText to the CommandText property of the ADODB
Command object, and next, we run the Execute method of the ADODB
Command object.The $strCommandText variable is the argument of the
Execute method. The value of the $strCommandText is the Active
Directory analog of an SQL statement use to query an relational
database. $strCommandText comprises four elements:</p>
<p>a. $strADsPath</p>
<p>b. $strFilter</p>
<p>c. $strAttribs</p>
<p>d. $strScope</p>
<p>$strADsPath contains the address of the Active Directory server, and the
subset of the total set of records one wishes to search through. The
address of the Active Directory server is specified by splitting the
domain name up. And the result is <code>DC=someuniversity,DC=edu</code>. The
subset of the records in the Active Directory is defined by listing the
hierarchy of OUs (Organizational Units) e.g.
<code>OU=somedivision,OU=somedepartment</code>. The syntax of the entire
$strADsPath string complies with the LDAP RFC 2307 syntax. However, many
programming or scripting languages do not seem to support this syntax as
yet. Instead, the LDAP RFC 2251 syntax is widely supported.</p>
<p>$strFilter specificies the Active Directory records that we are
interested in. In this instance, we are interested in the record where
<code>userPrincipalName</code> is equal to <code>someuserid@someuniversity.edu</code>.
Hence, this relationship is expressed as</p>
<pre>
    $strFilter=&quot;(&quot; . $strAttributeName . &quot;=&quot; . $strAttributeValue . &quot;)&quot;.</pre>
<p>$strAttribs contains the list of fields that we want to retrieve from
the query. If the query is successful, the result will be returned in
ADODB Recordset object, and we can use the methods in the ADODB
Recordset objects to retrieve the data.</p>
<p><code>$strScope=&quot;subtree&quot;</code> indicates that the scope of the search is limited
to the subtree that has been specified in <code>$strADsPath</code>.</p>
<p>Finally, we turn our attention to getting a list of a user's
superiors. This is possible because each user's record in the Active
Directory has a <code>manager</code> field that contains the canonical name or <code>CN</code>
(amongst other bits of data) of the user's immediate superior. The
<code>GetCommandChain</code> subroutine returns an array of a user's superiors. This
subroutine takes two arguments:</p>
<p>a. $refAdRecord</p>
<p>b. $strApexTitle</p>
<pre>
    sub GetManagerString {
        my %hashAdRecord = %$refAdRecord;
        my $strManagerString=$hashAdRecord{&quot;manager&quot;};
        return $strManagerString;
    }</pre>
<p>$refAdRecord is the reference of the user's data returned by
<code>GetUserData</code>. $strApexTitle is the highest office (e.g. ``Division
Manager'') relevant to the search. The logic within this subroutine is
quite simple. We make use of the <code>GetManagerString</code> subroutine to
retrieve the data that was obtained from the <code>Manager</code> field in the
Active Directory.</p>
<pre>
    sub GetManagerCN {
        my $strManagerString=shift;
        $strManagerString =~ /\bCN=([-_#@%\&amp;\$\*\.a-zA-Z0-9\s]+)/;
        return $1;
    }</pre>
<p>Next we use the <code>GetManagerCN</code> subroutine to extract the canonical name
from the string returned by the <code>GetManagerString</code> subroutine.</p>
<pre>
    do {
        $refAdRecord =
        &lt;GetUserData&gt;(&quot;cn&quot;,$strManagerCN,&quot;LDAP://OU=somedivision,
        OU=somedepartment,DC=someuniversity,DC=edu&quot;,
        &quot;\@someuniversity.edu&quot;);
        %hashAdRecord=%$refAdRecord;</pre>
<pre>
        $strTitle = $hashAdRecord{&quot;title&quot;};</pre>
<pre>
        push @arrCommandChain, {%hashAdRecord};
        $strManagerString = GetManagerString($refAdRecord);
        $strManagerCN = GetManagerCN($strManagerString); 
    } until ($strTitle eq $strApexTitle);
    $refCommandChain = \@arrCommandChain;
    return $refCommandChain;</pre>
<p>A <code>do</code> loop is used to traverse up the management hierarchy till we reach
the user record that has a title value which matches the value in
<code>$strApexTitle</code>. Over each iteration, we store the hash of the data
retreived from the Active Directory into the array <code>@arrCommandChain</code>.
Finally, we return the reference to this array as <code>$refCommandChain</code>.</p>
<p>In the next section we will examine how the client uses the XML-RPC
mechanism to make requests of the daemon.</p>
<p>
<h3><a name="the client in perl">The Client in Perl</a></h3>
<p>Since most of the work is done by the active directory daemon, the
active directory client in Perl is relatively simple. Because we've
used the XML-RPC protocol, the client can be written in various
languages, e.g. PHP 4, Python, Java, etc. However we shall continue
with Perl to be consistent with the theme of this web site.</p>
<p>As with the daemon, we invoke the strict pragma, and load the
Frontier::Client module.</p>
<pre>
    $strDaemon_url = &quot;<a href="http://www.someuniversity.edu:8080/RPC2&quot">http://www.someuniversity.edu:8080/RPC2&quot;</a>;</pre>
<p>To make use of the subroutines in the Active Directory daemon, we need
to provide a url to the daemon. In our case we've assigned the url to
the <code>$strDaemon_url</code> variable. As discussed in the Daemon section of this
article, we've assigned port 8080 for our daemon's use. The
<code>Frontier::Daemon</code> package has also assigned a default virtual directory,
RPC2.</p>
<p>Next, we create a new instance of the XML RPC client by passing
$strDaemon_url as the value part of the key-value pair of a hash entry.</p>
<pre>
    $objServer = Frontier::Client-&gt;new(url =&gt; $strDaemon_url);</pre>
<p>Now we can utilize the published subroutines in the Active Directory
daemon.</p>
<pre>
$refAdRecord=$objServer-&gt;call('activedirectory_daemon.AuthenticateUser','someuserid',
'Somepassword1','LDAP://OU=somedivision,OU=somedepartment,DC=someuniversity,DC=edu',
&quot;\@someuniversity.edu&quot;);</pre>
<p>The first argument in the <code>$objServer-&gt;call</code> subroutine is the
qualified daemon subroutine name. The rest of the arguments are the
arguments of the daemon subroutine.</p>
<p>As mentioned earlier, the XML-RPC daemon, can only return references.
As such, we need to convert references to hashes, or arrays as
appropriate. For example, <code>%hashAdRecord = %$refAdRecord</code>.</p>
<p>
<h3><a name="conclusion">Conclusion</a></h3>
<p>XML-RPC is a much more than an effective mechanism to enable
distributed computing. We can use it to provide access to platform
specific services. In our case, we used XML-RPC to enable a non-Windows
host to access data and services in the Active Directory. Furthermore,
XML-RPC is simple to implement. I've made forays into distributed
computing several years ago by way of Java's RMI and Microsoft's DCOM.
In my experience, XML-RPC is by far the cleanest and most fuss-free
mechanism of the three.</p>
<p>So, if you're a Perl programmer, and are looking to leveraging off a
service that only runs on the Windows platform, give Active Perl and
XML-RPC a go. You'll be pleasantly surprised.</p>
<p>
<h3><a name="resources">Resources</a></h3>
<p><a href="http://www.cpan.org">http://www.cpan.org</a></p>
<p><a href="http://www.activestate.com">http://www.activestate.com</a></p>
<p><a href="http://xmlrpc-c.sourceforge.net/xmlrpc-howto/xmlrpc-howto.html">http://xmlrpc-c.sourceforge.net/xmlrpc-howto/xmlrpc-howto.html</a></p>



        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1638" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2001/12/11/perltk.html" rel="bookmark">A Drag-and-Drop Primer for Perl/Tk</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Steve Lidie</span> on <abbr class="published" title="2001-12-11T00:00:00-08:00">December 11, 2001 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            <p>
As it happens, no matter how much I write about Perl/Tk, there's
always something left unsaid. A case in point is the topic of drag and
drop, which didn't make it into our book, <i>Mastering Perl/Tk</i>.
</p>

<p>
This article describes the Perl/Tk drag-and-drop mechanism, often
referred to as DND. We'll illustrate DND operations local to a single
application, where we drag items from one Canvas to another.
</p>



<p>
There are two basic types of DND operations, local (intra-application)
and remote (inter-application). Local drops are fully supported, but
there is no standard for remote drops. For this reason, this article
describes only local DND operations. Note: Perl/Tk supports Sun, XDND,
KDE, and Win32 remote DND protocols. </p>

<p>
To write DND code you should be comfortable with these concepts:

<ol>
<li>
 The drag source is the widget that we drag.  In the case of
   a Canvas widget, we can arrange for an individual item to
   be the drag source.
</li>
<li>
 The drop destination is the widget upon which we drop the
   source widget.
</li>
<li>
 The DND token is a <code>Label</code> widget that tracks the cursor as it moves from the drag source to the drop destination. We can configure the DND token with a text string or an image.
</li>
    </ol>
</p>

<p>
<img src="/pub/2001/12/11/graphics/drag.jpg"></p>

<p>
This figure shows what we will end up with--one Canvas populated
by various types of objects, which we can drag around the application
and drop onto another Canvas. Let's now look at the code.
  </p>

<p> Here we have a rather typical Perl/Tk prologue.
<code>Tk::DragDrop</code> is required if coding a program with a drag
source, while <code>Tk::DropSite</code> is required for programs
declaring a drop destination.</p>

<pre>
    use Tk;
    use strict;
    use Tk::DragDrop;
    use Tk::DropSite;
    use subs qw/make_bindings move_bbox move_image/;
</pre>

<h3>Global variables</h3>

<p>A drag begins with a
<code>&lt;ButtonPress-1&gt;</code> event, where we record the ID of the
specified Canvas item in the variable <code>$drag_id</code>. <code>$mw</code> is, of course, a
reference to the program's MainWindow.
</p>

<pre>
    our (
         $drag_id,              # Canvas item id of drag source
         $mw,                   # Perl/Tk MainWindow reference
    );

$mw = MainWindow->new(-background => 'green');
</pre>

<p> Define the drag source--a Canvas full of items. Here we declare
that a <code>&lt;B1-Motion&gt;</code> event over the source Canvas
signals the start of a local drag operation. </p>

<p> <code>$drag_source</code> is a <code>Tk::DragDrop</code> object,
sometimes called a DND token. It's really a disguised
<code>Label</code> widget, which we can configure in the standard
fashion. For our purposes, we set the <code>-text</code> option to
describe the <code>Canvas</code> item we are dragging, rather than the
default text of the source widget's class name. But you can assign an
image to the DND token if desired.</p>

<p>
When performing a DND operation, notice that the DND token has a flat
relief over the source, and a sunken relief over the destination.
  </p>

<pre>
    my $c_src = $mw->Canvas(qw/-background yellow/)->pack;

    my $drag_source = $c_src->DragDrop(
        -event     => '&lt;B1-Motion&gt;',
        -sitetypes => [qw/Local/],
    );
</pre>

<p>
Every <code>Canvas</code> source item has a
<code>&lt;ButtonPress-1&gt;</code> binding associated with it. The
callback bound to this event serves to record the item's ID in the
global variable <code>$drag_id</code>, and to configure the drag
<code>Label</code>'s <code>-text</code>/ option with the item's ID and
type.</p>

<pre>
    my $press = sub {
        my ($c_src, $c_src_id, $drag_source) = @_;
        $drag_id = $c_src_id;
        my $type = $c_src->type($drag_id);
        $drag_source->configure(-text => $c_src_id . " = $type");
    };
  </pre>

<p>
OK, let's populate the source Canvas with items of various types.
For this demonstration, we limit the choices to ovals, rectangles, and
all the GIF files in the current directory. As noted earlier, every
item gets a <code>&lt;ButtonPress-1&gt;</code> binding.
</p>

<pre>
    my ($x, $y) = (30, 30);
    foreach (&lt;*.gif>) {

        my $id = $c_src->createImage($x, $y,
            -image => $mw->Photo(-file => $_));
        $x += 80;
        $c_src->bind($id, '&lt;ButtonPress-1>' => [$press, $id, $drag_source]);
    
    } # forend

    $x = 30;
    $y = 80;

    foreach (qw/oval rectangle/) {

        my $method = 'create' . ucfirst $_;
        my $id = $c_src->$method($x, $y, $x + 40, $y + 40, -fill => 'orange');
        $x += 80;
        $c_src->bind($id, '&lt;ButtonPress-1&gt;' => [$press, $id, $drag_source]);
    
    } # forend
  </pre>

<p>
Define the drop-site destination--another <code>Canvas</code>. As a
source <code>Canvas</code> item is dropped here, create an identical
item in the destination at the drop coordinates.
  </p>

<pre>
    my $c_dest = $mw->Canvas(qw/-background cyan/)->pack;
    $c_dest->DropSite(
        -droptypes   => [qw/Local/],
        -dropcommand => [\&move_items, $c_src, $c_dest],
    );
  </pre>

<p>
Build the obligatory Quit Button, and enter the main event loop.
  </p>

<pre>
    my $quit = $mw->Button(-text => 'Quit', -command => [$mw => 'destroy']);
    $quit->pack;

    MainLoop;
  </pre>

<p>
These subroutines are invoked when a <code>Canvas</code> source item
is dropped on the destination <code>Canvas</code>. Callback
"<code>move_items</code>" is invoked first, with these arguments:
  </p>
<blockquote>
<pre>
$c_src  = source Canvas widget reference
$c_dest = destination Canvas widget reference
$sel    = selection type, here "XdndSelection"
$dest_x = Canvas drop site X coordinate
$dest_y = Canvas drop site Y coordinate
  </pre>
  </blockquote>
<p>
The first two arguments we supplied on the <code>-dropcommand</code>
option. The remaining arguments are implicitly supplied by Perl/Tk.
  </p>

<p>
"<code>move_items</code>" simply branches according to the item's
type, throwing an error for <code>Canvas</code> items we are not
prepared to handle. Each type handler receives the preceding
arguments plus the item's type.
  </p>

<pre>
    sub move_items {

        $_ = $_[0]->type($drag_id);
        return unless defined $_;

      CASE: {

        /image/      and do {move_image $_, @_; last CASE};
        /oval/       and do {move_bbox  $_, @_; last CASE};
        /rectangle/  and do {move_bbox  $_, @_; last CASE};
        warn "Unknown Canvas item type '$_'.";

      }# casend

    } # end move_items
  </pre>

<p>
Subroutine "<code>move_bbox</code>" handles all <code>Canvas</code>
item types described by a bounding box. (For this demonstration, we
only propagate the <code>-fill</code> attribute from the
<code>Canvas</code> source item to the new item.)  It uses the
subroutine "<code>make_bindings</code>" given below to establish local
bindings on the newly created destination item, so it can be dragged
about the destination Canvas.
</p>

<pre>
    sub move_bbox {

        my ($item_type, $c_src, $c_dest, $sel, $dest_x, $dest_y) = @_;

        my $fill = $c_src->itemcget($drag_id, -fill);
        my $method = 'create' . ucfirst $item_type;
        my $id = $c_dest->$method($dest_x, $dest_y,
            $dest_x + 40, $dest_y + 40, -fill => $fill,
        );

        make_bindings $c_dest, $id;

    } # end move_bbox
  </pre>

<p>
Subroutine "<code>move_image</code>" handles a <code>Canvas</code>
image item type. It uses the "<code>make_bindings</code>" subroutine
just described.
  </p>
<pre>
    sub move_image {

        my ($item_type, $c_src, $c_dest, $sel, $dest_x, $dest_y) = @_;

        my $image = $c_src->itemcget($drag_id, -image);
        my $id = $c_dest->createImage($dest_x, $dest_y, -image => $image);

        make_bindings $c_dest, $id;

    } # end move_image
  </pre>

<p>
"<code>make_bindings</code>" itself adds drag behavior to our newly
dropped <code>Canvas</code> items, but without using the DND
mechanism. The basic idea is as follows:
  </p>
<ul><li> On a <code>&lt;ButtonPress-1&gt;</code> event, record the
<code>Canvas</code> item's (x,y) coordinates in instance variables of
the form <code>"x" . $id</code> and <code>"y" . $id</code>, where <code>$id</code> is the item's <code>Canvas</code> ID.
This ensures that each item's position is uniquely maintained.
    </li>
<li>
On a <code>&lt;ButtonRelease-1&gt;</code> event, compute an (x,y)
delta from the item's original position (stored in instance variables)
and the new position, and use the <code>Canvas</code> "<code>move</code>" method to relocate it.
    </li>
  </ul>

<pre>
    sub make_bindings {

        my ($c_dest, $id) = @_;

        $c_dest->bind($id, '&lt;ButtonPress-1&gt;' => [sub {
	    my ($c, $id) = @_;
	    ($c_dest->{'x' . $id}, $c_dest->{'y' . $id}) =
	        ($Tk::event->x, $Tk::event->y);
        }, $id]);

        $c_dest->bind($id, '$lt;ButtonRelease-1&gt;' => [sub {
	    my ($c, $id) = @_;
	    my($x, $y) = ($Tk::event->x, $Tk::event->y);
	    $c->move($id, $x - $c_dest->{'x' . $id}, $y - $c_dest->{'y' . $id});
        }, $id]);

    } # end make_bindings
  </pre>

<p>

The entire source code to this program is available <a
href="/2001/12/11/examples/drag.pl">here</a>, and for more information about Perl/Tk
programming, check out <a href="http://www.oreilly.com/catalog/mastperltk/">Mastering Perl/Tk</a>. </p>


<hr size="1" noshade="noshade" />

<p>
O'Reilly &amp; Associates will soon release 
(January 2002) <a href="http://www.oreilly.com/catalog/mastperltk/">Mastering Perl/Tk</a>. </p>

<ul> <!--
<li><p> 
<a href="">Sample Chapter [X], [Chapter Title here]</a>, is available 
free online. 
</p></li> -->

<li><p>
You can also look at the <!--
<a href="">Table of Contents</a>, the 
<a href="">Index</a>, and the -->
<a href="http://oreilly.com/catalog/mastperltk/desc.html">Full Description</a> of the book.
</p></li>

<li><p>
For more information, or to order the book, 
<a href="http://www.oreilly.com/catalog/mastperltk/">click here</a>. </p></li>  
</ul>









        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1644" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2001/12/p6pdigest/20011208.html" rel="bookmark">This Week on Perl 6 (2 - 8 December 2001)</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Bryan Warnock</span> on <abbr class="published" title="2001-12-10T00:00:00-08:00">December 10, 2001 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            <h3><a name="Notes">Notes</a></h3>

<p>

You can subscribe to an email version of this summary by sending an empty
message to 
<a href="mailto:perl6-digest-subscribe@netthink.co.uk">perl6-digest-subscribe@netthink.co.uk</a>.
</p>

<p>
This summary, as with past summaries, can be found in
<a href="http://members.home.com/bcwarno/Perl6/digests/">here</a>.  Please send additions, submissions, corrections, kudos, and complaints to 
<a href="mailto:bwarnock@capita.com">bwarnock@capita.com</a>.
</p>

<p>
There were 203 messages across 51 threads, with 46 authors contributing.  
<h3><a name="Parrot_003">Parrot 0.03 </a></h3>

</p>

<p>

Parrot 0.03 should now be available.  From the 
<a href="http://archive.develooper.com/perl6-internals@perl.org/msg06916.html">
release notes</a>:
<blockquote></p>

<p>
What have we unleashed? As promised, the latest release of Parrot, 0.0.3,
contains support for complex, language-specific data types to be created.
PMCs, or Parrot Magic Cookies, are abstract object data types, with class
libraries written in C specifying their behaviour. 
</p>

<p>
To start you off, we have implemented nice, happy, polymorphic Perl undef,
Perl Integer, Perl String and Perl Number classes. There's also a default
class you can inherit from if you're rolling your own data types. See
docs/vtables.pod for all the juicy details.
</p>

<p>
That's not all, however... We've more documentation, examples, a
minature Scheme implementation, support for pushing and popping onto
register and global user stacks, subroutine support for Jako, better
platform support, and a whole lot more. See the NEWS and ChangeLog files
for the rest.
</blockquote></p>

<p>

<a href="http://www.cpan.org/authors/id/S/SI/SIMON/parrot-0.0.3.tar.gz">Download
</a> it and give it a try.
<h3><a name="Parrot_FAQ_02">Parrot FAQ 0.2</a></h3>

</p>

<p>

Adam Turoff has coalesced many of the common questions on Parrot and Perl 6 
into the 
<a href="http://www.panix.com/~ziggy/parrot.html">Parrot FAQ</a>.  
<h3><a name="The_GCC_Register_Transfer_Language">The GCC Register Transfer Language</a></h3>

</p>

<p>

(17 posts) Terrence Brannon 
<a href="http://archive.develooper.com/perl6-internals@perl.org/msg06739.html">asked</a> why Parrot wasn't simply compiling to GCC's RTL, instead of having to invent
a brand new pseudo-architecture.
</p>

<p>
Dan Sugalski:
<ul><li>Because there are platforms where GCC doesn't run.
</li><li>Because GCC's licensing is onerously restrictive for our purposes.
</li><li>Because it makes embedding an interpreter a pain.
</li><li>Because we dynamically recompile and redefine ourselves, which makes this 
difficult.
</li><li>Because GCC's codegen is pretty bad.
</li></ul><h3><a name="Parrot_Execution_Environment">Parrot Execution Environment</a></h3>

</p>

<p>

(14 posts) Nguon Hao Ching 
<a href="http://archive.develooper.com/perl6-internals@perl.org/msg06766.html">wondered</a> how external arguments - via the command line, although the environment was
quickly added to the discussion - were going to work in Parrot.
</p>

<p>
Weighing particularly heavy on Dan's mind - embedded interpreters and 
multi-threaded applications:
<blockquote></p>

<p>
Who has control over the environment? The primary thread? All the threads? 
Should some have access and others not? Is there read-only access, or 
access to some but not all of the variables? Can an interpreter create or 
delete entries, and if so which ones? How much control does an embedder 
have, anyway? Should we call a separate function when 
getting/setting/querying/deleting? Do we even know which variables exist, 
or do we have to ask? Is it even thread-safe?
</p>

<p>
It's kinda messy, and since we can put it off for a bit, I'd as soon do 
that. We may have a half-kludge solution, but since that's all we have at 
the moment I'd rather wait and maybe a stroke of genius will occur. Or 
maybe not, in which case we're not really worse off than we are now.
</blockquote><h3><a name="String_to_Number_Conversions">String-to-Number Conversions</a></h3>

</p>

<p>

(11 posts) Alex Gough 
<a href="http://archive.develooper.com/perl6-internals@perl.org/msg06748.html">submitted</a>, then 
<a href="http://archive.develooper.com/perl6-internals@perl.org/msg06755.html">withdrew</a>, a patch to move string-to-number conversions to the encoding layer.  
(Alex discovered, as Tom Hughes pointed out, that the encoding layer is 
character agnostic, and that digit determination needs to occur at the 
character set layer.)
<h3><a name="Aggregate_Keys">Aggregate Keys</a></h3>

</p>

<p>

(11 posts) Dan Sugalski posted
<a href="http://archive.develooper.com/perl6-internals@perl.org/msg06760.html">his thoughts</a> on aggregate keys.  Jeff Goff is currently working on implementation.
<h3><a name="Parroty_Bits">Parroty Bits</a></h3>

</p>

<p>

Currently, Parrot is being developed without a license.  Inside sources 
indicate that Larry is coming to a final decision on this, and Parrot
should have one soon.
</p>

<p>
Parrot now has an IRC channel on 
<code>irc.rhizomatic.net</code> for some of the more mundane day-to-day development coordination. Join
<code>#parrot</code> and hang out some time.
</p>

<p>
It looks like The Parrot Conference will be in San Diego, July 22-26, 
2002.  More info will be forthcoming, but get your vacation notices in now.
(Yes, I believe that some other Open Source stuff will be going on, too. :-)
</p>

<hr>

<a href="http://members.home.com/bcwarno/Perl6/">Bryan C. Warnock</a>



        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1636" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2001/12/04/testing.html" rel="bookmark">An Introduction to Testing</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author"><a class="fn url" href="http://www.modernperlbooks.com/">chromatic</a></span> on <abbr class="published" title="2001-12-04T00:00:00-08:00">December  4, 2001 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            <p>Someday, you'll be dubiously blessed with the job of maintenance programming.
You might need to add new features or to fix long-standing bugs.  The code may
be your own or the apparently disturbed mutterings of a long-disappeared agent
of chaos.  If you haven't yet been this fortunate, then download a Perl CGI script
circa 1996 and try to make it operate under <code>use strict</code>, warnings and taint
mode.</p>
<p>Maintenance is rarely pretty, mixing forensics, psychology and playing-card
house construction.  Complicating the matter are concerns such as backward
compatibility, portability and interoperability.  You'll probably hate the
learning experience, but don't miss the chance to learn some important lessons:</p>
<ul>
<li><b><a name="item_Software_spends_more_time_being_maintained_than_be">Software spends more time being maintained than being developed.</a></b>

<li><b><a name="item_Things_that_were_obvious_in_development_are_easily">Things that were obvious in development are easily obscured.</a></b>

<li><b><a name="item_Fixing_bugs_is_easier_than_finding_them_and_making">Fixing bugs is easier than finding them and making sure nothing else breaks.</a></b><br>

<li><b><a name="item_The_real_cost_of_software_is_programmer_time_and_e">The real cost of software is programmer time and effort, not length of code, licenses or required hardware.</a></b>

</ul>
<p>These rules have been well-established since the early days (think Grace Hopper)
of software engineering.  Good practices remain the same:  Write good comments, document your assumptions and logic,  test your code to death, test it again.</p>
<p>Every serious software engineering methodology promotes testing.  It is
essential to newer approaches, like Extreme Programming.  A comprehensive test
suite helps to verify that the code performs as expected, helps to minimize the
scope of future modifications, and frees developers to improve the structure
and design of code without changing its behavior.  Yes, this can actually work.</p>

<h3><a name="caveats">Caveats</a></h3>
<p>Experienced readers (especially those with strong math backgrounds) rightly
note that testing <b>cannot</b> prove the absence of bugs.  If it's theoretically
impossible to write a non-trivial program with zero defects, it's impossible to
write enough tests to prove that the program works completely.  Programmers try
to write bug-free code anyway, so why not test anything and everything
possible?  A tested program may have unknown bugs, but an untested program
will.</p>
<p>Of course, some things are truly untestable.  This category includes the ``black
boxes,'' such as other processes and machines, and system libraries.  More
things are testable than not, though.  Perl allows good programmers to perform
scary black magic, including system table and run-time manipulations.  It's possible to create your own fake little world just to satisfy a testable interface.
A little megalomania can be handy.</p>
<p>Testing can be difficult.  A wad of code with minimal documentation -- a design
from the Perl 4 days -- and business logic that relies on prayer, global
variables and animal sacrifice may push you to new heights of productivity, or
teach you how to manage programmers.  If you don't fix it now, then when do you fix it?  Extreme
Programming recommends revising untestable code to make it easier to maintain
and to test.  Sometimes, you must write simple tests, rework the code slightly,
and iterate until it's palatable.</p>
<p>Don't let the enormity of the task get you down.  If you can write Perl code
worth testing, then you can write tests.</p>

<h3><a name="how perl module testing works">How Perl Module Testing Works</a></h3>


<p>This section assumes you're already familiar with <em>perlmodinstall</em>, having
installed a module manually.  After the <code>perl Makefile.PL</code> and <code>make</code> stages,
<code>make test</code> runs any tests shipped with the module, either <em>test.pl</em> or all
files in the <em>t/</em> directory that end in ``.t.''  The <em>blib/</em> directories are
added to <code>@INC</code>, and
<em>Test::Harness</em>
runs the test files, captures their output and provides a short summary of the
results, including success and failure.</p>
<p>At its heart, a test either prints ``ok'' or ``not ok.''  That's it.  Any test
program or testing framework that prints results to standard output can use
Test::Harness.  If you're feeling epistemological (a good trait to cultivate
for writing tests), you could ask ``What is truth?'':</p>
<pre>
        print &quot;1..1\n&quot;;

        if (1) {
                print &quot;ok\n&quot;;
        } else {
                print &quot;not ok\n&quot;;
        }</pre>
<p>Basic?  Yes.  Bogus?  Not really.  This is a variant of an actual Perl core
test.  If you understood that code, then you can write tests.  Ignoring the first
line for now, simply stick it in a file (<em>truth.t</em>) and run either the command
line:</p>
<pre>
        perl -MTest::Harness -e &quot;runtests 'truth.t'&quot;;</pre>
<p>or the program:</p>
<pre>
        #!/usr/bin/perl -w

        use strict;
        use Test::Harness;

        runtests 'truth.t';</pre>
<p>This should produce a message saying that all tests succeeded.  If not,
then something is broken, and many people would be interested in fixing
it.</p>



<p>The first line of the test corresponds to Test::Harness' handy test-numbering
feature.  The harness needs to know how many tests to expect, and each
individual test within a group can have its own number.  This is for your
benefit.  If one test in a 100 mysteriously fails, then it's much easier to
track down number 93 than it is to run through the debugger, comment out large
swaths of the test suite or rely on intuitively placed print statements.</p>

<p>Knowing truth is good, and so is discerning falsehood.  Let's extend <em>truth.t</em>
slightly.  Note the addition of test numbers to each potential printable line.
This is both a boon and a bane.</p>
<pre>
        print &quot;1..2\n&quot;;
		
        if (1) {
                print &quot;ok 1\n&quot;;
        } else {
                print &quot;not ok 1\n&quot;;
        }

        if (0) {
                print &quot;not ok 2\n&quot;;
        } else {
                print &quot;ok 2\n&quot;;
        }</pre>
<p>Besides the increasingly duplicate code, keeping test numbers synchronized is
painful.  False laziness is painful -- Test::Harness emits warnings if the
number of actual tests run does not meet its expectations.  Test writers may
not mind, but spurious warnings will confuse end users and healthily lazy
developers.  As a rule, the simpler the output, the more people will believe
that things succeeded.  The stuffed, smiling Pikachu (hey, it was a birthday
present from an attractive female Web designer) perched atop my monitor makes
me think that a giant yellow smiley face would be even better than a simple
``ok'' message.  ASCII artists, fire up your editors!</p>
<p>Unfortunately, the truth test is repetitive and fragile.  Adding a third test
between the first two (the progression from ``truth'' to ``hidden truth'' to
``falsehood'' makes sense) means duplicating the if/else block and renumbering
the previously second test.  There's also room for a subtle bug:</p>
<pre>
        print &quot;1..2\n&quot;;</pre>
<pre>
        if (1) {
                print &quot;ok 1\n&quot;;
        } else {
                print &quot;not ok 1\n&quot;;
        }</pre>
<pre>
        if ('0 but true') {
                print &quot;ok 2\n&quot;;
        } else {
                print &quot;not ok 2\n&quot;;
        }</pre>
<pre>
        if (0) {
                print &quot;not ok 3\n&quot;;
        } else {
                print &quot;ok 3\n&quot;;
        }</pre>
<p>Forgetting to update the first line is common.  Two tests were expected; three
tests ran.  The confused Test::Harness will report strange things, like
negative failure percentages.  Baby Pikachu may cry.  Smarter programmers
eventually apply good programming style, writing their own <code>ok()</code> functions:</p>
<pre>
        print &quot;1..3\n&quot;;</pre>
<pre>
        my $testnum = 1;
        sub ok {
                my $condition = shift;
                print $condition ? &quot;ok $testnum\n&quot; : &quot;not ok $testnum\n&quot;;
                $testnum++;
        }</pre>
<pre>
        ok( 1 );
        ok( '0 but true' );
        ok( ! 0 );</pre>
<p>The lowest levels of the Perl core test suite use this approach.  It's simpler
to write and handles numbering almost automatically.  It lacks some features,
though, and is little easier to debug.</p>














<h3><a name="enter test::more">Enter Test::More</a></h3>

<p>Several modules exist to make testing easier and almost enjoyable.  <em>Test</em>
ships with modern Perl distributions and plays well with Test::Harness.  The
<a href="http://perlunit.sourceforge.net">Perl-Unit</a> suite reimplements the popular
<a href="http://www.junit.com">JUnit</a> framework in Perl.  The rather new
<a href="http://search.cpan.org/search?dist=Test-Simple">Test::More</a> module adds
several features beyond those of <em>Test</em>.  (I admit a particular bias toward
the latter, though these and other modules are fine choices.)</p>

<p>Test::More has its own <code>ok()</code> function, but it is rarely used in favor of more
specific functions.  <code>is()</code> compares two expressions.  For example, testing an
addition function is as simple as:</p>
<pre>
        is( add(2, 2), 4 );</pre>
<p>This handles strings and numbers equally well. Since version 0.36, it also distinguishes between <code>0</code>,
	<code>''</code> (the empty string), and <code>undef</code> -- we hope.
</p>
<p><code>like()</code> applies a regular expression to a scalar.  This is also useful for
trapping fatal errors:</p>
<pre>
        $self-&gt;eat('garden salad'):

        eval { $self-&gt;write_article() };
        like( $@, qr/not enough sugar/ );</pre>
<p>The second argument can be either a regular expression compiled with the
<code>qr//</code> operator (introduced in Perl 5.005), or a string that resembles a
regular expression.  Modifiers are allowed.  If you absolutely must rewrite the
previous example to run on Perl 5.004 and to use StudlyCaps, then you can:</p>
<pre>
        eval { $self-&gt;write_article() };
        like( $@, '/NoT eNoUgH sUgAr/i' );</pre>
<p>That's too cute/hideous for a real test, but the regex form is completely
valid.</p>

<h3><a name="test::more makes debugging nicer">Test::More Makes Debugging Nicer</a></h3>
<p>That's useful enough already, but there's more to Test::More.</p>
<p>Test::More supports test numbering just as Test::Harness does, and
automatically provides the numbers.  This is a big win in two cases: where the
test suite may accidentally fail (from a <code>die()</code> call, a segmentation fault,
or spontaneous combustion), or if the tests can accidentally repeat (due to an
improper <code>chdir()</code>, unexpected input in a loop condition, or a time warp).
Test::Harness is happy to warn whether the number of tests actually run do not match
its expectations.  You just have to tell it how many should run.  This is
usually done when using Test::More:</p>
<pre>
        use Test::More tests =&gt; 50;</pre>
<p>When writing new tests, you may not know how many there will be.  Use the
<code>no_plan</code> option:</p>
<pre>
        use Test::More 'no_plan';</pre>
<p>Extreme Programming recommends this game-like approach: add a test, run it,
write code to pass the test, repeat.  When you've finished, update the <code>use</code>
line to reflect the actual number of tests.</p>
<p>Test::More also handles failures gracefully.  Given the following file with a
final, doomed test:</p>
<pre>
        use Test::More tests =&gt; 4;</pre>
<pre>
        is( 1, 1 );
        is( !0, 1 );
        is( 0, 0 );
        is( undef, 1 );</pre>
<p>Test::More run on its own, not through Test::Harness, produces:</p>
<pre>
        1..4
        ok 1
        ok 2
        ok 3
        not ok 4
        #     Failed test (numbers.t at line 6)
        #          got: undef
        #     expected: '1'
        # Looks like you failed 1 tests of 1.</pre>
<p>The error message provides the name of the file containing the tests, the
number of the failed test, the line number containing the failed test, and
expected and received data.  This makes for easier debugging.  Count tests to
find an error just once, and you'll prefer this approach.</p>
<p>Test::Harness also supports optional test comments attached to test messages.
That is, it allows raw tests to say:</p>
<pre>
        print &quot;ok 1 # the most basic test possible\n&quot;;</pre>
<p>Nearly all Test::More functions support this as an optional parameter:</p>
<pre>
        ok( 1, 'the number 1 should evaluate to true' );
        is( 2 + &quot;2&quot;, 4, 'numeric strings should numerify in addition' );
        like( 'abc', qr/z*/, '* quantifier should match zero elements' );</pre>
<p>These names are required by nothing except social convention.  Think of them as
little test comments.  If the test is wrong, or exposes a fixed bug that should
never reoccur, then a descriptive name makes it clear what the test should be
testing.  Test::Harness silently eats the names, but they're present when run
manually:</p>
<pre>
        ok 1 - the number 1 should evaluate to true
        ok 2 - numeric strings should numerify in addition
        ok 3 - * quantifier should match zero elements</pre>
<p>Manual test runs make for improved bug reports.  Ignore these convenient tools
at your own peril.</p>
<h3><a name="intermediate test::more features">Intermediate Test::More Features</a></h3>
<p>If the previous features weren't enough, Test::More supports still more!  One
such is the notion of skippable tests.  Occasionally, the presence or absence
of certain criteria obviate the need to test a feature.  Consider the <code>qr//</code>
operator explained earlier.  A module that needs to be backward compatible to
Perl 5.004 can gradefully degrade its test suite with skippable tests:</p>
<pre>
        SKIP: {
                skip( 'qr// not supported in this version', 2 ) unless $] &gt;= 5.005;</pre>
<pre>
                my $foo = qr/i have a cat/;
                ok( 'i have a caterpillar' =~ $foo,
                        'compiled regex should match similar string' );</pre>
<pre>
                ok( 'i have a cold' !~ $foo,
                        'compiled regex should not match dissimilar string' );
        }</pre>
<p>There's a lot to digest.  First, the skippable tests are contained in a
labelled block.  The label must be <em>SKIP</em>.  (Don't worry: you can have several
of these within a file.)  Next, there should be a condition that governs
whether to skip the tests.  This example checks the special variable
<em>perlvar</em> to find the current Perl version.  <code>skip()</code> will only be called
when run with an older version.</p>
<p>The <code>skip()</code> function always confuses me with its unique parameter order.  The
first argument is the name to display for each skipped test.  The second
argument is the number of tests to skip.  This must match the number of tests
within the block, at the risk of certain confusion.  Run on Perl 5.004, the
above test produces:</p>
<pre>
        ok 1 # skip qr// not supported in this version
        ok 2 # skip qr// not supported in this version</pre>
<p>Though the message says <em>ok</em>, Test::Harness will see skip and report the
tests as skipped, not passed.  This should only be used for tests that
absolutely will not run due to platform or version differences.  For tests you
just can't figure out <b>yet</b>, use <code>todo()</code>.</p>
<p>Though everything is built on <code>Test::Builder::ok()</code>, other functions offer
helpful shortcuts.  <code>use_ok()</code> and <code>require_ok</code> load and optionally import
the named file, reporting the success or error.  These verify that a module can
be found and compiled, and are often used for the first test in a suite.  The
<code>can_ok()</code> function attempts to resolve a class or an object method.
<code>isa_ok()</code> checks inheritance:</p>
<pre>
        use_ok( 'My::Module' );
        require_ok( 'My::Module::Sequel' );</pre>
<pre>
        my $foo = My::Module-&gt;new();
        can_ok( $foo-&gt;boo() );
        isa_ok( $foo, 'My::Module' );</pre>
<p>They produce their own test names:</p>
<pre>
        ok 1 - use My::Module;
        ok 2 - require My::Module::Sequel;
        ok 3 - My::Module-&gt;can(boo)
        ok 4 - object-&gt;isa('My::Module')</pre>
<p>Other functions and features are documented in the Test::More documentation.
As well, <a href="http://search.cpan.org/doc/MSCHWERN/Test-Simple-0.36/lib/Test/Tutorial.pod">the Test::Tutorial manpage</a> explains similar things with a different wit.</p>
<p>Finally, do not forget good programming practices.  Test functions are simply
standard subroutines.  Tests are just Perl code.  Use loops, variables, helper
subs, <code>map()</code>,  and anything else, when they make things easier.  For example,
basic inherited interface testing can be made easier with:</p>
<pre>
        # see if IceCreamBar inherits these methods from Popsicle
        my $icb = IceCreamBar-&gt;new();</pre>
<pre>
        foreach my $method (qw( fall_off_stick freeze_tongue drip_on_carpet )) {
                can_ok( $icb, $method, &quot;IceCreamBar should be able to $method()&quot; );
        }</pre>
<p>That beats writing several individual <code>can_ok()</code> tests.  Interpolating things
into the test name is also handy.</p>
<h3><a name="conclusion">Conclusion</a></h3>
<p>Testing is unfortunately often neglected, especially among free software
projects.  Think of it as getting plenty of sleep, eating vegetables, and
working out regularly.  It may cramp your style at first, but will improve
things immensely if you do it consistently.  (Results may vary if you're adding
tests to a huge system that doesn't have them, like, say, Perl itself.)</p>
<p>One goal of Perl is to make your life easier.  Perl 5.8 will include <a href="http://search.cpan.org/doc/MSCHWERN/Test-Simple-0.36/lib/Test/More.pm">Test::More</a>
and its hearty brethren, <a href="http://search.cpan.org/doc/MSCHWERN/Test-Simple-0.36/lib/Test/Simple.pm">the Test::Simple manpage</a> and <a href="http://search.cpan.org/doc/MSCHWERN/Test-Simple-0.36/lib/Test/Builder.pm">the Test::Builder manpage</a>.  They exist to
make writing tests less of a hassle, and even more pleasant.  Consider them.</p>

<p>The easier it is to write and maintain tests, the more likely people will do it.  More and better tests improve software portability, maintainability, and reliability.  You may currently compare testing to broccoli, brussel sprouts, and wind sprints.  Try Test::More or another framework, and you may grow to see them as oranges, sweet potatoes with marshmallows, and a trip to the sauna.  It really is good for you.</p>

<p><em>chromatic is the author of <a href="http://onyxneon.com/books/modern_perl/">Modern Perl</a>. In his spare time, he has been working on <a href="http://trendshare.org/how-to-invest/">helping novices understand stocks and investing</a>.</em></p>
        </div>



    </div>
    <div class="asset-footer"></div>
</div>




                            <div class="content-nav">
                                <a href="/pub/2001/11/">&laquo; November 2001</a> |
                                <a href="/pub/">Main Index</a> |
                                <a href="/pub/archives.html">Archives</a>
                                | <a href="/pub/2002/01/">January 2002 &raquo;</a>
                            </div>


                        </div>
                    </div>


                    <div id="beta">
    <div id="beta-inner">


    
    <div class="widget-what-is-perl widget">
    <div class="widget-content widget-content-what-is-perl">
       Visit the home of the  Perl programming language: <a href="http://www.perl.org/">Perl.org</a
    </div>
</div>
<div class="widget-find-out-more widget-archives widget">
    <div class="widget-content">
        <ul>
            <li><a href="http://www.perl.org/get.html">Download</a></li>
            <li><a href="http://perldoc.perl.org/">Documentation</a></li>
            <li><a href="http://blogs.perl.org/">Perl Bloggers</a></li>
            <li><a href="http://news.perlfoundation.org/">Foundation News</a></li>
        </ul>
    </div>
</div><div class="widget-tcpc widget">
<h3 class="widget-header">Sponsored by</h3>
    <div class="widget-content">
        <a href="http://training.perl.com/" alt="Perl Training" target="_blank"><img src="/i/tcpc.png" width="150" height="50"></a>
    </div>
</div>

<div class="widget-syndication widget">
    <div class="widget-content">
        <ul>
            <li><img src="/mt-static/images/status_icons/feed.gif" alt="Subscribe to feed" width="9" height="9" /> <a href="/pub/atom.xml">Subscribe to this website's feed</a></li>

        </ul>
    </div>
</div>
<div class="widget-archive-monthly widget-archive widget">
    <h3 class="widget-header">Monthly <a href="/pub/archives.html">Archives</a></h3>
    <div class="widget-content">
        <ul>
        
            <li><a href="/pub/2014/02/">February 2014 (1)</a></li>
        
    
        
            <li><a href="/pub/2014/01/">January 2014 (1)</a></li>
        
    
        
            <li><a href="/pub/2013/10/">October 2013 (1)</a></li>
        
    
        
            <li><a href="/pub/2013/01/">January 2013 (1)</a></li>
        
    
        
            <li><a href="/pub/2012/12/">December 2012 (1)</a></li>
        
    
        
            <li><a href="/pub/2012/11/">November 2012 (1)</a></li>
        
    
        
            <li><a href="/pub/2012/10/">October 2012 (2)</a></li>
        
    
        
            <li><a href="/pub/2012/08/">August 2012 (2)</a></li>
        
    
        
            <li><a href="/pub/2012/06/">June 2012 (11)</a></li>
        
    
        
            <li><a href="/pub/2012/05/">May 2012 (18)</a></li>
        
    
        
            <li><a href="/pub/2012/04/">April 2012 (17)</a></li>
        
    
        
            <li><a href="/pub/2012/02/">February 2012 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/12/">December 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/09/">September 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/08/">August 2011 (2)</a></li>
        
    
        
            <li><a href="/pub/2011/06/">June 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/05/">May 2011 (3)</a></li>
        
    
        
            <li><a href="/pub/2011/04/">April 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/03/">March 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/02/">February 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/01/">January 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2010/11/">November 2010 (1)</a></li>
        
    
        
            <li><a href="/pub/2010/10/">October 2010 (2)</a></li>
        
    
        
            <li><a href="/pub/2010/09/">September 2010 (1)</a></li>
        
    
        
            <li><a href="/pub/2010/08/">August 2010 (3)</a></li>
        
    
        
            <li><a href="/pub/2010/07/">July 2010 (2)</a></li>
        
    
        
            <li><a href="/pub/2010/04/">April 2010 (2)</a></li>
        
    
        
            <li><a href="/pub/2010/03/">March 2010 (4)</a></li>
        
    
        
            <li><a href="/pub/2008/05/">May 2008 (1)</a></li>
        
    
        
            <li><a href="/pub/2008/04/">April 2008 (2)</a></li>
        
    
        
            <li><a href="/pub/2008/03/">March 2008 (1)</a></li>
        
    
        
            <li><a href="/pub/2008/02/">February 2008 (1)</a></li>
        
    
        
            <li><a href="/pub/2008/01/">January 2008 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/12/">December 2007 (2)</a></li>
        
    
        
            <li><a href="/pub/2007/09/">September 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/08/">August 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/07/">July 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/06/">June 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/05/">May 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/04/">April 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/03/">March 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/02/">February 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/01/">January 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/12/">December 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/11/">November 2006 (2)</a></li>
        
    
        
            <li><a href="/pub/2006/10/">October 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/09/">September 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/08/">August 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/07/">July 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/06/">June 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/05/">May 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/04/">April 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/03/">March 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/02/">February 2006 (4)</a></li>
        
    
        
            <li><a href="/pub/2006/01/">January 2006 (4)</a></li>
        
    
        
            <li><a href="/pub/2005/12/">December 2005 (4)</a></li>
        
    
        
            <li><a href="/pub/2005/11/">November 2005 (3)</a></li>
        
    
        
            <li><a href="/pub/2005/10/">October 2005 (2)</a></li>
        
    
        
            <li><a href="/pub/2005/09/">September 2005 (2)</a></li>
        
    
        
            <li><a href="/pub/2005/08/">August 2005 (9)</a></li>
        
    
        
            <li><a href="/pub/2005/07/">July 2005 (8)</a></li>
        
    
        
            <li><a href="/pub/2005/06/">June 2005 (9)</a></li>
        
    
        
            <li><a href="/pub/2005/05/">May 2005 (8)</a></li>
        
    
        
            <li><a href="/pub/2005/04/">April 2005 (7)</a></li>
        
    
        
            <li><a href="/pub/2005/03/">March 2005 (6)</a></li>
        
    
        
            <li><a href="/pub/2005/02/">February 2005 (7)</a></li>
        
    
        
            <li><a href="/pub/2005/01/">January 2005 (6)</a></li>
        
    
        
            <li><a href="/pub/2004/12/">December 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/11/">November 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/10/">October 2004 (5)</a></li>
        
    
        
            <li><a href="/pub/2004/09/">September 2004 (9)</a></li>
        
    
        
            <li><a href="/pub/2004/08/">August 2004 (6)</a></li>
        
    
        
            <li><a href="/pub/2004/07/">July 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/06/">June 2004 (6)</a></li>
        
    
        
            <li><a href="/pub/2004/05/">May 2004 (7)</a></li>
        
    
        
            <li><a href="/pub/2004/04/">April 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/03/">March 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/02/">February 2004 (9)</a></li>
        
    
        
            <li><a href="/pub/2004/01/">January 2004 (7)</a></li>
        
    
        
            <li><a href="/pub/2003/12/">December 2003 (4)</a></li>
        
    
        
            <li><a href="/pub/2003/11/">November 2003 (7)</a></li>
        
    
        
            <li><a href="/pub/2003/10/">October 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2003/09/">September 2003 (6)</a></li>
        
    
        
            <li><a href="/pub/2003/08/">August 2003 (7)</a></li>
        
    
        
            <li><a href="/pub/2003/07/">July 2003 (9)</a></li>
        
    
        
            <li><a href="/pub/2003/06/">June 2003 (9)</a></li>
        
    
        
            <li><a href="/pub/2003/05/">May 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2003/04/">April 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2003/03/">March 2003 (10)</a></li>
        
    
        
            <li><a href="/pub/2003/02/">February 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2003/01/">January 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2002/12/">December 2002 (5)</a></li>
        
    
        
            <li><a href="/pub/2002/11/">November 2002 (9)</a></li>
        
    
        
            <li><a href="/pub/2002/10/">October 2002 (7)</a></li>
        
    
        
            <li><a href="/pub/2002/09/">September 2002 (11)</a></li>
        
    
        
            <li><a href="/pub/2002/08/">August 2002 (8)</a></li>
        
    
        
            <li><a href="/pub/2002/07/">July 2002 (8)</a></li>
        
    
        
            <li><a href="/pub/2002/06/">June 2002 (4)</a></li>
        
    
        
            <li><a href="/pub/2002/05/">May 2002 (6)</a></li>
        
    
        
            <li><a href="/pub/2002/04/">April 2002 (6)</a></li>
        
    
        
            <li><a href="/pub/2002/03/">March 2002 (7)</a></li>
        
    
        
            <li><a href="/pub/2002/02/">February 2002 (5)</a></li>
        
    
        
            <li><a href="/pub/2002/01/">January 2002 (8)</a></li>
        
    
        
            <li><a href="/pub/2001/12/">December 2001 (7)</a></li>
        
    
        
            <li><a href="/pub/2001/11/">November 2001 (5)</a></li>
        
    
        
            <li><a href="/pub/2001/10/">October 2001 (9)</a></li>
        
    
        
            <li><a href="/pub/2001/09/">September 2001 (7)</a></li>
        
    
        
            <li><a href="/pub/2001/08/">August 2001 (13)</a></li>
        
    
        
            <li><a href="/pub/2001/07/">July 2001 (8)</a></li>
        
    
        
            <li><a href="/pub/2001/06/">June 2001 (13)</a></li>
        
    
        
            <li><a href="/pub/2001/05/">May 2001 (11)</a></li>
        
    
        
            <li><a href="/pub/2001/04/">April 2001 (9)</a></li>
        
    
        
            <li><a href="/pub/2001/03/">March 2001 (8)</a></li>
        
    
        
            <li><a href="/pub/2001/02/">February 2001 (8)</a></li>
        
    
        
            <li><a href="/pub/2001/01/">January 2001 (8)</a></li>
        
    
        
            <li><a href="/pub/2000/12/">December 2000 (6)</a></li>
        
    
        
            <li><a href="/pub/2000/11/">November 2000 (10)</a></li>
        
    
        
            <li><a href="/pub/2000/10/">October 2000 (10)</a></li>
        
    
        
            <li><a href="/pub/2000/09/">September 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/2000/08/">August 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/2000/07/">July 2000 (5)</a></li>
        
    
        
            <li><a href="/pub/2000/06/">June 2000 (7)</a></li>
        
    
        
            <li><a href="/pub/2000/05/">May 2000 (7)</a></li>
        
    
        
            <li><a href="/pub/2000/04/">April 2000 (3)</a></li>
        
    
        
            <li><a href="/pub/2000/03/">March 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/2000/02/">February 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/2000/01/">January 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/1999/12/">December 1999 (6)</a></li>
        
    
        
            <li><a href="/pub/1999/11/">November 1999 (6)</a></li>
        
    
        
            <li><a href="/pub/1999/10/">October 1999 (5)</a></li>
        
    
        
            <li><a href="/pub/1999/09/">September 1999 (4)</a></li>
        
    
        
            <li><a href="/pub/1999/08/">August 1999 (3)</a></li>
        
    
        
            <li><a href="/pub/1999/07/">July 1999 (2)</a></li>
        
    
        
            <li><a href="/pub/1999/06/">June 1999 (3)</a></li>
        
    
        
            <li><a href="/pub/1999/04/">April 1999 (1)</a></li>
        
    
        
            <li><a href="/pub/1999/03/">March 1999 (1)</a></li>
        
    
        
            <li><a href="/pub/1999/01/">January 1999 (1)</a></li>
        
    
        
            <li><a href="/pub/1998/12/">December 1998 (1)</a></li>
        
    
        
            <li><a href="/pub/1998/11/">November 1998 (1)</a></li>
        
    
        
            <li><a href="/pub/1998/07/">July 1998 (2)</a></li>
        
    
        
            <li><a href="/pub/1998/06/">June 1998 (1)</a></li>
        
    
        
            <li><a href="/pub/1998/03/">March 1998 (1)</a></li>
        
        </ul>
    </div>
</div>
        
    

<div class="widget-powered widget">
    <div class="widget-content">
        <a href="http://www.movabletype.com/"><img src="/mt-static/images/bug-pbmt-white.png" alt="Powered by Movable Type 5.13-en" width="120" height="75" /></a>
    </div>
</div>



    </div>
</div>






                </div>
            </div>


            <div id="footer">
    <div id="footer-inner">
        <div id="footer-content">
            <div class="widget-powered widget">
                <div class="widget-content">
                    Powered by <a href="http://www.movabletype.com/" rel="generator">Movable Type Pro</a>
                </div>
            </div>

            <div class="widget-creative-commons widget">
                <div class="widget-content">
                    This blog is licensed under a <a href="http://creativecommons.org/licenses/by-nc-nd/3.0/">Creative Commons License</a>.
                </div>
            </div>

        </div>
    </div>
</div>



        </div>
    </div>
</body>
</html>
