<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" id="sixapart-standard">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="generator" content="Movable Type Pro 5.13-en" />
<link rel="stylesheet" href="/pub/styles.css" type="text/css" />
<link rel="start" href="/pub/" title="Home" />
<link rel="alternate" type="application/atom+xml" title="Recent Entries" href="/pub/atom.xml" />
<script type="text/javascript" src="/pub/mt.js"></script>
<!--
<rdf:RDF xmlns="http://web.resource.org/cc/"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
<Work rdf:about="/pub/">
<dc:title>Perl.com</dc:title>
<dc:description>news and views of the Perl programming language</dc:description>
<license rdf:resource="http://creativecommons.org/licenses/by-nc-nd/3.0/" />
</Work>
<License rdf:about="http://creativecommons.org/licenses/by-nc-nd/3.0/">
</License>
</rdf:RDF>
-->

<script type="text/javascript">

 var _gaq = _gaq || [];
 _gaq.push(['_setAccount', 'UA-50555-22']);
 _gaq.push(['_trackPageview']);

 (function() {
   var ga = document.createElement('script'); ga.type =
   'text/javascript'; ga.async = true;
   ga.src = ('https:' == document.location.protocol ? 'https://ssl' :
   'http://www') + '.google-analytics.com/ga.js';
   var s = document.getElementsByTagName('script')[0];
   s.parentNode.insertBefore(ga, s);
 })();

</script>
<script type='text/javascript' src='http://partner.googleadservices.com/gampad/google_service.js'></script>
<script type='text/javascript'>
GS_googleAddAdSenseService("ca-pub-4136420132070439");
GS_googleEnableAllServices();
</script>
<script type='text/javascript'>
GA_googleAddSlot("ca-pub-4136420132070439", "Perl_728x90");
</script>
<script type='text/javascript'>GA_googleFetchAds();</script>
    <title>Perl.com: April 2001 Archives</title>


    <link rel="prev" href="/pub/2001/03/" title="March 2001" />
    <link rel="next" href="/pub/2001/05/" title="May 2001" />

</head>
<body id="perl-com" class="mt-archive-listing mt-datebased-monthly-archive layout-wt">
    <div id="container">
        <div id="container-inner">


            <div id="header">
    <div id="header-inner">
        <div id="header-content">
        <span id="top_advert"> 
<!-- Put any landscape advert in here -->
<!-- Perl_728x90 -->
<script type='text/javascript'>
GA_googleFillSlot("Perl_728x90");
</script>
        </span> 



            <div id="header-name"><a href="/pub/" accesskey="1">Perl.com</a></div>
            <div id="header-description">news and views of the Perl programming language</div>




        </div>
    </div>
</div>



            <div id="content">
                <div id="content-inner">


                    <div id="alpha">
                        <div id="alpha-inner">


                            <h1 id="page-title" class="archive-title">April 2001 Archives</h1>





                            
                            <div id="entry-1506" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2001/05/p5pdigest/THISWEEK-20010429.html" rel="bookmark">This Week on p5p 2001/04/29</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Simon Cozens</span> on <abbr class="published" title="2001-04-29T00:00:00-08:00">April 29, 2001 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            </P>

<P>


<!-- This week on perl5-porters (23-29 Apr 2001) -->

<br />
<br />
      <H3><a name="Notes">Notes</a></H3>

</P>

<P>

You can subscribe to an email version of this summary by sending an
empty message to 
<a href="mailto:perl5-porters-digest-subscribe@netthink.co.uk"><tt>perl5-porters-digest-subscribe@netthink.co.uk</tt>.</a></P>

<P>
Please send corrections and additions to 
<CODE>perl-thisweek-YYYYMM@simon-cozens.org</CODE> where 
<CODE>YYYYMM</CODE> is the current year and month.  Changes and additions to the 
<a href="http://simon-cozens.org/writings/whos-who.html">perl5-porters</a> biographies are particularly welcome.
</P>

<P>
This week was particularly busy, seeing nearly 550 messages.
<H3><a name="MacPerl_561_Alpha">MacPerl 5.6.1 Alpha</a></H3>

</P>

<P>

<a href="http://simon-cozens.org/writings/whos-who.html#NANDOR">Chris Nandor </a> announced that MacPerl 5.6.1 is now in its alpha state.
Mac users, wander over to 
<a href="http://macperl.sourceforge.net/">the MacPerl Sourceforge page</a> and grab it.
<H3><a name="BDeparse_Hackery_Continues">B::Deparse Hackery Continues</a></H3>

</P>

<P>

As usual, 
<a href="http://simon-cozens.org/writings/whos-who.html#HOUSTON">Robin</a> has been providing huge numbers of patches for 
<CODE>B::Deparse</CODE> - over the past few years, we've been adding all sorts of neat
optimizations to the interpreter, and now Robin's been putting support
for them back into the deparser. I asked him about it the other day and
it seems it's getting close to the time when it's sensible to use 
<CODE>B::Deparse</CODE> for code serialization. 
</P>

<P>
This week saw additions of human-readable pragmas, honouring lexical scoping
inside things like 
<CODE>do {  }</CODE>, 
<CODE>__END__</CODE> sections, better filetest handling, better variable interpolation
support, correct context forcing,  as well as many smaller nits. 
</P>

<P>
The Deparser is particularly important, because it shows us just how
much we can get out of Perl bytecode. What would happen, for instance,
if someone rewrote the Deparser to output not Perl, but another
language?
<H3><a name="Underscores_in_constants">Underscores in constants</a></H3>

</P>

<P>

</P>

<P>
On a similar note, 
<a href="http://simon-cozens.org/writings/whos-who.html#GUY">Mike Guy </a> produced a patch which explained why 
<CODE>0</CODE> and 
<CODE>1</CODE> in void context don't cause warnings, but every other constant does.
This caused heated but essentially pointless discussion.
<H3><a name="Licensing_Perl_modules">Licensing Perl modules</a></H3>

</P>

<P>

The vexed issue of module licensing turned up, after the GNU Automake
project wanted to use a CPAN module in their work. However, the module
has no license declaration and the author has disappeared, so they can't
use the code; the FSF took this as a cue to remind us that everything ought
to have an explicit license. Ask brought the discussion to P5P, asking
us how best to encourage module authors to specify license information.
One suggestion was to extend the 
<CODE>DSLI</CODE> classification for CPAN modules to have a &quot;license&quot; category and nag
authors to state their license intentions. 
<a href="http://simon-cozens.org/writings/whos-who.html#HIETANIEMI">Jarkko</a> and Elaine were
concerned that we should not get so heavy on CPAN authors, and Jarkko
noted that Elaine had recently added a default 
<CODE>LICENSE</CODE> section in 
<CODE>h2xs</CODE> which should act as encouragement in the future. 
<a href="http://simon-cozens.org/writings/whos-who.html#ALLBERY">Russ Allbery </a> reminded
 us of the recommended license text:
<blockquote> This program is free software; you may redistribute it and/or modify it
 under the same terms as Perl itself.
</blockquote></P>

<P>
He also sparked a lot of armchair lawyering about &quot;public domain&quot;
works. Amazingly, we managed to have a reasonably sensible discussion
about licenses without anyone Cc'ing RMS.
<H3><a name="M17N_and_POD">M17N and POD</a></H3>

</P>

<P>

Sean Dague asked if there was a good way to have multiple languages in
one's POD files; Jarkko suggested using 
</P>

</P><PRE>
    =for lang en
</PRE>

<P>
and coaxing the podlators into spitting out the ones you want. Graham
Barr said that he'd rather put different languages in different files,
but Michael Stevens reminded us that keeping POD and code in the same
place is a Good Thing. 
</P>

<P>
I'd be interested to hear from anyone who's tried to use the POD
utilities for things like this, and I'm sure Sean would be too.
<a href="http://simon-cozens.org/writings/whos-who.html#MANFREDI">Raphael</a> announced that he had produced a POD pre-processor, 
<a href="http://search.cpan.org/search?dist=Pod-PP">POD::PP</a>, which may help solving this sort of thing.
<H3><a name="Regex_dumping_again">Regex dumping again</a></H3>

</P>

<P>

<a href="http://simon-cozens.org/writings/whos-who.html#SANDEN">Hugo</a> rewrote
<a href="http://simon-cozens.org/writings/whos-who.html#DOMINUS">MJD's</a> patch to the regular expression dumper
(remember 
<a href="/pub/2001/04/p5pdigest/THISWEEK-20010422.html#Regex_Debugger_and_Reference_Type">this</a>?) by ensuring that the value it depends on is always set, but Jarkko
then noticed it was coredumping whenever he ran 
<CODE>pod2man</CODE>. Hugo explained what was going on:
<blockquote>Hmm, I start to understand - probably more than I wanted to.
</P>

<P>
We need to know two things: which node is logically next in the regexp,
and which is physically next in memory. The patch above causes problems
because NEXT_OFF is expected to point to the logical next node, not
the physical next node.
</P>

<P>
The attached patch doesn't quite work either, and I'm not yet sure why not:
it dumps the right thing for /(\G|x)([^x]*)x/, but not for
/(\G|x)([[:alpha:]]*)x/. (I'm also a bit concerned about using up the last
bit of ANYOF_FLAGS.)
<I>(And later...)</I></P>

<P>
This area could probably do with some cleanup: it doesn't help that there
is already a 'ANYOF_CLASS' flag, but that it does not distinguish between
a regnode_charclass and a regnode_charclass_class - luckily I didn't need
to understand it for this patch, since it is something to do with locale.
</blockquote></P>

<P>
Jarkko promised to document what was going on with 
<CODE>ANYOF_CLASS</CODE> and explained the difference between 
<CODE>regnode_charclass</CODE> and 
<CODE>regnode_charclass_class</CODE>: &quot;
<CODE>ANYOF_CLASS</CODE> has 
<CODE>[[:blah:]]</CODE> flags. The first one is 
<CODE>ANYOF</CODE> with only static character class characters
marked in its 256-bit bitmap, the second one in an 
<CODE>ANYOF</CODE> that has
(hopefully) the 
<CODE>ANYOF_CLASS</CODE> flag on and has locale-dependent (and
therefore runtime-dynamic) 
<CODE>[[:blah:]]</CODE> classes.
</P>

<P>
Jarkko also mentioned that someone ought to write 
<CODE>t/pragma/re.t</CODE> to test 
<CODE>use re "debug"</CODE> behaviour. (That's a hint.)
</P>

<P>
There was also an extremely confusing thread about word boundaries with
Hugo and 
<a href="http://simon-cozens.org/writings/whos-who.html#ZAKHEREVICH">Ilya</a> disagreeing with each other, and in unrelated regex
wibblings, Leon Brocard found that 
<CODE>use re 'debug'</CODE> wasn't actually producing any output any more. Jarkko fixed the bug,
and MJD poined out Mr Maeda's wonderful 
<a href="http://www.cc.rim.or.jp/~midorin/mad-p/RegexDiagram.html">regex grapher</a>.
<H3><a name="Various">Various</a></H3>

</P>

<P>

Benjamin Sugars continued the XSification of the 
<CODE>Cwd</CODE> module, by implementing 
<CODE>Cwd::abs_path</CODE> in C. Phillip Newton smashed a few bugs in 
<CODE>find2perl</CODE>.
</P>

<P>
Matt Sergeant updated the FAQ to reflect the fact that we now have 
<CODE>Time::Piece</CODE> in the core, making 
<CODE>Time::localtime</CODE> and other modules a less than optimal solution.
</P>

<P>
Last week, we reported on the efforts to create a pure-Perl compression
library; the discussions this week seem to have centered around trying
to ship 
<CODE>zlib</CODE> with Perl, integrate it in the Perl build process and ensuring its
 portability to everywhere Perl can go.
<a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2001-04/msg01422.html">Paul Marquess' message</a> about this is a good summary of what's going on.
</P>

<P>
Paul also put in the next version of 
<CODE>DB_File</CODE>. 
<a href="http://simon-cozens.org/writings/whos-who.html#SCHWERN">Michael Schwern</a> asked why references decompose to integers in a number
context. Some people pointed at the documentation, and explained that it
was to help comparing references. He also asked if you can get the
variable name of an SV; you can't.
</P>

<P>
Dave Mitchell asked if maintainence branches could be made more
frequent. Sarathy said that he would like that to happen, but doesn't
have the tuits to make it happen right now. His 
<a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2001-04/msg01626.html">thoughts on handling the maintainance</a> are definitely worth reading.
<a href="http://simon-cozens.org/writings/whos-who.html#WEST">Casey West</a> announced his 
<CODE>perl5-porters</CODE> impressions night at TPC. Contact him at 
<CODE>casey@geeknest.com</CODE> for more information about that. He also cleaned up 
<CODE>FindBin</CODE><a href="http://simon-cozens.org/writings/whos-who.html#ABIGAIL">Abigail</a> asked why we can have underscores in fractional parts of numeric
constants, like 
<CODE>5.___5</CODE>. Well, we just can. 
</P>

<P>
Until next week I remain, your humble and obedient servant,
</P>

<hr>

<a href="mailto:simon@brecon.co.uk">Simon Cozens</a>


<ul>
  <li><a href="#Notes">Notes</a>
  <li><a href="#MacPerl_561_Alpha">MacPerl 5.6.1 Alpha</a>
  <li><a href="#BDeparse_Hackery_Continues">B::Deparse Hackery Continues</a>
  <li><a href="#Underscores_in_constants">Underscores in constants</a>
  <li><a href="#Licensing_Perl_modules">Licensing Perl modules</a>
  <li><a href="#M17N_and_POD">M17N and POD</a>
  <li><a href="#Regex_dumping_again">Regex dumping again</a>
  <li><a href="#Various">Various</a>
</ul>

        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1486" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2001/04/24/soap.html" rel="bookmark">Quick Start Guide with SOAP Part Two</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Paul Kulchenko</span> on <abbr class="published" title="2001-04-23T00:00:00-08:00">April 23, 2001 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            <!-- Quick Start Guide With SOAP and SOAP::Lite Part Two -->
<p><table width="180" cellspacing="0" cellpadding="4" align="right" border="1"> <tr> <td align="center" valign="top" bgcolor="#6699cc"> <font color="#ffffff">Table of Contents</td> </tr>  <tr> <td> <p class="fine"> &#149;<a href="/pub/2001/01/soap.html">Quick Start with SOAP Part I</a><br /><br /> &#149;<a href="#more complex server (daemon, mod_perl and mod_soap)">More Complex Server (daemon, mod_perl and mod_soap)</a><br /><br /> &#149;<a href="#access to remote services">Access to Remote Services</a><br /><br /> &#149;<a href="#access with service description (wsdl)">Access With Service Description (WSDL)</a><br /><br /> &#149;<a href="#security (ssl, basic/digest authentication, cookiebased authentication, ticketbased authentication, access control)">Security (SSL, basic/digest authentication, cookie-based authentication, ticket-based authentication, access control)</a><br /><br /> &#149;<a href="#handling lols (list of lists, structs, objects, or something else)">Handling LoLs (List of Lists, Structs, Objects, or something else)</a><br /> </td> </tr> </p> </table>  <h3><a name="more complex server (daemon, mod_perl and mod_soap)">More Complex Server (daemon, mod_perl and mod_soap)</a></h3>   <p>You shouldn't have many problems with the CGI-based SOAP server you created in the <a href="/pub/2001/01/soap.html">first part of this article</a>;
however, performance could be significantly better. The next logical step 
might be to implement SOAP services using accelerators (like PerlEx or 
VelociGen) or persistent technologies (like mod_perl). 
Another lightweight solution might be to implement the SOAP service as an HTTP 
daemon; in that case, you don't need to use a separate Web server. This might 
be useful in a situation where a client application accepts SOAP calls, or 
for internal usage.</p> <dl> <dt><strong><a name="item_HTTP_daemon">HTTP daemon</a></strong><br> <dd> The following code shows an example implementation for a HTTP daemon:
<p> 4.a. server   (HTTP daemon)                     
<pre> #!perl -w

  use SOAP::Transport::HTTP;

  use Demo;

  # don't want to die on 'Broken pipe' or Ctrl-C
  $SIG{PIPE} = $SIG{INT} = 'IGNORE';

  $daemon = SOAP::Transport::HTTP::Daemon
    -&gt; new (LocalPort =&gt; 80)
    -&gt; dispatch_to('/home/soaplite/modules')
  ;

  print &quot;Contact to SOAP server at &quot;, $daemon-&gt;url, &quot;\n&quot;;
  $daemon-&gt;handle;</pre> </div>  <p>Not much difference from the CGI server (<a href="/pub/2001/01/soap.html#item_Dynamic"><code>Dynamic</code></a>), huh? 
And it makes the same interface accessible, only through a different 
endpoint. This code is all you need to run the SOAP server on your computer 
without anything else.</p> <p></p> <dt><strong><a name="item_HTTP_daemon_in_VBScript">HTTP daemon in VBScript</a></strong><br> <dd> Similar code in VBScript may look like:
<p>4.b. server (HTTP daemon, VBScript)
<pre> call CreateObject(&quot;SOAP.Lite&quot;) _
   .server(&quot;SOAP::Transport::HTTP::Daemon&quot;, _
     &quot;LocalPort&quot;, 80) _
   .dispatch_to(&quot;/home/soaplite/modules&quot;) _
   .handle</pre>  <p>This is all you need to run SOAP server on a Microsoft platform (and it will
run on Win9x/Me/NT/2K as soon as you register Lite.dll with <code>regsvr32 Lite.dll</code>).</p>   <dt><strong><a name="item_ASP%2FVB">ASP/VB</a></strong><br> <dd> An ASP server could be created with VBScript or PerlScript code:

<p>4.c. server (ASP server, VBScript) 
<pre> &lt;%
    Response.ContentType = &quot;text/xml&quot;
    Response.Write(Server.CreateObject(&quot;SOAP.Lite&quot;) _
      .server(&quot;SOAP::Server&quot;) _ 
      .dispatch_to(&quot;/home/soaplite/modules&quot;) _
      .handle(Request.BinaryRead(Request.TotalBytes)) _
    )
  %&gt;</pre>  <dt><strong><a name="item_Apache%3A%3ARegistry">Apache::Registry</a></strong><br> <dd> One of the easiest ways to significantly speed up your CGI-based SOAP server 
is to wrap it with the mod_perl Apache::Registry module. You need to configure it 
in the httpd.conf file:
<p>4.d. server (Apache::Registry, httpd.conf) 
<pre> Alias /mod_perl/ &quot;/Apache/mod_perl/&quot;
  &lt;Location /mod_perl&gt;
    SetHandler perl-script
    PerlHandler Apache::Registry
    PerlSendHeader On
    Options +ExecCGI
  &lt;/Location&gt;</pre>  <p>Put the CGI
script <code>soap.mod_cgi</code> in the <em>/Apache/mod_perl/</em> directory mentioned above:</p>  <p>4.d. server (Apache::Registry, soap.mod_cgi) 
<pre> #!perl -w

  use SOAP::Transport::HTTP;
  
  SOAP::Transport::HTTP::CGI
    -&gt; dispatch_to('/home/soaplite/modules')
    -&gt; handle
  ;</pre>  <dt><strong><a name="item_mod_perl">mod_perl</a></strong><br> <dd> Let's consider a mod_perl-based server now. To run it you'll need to
put the SOAP::Apache module (<em>Apache.pm</em>) in any directory in <code>@INC</code>:
<p>4.e. server (mod_perl, Apache.pm) 
<pre> package SOAP::Apache;

  use SOAP::Transport::HTTP;
  
  my $server = SOAP::Transport::HTTP::Apache
    -&gt; dispatch_to('/home/soaplite/modules') 
	
  sub handler { $server-&gt;handler(@_) }

  1;</pre>  <p>Then modify your httpd.conf file:</p> <p>4.e. server (mod_perl, httpd.conf) 
<pre> &lt;Location /soap&gt;
    SetHandler perl-script
    PerlHandler SOAP::Apache
  &lt;/Location&gt;</pre>  <dt><strong><a name="item_mod_soap">mod_soap</a></strong><br> <dd> mod_soap allows you to create a SOAP server by simply configuring the
httpd.conf or .htaccess file.
<p> 4.f. server (mod_soap, httpd.conf) 
<pre> # directory-based access
  &lt;Location /mod_soap&gt;
    SetHandler perl-script
    PerlHandler Apache::SOAP
    PerlSetVar dispatch_to &quot;/home/soaplite/modules&quot;
    PerlSetVar options &quot;compress_threshold =&gt; 10000&quot;
  &lt;/Location&gt;

  # file-based access
  &lt;FilesMatch &quot;\.soap$&quot;&gt;
    SetHandler perl-script
    PerlHandler Apache::SOAP
    PerlSetVar dispatch_to &quot;/home/soaplite/modules&quot;
    PerlSetVar options &quot;compress_threshold =&gt; 10000&quot;
  &lt;/FilesMatch&gt;</pre>  <p>Directory-based
access turns a directory into a SOAP endpoint. For example,
you may point your request to <em>http://localhost/mod_soap</em> (there is no
need to create this directory).</p> <p>File-based access turns a file with a specified name (or mask) into a SOAP 
endpoint. For example, <em>http://localhost/somewhere/endpoint.soap</em>.</p> <p>Alternatively, you may turn an existing directory into a SOAP server
if you put an
<em>.htaccess</em> file inside it:</p>  <p> 4.g. server (mod_soap, .htaccess) 
<pre> SetHandler perl-script
  PerlHandler Apache::SOAP
  PerlSetVar dispatch_to &quot;/home/soaplite/modules&quot;
  PerlSetVar options &quot;compress_threshold =&gt; 10000&quot;</pre>  </dl>  <h3><a name="access to remote services">Access to Remote Services</a></h3> <p>It's time now to re-use what has already been done and to try to call
some services 
available on the Internet. After all, the most interesting part of SOAP is 
interoperability between systems where the communicating parts are 
created in different languages, running on different platforms or in 
different environments, and are providing interfaces with service descriptions 
or documentation. XMethods.net can be a perfect starting point.</p> <dl> <dt><strong><a name="item_number">Name of state based on state's number (in alphabetical order)</a></strong><br> <dd> Frontier implementation has a test server that returns the name of a state 
based on a number you provide. By default, SOAP::Lite generates a SOAPAction 
header with the structure of <code>[URI]#[method]</code>.  Frontier, however, expects 
SOAPAction to be just the URI, so we have to use on_action to modify it. In our example, we specify <code>on_action(sub { sprintf '&quot;%s&quot;', shift })</code>,
so the resulting SOAPAction will contain only the URI (and don't forget
the double quotes there).
<p> 5.a. client 
<pre> #!perl -w
  
  use SOAP::Lite;

  # Frontier <a href="http://www.userland.com/">http://www.userland.com/</a>  $s = SOAP::Lite 
    -&gt; uri('/examples')
    -&gt; on_action(sub { sprintf '&quot;%s&quot;', shift })
    -&gt; proxy('http://superhonker.userland.com/')
  ;

  print $s-&gt;getStateName(SOAP::Data-&gt;name(statenum =&gt; 25))-&gt;result;</pre>  <p>You should get the output:</p> <p> 5.a. result
<pre>Missouri</pre>  <table width="170" border="0" cellspacing="0" cellpadding="20" align="right"> <tr> <td width="170" valign="top" bgcolor="#ffffff"> <hr size="1" color="#6699cc"><br /> <font size="-1" color="#6699cc"><b><p> <a href="/pub/au/Kulchenko_Paul">Paul Kulchenko</a></b> is a featured speaker at the upcoming O'Reilly Open
Source Convention in San Diego, CA, July 23 - 27, 2001. Take this
opportunity to rub elbows with open source leaders while relaxing in the
beautiful setting of the beach-front Sheraton San Diego Hotel and Marina.
For more information, visit our <a
href="http://conferences.oreilly.com/oscon/">conference home page</a>. You
can register online.</p></b></font><hr size="1" color="#6699cc"><br /></td> </tr> </table>    <dt><strong><a name="item_Whois">Whois</a></strong><br> <dd> We will target services with different implementations. The following service
is running on a Windows platform:
<p> 5.b. client 
<pre> #!perl -w

  use SOAP::Lite;

  # 4s4c (aka Simon's SOAP Server Services For COM) <a href="http://www.4s4c.com/">http://www.4s4c.com/</a>  print SOAP::Lite 
    -&gt; uri('http://www.pocketsoap.com/whois')
    -&gt; proxy('http://soap.4s4c.com/whois/soap.asp')
    -&gt; whois(SOAP::Data-&gt;name('name' =&gt; 'yahoo'))
    -&gt; result;</pre>  <p>Nothing fancy here; <code>'name'</code> is the name of the field and <code>'yahoo'</code> is the value. That should give you the output:</p> <p>5.b. result 
<pre> The Data in Network Solutions' WHOIS database is provided by Network
  Solutions for information purposes, and to assist persons in obtaining
  information about or related to a domain-name registration record.
  Network Solutions does not guarantee its accuracy. By submitting a
  WHOIS query, you agree that you will use this Data only for lawful
  purposes and that, under no circumstances will you use this data to:
  (1) allow, enable or otherwise support the transmission of mass
  unsolicited, commercial advertising or solicitations via e-mail
  (spam); or  (2) enable high volume, automated, electronic processes
  that apply to Network Solutions (or its systems). Network Solutions
  reserves the right to modify these terms at any time. By submitting
  this query, you agree to abide by this policy.
  Yahoo (YAHOO-DOM)                                            YAHOO.COM
  Yahoo Inc. (YAHOO27-DOM)                                     YAHOO.ORG
  Yahoo! Inc. (YAHOO4-DOM)                                     YAHOO.NET

  To single out one record, look it up with &quot;!xxx&quot;, where xxx is the
  handle, shown in parenthesis following the name, which comes first.</pre>   <dt><strong><a name="item_Book_price_based_on_ISBN">Book price based on ISBN</a></strong><br> <dd> In many cases the SOAP interface is just a front end that requests information,
parses the response, formats it and returns according to your request. It may 
not be doing that much, but it saves you time on the client side and fixes 
this interface, so you don't need to update it each time your service 
provider changes format or content. 
In addition, the major players are moving quickly toward XML; 
for example, Google already has an XML-based interface for its search 
engine. Here is the service that returns the price of a book given its ISBN:
<p> 5.c. client 
<pre> #!perl -w

  use SOAP::Lite;

  # Apache SOAP <a href="http://xml.apache.org/soap/">http://xml.apache.org/soap/</a> (running on XMethods.net)

  $s = SOAP::Lite                             
    -&gt; uri('urn:xmethods-BNPriceCheck')                
    -&gt; proxy('http://services.xmethods.net/soap/servlet/rpcrouter');

  my $isbn = '0596000278'; # Programming Perl, 3rd Edition
  print $s-&gt;getPrice(SOAP::Data-&gt;type(string =&gt; $isbn))-&gt;result;</pre>  <p>Here is the result for 'Programming Perl, 3rd Edition':</p> <p> 5.c. result 
<pre> 39.96</pre>  <p>Note that we
explicitly specified the type to be <code>'string'</code>, because an
ISBN looks like
number and will be serialized by default as an integer. However, the
SOAP server we work 
with requires it to be a string.</p>  <dt><strong><a name="item_Currency_Exchange_rates">Currency exchange rates</a></strong><br> <dd> This service returns the value of one unit of country1's currency converted into 
country2's currency:
<P>5.d. client 
<pre> #!perl -w

  use SOAP::Lite;

  # GLUE <a href="http://www.themindelectric.com/">http://www.themindelectric.com/</a> (running on XMethods.net)

  my $s = SOAP::Lite                             
    -&gt; uri('urn:xmethods-CurrencyExchange')                
    -&gt; proxy('http://services.xmethods.net/soap');

  my $r = $s-&gt;getRate(SOAP::Data-&gt;name(country1 =&gt; 'England'), 
                      SOAP::Data-&gt;name(country2 =&gt; 'Japan'))
            -&gt;result;
  print &quot;Currency rate for England/Japan is $r\n&quot;;</pre>  <p>Which gives you (as of 2001/03/11):</p> <p> 5.d. result 
<pre> Currency rate for England/Japan is 175.4608</pre>  <dt><strong><a name="item_NASDAQ_quotes">NASDAQ quotes</a></strong><br> <dd> This service returns a delayed stock quote based on a stock symbol:
<p> 5.e. client 
<pre> #!perl -w

  use SOAP::Lite;

  # GLUE <a href="http://www.themindelectric.com/">http://www.themindelectric.com/</a> (running on XMethods.net)

  my $s = SOAP::Lite                             
    -&gt; uri('urn:xmethods-delayed-quotes')                
    -&gt; proxy('http://services.xmethods.net/soap');

  my $symbol = 'AMZN';
  my $r = $s-&gt;getQuote($symbol)-&gt;result;
  print &quot;Quote for $symbol symbol is $r\n&quot;;</pre>  <p>It may (or may not, depending on how Amazon is doing) give you:</p> <p>5.e. result 
<pre> Quote for AMZN symbol is 12.25</pre> </dl>  <h3><a name="access with service description (wsdl)">Access with service description (WSDL)</a></h3> <p>Although support for WSDL 1.1 is limited in SOAP::Lite for now (the service 
description may work in some cases, but hasn't been extensively 
tested), you can access services that don't have complex types in their 
description:</p> <p> 6.a. client 
<pre> #!perl -w

  use SOAP::Lite;
  
  print SOAP::Lite
    -&gt; service('http://www.xmethods.net/sd/StockQuoteService.wsdl')
    -&gt; getQuote('MSFT');</pre>  <p>If we take a
look under the hood we'll find that SOAP::Lite requests
a service description, parses it, builds the stub (a local
object that has
the same methods as the remote service) and returns it to you. 
As a result, you can run several requests using the same service 
description:</p> <p>6.b. client 
<pre> #!perl -w

  use SOAP::Lite;
  <div class="client-highlight"> my $service = SOAP::Lite
    -&gt; service('http://www.xmethods.net/sd/StockQuoteService.wsdl');</pre> </div> print 'MSFT + ORCL = ', 
        $service-&gt;getQuote('MSFT') + $service-&gt;getQuote('ORCL');</pre>  <p>The service description doesn't need to be on the Internet; you can access it 
from your local drive also:</p> <p>6.c. client 
<pre> #!perl -w

  use SOAP::Lite
    service =&gt; 'http://www.xmethods.net/sd/StockQuoteService.wsdl',
    # service =&gt; '<a href="file:/your/local/path/StockQuoteService.wsdl">file:/your/local/path/StockQuoteService.wsdl</a>',
    # service =&gt; '<a href="file:./StockQuoteService.wsdl">file:./StockQuoteService.wsdl</a>',
  ;

  print getQuote('MSFT'), &quot;\n&quot;;</pre>  <p>This code works similar to the previous example (in OO style), but 
loads the description and imports all the methods, so you can use the
functional interface.</p> <p>And finally, a couple of one-liners for those who like to do something short
and simple (albeit useful and powerful):</p>  <p>6.d. client 
<pre> # The following command is split for readability
  perl &quot;-MSOAP::Lite service=&gt;'http://www.xmethods.net/sd/StockQuoteService.wsdl'&quot; 
       -le &quot;print getQuote('MSFT')&quot;

  perl &quot;-MSOAP::Lite service=&gt;'<a href="file:./quote.wsdl">file:./quote.wsdl</a>'&quot; -le &quot;print getQuote('MSFT')&quot;</pre>  <p>The last
example (marked line) seems to be the shortest SOAP method invocation.</p>   <h3><a name="security (ssl, basic/digest authentication, cookiebased authentication, ticketbased authentication, access control)">Security (SSL, basic/digest authentication, cookie-based authentication, ticket-based authentication, access control)</a></h3> <p>Though SOAP doesn't impose any security mechanisms (unless you count
the SOAP Security Extensions: Digital Signature specification), the extensibility
of the protocol allows you to leverage many security methods that are available 
for different protocols, like SSL over HTTP or S/MIME. We'll consider how
SOAP can be used together with SSL, basic authentication, cookie-based
authorization and access control.</p> <dl> <dt><strong><a name="item_SSL">SSL</a></strong><br> <dd> Let's start with <strong>SSL</strong>. Surprisingly there is nothing SOAP-specific you 
need to do on the server side, and there is only a minor modification on 
the client side: just specify <code>https:</code> instead of <code>http:</code> as the protocol 
for your endpoint and everything else will be done for you. Obviously, 
both endpoints should support this functionality and the server should
be properly configured.
<p>7.a. client 

<pre> #!perl -w
  
  use SOAP::Lite +autodispatch =&gt; 
    uri =&gt; 'http://www.soaplite.com/My/Examples',

    proxy =&gt; 'https://localhost/cgi-bin/soap.cgi',

    on_fault =&gt; sub { my($soap, $res) = @_; 
      die ref $res ? $res-&gt;faultdetail : $soap-&gt;transport-&gt;status, &quot;\n&quot;;
    }
  ;

  print getStateName(21);</pre>  <dt><strong><a name="item_Basic_authentication">Basic authentication</a></strong><br> <dd> The situation gets even more interesting with <strong>authentication</strong>. Consider this 
code that accesses an endpoint that requires authentication.

<p>7.b. client 

<pre> #!perl -w

  use SOAP::Lite +autodispatch =&gt; 
    uri =&gt; 'http://www.soaplite.com/My/Examples', 
    proxy =&gt; 'http://services.soaplite.com/auth/examples.cgi', 
    on_fault =&gt; sub { my($soap, $res) = @_; 
      die ref $res ? $res-&gt;faultdetail : $soap-&gt;transport-&gt;status, &quot;\n&quot;;
    }
  ;

  print getStateName(21);</pre>  <p>Keep in mind that the password will be in clear text during the transfer 
(not exactly in clear text; it will be base64 encoded, but that's almost 
the same) unless the user uses https (i.e. authentication doesn't mean 
encryption).</p> <p>The server configuration for an Apache Web server with authentication 
can be specified in a .conf or in .htaccess file, and may look like this:</p> <p>7.b. server (.htaccess) 
<pre> AuthUserFile /path/to/users/file/created/with/htpasswd
  AuthType Basic
  AuthName &quot;SOAP::Lite authentication tests&quot;
  require valid-user</pre>  <p>If you run
example 7.b against this endpoint, you'll probably get the following error:</p> <p>7.b. result 
<pre> 401 Authorization Required</pre>  <p>You may provide
the required credentials on the client side (user <code>soaplite</code>,
and password <code>authtest</code>) overriding the function <code>get_basic_credentials()</code> in the class SOAP::Transport::HTTP::Client:</p>  <p>7.c. client 
<pre> #!perl -w
  
  use SOAP::Lite +autodispatch =&gt; 
    uri =&gt; 'http://www.soaplite.com/My/Examples', 
    proxy =&gt; 'http://services.soaplite.com/auth/examples.cgi', 
    on_fault =&gt; sub { my($soap, $res) = @_; 
      die ref $res ? $res-&gt;faultdetail : $soap-&gt;transport-&gt;status, &quot;\n&quot;;
    }
  ;

  sub SOAP::Transport::HTTP::Client::get_basic_credentials { 
    return 'soaplite' =&gt; 'authtest';
  }

  print getStateName(21);</pre>  <p>That gives you the correct result:</p> <p>7.c. result 
<pre>Massachusetts</pre>   <p>Alternatively
you may provide this information with a <code>credentials()</code> functions,
but you need to specify the host and realm also:</p>  <p>7.d. client 

<pre> #!perl -w

  use SOAP::Lite +autodispatch =&gt; 
    uri =&gt; 'http://www.soaplite.com/My/Examples',

    proxy =&gt; [
      'http://services.soaplite.com/auth/examples.cgi', 
      credentials =&gt; [
        'services.soaplite.com:80',        # host:port
        'SOAP::Lite authentication tests', # realm
        'soaplite' =&gt; 'authtest',          # user, password
      ]
    ],

    on_fault =&gt; sub { my($soap, $res) = @_; 
      die ref $res ? $res-&gt;faultdetail : $soap-&gt;transport-&gt;status, &quot;\n&quot;;
    }
  ;

  print SOAP-&gt;getStateName(21);</pre> <p>Under modern
Perl you <em>may</em> get a warning about ``deprecated usage of inherited 
AUTOLOAD''. To avoid it use the full syntax: <code>SOAP-&gt;getStateName(21)</code> instead of <code>getStateName(21)</code>.</p> <p>The simplest and most convenient way would probably be to provide the user and 
password embedded in a URL. Surprisingly, this works:</p>  <p>7.e. client
<pre> #!perl -w

  use SOAP::Lite;

  print SOAP::Lite
    -&gt; uri('http://www.soaplite.com/My/Examples')

    -&gt; proxy('http://soaplite:authtest@services.soaplite.com/auth/examples.cgi')

    -&gt; getStateName(21)
    -&gt; result;</pre>   <dt><strong><a name="item_Cookie%2Dbased_authentication">Cookie-based authentication</a></strong><br> <dd> <strong>Cookie-based authentication</strong> also doesn't require much work on 
the client side. Usually, it means that you need to provide credentials 
in some way, and if everything is OK, the server will return a cookie on 
success, and will then check it for all subsequent requests. 
Using available functionality you may not only
support this behavior on the client side in one session, but even store cookies
in a file and use the same server session for several runs. All you need to
do is:
<p>7.f. client 
<pre> #!perl -w

  use SOAP::Lite; 
  use HTTP::Cookies;

  my $soap = SOAP::Lite
    -&gt; uri('urn:xmethodsInterop')

    -&gt; proxy('http://services.xmethods.net/soap/servlet/rpcrouter', 
             cookie_jar =&gt; HTTP::Cookies-&gt;new(ignore_discard =&gt; 1));

  print $soap-&gt;echoString('Hello')-&gt;result;</pre>  <p>All the magic is in the cookie jar. You may even add or delete cookies 
between calls, but the underlying module does everything you need by default. 
Add the option <code>file =&gt; 'filename'</code> to the call to
<code>new()</code> to save and restore cookies
between sessions. Not much work, huh? Kudos to Gisle Aas on that!</p> <p></p> <dt><strong><a name="item_Ticket%2Dbased_authentication">Ticket-based authentication</a></strong><br> <dd> Ticket-based authentication is a bit more complex. The logic is similar 
to cookie-based authentication, but it is executed at the application level, 
instead of at the transport level. The advantage is that it works for any 
SOAP transport (not only for HTTP) and gives you a bit more flexibility. 
As a result, you won't get support from the Web server and you'll have to do 
everything manually. No big deal, right?
<p>The first step is the ticket generation. We'll build a ticket that contains
an e-mail address, a time and a signature.</p>  <p>7.g. server (TicketAuth) 
<pre> package TicketAuth;

  # we will need to manage Header information to get a ticket
  @TicketAuth::ISA = qw(SOAP::Server::Parameters);

  # ----------------------------------------------------------------------
  # private functions
  # ----------------------------------------------------------------------

  use Digest::MD5 qw(md5);

  my $calculateAuthInfo = sub {
    return md5(join '', 'something unique for your implementation', @_);
  };

  my $checkAuthInfo = sub {
    my $authInfo = shift;
    my $signature = $calculateAuthInfo-&gt;(@{$authInfo}{qw(email time)});
    die &quot;Authentication information is not valid\n&quot; 
      if $signature ne $authInfo-&gt;{signature};
    die &quot;Authentication information is expired\n&quot; 
      if time() &gt; $authInfo-&gt;{time};
    return $authInfo-&gt;{email};
  };

  my $makeAuthInfo = sub {
    my $email = shift;
    my $time = time()+20*60; # signature will be valid for 20 minutes
    my $signature = $calculateAuthInfo-&gt;($email, $time);
    return +{time =&gt; $time, email =&gt; $email, signature =&gt; $signature};
  };

  # ----------------------------------------------------------------------
  # public functions
  # ----------------------------------------------------------------------

  sub login { 
    my $self = shift;

    pop; # last parameter is envelope, don't count it
    die &quot;Wrong parameter(s): login(email, password)\n&quot; unless @_ == 2;
    my($email, $password) = @_;

    # check credentials, write your own is_valid() function
    die &quot;Credentials are wrong\n&quot; unless is_valid($email, $password);

    # create and return ticket if everything is ok
    return $makeAuthInfo-&gt;($email);

  }

  sub protected { 
    my $self = shift;

    # authInfo is passed inside the header
    my $email = $checkAuthInfo-&gt;(pop-&gt;valueof('//authInfo'));

    # do something, user is already authenticated 
    return;
  }</pre>  <p>It would be very careless (and insecure) to create <code>calculateAuthInfo()</code> as a normal, exposed function, because a client could invoke it
directly and 
generate a valid ticket without providing valid credentials (unless you 
forbid it in the SOAP server configuration, but we'll show another way). 
Therefore, we create <code>calculateAuthInfo()</code>, <code>checkAuthInfo()</code> and 
<code>makeAuthInfo()</code> as 'private' functions, so only other functions inside 
the same file can access it. It effectively prevents clients from accessing 
them directly.</p> <p>The <code>login()</code> function returns a hash that has an e-mail and time inside, as well
as an MD5 signature that prevents the user from altering this information.
Since the server used a secret string during signature generation, the user 
is not able to tamper with the resulting signature. To access protected 
methods, the client has to provide the obtained ticket in the header:</p>  <p>7.g. fragment 

<pre> # login
  my $authInfo = login(email =&gt; 'password');

  # convert it into the Header
  $authInfo = SOAP::Header-&gt;name(authInfo =&gt; $authInfo);

  # invoke protected method
  protected($authInfo, 'parameters');</pre>  <p>This is just a fragment, but it should give you some ideas on how to 
implement ticket-based authentication on application level. You could even
get the ticket in one place (via HTTP for example) and access a SOAP server
via SMTP providing this ticket (ideally you should use PKI [public key 
infrastructure] for that matter).</p>   <dt><strong><a name="item_Access_control">Access control</a></strong><br> <dd> Why would you need <strong>access control</strong>? Imagine you have a class and
want to give access to it selectively; for example, read access to one 
person and read/write access to another person or a list of people. 
At a low level, read and write access means access to specific 
functions/methods in class.
<p>You could put this check in at the application level (for example with 
ticket-based authentication), or you could split your class into two different 
classes and give one person access only to one of them. Neither of these
is optimal solutions. We consider a different approach, where you create two 
different endpoints that refer to the same class on the server side, but 
have different access options.</p>  <p>7.e. server (first endpoint)
<pre> use SOAP::Transport::HTTP;
  
  use Protected;
  SOAP::Transport::HTTP::CGI
    -&gt; dispatch_to('Protected::readonly')
    -&gt; handle
  ;</pre>  <p>This endpoint will have access only to <code>readonly()</code> method in <code>Protected</code> class.</p>  <p>7.e. server (second endpoint)
<pre> use SOAP::Transport::HTTP;

  use Protected;
  SOAP::Transport::HTTP::CGI
    -&gt; dispatch_to('Protected')
    -&gt; handle
  ;</pre>  <p>This endpoint will have unrestricted access to all methods/functions in 
<code>Protected</code> class. Now you can put it under basic, digest or some other 
kind of authentication to prevent unauthorized access.</p> <p>Thus, by combining the capabilities of a Web server with the SOAP server you 
can create an application that best suites your needs.</p></dd></dt></dl>  <h3><a name="handling lols (list of lists, structs, objects, or something else)">Handling LoLs (List of Lists, Structs, Objects, or something else)</a></h3> <p>Processing complex data structures isn't different in any aspect
from the usual processing in your programming language. The general rule is
simple: <strong>'Treat the result of a SOAP call as a variable of specified type'</strong>.</p> <p>The next example shows a service that works with array of structs:</p>  <p>8.a. client 
<pre> #!perl -w

  use SOAP::Lite;

  my $result = SOAP::Lite
        -&gt; uri('urn:xmethodsServicesManager')
        -&gt; proxy('http://www.xmethods.net/soap/servlet/rpcrouter')
        -&gt; getAllSOAPServices();

  if ($result-&gt;fault) {
    print $result-&gt;faultcode, &quot; &quot;, $result-&gt;faultstring, &quot;\n&quot;;
  } else {
    # reference to array of structs is returned
    my @listings = @{$result-&gt;result};

    # @listings is the array of structs
    foreach my $listing (@listings) {
      print &quot;-----------------------------------------\n&quot;;
      # print description for every listing
      foreach my $key (keys %{$listing}) {
        print $key, &quot;: &quot;, $listing-&gt;{$key} || '', &quot;\n&quot;;
      }        
    }
  }
</pre> <p>The same is true about structs inside other structs,
lists of objects, objects that have lists inside, etc. 'What you return 
on server side is what you get on client side, and let me know if you get
something else.'</p> <p>(OK, not always. You MAY get a blessed array even 
when you return a simple array on the other side and you MAY get a blessed 
hash when you return a simple one, but it won't change anything in your code,
just access it as you usually do).</p> <hr size="1" noshade> <p>Major contributors:</p> <dl> <dt><strong><a name="item_Nathan_Torkington">Nathan Torkington</a></strong><br> <dd> Basically started this work and pushed the whole process.
<p></p> <dt><strong><a name="item_Tony_Hong">Tony Hong</a></strong><br> <dd> Invaluable comments, fixes and input help me keep this material correct, 
fresh and simple.
<p></p></dl>


        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1494" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2001/04/p5pdigest/THISWEEK-20010422.html" rel="bookmark">This Week on p5p 2001/04/22</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Simon Cozens</span> on <abbr class="published" title="2001-04-22T00:00:00-08:00">April 22, 2001 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            
<!-- This week on perl5-porters (16-22 Mar 2001) -->

<br />
<br />
      </P>

<P>

<H3><a name="Notes">Notes</a></H3>

</P>

<P>
You can subscribe to an email version of this summary by sending an
empty message to 
<a href="mailto:perl5-porters-digest-subscribe@netthink.co.uk"><tt>perl5-porters-digest-subscribe@netthink.co.uk</tt>.</a></P>

<P>
Please send corrections and additions to 
<CODE>perl-thisweek-YYYYMM@simon-cozens.org</CODE> where 
<CODE>YYYYMM</CODE> is the current year and month.  Changes and additions to the 
<a href="http://simon-cozens.org/writings/whos-who.html">perl5-porters</a> biographies are particularly welcome.
</P>

<P>
There were just under 500 messages this week.
<H3><a name="Modules_in_the_core">Modules in the core</a></H3>

</P>

<P>

Jarkko faced the allegations of bloat after having added 
<CODE>Scalar-List-Utils</CODE> to the core head on, with a list of
<a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2001-04/msg00806.html">proposed module additions</a>. This, inevitably, sparked a huge thread. The main argument was not
about bloat per se, but about the less of a clear sense of who is
responsible for a module, especially if it has a separate life on CPAN,
and how updates would get fed back.
</P>

<P>
Paul Marquess remarked that he wanted to put the 
<CODE>zlib</CODE> source into the 
<CODE>Compress::Zlib</CODE> distribution, which would make it suitable for core-ification so that 
<CODE>CPAN.pm</CODE> can deal with compressed files.
Unfortunately, the source is big, not really as portable as Perl. Another
suggestion was to add a configure probe for 
<CODE>-lz</CODE> when Perl was being built, and build 
<CODE>Compress::Zlib</CODE>. Nick Clark has been working on a compression/decompression PerlIO
filter, but this too would use 
<CODE>libz</CODE>. The comparison between this and the 
<CODE>-lgdbm</CODE> dependency of 
<CODE>GDBM_File</CODE> led to talk of an 
<CODE>AnyCompress</CODE> library which had pure Perl decompression fallbacks. A good summary of
 that part of the discussion is given in 
<a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2001-04/msg01121.html">this message</a> by Nick Clark.
</P>

<P>
Anton Berezin remarked that FreeBSD was going to break up 
5.6.1 into essential core components and additional &quot;ports&quot;. This
worried a couple of people until they remembered that Debian has been
doing just this as well, and Joe Karthauser pointed out that breaking
off core modules into separate ports would allow them to be updated
independently of the Perl version.
</P>

<P>
Larry said that requiring 
<CODE>expat</CODE> wasn't too much of an impediment to 
<CODE>XML::Parser</CODE> being included, because XML is everywhere these days. Nat noted that
 Paul Kulchenko wrote a pure-Perl parser, 
<CODE>XML::Parser::Lite</CODE> which could also be contributed to core. Dan Brian astutely pointed out
 that if someone's got expat installed and they'll be doing XML things,
 it's likely they'll have 
<CODE>XML::Parser</CODE> anyway, so there isn't much point in having a pure-Perl fallback. Matt
Sergeant reminded us that there isn't a consensus on the &quot;best&quot; XML API
module, so we can't really include one of them either.
</P>

<P>
Larry wanted to talk with Paul about how slow 
<CODE>XML::Parser::Lite</CODE> turned out to be, presumably to help him decide about regular
 expression strategies for Perl 6.
<H3><a name="Kwalitee_Control">Kwalitee Control</a></H3>

</P>

<P>

Perl's Quality Control department - Mr. Schwern - was in full flow this
week; first he found that one of the test suites had some special-case 
<CODE>@INC</CODE> handling for Mac. If this was needed, he argued, why wasn't it needed
for all of the tests? And if it was needed for all of the tests, why not
abstract it out into a separate module? Since the 
<CODE>TEST</CODE> harness automatically loads 
<CODE>TestInit.pm</CODE> anyway, why not use that? Chris Nandor was in agreement, but pointed
out that you'd still have to remove the 
<CODE>@INC</CODE> modifications from all the test scripts, because they would run after
<CODE>TestInit</CODE> had done its modifications.
</P>

<P>
He also suggested that 
<CODE>Test::Simple</CODE> and 
<CODE>Test::More</CODE> were put into the core. Nobody had any comments on that.
</P>

<P>
Next, he removed the &quot;compilation&quot; tests from 
<CODE>t/lib/1_compile.t</CODE> for those modules which already have tests. Jarkko suggested that this
would have to keep happening periodically, and wanted a cleverer
solution, but Schwern thought of a better one - WRITE MORE TESTS!
</P>

<P>
He then produced a 
<a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2001-04/msg01218.html">list</a> of all the modules which were untested, and offered an 
<a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2001-04/msg01223.html">incentive</a> - once all the modules have sufficient tests, Schwern will donate
$500 dollars to 
<a href="http://www.yetanother.org/">Yet Another Society</a>. Get to it and deprive this man of his hard earned cash! There may even
be prizes in it for you...
</P>

<P>
He also proposed two pretty uncontroversial (well, by most people's
standards) standards for new modules coming into the core: that they
should have some documentation and a reasnoable amount of tests. Schwern
said &quot;I don't want to get any more elaborate for the moment to avoid
lengthy debate.&quot; This didn't work.
</P>

<P>
Peter Prymmer had Perl avoid testing the new 
<CODE>List::Utils</CODE> module on platforms which hadn't built the XS code for it. Graham Barr 
briefly objected, saying that it should fallback to pure Perl
replacements; however, if they weren't built, these replacements
wouldn't be moved to 
<CODE>lib/</CODE>. When he realised that the fallbacks were there for those people who
didn't have compilers, and that you tend to have a compiler handy during
the Perl build process, he withdrew his objection.
<H3><a name="Regex_Debugger_and_Reference_Type">Regex Debugger and Reference Type</a></H3>

</P>

<P>

Mark-Jason Dominus has been working on the regular expression debugger
for ActiveState's 
<a href="http://www.activestate.com/ASPN/Downloads/Komodo/More">Komodo</a> IDE - it allows you to, for example, set breakpoints in a regular expression.
However, one of the problems he came across was relating the positions
of the nodes of the compiled regular expression (
<CODE>ANYOF</CODE>, 
<CODE>EXACT</CODE>, and so on.) to character offsets in the string representation of it.
For instance, if you have 
<CODE>/([\d.]+)f/</CODE> your debugger will want to stop at the &quot;f&quot;. To do this, the compiled
form will need to know where the &quot;f&quot; is. To provide this, he submitted a
patch which 
</P>

<P>
He's put back a patch which generates an array of offsets every time a
regular expression is compiled; he also patched 
<CODE>perldebguts</CODE> to 
<a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2001-04/msg01240.html">explain how it all works. </a></P>

<P>
As well as this, MJD noticed a problem with the debugging output for
regular expressions: when you have a character class, Perl uses a
bitmask to note which characters you're matching. It used to be 256
bits, one for each character. However, with UTF8 regular expressions,
that bitmask now needs to be a lot wider than it used to be. However,
the debugger didn't know about this new wide bitmask, and was still only
skipping over 256 bits, landing somewhere in the middle of the Unicode
bitmask. If the bits at this point were set to zero, which is likely,
the debugger would interpret it as a null operation. MJD fixed this by
having Perl skip to the next node in the list rather than trying to
grovel over the bytecode.
</P>

<P>
Meanwhile, Michael Schwern asked why the 
<CODE>Regexp</CODE> type you get when you do 
<CODE>ref qr/foo/</CODE> wasn't documented, or why it wasn't 
<CODE>REGEXP</CODE> like all the other built-in types. Jarkko agreed it should be 
<CODE>REGEXP</CODE> and Larry (Look, he's back!) suggested making it 
<CODE>REGEX</CODE> instead for pronouncability. Sarathy said he wanted to change it, but
there were a couple of points that never got resolved: the name
(which we now have a diktat on) and what the class should do. So Schwern
suggested a patch to change the name. Sarathy, however, was concerned at
the fact that since the &quot;thing&quot; returned by 
<CODE>qr/foo/</CODE> is actually blessed, one can treat it as an object and create a 
<CODE>Regexp.pm</CODE> to implement methods for this object. (This is exactly what Damian
Conway does in his Object Oriented Perl book.) The point of the
upper-cased types are unblessed; there's nothing to stop someone writing
<CODE>SCALAR.pm</CODE> but that would get confusing, because you could no longer tell whether
 something coming back from 
<CODE>ref</CODE> was blessed or unblessed. This convinced Jarkko not to change the
 capitalisation of 
<CODE>Regexp</CODE>.
<H3><a name="iThreads">iThreads</a></H3>

</P>

<P>

Artur Bergman reported that he'd started work on a module which will
hopefully one day replace 
<CODE>Thread.pm</CODE>. Instead of the old-style &quot;5.005&quot; threading, it uses the new
interpreter threads. These are called iThreads, come in a range of
exciting colours and are hideously overpriced. They're the trickery used
to emulate 
<CODE>fork</CODE> on Windows - instead of forking, all you do is clone the interpreter to
 form a &quot;pseudo-process&quot;.
</P>

<P>
However, until now there hasn't been a way to control iThreads from Perl
space; it all has to be done from C. Artur's not finished yet, but I
hear that he's got quite a lot of the fundamentals working.
</P>

<P>
Interested? Join the 
<a href="mailto:perl-ithreads-subscribe@perl.org">mailing list</a>.
<H3><a name="B_Bumblings">B Bumblings</a></H3>

</P>

<P>

Robin produced a rather amazing patch which adds support for pragmata
in 
<CODE>B::Deparse</CODE>. He also added something to parenthesis arguments to
currently-undefined subroutines; that is:
</P>

</P><PRE>
    foo 23
    sub foo { }
</PRE>

<P>
needs parenthesis. Then he fixed UTF8 literal strings, and noticed a
problem with regular expressions and large codepoints. David Dyck fixed
the deparsing of 
<CODE>split " "</CODE> which was previously saying 
<CODE>split /\s+/</CODE>. Robin also got the deparser recognising special constants like 
<CODE>$^W</CODE>, and recognising the difference between lexical and global variables.
Oh, and 
<CODE>BEGIN/INIT/END</CODE> blocks, and all sorts of other little features.
</P>

<P>
Michael Schwern has also been messing about with 
<CODE>B</CODE>, and found some mis-documentation in 
<CODE>B::walksymtable</CODE>, which he fixed up, as well as a bug in what Robin had been playing
with. Robert replied with a truly wonderful explanation of 
<a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2001-04/msg01253.html">how pragmata can be detected</a>.
<H3><a name="Various">Various</a></H3>

</P>

<P>

Benjamin Franz announced Yet Another Mailing List, a working group to
come up with a coherent strategy for coming up with a &quot;named parameters&quot;
module. If that appeals to you, send mail with a body of 
<CODE>subscribe argument-shop</CODE> to 
<CODE>majordomo@nihongo.org</CODE>.
</P>

<P>
Elaine Ashton put in a couple of patches to the FAQ, as well as adding
&quot;mailing list&quot; and &quot;license&quot; sections to the stub documentation produced
by 
<CODE>h2xs</CODE>. These weren't huge,
but I mention them because Elaine's one of those unsung heros, and
people tend to forget the work she 
does for us in terms of behind the scenes things, such as 
tidying up the FAQ, perl.org stuff, the 
<a href="http://search.cpan.org/">CPAN search engine</a> and the wonderful
<a href="http://lists.perl.org/">Perl mailing lists lists</a>.
</P>

<P>
Tom Roche came up with a suggestion to change Perl's version searching
behaviour to allow different versions of a module to be installed. There
were various explanations given for why this wouldn't work, (since Perl
must load a module before recognising its version) and two neat
alternative solutions: Richard Soderberg suggested a coderef in 
<CODE>@INC</CODE> and MJD suggested simply putting the version number in the module's
file name. In fact, why not have a directory per module, so you have 
<CODE>use Foo::Bar::1.10</CODE>? But I digress...
</P>

<P>
Calle Dybedhal asked why we have a file called 
<CODE>patchlevel.h</CODE>, since ImageMagick has one too, and that was screwing up Perl. Larry
replied, saying that we had it first.
</P>

<P>
Until next week I remain, your humble and obedient servant,
</P>

<hr>

<a href="mailto:simon@brecon.co.uk">Simon Cozens</a>


<ul>
  <li><a href="#Notes">Notes</a>
  <li><a href="#Modules_in_the_core">Modules in the core</a>
  <li><a href="#Kwalitee_Control">Kwalitee Control</a>
  <li><a href="#Regex_Debugger_and_Reference_Type">Regex Debugger and Reference Type</a>
  <li><a href="#iThreads">iThreads</a>
  <li><a href="#B_Bumblings">B Bumblings</a>
  <li><a href="#Various">Various</a>
</ul>

        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1484" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2001/04/17/msxml.html" rel="bookmark">MSXML, It's Not Just for VB Programmers Anymore</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Shawn Ribordy</span> on <abbr class="published" title="2001-04-17T00:00:00-08:00">April 17, 2001 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            <!-- MSXML, It's Not Just for VB Programmers Anymore -->

<br />
<p>
My co-workers cringe when I tell them the truth.  <i>What XML parser are you using? 
MSXML? With Perl?</i>  You've gotta be crazy.
</p>
<p>
Yes, it's true, but I couldn't help myself.  After test driving MSXML in a Visual
Basic application, it begged the question: "I wonder if Perl can use MSXML?"
</p>
<p>
I have been using MSXML to do my XML parsing 
in Perl and the truth is that Perl is excellent for working with the Microsoft's 
MSXML Parser on the Win32 platform. If you use Perl on Win32, give MSXML a try
from the comfort of your favorite text editor.
<p>

<h3>Grab the MSXML Parser</h3>

<h4>You Grab It</h4>

<p>
Go to Microsoft's <a href="http://www.msdn.microsoft.com/xml/default.asp">MSDN site</a>
to download the latest version of MSXML, which is the 3.0 Release.  
Run the installation program and restart your machine.  You have installed the latest 
version in side-by-side mode.  None of your other Microsoft applications that use 
previous versions of MSXML will be affected.  
</p>

<h4>Now Let Perl at It</h4>

<p>
Perl can control the MSXML parser using OLE.  As with almost everything Perl, the difficult
part has been done for us.  The "kind people at Hip and ActiveWare(ActiveState)" have already
provided us with the <code>Win32::OLE</code> module.  The only thing that 
we need to know is the progID for the MSXML parser.  A progID is a string used to uniquely identify 
an OLE automation class in the Windows registry.  MSXML offers version dependent and version
independent progIDs depending on the method of the installation. Since we have installed MSXML in 
side-by-side mode, we will need to use the version dependent progID.
</p>

<h3>Creating an OLE Instance of MSXML.DOMDocument</h3>

<p>
I begin by using the <code>Win32::OLE</code> module.  
</p>

<pre>
use Win32::OLE qw(in with);  # make sure you include(in & with)!!
                             # we will need them later.
</pre>

<p>
Now I am ready to use OLE to create an instance of the MSXML parser or, 
more correctly, an OLE instance of <code>MSXML2.DOMDocument.3.0</code>, which I will
simply call a DOMDocument.
</p>

<pre>

# Version dependent method - this is what we want -
  my $DOM_document = Win32::OLE->new('MSXML2.DOMDocument.3.0') 
    or die "couldn't create";

# Version independent method - Assumes MSXML was installed in Replace Mode
# if you get errors with the above example - try using this example.
  my $DOM_document = Win32::OLE->new('MSXML2.DOMDocument') 
    or die "couldn't create";

</pre>


<h3>Parsing the XML</h3>

<p>
Since I am a swim coach, I keep all kind of records, times and scores on hand.
One of my favorite things to track is records, so I maintain an XML document that contains the school's
top 10 times for each event.  Below is what <b>toptimes.xml</b> looks like:
</p>

<PRE>
&lt;TOP_TEN_TIMES&gt;
   &lt;EVENT NAME="200 Freestyle"&gt;
      &lt;SWIMMER NUMBER="1" TIME="1:51.49" DATE="2/21/98" NAME="Chris Miller"/&gt;
      &lt;SWIMMER NUMBER="2" TIME="1:54.19" DATE="2/17/01" NAME="Peter Myers"/&gt;
 ...
      &lt;SWIMMER NUMBER="10" TIME="2:19.31" DATE="12/8/00" NAME="Andrew Johnson"/&gt;
   &lt;/EVENT&gt;
   &lt;EVENT NAME="200 IM"&gt;
 ... 
   &lt;/EVENT&gt;
   ...
&lt;/TOP_TEN_TIMES&gt;
</PRE>

<P>
My backstrokers and butterfliers don't like XML very much, so I want to parse 
the XML document and print out the top 10 times for the 100 backstroke and 
100 butterfly.  I begin by loading <b>toptimes.xml</b> using the DOMDocument object that I have 
already created.  The load method is where the XML document is actually parsed 
into its respective pieces such as Nodes and NodeLists.  Validation also occurs 
at this point. The Load method returns a boolean that I can use to test whether
my document loaded properly.  I am going to validate my document, so I will
set the <code>validateOnParse</code> property to 'True'.
</P>

<pre>
 $DOM_document->{async} = "False";           # disable asynchrous
 $DOM_document->{validateOnParse} = "True";  # validate
 my $boolean_Load = $DOM_document->Load("topten.xml");
 if (!$boolean_Load) 
 {
   die "topten.xml did not load";
 }
</pre>

<h3>Iterating Through the XML Document</h3>

<p>
Now that I have successfully loaded the document, I need a method of iterating 
through all of the document Nodes.  In order to iterate through the document, 
I first need to find the root Node.  In this example, the root Node is <code>&lt;TOP_TEN_TIMES&gt;</code>,
so I will define <code>$Top_Ten_Times</code> to be the root Node of the xml document as such:
</p>

<pre>
my $Top_Ten_Times = $DOM_document->DocumentElement();  # assign the root node
</pre>

<p>
Next, I want to find all of the child Nodes of <code>&lt;TOP_TEN_TIMES&gt;</code>.  
<code>$Events</code> will be all of the root's child Nodes.  In this example, <code>
$Events</code> refers to every <code>&lt;EVENT&gt;</code> Node.
</p>

<pre>
my $Events = $Top_Ten_Times->childNodes();      # all of the root's child nodes
</pre>

<p>
<code>$Events</code> is now an NodeList (which is an OLE collection object) that I can use to iterate through each 
<code>&lt;EVENT&gt;</code> node in the XML document.  Veteran Perl programmers will recognize
the iteration code as being very similar to iterating through the elements of an array. 
The only difference is the little keyword <code>'in'</code> that I mentioned earlier when 
we used <code>Win32::OLE</code>.  The keyword <code>'in'</code> is used to distinguish an OLE collection 
object from a standard Perl array.
</p>
<p>
I now iterate over each <code>&lt;EVENT&gt;</code> Node in the document checking each time to see whether I
have one of the events that I need.  When I arrive at one of the desired events, I will print the <code>NAME</code>
Attribute of the current <code>&lt;EVENT&gt;</code> Node and create a new NodeList called <code>$Swimmers</code>.
I will then iterate over each <code>&lt;SWIMMER&gt;</code> Node and print the <code>TIME</code> Attribute.
</p>

<pre>
foreach my $Event (in $Events) # make sure you include the 'in'
{
   if ( ($Event->Attributes->getNamedItem("NAME")->{Text} eq "100 Backstroke") ||
        ($Event->Attributes->getNamedItem("NAME")->{Text} eq "100 Butterfly") )
   {
       # print the event name stored in the NAME attribute
        print $Event->Attributes->getNamedItem("NAME")->{Text}, "\n"; 
        my $Swimmers = $Event->childNodes();       # $Swimmers is now a NodeList collection
        foreach my $Swimmer (in $Swimmers )        # iterate through all swimmers
        {
           print $Swimmer->Attributes->getNamedItem("TIME")->{Text}, "\n";  # print the time
        }
   }
}
</pre>

<h3>Transforming the XML</h3>

<p>
Now that I have satisfied the butterfliers and backstrokers on my team, I am 
beginning to realize that the design of my XML syntax is less than desirable.  
Most of my actual data is stored as attribute data, and I would really like it to 
be element data.  I am going to perform a transformation that will place all of 
my actual data into element data.  My goal is to make the XML document look like 
the following.
</p>

<pre>
&lt;TOP_TEN_TIMES&gt;
   &lt;EVENT&gt;
      &lt;EVENT_NAME&gt;200 Freestyle&lt;/EVENT_NAME&gt;
      &lt;SWIM&gt;
         &lt;SWIMMER>Chris Miller&lt;/SWIMMER&gt;
         &lt;TIME&gt;1:51.49&lt;/TIME&gt;
         &lt;DATE&gt;2/21/98&lt;/DATE&gt;
      &lt;/SWIM&gt;
      &lt;SWIM&gt;
         &lt;SWIMMER&gt;Peter Myers&lt;/SWIMMER&gt;
         &lt;TIME&gt1:54.19&lt;/TIME&gt;
         &lt;DATE&gt2/17/01&lt;/DATE&gt;
      &lt;/SWIM&gt;
      ...
   &lt;/EVENT&gt; 
   &lt;EVENT&gt;
      ...
   &lt;/EVENT&gt;
   ...
&lt;/TOP_TEN_TIMES&gt;
</pre>
   
<p>
After a little work, I come up with the following stylesheet to do the transformation.
</p>
<pre>

&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt; 
&lt;xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0"&gt;
&lt;xsl:output method="xml" indent="yes" encoding="ISO-8859-1"/&gt;
&lt;xsl:template match="/"&gt;
&lt;TOP_TEN_TIMES&gt;
&lt;xsl:for-each select="TOP_TEN_TIMES"&gt;
  &lt;xsl:for-each select="EVENT"&gt;
  &lt;EVENT&gt;
     &lt;EVENT_NAME&gt;&lt;xsl:value-of select="@NAME"/&gt;&lt;/EVENT_NAME&gt;
     &lt;xsl:for-each select="SWIMMER"&gt;
     &lt;SWIM&gt;
        &lt;SWIMMER&gt;&lt;xsl:value-of select="@NAME"/&gt;&lt;/SWIMMER&gt;
        &lt;TIME&gt;&lt;xsl:value-of select="@TIME"/&gt;&lt;/TIME&gt;
        &lt;DATE&gt;&lt;xsl:value-of select="@DATE"/&gt;&lt;/DATE&gt;
     &lt;/SWIM&gt;
     &lt;/xsl:for-each&gt;
  &lt;/EVENT&gt;
  &lt;/xsl:for-each&gt;
&lt;/xsl:for-each&gt;
&lt;/TOP_TEN_TIMES&gt;
&lt;/xsl:template&gt;
&lt;/xsl:stylesheet&gt;
</pre>
<p>
To perform the transformation, I will need to create three OLE instances of 
DOMDocument.  The first instance loads the top-times document 
and the second instance loads the stylesheet from above.  
The third instance will be used as the result of the transformation.  
I have created a subroutine that uses what we have already covered
to create the three DOMDocument instances, and to load the top-times and stylesheet
documents.  
</p>

<pre>
sub Transform {
 # Assign the File Names
  my $xml_doc_file     = shift;
  my $stylesheet_file  = shift;
  my $new_xml_doc_file = shift;
  my $boolean_Load;

 # Create the three OLE DOM instances
  my $doc_to_transform = Win32::OLE->new('MSXML2.DOMDocument.3.0');  
  my $style_sheet_doc  = Win32::OLE->new('MSXML2.DOMDocument.3.0');
  my $transformed_doc  = Win32::OLE->new('MSXML2.DOMDocument.3.0');

 # Load the Top Times document - just like above
  $doc_to_transform->{async} = "False";
  $doc_to_transform->{validateOnParse} = "True";
  $boolean_Load = $doc_to_transform->Load("$xml_doc_file");
  if(!$boolean_Load)
  {
      die "The Top Times did not load\n";
  }

 # Load the Stylesheet - just like above
  $style_sheet_doc->{async} = "False";
  $style_sheet_doc->{validateOnParse} = "True";
  $boolean_Load = $style_sheet_doc->Load($stylesheet_file);
  if(!$boolean_Load)
  {
      die "The Stylesheet did not load\n";
  }

 #Perform the transformation and save the resulting DOM object
  $doc_to_transform->transformNodeToObject($style_sheet_doc, $transformed_doc);
  $transformed_doc->save("$new_xml_doc_file");
}
</pre>
<p>
The <code>transformNodeToObject</code> method is where the magic happens.  I use the top-times 
DOMDocument instance to invoke the <code>transformNodeToObject</code> method and I pass the stylesheet
and transformation-result instances as arguments.  After the method returns,
the result of the transformation is stored in
<code>$transformed_doc</code>, which
is strictly in memory.  We simply call the save method and write the XML document to disk.
</p>
<p>
Now we can perform transformations using any stylesheet or XML document
that we want (as long as the stylesheet relates to the XML document).  
We just need to pass the subroutine three file names: the name of the document to transform, the 
name of the stylesheet and the name of the new document.  For our example, I will call 
the subroutine like the following.
</p>

<pre>
Transform("toptimes.xml", "toptimes.xsl", "newtoptimes.xml");
</pre>

<p>
After this code has executed, I have a brand new XML document 
<b>newtoptimes.xml</b> that conforms to my new XML syntax.
</p>

<h3>Updating the XML Document</h3>

<p>
After all this great work, one of my butterfliers informs me that I have been spelling
his name wrong all season.  I guess that there is two 'e's in Myers, not one. No problem. 
I can do this easily enough.
</p>
<p>
I can't use the exact code from above because the document structure has changed.  Since the 
swimmers' names are pretty deep in the new structure, it will be too painful to find the root node
and create a slew of nested loops (not to mention expensive to the processor). This is exactly
what XPath is for.  I will create a query to find all occurrences of "Peter Myers" and 
change them to "Peter Meyers".  Once again, I create an instance of DOMDocument and load the XML document.
However, this time I will call a new method, the <code>selectNodes</code> method, directly against the DOMDocument.
As an argument, I supply an XPath query.  The method returns a NodeList of all the Nodes
that matched the XPath query.  I can then iterate through the NodeList just like above and update
the element data as I go.
</p>

<pre>  
my $Peter_Nodes = 
     $new_DOM_document->selectNodes("TOP_TEN_TIMES/EVENT/SWIM/SWIMMER[. = \"Peter Myers\"]");
foreach my $Peter (in $Peter_Nodes)
{
   $Peter->{nodeTypedValue} = "Peter Meyers"  # update the Value
}
$new_DOM_document->save("newertoptimes.xml"); # save the changes
</pre>

<h3>Conclusion</h3>

<p>
MSXML isn't just for Visual Basic and Visual C++ programmers.  The <code>Win32::OLE</code> module allows
Perl programmers to take advantage of Microsoft's XML parser from the comfort of their
favorite text editor, and now that everyone on the team is happy with the top ten times, I can 
put away my XML Parser until next season ... .
</p>

<h3>Resources</h3>

<ul>
<li><a href="/2001/04/17/msxml_sample_code.zip">Download Sample Code</a>
<li><a href="http://www.msdn.microsoft.com/xml/default.asp">Microsoft MSDN XML Developer Center</a>
<li><a href="http://www.activestate.com/ASPN/Mail/browse/perl-win32-users">ActiveState's Win32 Users Mailing List</a>
</ul>




        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1492" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2001/04/p5pdigest/THISWEEK-20010415.html" rel="bookmark">This Week on p5p 2001/04/15</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Simon Cozens</span> on <abbr class="published" title="2001-04-15T00:00:00-08:00">April 15, 2001 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            </P>

<P>


<!-- This week on perl5-porters (09-15 Apr 2001) -->

<br />
<br />
      <H3><a name="Notes">Notes</a></H3>

</P>

<P>

You can subscribe to an email version of this summary by sending an
empty message to 
<a href="mailto:perl5-porters-digest-subscribe@netthink.co.uk"><tt>perl5-porters-digest-subscribe@netthink.co.uk</tt>.</a></P>

<P>
Please send corrections and additions to 
<CODE>perl-thisweek-YYYYMM@simon-cozens.org</CODE> where 
<CODE>YYYYMM</CODE> is the current year and month.  Changes and additions to the 
<a href="http://simon-cozens.org/writings/whos-who.html">perl5-porters</a> biographies are particularly welcome.
</P>

<P>
There were just under 300 messages this week.
<H3><a name="perl_beginners_list">perl-beginners list</a></H3>

</P>

<P>

Casey West came up with the great idea of having a mailing list for Perl
beginners. It's worth quoting extensively from his post:
<blockquote>I have been throwing around the idea of a central place where Perl
newcomers can come and ask FAQ questions and the like.  My dream is to
funnel all the RTFM  traffic from p5p, c.l.p.* and other such places.  I
would like to see a place where the newbies are accepted as people who
just don't know yet.
...
</P>

<P>
There are a few crucial things that must take place in order to make this list
as effective as possible:
</P>

<P>
* Moderation.  Flames must be removed at all times.  It should be easy to be
the newbie.
</P>

<P>
* Direction.   Archives are a valuable resource.  We don't do homework.
</P>

<P>
* Publicity.   List and News Group FAQ's can and should list perl-newbies as
the primary source for simple, 'new commer' questions.  Questions of this
nature should be immediatly redirected to perl-newbies.
</P>

<P>
* Teachers.    They can and will ask, we must answer.
</P>

<P>
At first I thought PerlMonks was this thing, however, PerlMonks is not
an environment where newbies are alowed to ask simple questions
answered in the documentation.
</blockquote></P>

<P>
Abigail suggested that &quot;learning how to uses available documentation
isn't something unique for Perl - it should be standard practise for
anyone out of primary school&quot;. While I personally agree with that, I
think there's definitely a need for hand-holding as well, and I take my
hat off to Casey for having done something about it.
</P>

<P>
Accordingly, the mailing list - called &quot;beginners&quot; to avoid people
feeling demeaned by the &quot;newbie&quot; tag - has been set up. Mail 
<CODE>beginners-subscribe@perl.org</CODE> to get involved, whether you want to ask questions or to answer them.
</P>

<P>
Kevin Lenzo noted that he's set up a help IRC channel with Casey's goals
in mind at 
<CODE>#perl-help</CODE> on 
<CODE>irc.rhizomatic.net</CODE>. Feel free to join in, but remember - no flames, no RTFMs, be nice.
<H3><a name="Dynamically_scoped_last">Dynamically scoped last()</a></H3>

</P>

<P>

There was a very long and very pointless thread which started when
Michael Schwern found the following bit of functionality:
</P>

</P><PRE>
	$ perl -wle 'sub foo { last; } while(1) { foo() }  print "Bar"'
	Exiting subroutine via last at -e line 1.
	Bar
</PRE>

<P>
He expected that to be an infinite loop, but the 
<CODE>last</CODE> actually ended the nearest loop, which is the 
<CODE>while</CODE> loop - 
<CODE>sub</CODE> isn't a loop, which is why you're not supposed to exit one with
<CODE>last</CODE>. A million and one people pointed out that this was documented in 
<CODE>perlsyn</CODE>, but it seemed to be documented very confusingly.
</P>

<P>
But what about bare blocks, he cried? Well, they're actually loops,
they're just loops that are executed once, replied Abigail, Dan and Graham in
chorus. Schwern asked why Perl behaved like this; Dan answered:
<blockquote>I think it makes the parser a bit simpler, because otherwise it would
need
to track loop starts and subroutine declarations and such to match up
loops
with lasts/redos/nexts. Plus you'd still need to walk the call stack
with
string evals, which'd be a bit of a mess.
</P>

<P>
I can't really see any reason that last, redo, or next should propagate
outside a subroutine, but it's probably a bit late to change this in
perl 5
</blockquote></P>

<P>
Abigail patched the documentation to make it explicit what's going on,
and after a few iterations, came up with a patch that everyone broadly
agreed on. After this brief burst of productivity, the discussion then
got silly, and the referees started blowing whistles and giving free
kicks.
</P>

<P>
In the end, Michael Schwern came up with some tests for the existing
behaviour, plus some patches to rewrite the warnings to call the
behaviour &quot;deprecated&quot;. 
</P>

<P>
Schwern also added tests for Exporter, which amazingly didn't have
any to date - they even found a bug in 
<CODE>require_version</CODE>. He tried to open the 
<CODE>B::walkoptree_slow</CODE> container of annelids again, but Jarkko didn't take the bait.
<H3><a name="perlbug_Administration">perlbug Administration</a></H3>

</P>

<P>

Jarkko reminded the world that there are - or at least, were - 1777 open 
bug ids, and suggested that the bug administrators get 5.6.1 installed
and attack the bug database with all their might. Merijn found that all
the HP/UX bugs were his smoke reports - how convenient! Ask suggested
that Chris Nandor advertise for bug administrators on 
<a href="http://use.perl.org/">Use Perl</a>, and I shall do it here as well:
</P>

<P>
If you want to help out squashing Perl bugs, please get in touch with
<a href="mailto:perlbug@rfi.net">Richard Foley</a> who will tell you how to get involved. You don't need to be able to
fix the bugs, although if you can, it obviously helps - we just need
people to be able to run through the database and say &quot;This is still a
problem as of 5.6.1&quot; or &quot;I don't see this in 5.6.1 any more&quot;, and report
back to us at P5P. A knowledge of the way P5P and bug squashing works -
which you can get through the
<a href="http://simon-cozens.org/writings/p5p-faq">P5P FAQ</a> will be useful, although Richard will tell you all you need to know
 about the actual 
<a href="http://bugs.perl.org/perlbug.cgi?req=webhelp">bug database</a> side of things. You can also subscribe to the 
<a href="mailto:bugmongers@perl.org">Bug Mongers mailing list</a>, but I have a feeling you're better off talking to Richard first.
</P>

<P>

<H3><a name="Problems_with_tar">Problems with tar</a></H3>

</P>

<P>
Mike Guy found that he was unable to untar Perl 5.6.1 on Solaris and
SunOS - Sarathy explained that the Solaris tar is broken for archives
which contain long path names, so he used GNU tar instead. Robert Spier
documented this fact in the README for CPAN.
</P>

<P>
Calle Dybedahl explained that it was the usual case of GNU versus the
world:
<blockquote>For paths longer than 100 characters, there are two incompatible
standards for tar archives: GNU tar and the rest of the world. If you
have such paths and built the archive with GNU tar, you must have GNU
tar to unpack it.
</blockquote></P>

<P>
Great, thought Sarathy - but we don't use any paths over 100 characters.
It turned out that there were at least three different problems
intersecting here: firstly, Mike's download was busted. Second, Solaris'
tar is busted, but a patch has been issued, and thirdly, there are two
different standards for tars - 
<a href="http://simon-cozens.org/writings/whos-who.html#BURLISON">Alan</a> explained it 
<a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2001-04/msg00527.html">beautifully</a>.
<H3><a name="NetPing_and_the_stream_protocol">Net::Ping and the "stream" protocol</a></H3>

</P>

<P>

Scott Bronson came up with an interesting idea for 
<CODE>Net::Ping</CODE>: because dynamic IPs exist, he needed to be able to both ping a host
and ensure it was the same host he's pung in the past. So, he added
a protocol to 
<CODE>Net::Ping</CODE> which keeps the connection alive between pings, and duly submitted the
patch to P5P. 
<!-- Good grief, an idea *and* a working implementation. Whatever next? --></P>

<P>
Colin McMillen, the maintainer of 
<CODE>Net::Ping</CODE>, recommended it for inclusion into bleadperl, and came up
with some changes of his own, particularly to replace the 
<CODE>alarm</CODE> timeout with non-blocking IO using 
<CODE>select</CODE>. This made Scott unhappy:
<blockquote>First of all, tcp ping is broken.  Select won't return if you haven't
written any data to be echoed.  If you were to write data, however,
that would disagree with the documentation: &quot;No data bytes are actually
sent since the successful establishment of a connection is proof enough
of the reachability of the remote host.&quot;  Which is it to be?  And,
how about warning me that it doesn't work before I start trying to
figure out what I broke?
</P>

<P>
I fixed this in the patch by writing some bytes to be echoed and
reading them back.  But I think this is a very bad idea.  Also from
the docs, &quot;tcp is expensive and doesn't need our help to add to the  
overhead.&quot;  You're changing Net::Ping's personality.
</blockquote></P>

<P>
Colin defended his changes, saying that the current behaviour is
horribly broken anyway, as has been discussed several times in the past.
He also defended forking a new process for ping on Win32, since
expensive Win32 functionality is better than none. Graham Barr also
chimed in, demonstrating how to do a non-blocking connect and select
with timeout, and noting that 
<CODE>alarm</CODE> is best avoided.
<H3><a name="Various">Various</a></H3>

</P>

<P>

Rich Williams found a little bug with the regular expression optimizer
in Perl 5.6.1 - apparently it only strikes when using 
<CODE>.*</CODE> together with
<CODE>/sg</CODE>. However, he put in the time and the detective work to isolate it to
a couple of patches, from which Sarathy and Hugo managed to squash the
bug;
<a href="http://simon-cozens.org/writings/whos-who.html#AAS">Gisle</a> fixed 
<CODE>Digest::MD5</CODE> for UTF8 strings.
</P>

<P>
Peter Prymmer updated the 
<CODE>perlebcdic</CODE> documentation to document Nick Ing-Simmon's heroic UTF-EBCDIC effort.
Tom Horsley complained about 
<CODE>perlbug</CODE> occasionally putting
<CODE>~s ...the subject</CODE> and
<CODE>~c ...the sender's email address</CODE> in the body of the mail instead of actually writing the headers
 properly - Kurt Starsinic explained that it was actually a bug in 
<CODE>Mail::Mailer</CODE> and a workaround is to set 
<CODE>PERL_MAILERS=mail:/no/such/thing</CODE></P>

<P>

Jonathan Stowe found some horrible bugs in SCO's 
<CODE>NaN</CODE> handling - 
<CODE>NaN</CODE> compares equal to 1.0 and less than 1.0. Urgh. Andy Dougherty suggested
that we whip up a C program which tests for platforms with broken 
<CODE>NaN</CODE> and papers over the cracks in the test suite; Jarkko, on the other
 hand, was more sanguine as suggested that 5.7.2 will have to bite the
<CODE>NaN</CODE> and 
<CODE>inf</CODE> bullets. Nick Clark pointed out that 
<CODE>$_ & ~0</CODE> will do weird things for many values of
<CODE>$_</CODE>.
</P>

<P>
Vadim Konovalov found a problem with the 
<CODE>-f</CODE> operator in Cygwin - it interprets 
<CODE>-f "foo"</CODE> as 
<CODE>-f "foo" || -f "foo.exe"</CODE>. Urgh. Mike Giroux explained that it made some sense - programs on
Windows want to execute 
<CODE>foo.exe</CODE> by saying just 
<CODE>foo</CODE>. Fair enough, but Vadim pointed out that there's code in 
<CODE>win32/win32.c</CODE> to work around this for Borland's C compiler, so this could be extended
to Cygwin. 
</P>

<P>
Robin Houston continued his conquest of 
<CODE>B::*</CODE>. His changes were
<a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2001-04/msg00641.html">numerous</a>.
</P>

<P>
Jarkko has suggested that he wants to integrate 
<CODE>Time::HiRes</CODE> into 5.7.2 - after some time, the maintainer of the module was tracked
down and subdued. There'll be a lot more about new module integration
next week.
</P>

<P>
Aaron Mackey reported that building Perl on Mac OS X doesn't work
properly because of problems with case-folding in the file system - if
you're finding this, try adding 
<CODE>-Dmakefile=GNUmakefile</CODE> to the Configure command, and/or set the environment variable 
<CODE>LC_ALL=C</CODE>. 
</P>

<P>
The 
<CODE>FETCHSLICE</CODE>/
<CODE>STORESLICE</CODE> idea reared its ugly head again, with Rick Delaney implementing a 
<CODE>FETCHSIZE</CODE> method. While it's certainly a good idea, Dave Mitchell pointed out it
may well have the same problems as 
<CODE>*SLICE</CODE> when it comes to unscrupulously inheriting modules.
</P>

<P>
Eric Kolve noted that Perl does 
<a href="http://bugs.perl.org/perlbug.cgi?req=bug_id&bug_id=20010411.004&format=H&trim=25&range=1277&target=perbug">Weird Things </a> if you try doing a 
<CODE>tie</CODE> inside of a 
<CODE>FETCH</CODE> from a tied variable - this isn't surprising, but it would be a good
 thing for someone with a bit of spare time to look into.
</P>

<P>
Until next week I remain, your humble and obedient servant,
</P>

<hr>

<a href="mailto:simon@brecon.co.uk">Simon Cozens</a>


<ul>
  <li><a href="#Notes">Notes</a>
  <li><a href="#perl_beginners_list">perl-beginners list</a>
  <li><a href="#Dynamically_scoped_last">Dynamically scoped last()</a>
  <li><a href="#perlbug_Administration">perlbug Administration</a>
  <li><a href="#Problems_with_tar">Problems with tar</a>
  <li><a href="#NetPing_and_the_stream_protocol">Net::Ping and the "stream" protocol</a>
  <li><a href="#Various">Various</a>
</ul>

        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1482" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2001/04/10/engine.html" rel="bookmark">Designing a Search Engine</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Pete Sergeant</span> on <abbr class="published" title="2001-04-10T00:00:00-08:00">April 10, 2001 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            <!-- Designing a Search Engine -->

<br />
<p>A couple of months ago, I was approached by a company that I had done some 
work for previously, and was asked to build them a search engine to index 
about 200MB of HTML. However, some fairly strict rules were laid down about 
what I could and couldn't do. First, the search engine had to be built 
from scratch, so that the rights to it were fully theirs. Second, I wasn't 
allowed to use any non-standard modules. Third, the data had to be held in 
plain-text files. Fourth, I was assured that all DB* modules were not 
working, and couldn't be made to work, which seemed somewhat surprising. 
And finally, one had to be able to perform Boolean searches, including the use 
of brackets.</p>

<p>As you can imagine, this presented quite a challenge, so I accepted 
and got to work. I want to discuss the two most interesting parts of 
the project: how to store and retrieve the data efficiently, and how to 
parse search terms.</p>

<p>Because of the ideas I had on parsing the search terms, which will be 
discussed later, I needed a system that could take a word and send back a 
list of all the files it appeared in and how many times it appeared in 
them. This had to be as fast as possible without using insane amounts of 
disk space.  Second, I needed to be able to get information about the 
files indexed quickly without actually opening them - the files could be 
large, and could be held remotely.</p>

<p>The first thing to do was to assign each indexed file a unique number - 
this would allow me to save space when referring to it, and would allow me 
to easily look up information on the file. Each word would have a list 
of these numbers listed under it, so I could take the word 'camel' for 
example, and get a list of file numbers back.</p>

<p>To me, the most obvious way of implementing this was to use a tied hash. 
However, my project rules stated I wasn't allowed to do that. I tried to think of 
other ways to implement a tied-hash system without using any of the DB or 
DBI modules. My first idea was to piggy back off a similar feature used in almost all operating systems; or, to be more precise, every file system. By 
creating each word as a file I could easily <code>open (DATA, "camel")</code> to get my 
data.</p>

<p>At this point, I had two types of indexes: one that listed 
summary information for each file by file number, and another that held information about each word.</p>

<p>There were two problems, however, with using the file system as my hash. 
While with a small number of words it was quite fast, most operating systems 
use a linear search to locate files in a directory, so opening "zulu" in a 
10,000 file directory quickly became quite slow. The other problem was 
minimum file sizes, especially under Windows. This is a huge problem when 
your minimum file size is 16kb - as it is on fat16 with a 1GB hard drive - as 
100 files translates as 1.6MB. When the data you're indexing is 20MB and you get about four times this much worth of index files, you're doing 
something wrong.</p>

<p>The solution for the file numbers was quite easy: I would spit out the file 
offsets of where information about each file was stored in my file index. 
Then, I'd read these offsets in at the start of each search, so that if I 
wanted information about file 15, I could get the offset by saying $file[15] 
and then seeking to that point.</p>

<p>I was beginning to despair for an elegant solution to the word indexing 
until Simon Cozens pointed out the wonderful Search::Dict. Search::Dict is a 
standard module that searches for keys in dictionary files. Essentially, it allows you to give it a word and a file-handle, where the 
file-handle is tied to a bunch of lines in alphabetical order, and will then 
change the next read position of the file-handle to the line that starts 
with the word. For example:</p>
<pre>
look *INDEX, "camel";
$line = &lt;INDEX>;
</pre>
</p>
<p>would assign $line to the first line in the file handle beginning with 
camel. In addition, since it uses an effective binary search to achieve 
this, retrieval of data was fast. Problem solved.</p>

<p>Parsing of the Boolean search terms was the most difficult part of the 
program. Users had to be able to enter terms such as cat and (dog not sheep) 
and get sane results. The only way I could deal with this, I decided, was to 
go along the search terms from left to right and keep an array of file 
numbers that were still applicable.</p>

<p>To do this, I created three subroutines that I called <code>&amp;array_and</code>, 
<code>&amp;array_not</code>, and <code>&amp;array_both</code>. <code>&amp;array_and</code> would take our current results 
array and add the list of file numbers from a given word. <code>&amp;array_not</code> 
would 'subtract' the file numbers from one word from our results array, and 
<code>&amp;array_both</code> would return shared elements between the results array and the 
file numbers from the search word.</p>

<p>I ripped a lot of code from the Perl Cookbook to make these array functions. 
The code for these functions can be seen below:
<pre>
sub array_both {
 my $prev = 'nonesuch';
 my @total_first = (@{$_[0]}, @{$_[1]});
 @total_first = sort(@total_first);
 my $current;
 my @return_array;
 foreach $current (@total_first) {
  if ($prev eq $current) { push(@return_array, $prev);  }
  $prev = $current;
 }
 @return_array = @{&amp;add_array(\@return_array, \@return_array)};
 return \@return_array;
}

sub array_and {
 my $prev = 'nonesuch';
 my @total_first = (@{$_[0]}, @{$_[1]});
 my %seen = (); # These next two lines are from the PCB
 my @return_array = grep { ! $seen{$_} ++ } @total_first ;
 return \@return_array;
}

sub array_not {

 # Again this is ripped straight from PCB

 my @a = @{$_[0]};
 my @b = @{$_[1]};
 my %hash = map {$_ => 1} @a;
 my $current;
 foreach $current (@b) {
  delete $hash{$current};
 }
 @a = keys %hash;
 @a = sort(@a);
 return \@a;
}
</pre>

<p>The only big problem left was dealing with brackets. The only 
solution I could come up with was to make the search term parsing code a 
subroutine that returned an array. This way when I came to some logic in 
brackets, I could send it back to the subroutine, from which I would get a 
list of words, exactly like if the logic had been a single word. The main 
problem that I envisaged with this would be getting Perl to deal with 
expressions such as <code>sheep and (dog not cat) and (camel not panther)</code>. How did I 
get Perl to match just the first set of brackets, or, if nested brackets 
were present, to match all the logic? Damian Conway has written an excellent 
module called Text::Balanced, which I was just about to start using, before 
the project specifications changed(!) and I was told we no longer needed to 
allow nested-bracket searching.</p>

<p>Yet again, Perl came into its own when writing the search engine. The 
availability of solutions to my problems in the form of modules saved me a 
lot of time, and saved the task from being inundated with my own, rather 
bad, code. The ability to use Perl to quickly extract titles from HTML 
documents and strip HTML tags in very few lines of code also made my life 
far easier.</p>

        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1490" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2001/04/p5pdigest/THISWEEK-20010408.html" rel="bookmark">This Week on p5p 2001/04/08</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Simon Cozens</span> on <abbr class="published" title="2001-04-08T00:00:00-08:00">April  8, 2001 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            </P>

<P>


<!-- This week on perl5-porters (02-08 Apr 20XX) -->

<br />
<br />
      <H3><a name="Notes">Notes</a></H3>

</P>

<P>

You can subscribe to an email version of this summary by sending an
empty message to 
<a href="mailto:perl5-porters-digest-subscribe@netthink.co.uk"><tt>perl5-porters-digest-subscribe@netthink.co.uk</tt>.</a></P>

<P>
Please send corrections and additions to 
<CODE>perl-thisweek-YYYYMM@simon-cozens.org</CODE> where 
<CODE>YYYYMM</CODE> is the current year and month.  Changes and additions to the 
<a href="http://simon-cozens.org/writings/whos-who.html">perl5-porters</a> biographies are particularly welcome.
</P>

<P>
Apologies for the delay in this week's summary; I was travelling this
weekend, and didn't get back until Tuesday.
<H3><a name="Perl_561_and_Perl_571_Released">Perl 5.6.1 and Perl 5.7.1 Released!</a></H3>

</P>

<P>

The big news this week is that, as you probably already know by now,
Perl 5.6.1 and Perl 5.7.1 are available. Get them from 
<a href="http://www.cpan.org/src/">CPAN</a>. Well done to Sarathy and Jarkko for getting these out of the door.
<H3><a name="Robin_Houston_Left_On_ALL_WEEK">Robin Houston Left On ALL WEEK</a></H3>

</P>

<P>

Someone has just far too much free time on their hands. Robin Houston
started the week by adding a warning to 
</P>

</P><PRE>
    push @array;
</PRE>

<P>
This was slightly controversial, as it might introduce new warnings to old
code, (albeit old, broken code) and some people - myself included - wanted
to see 
<CODE>push</CODE> default to 
<CODE>$_</CODE> instead. That really would change the semantics of old code, however.
Mark-Jason Dominus wondered whether anyone could write 
<CODE>push @array</CODE> by accident, or even have a program write it legimitately, but both
Ronald and Jarkko confessed to have written it when they meant 
<CODE>push @array, $_</CODE>. 
</P>

<P>
Then he moved over to hacking on 
<CODE>B::Concise</CODE>; he found an interesting optimisation where you have code like 
</P>

<P>
  @a = split(/pat/, str);
</P>

<P>
Perl actually places the symbol table entry for 
<CODE>@a</CODE> inside the opcode for the regular expression, casting it into an OP as
 it goes. 
<CODE>B::Concise</CODE> wasn't aware of this peculiarity and thought that the op was, well, an
op. Boom.
</P>

<P>
Next, he fixed up something with lexicals; the way lexicals are stored
is quite complex, as he explains:
<blockquote>perl stores the names of lexical variables in SV structures.
But of course it doesn't stop there. Oh no! Not only are the
IVX and NVX slots used to hold scope information, but SvCUR
is used for some nefarious purpose which I don't understand.
(look in op.c/Perl_newASSIGNOP for (at least some of) this
SvCUR chicanery. It seems to be connected with the mysterious
variable PL_generation.)
</P>

<P>
B::Concise is making naive assumptions about perl's sanity
again. Try this, for example:
</P>

<P>
  perl -MO=Concise -e 'my @x; @x=2;' |less
</P>

<P>
The variable name (&quot;@x&quot;) is followed by all kinds of weird
binary data, because B::Concise believed perl when it gave
the length of the string, not suspecting for a moment that
the slot which ordinarily holds the length happens to be
used for devil-worship in this situation.
</blockquote></P>

<P>
This is, as Stephen McCamant explained, related to a clever optimization
to allow both
</P>

</P><PRE>
    ($a, $b) = ($c, $d);
</PRE>

<P>
and
</P>

</P><PRE>
    ($a, $b) = ($b, $a);
</PRE>

<P>
to both work - in the second case, Perl needs to use a temporary variable
to swap the values over. It determines whether or not the left-hand and
right-hand sides have elements in common by &quot;marking&quot; each element, and
that's what the devil-worship was for.
</P>

<P>
Robin realised that this meant that variables with very long names used
in a list assignment would be truncated, so he fixed them up as well.
</P>

<P>
By now, however, Robin is unstoppable. He made 
<CODE>B::Deparse</CODE> give sensible output for variables which start with control characters
such as 
<CODE>$^WIDE_SYSTEM_CALLS</CODE>. Realising this was a common problem, he made a 
<CODE>B::GV::SAFENAME</CODE> method to ensure the name was printable and converted all the 
<CODE>B::*</CODE> modules to use that. Good work!
</P>

<P>
But no, it doesn't end here. He fixed up 
<CODE>B::*</CODE> to cope with IVs that were actually UVs, 
<CODE>B::Deparse</CODE> handling of regular expressions,
<CODE>"${foo}bar"</CODE> and 
<CODE>binmode</CODE>, and made it warning-clean.
</P>

<P>
By the end of the week, he was pleased to report that you can now run 
<CODE>t/base/lex.t</CODE> through 
<CODE>B::Deparse</CODE> and back through Perl, and all tests pass. Wow.
<H3><a name="More_on_glob">More on glob</a></H3>

</P>

<P>

Benjamin Sugars tried to speed up 
<CODE>glob</CODE>. As you may or may not now, core's 
<CODE>glob</CODE> automagically loads up 
<CODE>File::Glob</CODE> and uses the 
<CODE>glob</CODE> function that that provides. Unfortunately, this also pulls in 
<CODE>Exporter</CODE> and all sorts of other modules. Benjamin rewrote 
<CODE>File::Glob</CODE> to avoid the compile-time dependencies on these modules, and fiddled
the bit in the core (after a few false starts) which loads up the module
to make it equivalent to 
<CODE>use File::Glob ()</CODE>. He also documented 
<CODE>load_module</CODE>, which is the core function for magical module using.
<H3><a name="Changes_files_in_core">Changes files in core</a></H3>

</P>

<P>

John Allen asked &quot;does anyone else think it may be time
to grant the voluminous ChangesX.XXX files in the standard perl
distribution their own separately downloadable gzip file?&quot; Well, as usual,
some did and some didn't. The motivation for not doing so would be that
it would not be necessary to download anything other than the Perl source
tarball to understand the sources. Further, Jarkko pointed out that the
Changes files describe patches that affect more than one file at once and
wouldn't be sensibly documented in any single one of them. 
</P>

<P>
Benjamin Sugars suggested moving them to a separate directory rather than
getting rid of them altogether; Jarkko hinted that he wasn't going to go
through the Perforce hell of moving files just for the sake of moving them. 
</P>

<P>
John's eventual compromise was to keep them in the development sources
for those people who want to hack on them, and remove them from the 
stable sources. This seems to suit everyone, but nobody said anything 
further.
<H3><a name="How_Magic_and_Ties_Work">How Magic and Ties Work</a></H3>

</P>

<P>

I provided a sample few sections from my forthcoming Perl Internals
training course about 
<a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2001-04/msg00238.html">how magic and ties work</a>. Enjoy.
<H3><a name="Various">Various</a></H3>

</P>

<P>

Olaf Flebbe turned in EPOC fixes before 5.6.1 went out, and Craig Berry
updated 
<CODE>README.vms</CODE> while Peter Prymmer updated all sorts of other VMS things; 
<a href="http://simon-cozens.org/writings/whos-who.html#AAS">Gisle</a> came up with a neat patch to let 
</P>

</P><PRE>
    @foo = do { ... };
</PRE>

<P>
propagate array context to the 
<CODE>do</CODE> block.
</P>

<P>
Paul Schinder came up with some OS X fixes for 5.6.1; apparently OS X's
gcc isn't very gcc, and this caused the preprocessor to do weird things
which broke 
[Errno].
</P>

<P>
John Peacock fixed up some bugs in 
<CODE>Math::BigFloat</CODE> found by Tom Roche but the only thanks he got was a discussion of
the indentation style of the Perl sources. 8-wide tabs, 4 spaces,
people. (
<a href="http://simon-cozens.org/writings/whos-who.html#ALLBERY">Russ</a> says we should use spaces instead of tabs, but it's a bit late now.)
</P>

<P>
Jonathan Stowe tried to change something about 
<CODE>$#</CODE>; Sarathy suggested that this might break some ten year old code, even
though the bug's been in there since forever...
</P>

<P>
The 
<CODE>TIESLICE</CODE>/
<CODE>STORESLICE</CODE> issue came back. The discussion produced more light than heat.
</P>

<P>
And finally... Dan Brian explained
<a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2001-04/msg00188.html">what happens if you cross Black and White with Perl5-Porters.</a></P>

<P>
Until next week I remain, your humble and obedient servant,
</P>

<hr>

<a href="mailto:simon@brecon.co.uk">Simon Cozens</a>


<ul>
  <li><a href="#Notes">Notes</a>
  <li><a href="#Perl_561_and_Perl_571_Released">Perl 5.6.1 and Perl 5.7.1 Released!</a>
  <li><a href="#Robin_Houston_Left_On_ALL_WEEK">Robin Houston Left On ALL WEEK</a>
  <li><a href="#More_on_glob">More on glob</a>
  <li><a href="#Changes_files_in_core">Changes files in core</a>
  <li><a href="#How_Magic_and_Ties_Work">How Magic and Ties Work</a>
  <li><a href="#Various">Various</a>
</ul>

        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1480" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2001/04/02/wall.html" rel="bookmark">Apocalypse 1: The Ugly, the Bad, and the Good</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Larry Wall</span> on <abbr class="published" title="2001-04-02T00:00:00-08:00">April  2, 2001 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            <!-- Apocalypse 1: The Ugly, the Bad, and the Good -->

<p><em>Editor's Note: this Apocalypse is out of date and remains here for historic reasons.  See <a href="http://dev.perl.org/perl6/doc/design/syn/S01.html">Synopsis 01</a> for the latest information.</em></p>

<br />

<p><table width="180" cellspacing="0" cellpadding="4" align="right" border="1">
<tr>
<td align="center" valign="top" bgcolor="#6699cc">
<font color="#ffffff">Table of Contents</td>
</tr>

<tr>
<td>
<p class="fine">
&#149;<a href="#rfc141">RFC 141: This Is The Last
Major Revision</a><br /><br />
&#149;<a href="#rfc28">RFC 28: Perl should stay
Perl</a><br /><br />
&#149;<a href="#rfc16">RFC 16: Keep
default Perl free
of constraints such as warnings and strict</a><br /><br />
&#149;<a href="#rfc73">RFC 73: All Perl core
functions should return objects</a><br /><br />
&#149;<a href="#rfc26">RFC 26: Named
operators versus
functions</a><br />


</td>
</tr>
</p>
</table>
<p>People get scared when they hear the word Apocalypse, but here I mean
it in the good sense: a Revealing.  An Apocalypse is supposed to reveal
good news to good people.  (And if it also happens to reveal bad news
to bad people, so be it.  Just don't be bad.)</p>
<p>What I will be revealing in these columns will be the design of Perl

6.  Or more accurately, the beginnings of that design, since the design
process will certainly continue after I've had my initial say in the
matter.  I'm not omniscient, rumors to the contrary notwithstanding.
This job of playing God is a little too big for me.  Nevertheless,
someone has to do it, so I'll try my best to fake it.  And I'll expect
all of you to help me out with the process of creating history.  We all
have to do our bit with free will.</p>
<p>"If you look at the history of Perl 6 up to this point, you will see why this 
 column is subtitled The Ugly, the Bad, and the Good. The RFC process 
 of last year was ugly, in a good sense. It was a brainstorming process, 
 and that means it was deliberately ugly&#151;not in the sense of incivility, 
 since the RFC process was in fact surprisingly civil, but in the sense that 
 there was little coherent design to the suggestions in the RFCs. Frankly, 
 the RFCs are all over the map, without actually covering the map. There are contradictory RFCs, and there are missing RFCs. 
 Many of the RFCs propose real problems but go off at funny angles in 
 trying to propose solutions. Many of them patch symptoms without 
 curing the underlying ailments.</p>

<!-- sidebar begins -->
<table width="170" border="0" cellspacing="12" cellpadding="6" align="right">
<tr> 
<td width="170" valign="top" height="4" bgcolor="#6699cc"></td></tr> 
<tr>
<td><font color="6699cc" size="-1"><b>Larry Wall will give his annual entertaining talk on the
     state of the Perl world, covering both Perl 5 and
     Perl 6 at this Year's <a href="http://conferences.oreilly.com/perl/">Open Source Convention</a>.
     Don't miss this rare opportunity to hear the creator of
     Perl, patch, and run share his insights.</b>

 </td></tr> <tr><td width="170" valign="top" height="4" bgcolor="#6699cc"> </td></tr></table>
<!-- sidebar ends -->



<p>I also discovered Larry's First Law of Language Redesign: Everyone
wants the colon.</p>
<p>That was the Ugly part.  The Bad part was that I was supposed to take
these RFCs and produce a coherent design in two weeks.  I starting out
thinking I could just classify the RFCs into the good, bad, and ugly
categories, but somehow most of them ended up in the ugly category,
because the good ones typically had something wrong with them, and the
even the bad ones typically indicated a problem that could use some
thought, even if the solution was totally bogus.</p>
<p>It is now five months later, and I've been mulling over coherence the
whole time, for some definition of mulling.  Many of you know what
happens when the size of your Perl process exceeds the size of your
physical memory&#151;you start thrashing.  Well, that's basically what
happened to me.  I couldn't get enough of the problem into my head at
once to make good progress, and I'm not actually very good at
subdividing problems.  My forte is synthesis, not analysis.  It didn't
help that I had a number of distractions in my life, some of them
self-inflicted, and some of them not.  I won't go into all that.  Save
it for my unauthorized autobiography.</p>

<table width="170" border="0" cellspacing="12" cellpadding="6" align="right">
<tr> 
<td width="170" valign="top" height="4" bgcolor="#6699cc"></td></tr> 
<tr>
<td><p align="center"><a href="http://www.oreilly.com/catalog/pperl3/"><img src="/images/progperl.jpg" height="111" width="85" border="0"></a> 
<p class="fine"><a href="http://www.oreilly.com/catalog/pperl3/" class="tiny"><b>Programming Perl, 3rd Edition</b></a>
<br />
Larry Wall, Tom Christiansen & Jon Orwant<br />
3rd Edition July 2000<br />
0-596-00027-8, Order Number: 0278<br />
1092 pages, $49.95<br />


</td></tr> <tr><td width="170" valign="top" height="4" bgcolor="#6699cc"></center></td></tr></table>

<p>But now we come to the Good part.  (I hope.)  After thinking lots and
lots about many of the individual RFCs, and not knowing how to start
thinking about them as a whole, it occurred to me (finally!) that the
proper order to think about things was, more or less, the order of the
chapters in the Camel Book.  That is, the Camel Book's order is
designed to minimize forward references in the explanation of Perl, so
considering Perl 6 in roughly the same order will tend to reduce the
number of things that I have to decide before I've decided them.</p>
<p>So I've merrily classified all the RFCs by chapter number, and they
look much more manageable now.  (I also restructured my email so that I
can look at a slice of all the messages that ever talked about a
particular RFC, regardless of which mailing list the message was on.
That's also a big help.) I intend to produce one Apocalypse for each
Chapter, so Apocalypse 1 corresponds to Chapter 1: An Overview of
Perl.  (Of course, in the book, the Overview is more like a small
tutorial, not really a complete analysis of the philosophical
underpinnings of Perl.  Nevertheless, it was a convenient place to
classify those RFCs that talk about Perl 6 on that level.)</p>
<p>So today I'm talking about the following RFCs:</p>
<pre>
    RFC  PSA  Title
    ---  ---  -----
     16  bdb  Keep default Perl free of constraints such as warnings and
strict.
     26  ccb  Named operators versus functions
     28  acc  Perl should stay Perl.
     73  adb  All Perl core functions should return objects
    141  abr  This Is The Last Major Revision</pre>
<p>The PSA rating stands for ``Problem, Solution, Acceptance''.
The problem
and solution are graded on an a-f scale, and very often you'll find I
grade the problem higher than the solution.  The acceptance rating is
one of</p>
<pre>
    a  Accepted wholeheartedly
    b  Accepted with a few &quot;buts&quot;
    c  Accepted with some major caveats
    r  Rejected</pre>
<p>I might at some point add a ``d'' for Deferred, if I really think it's
too
soon to decide something.</p>

<h3><a href="http://dev.perl.org/rfc/141.html" name="rfc141">RFC 141: This Is The Last
Major Revision</a></h3>
<p>I was initially inclined to accept this RFC, but decided to reject it
on theological grounds.  In apocalyptic literature, 7 is the number
representing perfection, while 6 is the number representing
imperfection.  In fact, we probably wouldn't end up converging on a
version number of <code>2*PI</code> as the RFC suggests, but rather on
<code>6.6.6</code>, which
would be rather unfortunate.</p>
<p>So Perl 7 will be the last major revision.  In fact, Perl 7 will be
so perfect, it will need no revision at all.  Perl 6 is merely
the prototype
for Perl 7.   <code>:-)</code></p>
<p>Actually, I agree with the underlying sentiment of the RFC&#151;I only
rejected
it for the entertainment value.  I want Perl to be a language that can
continue to evolve to better fit the problems people want to
solve with it.
To that end, I have several design goals that will tend to be obscured if
you just peruse the RFCs.</p>
<p>First, Perl will support multiple syntaxes that map onto a single
semantic model.  Second, that single semantic model will in turn map to
multiple platforms.</p>
<p>Multiple syntaxes sound like an evil thing, but they're really
necessary for the evolution of the language.  To some extent we already
have a multi-syntax model in Perl 5; every time you use a pragma or
module, you are warping the language you're using.  As long as it's
clear from the declarations at the top of the module which version of
the language you're using, this causes little problem.</p>
<p>A particularly strong example of how support of multiple syntaxes
will allow continued evolution is the migration from Perl 5 to Perl 6
itself.  See the discussion of RFC 16 below.</p>
<p>Multiple backends are a necessity of the world we live in
today.  Perl 6
must
not be limited to running only on platforms that can be
programmed in C.  It
must be able to run in other kinds of virtual machines, such as those
supported
by Java and C#.</p>

<h3><a href="http://dev.perl.org/rfc/28.html" name="rfc28">RFC 28: Perl should stay
Perl.</a></h3>
<p>It is my fond hope that those who are fond of Perl 5 will be
fonder still
of Perl 6.  That being said, it's also my hope that Perl will continue
trying to be all things to all people, because that's part of
Perl too.</p>
<p>While I accept the RFC in principle (that is, I don't intend to go
raving mad), I have some major caveats with it, because I think it is
needlessly fearful that any of several programming paradigms will ``take
over'' the design.  This is not going to happen.  Part of what makes
Perl Perl is that it is intentionally multi-paradigmatic.  You might
say that Perl allows you to be paradigmatic without being
``paradogmatic''.</p>
<p>The essence of Perl is really context sensitivity, not just to
syntactic
context, but also to semantic, pragmatic, and cultural context.  This
overall philosophy is not going to change in Perl 6, although specific
context sensitivities may come and go.  Some of the current context
sensitivities actually prevent us from doing a better job of it in
other areas.  By intentionally breaking a few things, we can make Perl
understand what we mean even better than it does now.</p>
<p>As a specific example, there are various ways things could improve if
we muster the courage to break the ``weird'' relationship between
<code>@foo</code>
and <code>$foo[]</code>.  True, we'd lose the current slice
notation (it can
be
replaced with something better, I expect).  But by consistently treating
<code>@foo</code>
as an utterance that in scalar context returns an array reference, we
can make subscripts always <em>take</em> an array reference, which among
other
things fixes the botch that in Perl 5 requires us to distinguish
<code>$foo[]</code> from <code>$foo-&gt;[]</code>.  There will be more
discussion of this in
Apocalypse 2, when we'll dissect ideas like RFC 9: Highlander Variable
Types.</p>

<h3><a href="http://dev.perl.org/rfc/16.html" name="rfc16">RFC 16: Keep
default Perl free
of constraints such as warnings and strict.</a></h3>

<p>I am of two minds about this debate&#151;there are good arguments for
both sides.  And if you read through the discussions, all those arguments
were forcefully made, repeatedly.  The specific discussion centered around
the issue of strictness, of course, but the title of the RFC claims a
more general philosophical position, and so it ended up in this
Apocalypse.</p>
<p>I'll talk about strictness and warnings in a moment, and I'll also talk
about constraints in general, but I'd like to take a detour through
some more esoteric design issues first.  To my mind, this RFC (and the
ones it is reacting against), are examples of why some language
designer like me has to be the one to judge them, because they're all
right, and they're all wrong, simultaneously.  Many of the RFCs stake
out polar positions and defend them ably, but fail to point out
possible areas of compromise.  To be sure, it is right for an RFC to
focus in on a particular area and not try to do everything.  But because
all these RFCs are written with (mostly) the design of Perl 5 in mind,
they cannot synthesize compromise even where the design of Perl 6 will
make it mandatory.</p>
<p>To me, one of the overriding issues is whether it's possible to
translate Perl 5 code into Perl 6 code.  One particular place of
concern is in the many one-liners embedded in shell scripts here and
there.  There's no really good way to translate those invocations, so
requiring a new command line switch to set ``no strict'' is not going to
fly.</p>
<p>A closely related question is how Perl is going to recognize when it
has accidentally been fed Perl 5 code rather than Perl 6 code.  It
would be rather bad to suddenly give working code a brand new set of
semantics.  The answer, I believe, is that it has to be impossible by
definition to accidentally feed Perl 5 code to Perl 6.  That is, Perl 6
must assume it is being fed Perl 5 code until it knows otherwise.  And
that implies that we must have some declaration that unambiguously
declares the code to be Perl 6.</p>
<p>Now, there are right ways to do this, and wrong ways.  I was peeved by
the approach taken by DEC when they upgraded BASIC/PLUS to handle long
variable names.  Their solution was to require every program using long

variable names to use the command <code>EXTEND</code> at the top.  So
henceforth
and forevermore, every BASIC/PLUS program had <code>EXTEND</code>
at the top
of
it.  I don't know whether to call it Bad or Ugly, but it certainly
wasn't Good.</p>
<p>A better approach is to modify something that would have to be there
anyway.  If you go out to CPAN and look at every single module out
there, what do you see at the top?  Answer: a ``<code>package</code>''
declaration.  So we break that.</p>
<p>I hereby declare that a <code>package</code> declaration at
the front of
a file
unambiguously indicates you are parsing Perl 5 code.  If you want to
write a Perl 6 module or class, it'll start with the keyword
<code>module</code>
or <code>class</code>.  I don't know yet what the exact syntax of a module
or a
class declaration will be, but one thing I do know is that it'll set
the current global namespace much like a <code>package</code> declaration
does.</p>
<p>Now with one fell swoop, much of the problem of programming in the
large can be dealt with simply by making modules and classes default to
strict, with warnings.  But note that the default in the main program
(and in one liners) is Perl 5, which is non-strict by definition.  We
still have to figure out how Perl 6 main programs should distinguish
themselves from Perl 5 (with a ``<code>use 6.0</code>'' maybe?),
and whether
Perl 6
main programs should default to strict or not (I think not), but you
can already see that a course instructor could threaten to flunk anyone
who doesn't put ``<code>module Main</code>'' at the front each
program, and
never
actually tell their pupils that they want that because it turns on
strictures and warnings.</p>
<p>Other approaches are possible, but that leads us to a deeper issue,
which is the issue of project policy and site policy.  People are
always hankering for various files to be automatically read in from
various locations, and I've always steadfastly resisted that because it
makes scripts implicitly non-portable.  However, explicit
non-portability is okay, so there's no reason our hypothetical class
instructor could not insist that programs start with a ``<code>use
Policy;</code>'' or
some such.</p>
<p>But now again we see how this leads to an even deeper language design
issue.  The real problem is that it's difficult to write such a Policy
module in Perl 5, because it's really not a module but a meta-module.
It wants to do ``<code>use strict</code>'' and ``<code>use
warnings</code>''
on behalf of the
student, but it cannot do so.  Therefore one thing we must implement in
Perl 6 is the ability to write meta-use statements that look like
ordinary use statements but turn around and declare other things on
behalf of the user, for the good of the user, or of the project, or of
the site.  (Whatever.  I'm not a policy wonk.)</p>
<p>So whether I agree with this RFC really depends on what it means by
``default''.  And like Humpty Dumpty, I'll just make it mean whatever I
think is
most convenient.  That's context sensitivity at work.</p>
<p>I also happen to agree with this RFC because it's my philosophical
position that morality works best when chosen, not when mandated.
Nevertheless, there are times when morality should be strongly suggested,
and I think modules and classes are a good place for that.</p>

<h3><a href="http://dev.perl.org/rfc/73.html" name="rfc73">RFC 73: All Perl core
functions should return objects</a></h3>
<p>I'm not sure this belongs in the overview, but here it is nonetheless.
In principle, I agree with the RFC.  Of course, if all Perl variables
are really objects underneath, this RFC is trivially true.  But the
real question is how interesting of an object you can return for a
given level of performance.  Perl 5's objects are relatively heavyweight,
and if all of Perl 6's objects are as heavy, things might bog down.</p>
<p>I'm thinking that the solution is better abstract type support for data
values that happen to be represented internally by C <code>struct</code>s.
We get
bogged down when we try to translate a C <code>struct</code> such a
<code>struct tm</code>
into an actual hash value.  On the other hand, it's rather efficient to
translate a <code>struct tm</code> to a <code>struct tm</code>,
since it's a
no-op.  We can
make such a <code>struct</code> look like a Perl object, and access it
efficiently
with attribute methods as if it were a ``real'' object.  And the typology
will (hopefully) mostly only impose an abstract overhead.  The biggest
overhead will likely be memory management of a <code>struct</code> over an
<code>int</code>
(say), and that overhead could go away much of the time with some
amount of contextually aware optimization.</p>
<p>In any event, I just want to point out that nobody should panic when we
talk about making things return objects that didn't used to return
them.  Remember that any object can define its <code>stringify</code> and
<code>numify</code> overloadings to do whatever the class likes,
so old code
that
looks like</p>
<pre>
    print scalar localtime;</pre>
<p>can continue to run unchanged, even though <code>localtime</code> might
be returning
an object in scalar context.</p>

<h3><a href="http://dev.perl.org/rfc/26.html" name="rfc26">RFC 26: Named
operators versus
functions</a></h3>
<p>Here's another RFC that's here because I couldn't think of a better
place for it.</p>
<p>I find this RFC somewhat confusing because the abstract seems to
suggest something more radical than the description describes.  If you
ignore the abstract, I pretty much agree with it.  It's already the
case in Perl 5 that we distinguish operators from functions primarily
by how they are called, not by how they are defined.  One place where
the RFC could be clarified is that Perl 5 distinguishes two classes of
named operators: named unary operators vs list operators.  They are
distinguished because they have different precedence.  We'll discuss
precedence reform under Apocalypse 3, but I doubt we'll combine the two
kinds of named operators.  (As a teaser, I do see ways of simplifying
Perl's precedence table from 24 levels down to 18 levels, albeit with
some damage to C compatibility in the less frequently used ops.  More
on that later.)</p>
<p>
<hr>

<p><table width="180" cellspacing="0" cellpadding="4" align="right" border="1">
<tr>
<td align="center" valign="top" bgcolor="#6699cc">
<font color="#ffffff">Perl 6 Apocalypse</td>
</tr>

<tr>
<td>
<p class="fine">The rest of the "Apocalypse" series can be found <a href="/pub/au/Wall_Larry">here</a>, as well as other articles by Larry Wall.

</td>
</tr>
</p>
</table>

<p>Do you begin to see why my self-appointed job here is much larger than
just voting RFCs up or down?  There are many big issues to face that
simply aren't covered by the RFCs.  We have to decide how much of our
culture
is just baggage to be thrown overboard, and how much of it is
who we are.  We have to smooth out the migration from Perl 5 to Perl 6 to
prevent people from using that as an excuse not to adopt Perl 6.  And
we have to stare at all those deep issues until we see through
them down to
the underlying deeper issues, and the issues below that.  And then in
our depths of understanding, we have to keep Perl simple enough for
anyone to pick up and start using to get their job done right now.</p>
<p>Stay tuned for Apocalypse 2, wherein we will attempt to
vary our variables, question our quotes, recontextualize our contexts,
and in general set the lexical stage for everything that follows.</p>


        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1488" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2001/04/p5pdigest/THISWEEK-20010401.html" rel="bookmark">This Week on p5p 2001/04/01</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Simon Cozens</span> on <abbr class="published" title="2001-04-01T00:00:00-08:00">April  1, 2001 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            </P>

<P>


<!-- This week on perl5-porters (26 Mar-01 Apr 2001) -->

<br />
<br />
      <H3><a name="Notes">Notes</a></H3>

</P>

<P>

You can subscribe to an email version of this summary by sending an
empty message to 
<a href="mailto:perl5-porters-digest-subscribe@netthink.co.uk"><tt>perl5-porters-digest-subscribe@netthink.co.uk</tt>.</a></P>

<P>
Please send corrections and additions to 
<CODE>perl-thisweek-YYYYMM@simon-cozens.org</CODE> where 
<CODE>YYYYMM</CODE> is the current year and month.  Changes and additions to the 
<a href="http://simon-cozens.org/writings/whos-who.html">perl5-porters</a> biographies are particularly welcome.
</P>

<P>
There were 446 messages this week.
<H3><a name="Perl_and_HTMLParser">Perl and HTML::Parser</a></H3>

</P>

<P>

<a href="http://simon-cozens.org/writings/whos-who.html#AAS">Gisle</a> complained that a recent snapshot of Perl broke 
<CODE>HTML::Parser</CODE>. Apparently, his code did something like
</P>

<P>
  sv_catpvf(sv, &quot;%c&quot;, 128);
</P>

<P>
and Perl upgraded the SV to UTF8, which caused confusion when his
C-level code then looked at the real value of the string. 
<a href="http://simon-cozens.org/writings/whos-who.html#HIETANIEMI">Jarkko</a> asked
why Gisle's code cared about the representation of the string, but it
seemed like Gisle expected it to be non-UTF8. (I could argue that this
was Perl's fault, and I could argue that it was Gisle's.)
<a href="http://simon-cozens.org/writings/whos-who.html#GURUSAMY">Sarathy</a> warned
ominously: &quot;We need to tread very carefully here, or 5.8.0 might break a
lot of XS code out there.&quot; 
<a href="http://simon-cozens.org/writings/whos-who.html#ING-SIMMONS">Nick I-S</a> pointed out the handy-looking 
<CODE>SvPVbyte</CODE> macro which returned a non-UTF8 version of the string's contents, plus
another way of doing things which was actually backwards compatible.
<H3><a name="Autoloading_Errno">Autoloading Errno</a></H3>

</P>

<P>

Last week, we covered the fact that using 
<CODE>%!</CODE> should autoload the 
<CODE>Errno</CODE> module but at the time, it failed to. Robin Houston fixed that, with
another quotable analysis:
<blockquote></P>

<P>
I must admit that I'm slightly dubious as to the wisdom of doing this. It's not
needed for compatibility (it's never worked), and any code which uses 
<CODE>%!</CODE> could simply put &quot;
<CODE>use Errno;</CODE>&quot; at the top.
</P>

<P>
The intention, presumably, is that code which doesn't make use of 
<CODE>%!</CODE> shouldn't
have to incur the penalty of loading 
[Errno.pm].
</P>

<P>
Currently cleverness only takes place when a glob is created. So, if you use a
hash called 
<CODE>%^E</CODE> then the magical scalar 
<CODE>$^E</CODE> is set up, even though you don't use it.
</P>

<P>
In this case though, we want 
<CODE>Errno.pm</CODE> to be loaded
<B>only</B> if <CODE>%!</CODE> is used. Loading the damned thing for every script which uses 
<CODE>$!</CODE> would be Bad.
</P>

<P>
The upshot of this all is that an extra test has to be inserted into the code
which deals with creating new stash <B>variables</B> (not just the first variable of the particular glob). Even a marginal slowdown like this doesn't
seem worth the insignificant benefit of not having to load Errno yourself.
</blockquote></P>

<P>
However, Sarathy commented that the intention was simplicity and transparency;
the 
<CODE>%!</CODE> language feature should be implemented in a manner transparent to the end
user, just like the loading of the Unicode swash tables. &quot;Besides,&quot; he 
concluded, &quot;there is probably no precedent for forcing people to
load a non-pragma to enable a language feature.&quot;
</P>

<P>
Jarkko looked slightly guilty. &quot;Ummm, well, in other news, I may have
have just created one&quot;, he said, referring to the new ability to export
<CODE>IO::Socket::atmark</CODE> to 
<CODE>sockatmark</CODE>. 
</P>

<P>
Robin also added some more reporting to 
<CODE>B::Debug</CODE>, and fixed up a parenthesis bug in 
<CODE>B::Deparse</CODE>. 
</P>

<P>

<H3><a name="MathBig">Math::Big*</a></H3>

</P>

<P>
Tels and John Peacock have been working together to rewrite 
<CODE>Math::BigInt</CODE> and 
<CODE>Math::BigFloat</CODE>. Their version is 
<a href="http://www.cpan.org/authors/id/T/TE/TELS/">on CPAN </a>. Jarkko seems understandably a little hestitant about replacing the in-core 
version with this one; while we're assured that it will be backwards
compatible (minus bugfixes, naturally) but obviously a complete rewrite
isn't mature enough to be considered for core yet.
<H3><a name="pack_and_unpack">pack and unpack</a></H3>

</P>

<P>

Someone asked a (non-maintainance) question about 
<CODE>pack</CODE> and 
<CODE>unpack</CODE> which 
<a href="http://simon-cozens.org/writings/whos-who.html#DOMINUS">MJD</a> dealt with; I took this as a cue to show my current work on a 
<CODE>perlpacktut</CODE>. A few people produced useful suggestions for that, which I'll get
finished when the next consignment of tuits arrives. There was a short
diversion about what an 
<CODE>asciz</CODE> string was; (see the documentation for the &quot;w&quot; pack format) it's
actually a C-style null-terminated string.
<H3><a name="Taint_testing">Taint testing</a></H3>

</P>

<P>

For some reason, the usual way to detect taintedness in the test suite
seems to be
</P>

</P><PRE>
    eval { $possibly_tainted, kill 0; 1 }
<a href="http://simon-cozens.org/writings/whos-who.html#CLARK">Nick Clark </a>thinks this sucks, but it's a bit too late to change it now.
</PRE>

<P>
Of course, MacPerl doesn't have 
<CODE>kill</CODE> so 
<a href="http://simon-cozens.org/writings/whos-who.html#NANDOR">Chris</a> found that his test suite was going horribly wrong. He had a
number of violent suggestions to fix this up, including having 
<CODE>kill</CODE> be a no-op which died on tainted data. MJD suggested that 
<CODE>kill</CODE> should do what it does already but be a no-op if it's passed a 0. The
eventual solution was to have it return 0 but check for tainted data. He
also hinted that this may be the precursor to Win32-like
pseudoprocesses.
<H3><a name="Various">Various</a></H3>

</P>

<P>

Benjamin Sugars was at it again. He fixed a bug in 
<CODE>socket</CODE> which leaked file descriptors, wrote a test suite for 
<CODE>Cwd</CODE>, joined the bug admin team, patched up 
<CODE>B::Terse</CODE> and
<CODE>File::*</CODE> to be warnings-happy, produced another version of his XS 
<CODE>Cwd</CODE> module. He didn't document
<a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2001-02/msg01780.html">references in <CODE>@INC</CODE></a>, though, so he doesn't get the gold star.
</P>

<P>
I zapped 
<CODE>OPpRUNTIME</CODE>, a flag that was set but never tested!
</P>

<P>
Stephen McCamant produced a couple of optimizations to 
<CODE>peep()</CODE>, the optimizer. 
</P>

<P>
Thomas Wegner and Chris Nandor fixed up 
<CODE>File::Glob</CODE> for MacOS. 
</P>

<P>
Jarkko floated the idea of a 
<CODE>FETCHSLICE</CODE> and 
<CODE>STORESLICE</CODE> for tied hashes and arrays to avoid multiple 
<CODE>FETCH</CODE>/
<CODE>STORE</CODE> operations; there was a little discussion about the syntax:
</P>

</P><PRE>
    STORESLICE($thing, $nkeys, $nvalues, @keys, @values)
</PRE>

<P>
would be more efficient but less user-friendly than
</P>

</P><PRE>
    STORESLICE($thing, \@keys, \@values)
</PRE>

<P>
but no implementation as yet.
</P>

<P>
Schwern asked if we were going to document the fact that 
<CODE>ref qr/Foo/</CODE> returns &quot;Regexp&quot;. Everyone went very quiet.
</P>

<P>
Mark-Jason Dominus tried to introduce a new operator, 
<CODE>epochtime</CODE>, which return the time of the system epoch; for instance, one could use
</P>

</P><PRE>
    localtime(epochtime())
</PRE>

<P>
to portably find out the date of the system epoch, allowing you to write
epoch-independent code. Jarkko rejected the patch on the grounds that it
was not sufficiently portable.
</P>

<P>
Until next week, then,
<B>squawk</B>,</P>

<hr>

<a href="mailto:simon@brecon.co.uk">Simon Cozens</a>


<ul>
  <li><a href="#Notes">Notes</a>
  <li><a href="#Perl_and_HTMLParser">Perl and HTML::Parser</a>
  <li><a href="#Autoloading_Errno">Autoloading Errno</a>
  <li><a href="#MathBig">Math::Big*</a>
  <li><a href="#pack_and_unpack">pack and unpack</a>
  <li><a href="#Taint_testing">Taint testing</a>
  <li><a href="#Various">Various</a>
</ul>

        </div>



    </div>
    <div class="asset-footer"></div>
</div>




                            <div class="content-nav">
                                <a href="/pub/2001/03/">&laquo; March 2001</a> |
                                <a href="/pub/">Main Index</a> |
                                <a href="/pub/archives.html">Archives</a>
                                | <a href="/pub/2001/05/">May 2001 &raquo;</a>
                            </div>


                        </div>
                    </div>


                    <div id="beta">
    <div id="beta-inner">


    
    <div class="widget-what-is-perl widget">
    <div class="widget-content widget-content-what-is-perl">
       Visit the home of the  Perl programming language: <a href="http://www.perl.org/">Perl.org</a
    </div>
</div>
<div class="widget-find-out-more widget-archives widget">
    <div class="widget-content">
        <ul>
            <li><a href="http://www.perl.org/get.html">Download</a></li>
            <li><a href="http://perldoc.perl.org/">Documentation</a></li>
            <li><a href="http://blogs.perl.org/">Perl Bloggers</a></li>
            <li><a href="http://news.perlfoundation.org/">Foundation News</a></li>
        </ul>
    </div>
</div><div class="widget-tcpc widget">
<h3 class="widget-header">Sponsored by</h3>
    <div class="widget-content">
        <a href="http://training.perl.com/" alt="Perl Training" target="_blank"><img src="/i/tcpc.png" width="150" height="50"></a>
    </div>
</div>

<div class="widget-syndication widget">
    <div class="widget-content">
        <ul>
            <li><img src="/mt-static/images/status_icons/feed.gif" alt="Subscribe to feed" width="9" height="9" /> <a href="/pub/atom.xml">Subscribe to this website's feed</a></li>

        </ul>
    </div>
</div>
<div class="widget-archive-monthly widget-archive widget">
    <h3 class="widget-header">Monthly <a href="/pub/archives.html">Archives</a></h3>
    <div class="widget-content">
        <ul>
        
            <li><a href="/pub/2014/02/">February 2014 (1)</a></li>
        
    
        
            <li><a href="/pub/2014/01/">January 2014 (1)</a></li>
        
    
        
            <li><a href="/pub/2013/10/">October 2013 (1)</a></li>
        
    
        
            <li><a href="/pub/2013/01/">January 2013 (1)</a></li>
        
    
        
            <li><a href="/pub/2012/12/">December 2012 (1)</a></li>
        
    
        
            <li><a href="/pub/2012/11/">November 2012 (1)</a></li>
        
    
        
            <li><a href="/pub/2012/10/">October 2012 (2)</a></li>
        
    
        
            <li><a href="/pub/2012/08/">August 2012 (2)</a></li>
        
    
        
            <li><a href="/pub/2012/06/">June 2012 (11)</a></li>
        
    
        
            <li><a href="/pub/2012/05/">May 2012 (18)</a></li>
        
    
        
            <li><a href="/pub/2012/04/">April 2012 (17)</a></li>
        
    
        
            <li><a href="/pub/2012/02/">February 2012 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/12/">December 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/09/">September 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/08/">August 2011 (2)</a></li>
        
    
        
            <li><a href="/pub/2011/06/">June 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/05/">May 2011 (3)</a></li>
        
    
        
            <li><a href="/pub/2011/04/">April 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/03/">March 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/02/">February 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/01/">January 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2010/11/">November 2010 (1)</a></li>
        
    
        
            <li><a href="/pub/2010/10/">October 2010 (2)</a></li>
        
    
        
            <li><a href="/pub/2010/09/">September 2010 (1)</a></li>
        
    
        
            <li><a href="/pub/2010/08/">August 2010 (3)</a></li>
        
    
        
            <li><a href="/pub/2010/07/">July 2010 (2)</a></li>
        
    
        
            <li><a href="/pub/2010/04/">April 2010 (2)</a></li>
        
    
        
            <li><a href="/pub/2010/03/">March 2010 (4)</a></li>
        
    
        
            <li><a href="/pub/2008/05/">May 2008 (1)</a></li>
        
    
        
            <li><a href="/pub/2008/04/">April 2008 (2)</a></li>
        
    
        
            <li><a href="/pub/2008/03/">March 2008 (1)</a></li>
        
    
        
            <li><a href="/pub/2008/02/">February 2008 (1)</a></li>
        
    
        
            <li><a href="/pub/2008/01/">January 2008 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/12/">December 2007 (2)</a></li>
        
    
        
            <li><a href="/pub/2007/09/">September 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/08/">August 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/07/">July 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/06/">June 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/05/">May 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/04/">April 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/03/">March 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/02/">February 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/01/">January 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/12/">December 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/11/">November 2006 (2)</a></li>
        
    
        
            <li><a href="/pub/2006/10/">October 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/09/">September 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/08/">August 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/07/">July 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/06/">June 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/05/">May 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/04/">April 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/03/">March 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/02/">February 2006 (4)</a></li>
        
    
        
            <li><a href="/pub/2006/01/">January 2006 (4)</a></li>
        
    
        
            <li><a href="/pub/2005/12/">December 2005 (4)</a></li>
        
    
        
            <li><a href="/pub/2005/11/">November 2005 (3)</a></li>
        
    
        
            <li><a href="/pub/2005/10/">October 2005 (2)</a></li>
        
    
        
            <li><a href="/pub/2005/09/">September 2005 (2)</a></li>
        
    
        
            <li><a href="/pub/2005/08/">August 2005 (9)</a></li>
        
    
        
            <li><a href="/pub/2005/07/">July 2005 (8)</a></li>
        
    
        
            <li><a href="/pub/2005/06/">June 2005 (9)</a></li>
        
    
        
            <li><a href="/pub/2005/05/">May 2005 (8)</a></li>
        
    
        
            <li><a href="/pub/2005/04/">April 2005 (7)</a></li>
        
    
        
            <li><a href="/pub/2005/03/">March 2005 (6)</a></li>
        
    
        
            <li><a href="/pub/2005/02/">February 2005 (7)</a></li>
        
    
        
            <li><a href="/pub/2005/01/">January 2005 (6)</a></li>
        
    
        
            <li><a href="/pub/2004/12/">December 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/11/">November 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/10/">October 2004 (5)</a></li>
        
    
        
            <li><a href="/pub/2004/09/">September 2004 (9)</a></li>
        
    
        
            <li><a href="/pub/2004/08/">August 2004 (6)</a></li>
        
    
        
            <li><a href="/pub/2004/07/">July 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/06/">June 2004 (6)</a></li>
        
    
        
            <li><a href="/pub/2004/05/">May 2004 (7)</a></li>
        
    
        
            <li><a href="/pub/2004/04/">April 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/03/">March 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/02/">February 2004 (9)</a></li>
        
    
        
            <li><a href="/pub/2004/01/">January 2004 (7)</a></li>
        
    
        
            <li><a href="/pub/2003/12/">December 2003 (4)</a></li>
        
    
        
            <li><a href="/pub/2003/11/">November 2003 (7)</a></li>
        
    
        
            <li><a href="/pub/2003/10/">October 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2003/09/">September 2003 (6)</a></li>
        
    
        
            <li><a href="/pub/2003/08/">August 2003 (7)</a></li>
        
    
        
            <li><a href="/pub/2003/07/">July 2003 (9)</a></li>
        
    
        
            <li><a href="/pub/2003/06/">June 2003 (9)</a></li>
        
    
        
            <li><a href="/pub/2003/05/">May 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2003/04/">April 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2003/03/">March 2003 (10)</a></li>
        
    
        
            <li><a href="/pub/2003/02/">February 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2003/01/">January 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2002/12/">December 2002 (5)</a></li>
        
    
        
            <li><a href="/pub/2002/11/">November 2002 (9)</a></li>
        
    
        
            <li><a href="/pub/2002/10/">October 2002 (7)</a></li>
        
    
        
            <li><a href="/pub/2002/09/">September 2002 (11)</a></li>
        
    
        
            <li><a href="/pub/2002/08/">August 2002 (8)</a></li>
        
    
        
            <li><a href="/pub/2002/07/">July 2002 (8)</a></li>
        
    
        
            <li><a href="/pub/2002/06/">June 2002 (4)</a></li>
        
    
        
            <li><a href="/pub/2002/05/">May 2002 (6)</a></li>
        
    
        
            <li><a href="/pub/2002/04/">April 2002 (6)</a></li>
        
    
        
            <li><a href="/pub/2002/03/">March 2002 (7)</a></li>
        
    
        
            <li><a href="/pub/2002/02/">February 2002 (5)</a></li>
        
    
        
            <li><a href="/pub/2002/01/">January 2002 (8)</a></li>
        
    
        
            <li><a href="/pub/2001/12/">December 2001 (7)</a></li>
        
    
        
            <li><a href="/pub/2001/11/">November 2001 (5)</a></li>
        
    
        
            <li><a href="/pub/2001/10/">October 2001 (9)</a></li>
        
    
        
            <li><a href="/pub/2001/09/">September 2001 (7)</a></li>
        
    
        
            <li><a href="/pub/2001/08/">August 2001 (13)</a></li>
        
    
        
            <li><a href="/pub/2001/07/">July 2001 (8)</a></li>
        
    
        
            <li><a href="/pub/2001/06/">June 2001 (13)</a></li>
        
    
        
            <li><a href="/pub/2001/05/">May 2001 (11)</a></li>
        
    
        
            <li><a href="/pub/2001/04/">April 2001 (9)</a></li>
        
    
        
            <li><a href="/pub/2001/03/">March 2001 (8)</a></li>
        
    
        
            <li><a href="/pub/2001/02/">February 2001 (8)</a></li>
        
    
        
            <li><a href="/pub/2001/01/">January 2001 (8)</a></li>
        
    
        
            <li><a href="/pub/2000/12/">December 2000 (6)</a></li>
        
    
        
            <li><a href="/pub/2000/11/">November 2000 (10)</a></li>
        
    
        
            <li><a href="/pub/2000/10/">October 2000 (10)</a></li>
        
    
        
            <li><a href="/pub/2000/09/">September 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/2000/08/">August 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/2000/07/">July 2000 (5)</a></li>
        
    
        
            <li><a href="/pub/2000/06/">June 2000 (7)</a></li>
        
    
        
            <li><a href="/pub/2000/05/">May 2000 (7)</a></li>
        
    
        
            <li><a href="/pub/2000/04/">April 2000 (3)</a></li>
        
    
        
            <li><a href="/pub/2000/03/">March 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/2000/02/">February 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/2000/01/">January 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/1999/12/">December 1999 (6)</a></li>
        
    
        
            <li><a href="/pub/1999/11/">November 1999 (6)</a></li>
        
    
        
            <li><a href="/pub/1999/10/">October 1999 (5)</a></li>
        
    
        
            <li><a href="/pub/1999/09/">September 1999 (4)</a></li>
        
    
        
            <li><a href="/pub/1999/08/">August 1999 (3)</a></li>
        
    
        
            <li><a href="/pub/1999/07/">July 1999 (2)</a></li>
        
    
        
            <li><a href="/pub/1999/06/">June 1999 (3)</a></li>
        
    
        
            <li><a href="/pub/1999/04/">April 1999 (1)</a></li>
        
    
        
            <li><a href="/pub/1999/03/">March 1999 (1)</a></li>
        
    
        
            <li><a href="/pub/1999/01/">January 1999 (1)</a></li>
        
    
        
            <li><a href="/pub/1998/12/">December 1998 (1)</a></li>
        
    
        
            <li><a href="/pub/1998/11/">November 1998 (1)</a></li>
        
    
        
            <li><a href="/pub/1998/07/">July 1998 (2)</a></li>
        
    
        
            <li><a href="/pub/1998/06/">June 1998 (1)</a></li>
        
    
        
            <li><a href="/pub/1998/03/">March 1998 (1)</a></li>
        
        </ul>
    </div>
</div>
        
    

<div class="widget-powered widget">
    <div class="widget-content">
        <a href="http://www.movabletype.com/"><img src="/mt-static/images/bug-pbmt-white.png" alt="Powered by Movable Type 5.13-en" width="120" height="75" /></a>
    </div>
</div>



    </div>
</div>






                </div>
            </div>


            <div id="footer">
    <div id="footer-inner">
        <div id="footer-content">
            <div class="widget-powered widget">
                <div class="widget-content">
                    Powered by <a href="http://www.movabletype.com/" rel="generator">Movable Type Pro</a>
                </div>
            </div>

            <div class="widget-creative-commons widget">
                <div class="widget-content">
                    This blog is licensed under a <a href="http://creativecommons.org/licenses/by-nc-nd/3.0/">Creative Commons License</a>.
                </div>
            </div>

        </div>
    </div>
</div>



        </div>
    </div>
</body>
</html>
