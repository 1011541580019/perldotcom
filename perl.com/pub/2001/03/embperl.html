<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" id="sixapart-standard">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="generator" content="Movable Type Pro 5.13-en" />
<link rel="stylesheet" href="/pub/styles.css" type="text/css" />
<link rel="start" href="/pub/" title="Home" />
<link rel="alternate" type="application/atom+xml" title="Recent Entries" href="/pub/atom.xml" />
<script type="text/javascript" src="/pub/mt.js"></script>
<!--
<rdf:RDF xmlns="http://web.resource.org/cc/"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
<Work rdf:about="/pub/2001/03/embperl.html">
<dc:title>Creating Modular Web Pages With EmbPerl</dc:title>
<dc:description> Table of Contents &#149;Getting Started &#149;Hello World &#149;Web Site Global Variables &#149;Modular Files &#149;Modular File Inheritance &#149;Subroutines in EmbperlObject &#149;Conclusions This tutorial is intended as a complement to the Embperl documentation, not a replacement. We assume a basic familiarity...</dc:description>
<dc:creator>Neil Gunton</dc:creator>
<dc:date>2001-03-13T00:00:00-08:00</dc:date>
<license rdf:resource="http://creativecommons.org/licenses/by-nc-nd/3.0/" />
</Work>
<License rdf:about="http://creativecommons.org/licenses/by-nc-nd/3.0/">
</License>
</rdf:RDF>
-->

<script type="text/javascript">

 var _gaq = _gaq || [];
 _gaq.push(['_setAccount', 'UA-50555-22']);
 _gaq.push(['_trackPageview']);

 (function() {
   var ga = document.createElement('script'); ga.type =
   'text/javascript'; ga.async = true;
   ga.src = ('https:' == document.location.protocol ? 'https://ssl' :
   'http://www') + '.google-analytics.com/ga.js';
   var s = document.getElementsByTagName('script')[0];
   s.parentNode.insertBefore(ga, s);
 })();

</script>
<script type='text/javascript' src='http://partner.googleadservices.com/gampad/google_service.js'></script>
<script type='text/javascript'>
GS_googleAddAdSenseService("ca-pub-4136420132070439");
GS_googleEnableAllServices();
</script>
<script type='text/javascript'>
GA_googleAddSlot("ca-pub-4136420132070439", "Perl_728x90");
</script>
<script type='text/javascript'>GA_googleFetchAds();</script>
    
    <link rel="prev bookmark" href="/pub/2001/03/p5pdigest/THISWEEK-20010312.html" title="This Week on p5p 2001/03/12" />
    <link rel="next bookmark" href="/pub/2001/03/p5pdigest/THISWEEK-20010319.html" title="This Week on p5p 2001/03/19" />
    
    
    <title>Creating Modular Web Pages With EmbPerl - Perl.com</title>
</head>
<body id="perl-com" class="mt-entry-archive layout-wt">
    <div id="container">
        <div id="container-inner">


            <div id="header">
    <div id="header-inner">
        <div id="header-content">
        <span id="top_advert"> 
<!-- Put any landscape advert in here -->
<!-- Perl_728x90 -->
<script type='text/javascript'>
GA_googleFillSlot("Perl_728x90");
</script>
        </span> 



            <div id="header-name"><a href="/pub/" accesskey="1">Perl.com</a></div>
            <div id="header-description">news and views of the Perl programming language</div>




        </div>
    </div>
</div>



            <div id="content">
                <div id="content-inner">


                    <div id="alpha">
                        <div id="alpha-inner">


                            <div id="entry-1464" class="entry-asset asset hentry">
                                <div class="asset-header">
                                    <h1 id="page-title" class="asset-name entry-title">Creating Modular Web Pages With EmbPerl</h1>
                                    <div class="asset-meta">
                                        <span class="byline">

                                            By <span class="vcard author">Neil Gunton</span> on <abbr class="published" title="2001-03-13T00:00:00-08:00">March 13, 2001 12:00 AM</abbr>

                                        </span>


                                    </div>
                                </div>
                                <div class="asset-content entry-content">

                                    <div class="asset-body">
                                        <!-- Using Embperl -->

<br />

<p><table width="180" cellspacing="0" cellpadding="4" align="right" border="1">
<tr>
<td align="center" valign="top" bgcolor="#6699cc">
<font color="#ffffff">Table of Contents</td>
</tr>

<tr>
<td>
<p class="fine">
&#149;<a href="#getting started">Getting Started</a><br /><br />
&#149;<a href="#Hello World">Hello World</a><br /><br />
&#149;<a href="#websiteglobal variables">Web Site Global Variables</a><br /><br />
&#149;<a href="#modular files">Modular Files</a><br /><br />
&#149;<a href="#modular file inheritance">Modular File Inheritance</a><br /><br />
&#149;<a href="#subroutines in embperlobject">Subroutines in EmbperlObject</a><br /><br />
&#149;<a href="#conclusions">Conclusions</a><br />

</td>
</tr>
</p>
</table>
<p>This tutorial is intended as a complement to the Embperl
documentation, not a replacement. We assume a basic familiarity 
with
Apache, mod_perl and Perl, and the Embperl documentation. No 
prior
experience with EmbperlObject is assumed. The real purpose 
is to
give a clearer idea of how EmbperlObject can help you build large
Web sites. We give example code that can serve as a starting
template and hints about the best practices 
that
have come out of real experience using the toolkit. As always, there
is more than one way to do it!</p>
<p>Since EmbperlObject is an evolving tool, it is likely that these
design patterns will evolve over time, and it is recommended that 
the
reader check back on the Embperl Web site for new versions.</p>
<p>
<h3><a name="motivation: constructing modular websites">Motivation: Constructing Modular Web Sites</a></h3>
<p>Embperl is a tool that allows you to embed Perl code in your 
HTML
documents. As such, it could handle just about everything
you need to do with your Web site. So what is the point of
EmbperlObject? What does it give us that we don't already get with
basic Embperl?</p>
<p>As often seems to be the case with Perl, the answer has to do with
laziness. We would all like the task of building Web sites to be as
simple as possible. Anyone who has had to build a non-trivial site
using pure HTML will have quickly experienced the irritation of 
having
to copy-and-paste common code between documents - stuff like
navigation bars and table formats. We have probably all wished for 
an
``include'' HTML tag. EmbperlObject goes a long way toward solving 
this
problem, without requiring the developer to resort to a lot of
customized Perl code.</p>
<p>In a nutshell, EmbperlObject extends Embperl by enabling the
construction of Web sites in a modular, or object-oriented, fashion. I
am using the term ``object-oriented'' (OO) loosely here in the 
context
of inheritance and overloading, but you don't really need to know
anything about the OO paradigm to benefit from EmbperlObject. As 
you
will see from this short tutorial, it is possible to benefit from
using EmbperlObject with even a minimal knowledge of Perl. With 
just a
little instruction, in fact, pure HTML coders can use it to improve
their Web site architecture. Having said that, however, 
EmbperlObject
also provides for more advanced OO functionality, as we'll see later.</p>

<h3><a name="getting started">Getting Started</a></h3>
<p>We'll assume that you've successfully installed the latest
Apache, mod_perl and Embperl on your system. That should all be
relatively painless - problems normally occur when mixing older
versions of one tool with later versions of another. If you can, try
to download the latest versions of everything.</p>
<p>Having done all that, you might want to get going with configuring a
Web site. The first thing you need to do is set up the Apache config
file, usually called <em>httpd.conf</em>.</p>
<p>
<h3><a name="configuring httpd.conf">Configuring <em>httpd.conf</em></a></h3>
<p>The following is an example configuration for a single virtual host to
use EmbperlObject. There are, as usual, different ways to do this; 
but
if you are starting from scratch, then it may be useful as a
template. It works with the later versions of Apache (1.3.6 and
up). Obviously, substitute your own IP address and domain name.</p>
<pre>
        NameVirtualHost 10.1.1.3:80
		
        &lt;VirtualHost 10.1.1.3:80&gt;
                ServerName www.mydomain.com
                ServerAdmin webmaster@mydomain.com
                DocumentRoot /www/mydomain/com/htdocs
                DirectoryIndex index.html
                ErrorLog /www/mydomain/com/logs/error_log
                TransferLog /www/mydomain/com/logs/access_log
                PerlSetEnv EMBPERL_ESCMODE 0
                PerlSetEnv EMBPERL_OPTIONS 16
                PerlSetEnv EMBPERL_MAILHOST mail.mydomain.com
                PerlSetEnv EMBPERL_OBJECT_BASE base.epl
                PerlSetEnv EMBPERL_OBJECT_FALLBACK notfound.html
                PerlSetEnv EMBPERL_DEBUG 0
        &lt;/VirtualHost&gt;
		
        # Set EmbPerl handler for main directory
        &lt;Directory &quot;/www/mydomain/com/htdocs/&quot;&gt;
                &lt;FilesMatch &quot;.*\.html$&quot;&gt;
                        SetHandler  perl-script
                        PerlHandler HTML::EmbperlObject
                        Options     ExecCGI
                &lt;/FilesMatch&gt;
                &lt;FilesMatch &quot;.*\.epl$&quot;&gt;
                        Order allow,deny
                        Deny From all
                &lt;/FilesMatch&gt;
        &lt;/Directory&gt;</pre>
<p>Note that you could change the .html file extension in the 
FilesMatch
directive; this is a personal preference issue. Personally, I use
.html for the main document files because I can edit files
using my favorite editor (emacs) and it will automatically load html
mode. Plus, this may be a minor thing - but using .html rather than 
a
special extension such as .epl adds a small amount of security to 
your
site since it provides no clue that the Web site is using Embperl. If
you're careful about the handling of error messages, then there 
never
will be any indication of this. These days, the less the script kiddies 
can
deduce about you, the better ...</p>
<p>Also, note that we have added a second FilesMatch directive, which
denies direct access to files with .epl extensions (again, you could
change this extension to another if you like, for example, .obj). This
can be helpful for cases where you have Embperl files that contain
fragments of code or HTML; you want those files to be in the 
Apache
document tree, but you don't want people to be able to request 
them
directly - these files should only included directly into other
documents from within Embperl, using Execute(). This is really a
security issue. In the following examples, we name files that are
not intended to be requested directly with the .epl extension. Files
that are intended to be directly requested are named with the
standard .html extension. This can also be helpful when scanning a
directory to see which are the main document files and which are 
the
modules. Finally, note that using the Apache FilesMatch directive 
to
restrict access does not prevent us from accessing these files (via
Execute) in Embperl.</p>
<p>So how does all this translate into a real Web site? Let's look
at the classic example, Hello World.</p>

<h3><a name="hello world">Hello World</a></h3>
<p>The file specified by the EMBPERL_OBJECT_BASE apache 
directive
(usually called <em>base.epl</em>) is the lynchpin of how EmbperlObject
operates. Whenever a request comes for any page on this 
Web site,
Emperl will look for <em>base.epl</em> - first in the same directory as the
request, and if it's not found there, then working up the directory tree to
the root directory of the Web site. For example, if a request comes for
http://www.yoursite.com/foo/bar/file.html,</a> then Embperl first looks
for <em>/foo/bar/base.epl</em>. If it doesn't find <em>base.epl</em> there, then
it looks in <em>/foo/base.epl</em>. If there's still no luck, then it finally looks in
<em>/base.epl</em>. (These paths are all relative to the document root for
the Web site). What is the point of all this?</p>
<p>In a nutshell, <em>base.epl</em> is a template for giving a common
look-and-feel to your Web pages. This file is what is used to
build the response to any request, regardless of the actual filename
that was requested. So even if <em>file.html</em> was requested,
<em>base.epl</em> is what is actually executed. <em>base.epl</em> is a normal
file containing valid HTML mixed with Perl code, but with a few
small differences. Here's a simple 'Hello World' example of this
approach:</p>
<p><em>/base.epl</em></p>
<pre>
        &lt;HTML&gt;
        &lt;HEAD&gt;
                &lt;TITLE&gt;Some title&lt;/TITLE&gt;
        &lt;/HEAD&gt;
        &lt;BODY&gt;
        Joe's Website
        &lt;P&gt;
        [- Execute ('*') -]
        &lt;/BODY&gt;
        &lt;/HTML&gt;</pre>
<p><em>/hello.html</em></p>
<pre>
        Hello world!</pre>
<p>Now, if the file http://www.yoursite.com/hello.html</a> is requested, 
then
<em>base.epl</em> is what will get executed initially. So where
does the file <em>hello.html</em> come into the picture? Well, the key is the
'*' parameter in the call to Execute(). '*' is a special filename,
only used in <em>base.epl</em>. It means, literally, ``the filename that
was actually requested.''</p>
<p>What you will see if you try this example is something like this:</p>
<pre>
        Joe's Website</pre>
<pre>
        Hello world!</pre>
<p>As you can see here, the text ``Joe's Web Site'' is from <em>base.epl</em> 
and
the ``Hello world!'' is from <em>hello.html</em>.</p>
<p>This architecture also means that only <em>base.epl</em> has to have the
boilerplate code that each HTML file normally needs to contain -
namely the &lt;HTML&gt; &lt;BODY&gt;, &lt;/HTML&gt; and so on. Since the '*' 
file is
simply inserted into the code, all it needs to contain is the actual
content that is specific to that file. Nothing else is necessary,
because <em>base.epl</em> has all the standard HTML trappings. Of 
course,
you'll probably have more interesting content, but you get the point.</p>

<h3><a name="websiteglobal variables">Web Site Global Variables</a></h3>
<p>Let's look at a more interesting example. When you 
create
Perl variables in Embperl usually their scope is the current file;
so they are effectively ``local'' to that file. When you split
your Web site into modules, however, it quickly becomes 
apparent
that it is useful to have variables that are global to the
Web site, i.e., shared between multiple files.</p>
<p>To achieve this, EmbperlObject has a special object that is
automatically passed to each page as it is executed. This object is
usually referred to as the ``Request'' object, because we get one of
these objects created for each document request that the Web 
server
receives. This object is passed in on the stack, so you can retrieve
it using the Perl ``shift'' statement. This object is also automatically
destroyed after the request, so the Request object cannot be used 
to
store data between requests. The idea is that you can store 
variables
that are local to the current request, and shared between all
documents on the current Web site; plus, as we'll see later, we can
also use it to call object methods. For example, let's say you set 
up
some variables in <em>base.epl</em>, and then use them in <em>file.html</em>:</p>
<p><em>/base.epl</em></p>
<pre>
        &lt;HTML&gt;
        &lt;HEAD&gt;
                &lt;TITLE&gt;Some title&lt;/TITLE&gt;
        &lt;/HEAD&gt;
        [- 
                $req = shift;
                $req-&gt;{webmaster} = 'John Smith'
        -]
        &lt;BODY&gt;
        [- Execute ('*') -]
        &lt;/BODY&gt;
        &lt;/HTML&gt;</pre>
<p><em>/file.html</em></p>
<pre>
        [- $req = shift -]
        Please send all suggestions to [+ $req-&gt;{webmaster} +].</pre>
<p>You can see that EmbperlObject is allowing us to set up global
variables in one place and share them throughout the Web site. If 
you
place <em>base.epl</em> in the root document directory, you can have 
any
number of other files in this and subdirectories, and they will all
get these variables whenever they are executed. No matter which 
file
is requested, <em>/base.epl</em> is executed first and then the 
requested
file.</p>
<p>You don't even need to include the requested '*' file, but typically you will
have to - it would be a bit odd to 
ignore
the requested file!</p>

<h3><a name="modular files">Modular Files</a></h3>
<p>The previous example is nice; it demonstrates the basic ability to
have Web site-wide variables set up in <em>base.epl</em> and then
automatically have them shared by all other files. Leading on from this, we
probably want to split up our files, for both maintainability and
readability. For example, a non-trivial Web site will probably define
some Web site-wide constants, perhaps some global variables, and 
maybe
also have some kind of initialization code that has to be executed
for each page (e.g. setting up a database connection). We could 
put
all of this in <em>base.epl</em>, but this file would quickly begin to look
messy. It would be nice to split this stuff out into other
files. For example:</p>
<p><em>/base.epl</em></p>
<pre>
        &lt;HTML&gt;
        [- Execute ('constants.epl')-]
        [- Execute ('init.epl')-]
        &lt;HEAD&gt;
                &lt;TITLE&gt;Some title&lt;/TITLE&gt;
        &lt;/HEAD&gt;
        &lt;BODY&gt;
        [- Execute ('*') -]
        &lt;/BODY&gt;
        [- Execute ('cleanup.epl') -]
        &lt;/HTML&gt;</pre>
<p><em>/constants.epl</em></p>
<pre>
        [-
                $req = shift;
                $req-&gt;{bgcolor} = &quot;white&quot;;
                $req-&gt;{webmaster} = &quot;John Smith&quot;;
                $req-&gt;{website_database} = &quot;mydatabase&quot;;
        -]</pre>
<p><em>/init.epl</em></p>
<pre>
        [-
                $req = shift;
                # Set up database connection
                use DBI;
                use CGI qw(:standard);
                $dsn = &quot;DBI:mysql:$req-&gt;{website_database}&quot;;
                $req-&gt;{dbh} = DBI-&gt;connect ($dsn);
        -]</pre>
<p><em>/cleanup.epl</em></p>
<pre>
        [-
                $req = shift;
                # Close down database connection
                $req-&gt;{dbh}-&gt;disconnect();
        -]</pre>
<p>You can see how this would be useful, since each page on your 
site
now has a database connection available in $req-&gt;{dbh}. Also 
notice
that we have a <em>cleanup.epl</em> file that is always executed at the
end - this is useful for cleaning up, shutting down connections
and so on.</p>

<h3><a name="modular file inheritance">Modular File Inheritance</a></h3>
<p>To recap, we have seen how we can break our site into modules 
that
are common across multiple files, because they are automatically
included by <em>base.epl</em>. Inheritance is a way in which we can 
make
our Web sites more modular.</p>
<p>Although the concept of inheritance is one that stems from the
object-oriented paradigm, you really don't need to be an OO guru to
understand it. We will demonstrate the concept through a simple
example.</p>
<p>Say you wanted different parts of your Web site to have different
&lt;TITLE&gt; tags. You could set the title in each page manually, but if
you had a number of different pages in each section, then this 
would
quickly get tiresome. We could split off the &lt;HEAD&gt; section 
into
its own file, just like <em>constants.epl</em> and <em>init.epl</em>, right? But
so far, it looks like we are stuck with a single <em>head.epl</em> file for
the entire Web site, which doesn't really help much.</p>
<p>The answer lies in subdirectories. This is the key to unlocking
inheritance and one of the most powerful features of
EmbperlObject. You may use subdirectories currently in your 
Web site
design, maybe for purposes of organization and maintenance. But 
here,
subdirectories actually enable you to override files from upper
directories. This is best demonstrated by example (simplified to 
make
this specific point clearer - assume <em>constants.epl</em>, <em>init.epl</em>
and <em>cleanup.epl</em> are the same as in the previous example):</p>
<p><em>/base.epl</em></p>
<pre>
        &lt;HTML&gt;
        [- Execute ('constants.epl')-]
        [- Execute ('init.epl')-]
        &lt;HEAD&gt;
        [- Execute ('head.epl')-]
        &lt;/HEAD&gt;
        &lt;BODY&gt;
        [- Execute ('*') -]
        &lt;/BODY&gt;
        [- Execute ('cleanup.epl') -]
        &lt;/HTML&gt;</pre>
<p><em>/head.epl</em></p>
<pre>
        &lt;TITLE&gt;Joe's Website&lt;/TITLE&gt;</pre>
<p><em>/contact/head.epl</em></p>
<pre>
        &lt;TITLE&gt;Contacting Joe&lt;/TITLE&gt;</pre>
<p>Assume that we have an <em>index.html</em> file in each directory 
that
does something useful. The main thing to focus on is
<em>head.epl</em>. You can see that we have one instance of this file in
the root directory, and one in a subdirectory, namely
<em>/contact/head.epl</em>. Here's the neat part: When a page is 
requested
from your Web site, EmbperlObject will search automatically for
<em>base.epl</em> first in the same directory as the requested page. If it
doesn't find it there, then it tracks back up the directory tree until
it finds the file. But then, when executing <em>base.epl</em>, any
files that are Executed (such as <em>head.epl</em>) are first looked for
in the <strong>original directory</strong> of the requested file. Again, if the file
is not found there, then EmbperlObject tracks back up the directory
tree.</p>
<p>So what does this mean? Well, if we have a subdirectory, 
then
we can see whether we want just the usual <em>index.html</em> file and 
nothing
else. In that case, all the files included by <em>base.epl</em> will be
found in the root document directory. But if we redefine 
<em>head.epl</em>, then EmbperlObject will pick up that version of 
the
file whenever we are in the /contact/ subdirectory.</p>
<p>That is inheritance in action. In a nutshell, subdirectories inherit
files such as <em>head.epl</em>, <em>constants.epl</em> and so on from ``parent'' directories. But if we want, we can redefine any of these
files in our subdirectories, thus specializing that functionality for
that part of our Web site. If we had 20 .html files in /contact/, then
loading any of them would automatically get
<em>/contact/head.epl</em>.</p>
<p>This is all very cool, but there is one more wrinkle. Let's say we
want to redefine <em>init.epl</em>, because there is some initialization
that is specific to the /contact/ subdirectory. That's fine since we can
create <em>/contact/init.epl</em> and that file would be loaded instead of
<em>/init.epl</em> whenever a file is requested from the /contact/
subdir. But this also means that the initialization code that is in
<em>/init.epl</em> would never get executed, right? That's bad, because 
the
base version of the file does a lot of useful set up. The answer is
simple: For cases such as this, we need to make sure to call the parent
version of the file at the start. For example:</p>
<p><em>/contact/init.epl</em></p>
<pre>
        [- Execute ('../init.epl') -]</pre>
<pre>
        [-
                # Do some setup specific to this subdirectory
        -]</pre>
<p>You can see that the first thing we do here is Execute the
parent version of the file (i.e., the one in the immediate parent
directory). Thus we can ensure the integrity of the basic
initialization that each page should receive.</p>
<p>EmbperlObject is smart about this process. For example, 
we
have a situation where we have several levels of subdirectory; then,
say we only redefine <em>init.epl</em> in one of the deeper levels, say
<em>/sub/sub/sub/init.epl</em>. Now, if this file tries to Execute
<em>../init.epl</em>, there may not be any such file in the immediate
parent directory - so EmbperlObject automatically tracks back up 
the
directories until it finds the base version, <em>/init.epl</em>. So, for
any subdirectory level in your Web site, you only have to redefine
those files that are specific to this particular area. This results
in a much cleaner Web site.</p>
<p>You can break up your files into whatever level of granularity you
want, depending on your needs. For instance, instead of just
<em>head.epl</em> you might break it down into <em>title.epl</em>,
<em>metatags.epl</em> and so on. It's up to you. The more you split it up,
the more you can specialize in each of the subdirectories. There is 
a
balance, however, because splitting things up too much results in an
overly fragmented site that can be harder to maintain. Moderation is
the key - only split out files if they contain a substantial chunk of
code, or if you know that you need to redefine them in 
subdirectories,
generally speaking.</p>

<h3><a name="subroutines in embperlobject">Subroutines in EmbperlObject</a></h3>
<p>There are two types of inheritance in EmbperlObject. The first is the
one that we described in the previous section, i.e., inheritance of
modular files via the directory hierarchy. The other type, which is closely
related, is the inheritance of subroutines (both pure Perl and
Embperl). In this context, subroutines are really object methods, as
we'll see below. As you are probably already aware, there are two
types of subroutines in Embperl, for example:</p>
<pre>
        [!
                sub perl_sub
                {
                        # Some perl code
                }
        !]
		
        [$ sub embperl_sub $]
                Some HTML
        [$ endsub $]</pre>
<p>In EmbperlObject, subroutines become object methods; the 
difference is
that you always call an object method through an object reference. 
For
example, instead of a straight subroutine call like this:</p>
<pre>
        foo();</pre>
<p>We have instead a call through some object:</p>
<pre>
        $obj-&gt;foo();</pre>
<p>EmbperlObject allows you to inherit object methods in much the 
same
way as files. Because of the way that Perl implements objects and
methods, there is just a little extra consideration needed. (Note:
This is not really a good place to introduce Perl's object
functionality. If you're not comfortable with inheritance, @ISA and
object methods, then I suggest you take a look at the book
``Programming Perl'' (O'Reilly) or ``Object Oriented Perl'' by Damien
Conway (Manning).)</p>
<p>A simple use of methods can be demonstrated using the following
example:</p>
<p><em>/base.epl</em></p>
<pre>
        [! sub title {'Joe's Website'} !]
        [- $req = shift -]
        &lt;HTML&gt;
        &lt;HEAD&gt;
        &lt;TITLE&gt;[+ $req-&gt;title() +]&lt;/TITLE&gt;
        &lt;/HEAD&gt;
        &lt;/HTML&gt;</pre>
<p><em>/contact/index.html</em></p>
<pre>
        [! sub title {'Contacting Joe'} !]
        [- $req = shift -]
        &lt;HTML&gt;
                A contact form goes here
        &lt;/HTML&gt;</pre>
<p>This is an alternative way of implementing the previous ``contact''
example, which still uses inheritance - but instead of placing the
&lt;TITLE&gt; tag in a separate file (<em>head.epl</em>), we use a method
(title()). You can see that we define this method in
<em>/base.epl</em>, so any page that is requested from the root 
directory
will get the title ``Joe's Web Site.'' This is a good default
title. Then, in <em>/foo/index.html</em> we redefine the <code>title()</code> method
to return ``Contacting Joe.'' Inheritance ensures that when the call to
<code>title()</code> occurs in <em>/base.epl</em>, the correct version of the method
will be executed. Since <em>/foo/index.html</em> has its own version of 
that
method, it will automatically be called instead of the base
version. This allows each file to potentially redefine methods
that were defined in <em>/base.epl</em>, and it works well. But, as your
Web sites get bigger, you will probably want to split off some 
routines
into their own files.</p>
<p>EmbperlObject also allows us to create special files that
contain only inheritable object methods. EmbperlObject can set up 
@ISA for
us, so that the Perl object methods will work as expected. To do 
this,
we need to access our methods through a specially created object
rather than directly through the Request object (usually called $r or
$req). This is best illustrated by the following example, which
demonstrates the code that needs to be added to <em>base.epl</em> and 

shows how we implement inheritance via a subdirectory. Once 
again,
assume that missing files such as <em>constants.epl</em> are the same 
as
the previous example (Note that the 'object' parameter to Execute only works in
1.3.1 and above).</p>
<p><em>/base.epl</em></p>
<pre>
        &lt;HTML&gt;
        [- $subs = Execute ({object =&gt; 'subs.epl'}); -]
        [- Execute ('constants.epl') -]
        [- Execute ('init.epl') -]
        &lt;HEAD&gt;
        [- Execute ('head.epl') -]
        &lt;/HEAD&gt;
        &lt;BODY&gt;
        [- Execute ('*', $subs) -]
        &lt;/BODY&gt;
        [- Execute ('cleanup.epl') -]
        &lt;/HTML&gt;</pre>
<p><em>/subs.epl</em></p>
<pre>
        [!
                sub hello
                {
                        my ($self, $name) = @_;
                        print OUT &quot;Hello, $name&quot;;
                }
        !]</pre>
<p><em>/insult/index.html</em></p>
<pre>
        [-
                $subs = $param[0];
                $subs-&gt;hello (&quot;Joe&quot;);
        -]</pre>
<p><em>/insult/subs.epl</em></p>
<pre>
        [! Execute ({isa =&gt; '../subs.epl'}) !]

        [!
                sub hello
                {
                        my ($self, $name) = @_;
                        $self-&gt;SUPER::hello ($name);
                        print OUT &quot;, you schmuck&quot;;
                }
        !]</pre>
<p>If we requested the file <em>/insult/index.html</em>, then we would see
something like:</p>
<pre>
        Hello, Joe, you schmuck</pre>
<p>So what is happening? First, note that we create a $subs
object in <em>base.epl</em>, using a special call to Execute(). We then
pass this object to files that will need it, via an <code>Execute()</code>
parameter. This can be seen with the '*' file.</p>
<p>Next, we have two versions of <em>subs.epl</em>. The first, <em>/subs.epl</em>,
is pretty straightforward. All we need to do is remember that all of
these subroutines are now object methods, and so take the extra
parameter ($self). The basic <code>hello()</code> method simply says Hello to the
name of the person passed in.</p>
<p>Then we have a subdirectory, called /insult/. Here we have another
instance of <em>subs.epl</em>, and we redefine hello(). We call the parent
version of the function, and then add the insult (``you schmuck''). 
You
don't have to call the parent version of methods you define, of
course, but it's a useful demonstration of the possibilities.</p>
<p>The file <em>/insult/subs.epl</em> has to have a call to <code>Execute()</code> that
sets up @ISA. This is the first line. You might ask why 
EmbperlObject
doesn't do this automatically; it is mainly for reasons of
efficiency. Not every file is going to contain methods that need
to inherit from the parent file, and so simply requiring this one line
seemed to be a good compromise. It also allows for more
flexibility, as you can include other arbitrary files into
the @ISA tree if you want.</p>

<h3><a name="conclusions">Conclusions</a></h3>
<p>So there you have it: an introduction to the use of EmbperlObject 
for
constructing large, modular Web sites. You will probably use it to
enable such things as Web site-wide navigation bars, table layouts 
and
whatever else needs to be modularized.</p>
<p>This document is just an introduction, to give a broad flavor of the
tool. You should refer to the actual documentation for details.</p>
<p>EmbperlObject will inevitably evolve as developers discover what is
useful and what isn't. We will try to keep this document up-to-date
with these changes, but make sure to check the Embperl 
Web site
regularly for the latest changes.</p>


                                    </div>


                                </div>
                                <div class="asset-footer">


                                    <div class="entry-tags">
                                        <h4>Tags<span class="delimiter">:</span></h4>
                                        <ul>
                                            <li><a href="javascript:void(0)" onclick="location.href='http://www.perl.com/mt-search.cgi?IncludeBlogs=2&amp;tag=embperl&amp;limit=20';return false;" rel="tag">embperl</a><span class="delimiter">,</span></li> <li><a href="javascript:void(0)" onclick="location.href='http://www.perl.com/mt-search.cgi?IncludeBlogs=2&amp;tag=epl&amp;limit=20';return false;" rel="tag">epl</a><span class="delimiter">,</span></li> <li><a href="javascript:void(0)" onclick="location.href='http://www.perl.com/mt-search.cgi?IncludeBlogs=2&amp;tag=html&amp;limit=20';return false;" rel="tag">html</a></li>
                                        </ul>
                                    </div>

                                </div>
                            </div>


                    
                    


                        </div>
                    </div>


                    <div id="beta">
    <div id="beta-inner">


    
    <div class="widget-what-is-perl widget">
    <div class="widget-content widget-content-what-is-perl">
       Visit the home of the  Perl programming language: <a href="http://www.perl.org/">Perl.org</a
    </div>
</div>
<div class="widget-find-out-more widget-archives widget">
    <div class="widget-content">
        <ul>
            <li><a href="http://www.perl.org/get.html">Download</a></li>
            <li><a href="http://perldoc.perl.org/">Documentation</a></li>
            <li><a href="http://blogs.perl.org/">Perl Bloggers</a></li>
            <li><a href="http://news.perlfoundation.org/">Foundation News</a></li>
        </ul>
    </div>
</div><div class="widget-tcpc widget">
<h3 class="widget-header">Sponsored by</h3>
    <div class="widget-content">
        <a href="http://training.perl.com/" alt="Perl Training" target="_blank"><img src="/i/tcpc.png" width="150" height="50"></a>
    </div>
</div>

<div class="widget-syndication widget">
    <div class="widget-content">
        <ul>
            <li><img src="/mt-static/images/status_icons/feed.gif" alt="Subscribe to feed" width="9" height="9" /> <a href="/pub/atom.xml">Subscribe to this website's feed</a></li>

        </ul>
    </div>
</div>
<div class="widget-archive-monthly widget-archive widget">
    <h3 class="widget-header">Monthly <a href="/pub/archives.html">Archives</a></h3>
    <div class="widget-content">
        <ul>
        
            <li><a href="/pub/2014/02/">February 2014 (1)</a></li>
        
    
        
            <li><a href="/pub/2014/01/">January 2014 (1)</a></li>
        
    
        
            <li><a href="/pub/2013/10/">October 2013 (1)</a></li>
        
    
        
            <li><a href="/pub/2013/01/">January 2013 (1)</a></li>
        
    
        
            <li><a href="/pub/2012/12/">December 2012 (1)</a></li>
        
    
        
            <li><a href="/pub/2012/11/">November 2012 (1)</a></li>
        
    
        
            <li><a href="/pub/2012/10/">October 2012 (2)</a></li>
        
    
        
            <li><a href="/pub/2012/08/">August 2012 (2)</a></li>
        
    
        
            <li><a href="/pub/2012/06/">June 2012 (11)</a></li>
        
    
        
            <li><a href="/pub/2012/05/">May 2012 (18)</a></li>
        
    
        
            <li><a href="/pub/2012/04/">April 2012 (17)</a></li>
        
    
        
            <li><a href="/pub/2012/02/">February 2012 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/12/">December 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/09/">September 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/08/">August 2011 (2)</a></li>
        
    
        
            <li><a href="/pub/2011/06/">June 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/05/">May 2011 (3)</a></li>
        
    
        
            <li><a href="/pub/2011/04/">April 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/03/">March 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/02/">February 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/01/">January 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2010/11/">November 2010 (1)</a></li>
        
    
        
            <li><a href="/pub/2010/10/">October 2010 (2)</a></li>
        
    
        
            <li><a href="/pub/2010/09/">September 2010 (1)</a></li>
        
    
        
            <li><a href="/pub/2010/08/">August 2010 (3)</a></li>
        
    
        
            <li><a href="/pub/2010/07/">July 2010 (2)</a></li>
        
    
        
            <li><a href="/pub/2010/04/">April 2010 (2)</a></li>
        
    
        
            <li><a href="/pub/2010/03/">March 2010 (4)</a></li>
        
    
        
            <li><a href="/pub/2008/05/">May 2008 (1)</a></li>
        
    
        
            <li><a href="/pub/2008/04/">April 2008 (2)</a></li>
        
    
        
            <li><a href="/pub/2008/03/">March 2008 (1)</a></li>
        
    
        
            <li><a href="/pub/2008/02/">February 2008 (1)</a></li>
        
    
        
            <li><a href="/pub/2008/01/">January 2008 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/12/">December 2007 (2)</a></li>
        
    
        
            <li><a href="/pub/2007/09/">September 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/08/">August 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/07/">July 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/06/">June 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/05/">May 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/04/">April 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/03/">March 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/02/">February 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/01/">January 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/12/">December 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/11/">November 2006 (2)</a></li>
        
    
        
            <li><a href="/pub/2006/10/">October 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/09/">September 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/08/">August 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/07/">July 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/06/">June 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/05/">May 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/04/">April 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/03/">March 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/02/">February 2006 (4)</a></li>
        
    
        
            <li><a href="/pub/2006/01/">January 2006 (4)</a></li>
        
    
        
            <li><a href="/pub/2005/12/">December 2005 (4)</a></li>
        
    
        
            <li><a href="/pub/2005/11/">November 2005 (3)</a></li>
        
    
        
            <li><a href="/pub/2005/10/">October 2005 (2)</a></li>
        
    
        
            <li><a href="/pub/2005/09/">September 2005 (2)</a></li>
        
    
        
            <li><a href="/pub/2005/08/">August 2005 (9)</a></li>
        
    
        
            <li><a href="/pub/2005/07/">July 2005 (8)</a></li>
        
    
        
            <li><a href="/pub/2005/06/">June 2005 (9)</a></li>
        
    
        
            <li><a href="/pub/2005/05/">May 2005 (8)</a></li>
        
    
        
            <li><a href="/pub/2005/04/">April 2005 (7)</a></li>
        
    
        
            <li><a href="/pub/2005/03/">March 2005 (6)</a></li>
        
    
        
            <li><a href="/pub/2005/02/">February 2005 (7)</a></li>
        
    
        
            <li><a href="/pub/2005/01/">January 2005 (6)</a></li>
        
    
        
            <li><a href="/pub/2004/12/">December 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/11/">November 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/10/">October 2004 (5)</a></li>
        
    
        
            <li><a href="/pub/2004/09/">September 2004 (9)</a></li>
        
    
        
            <li><a href="/pub/2004/08/">August 2004 (6)</a></li>
        
    
        
            <li><a href="/pub/2004/07/">July 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/06/">June 2004 (6)</a></li>
        
    
        
            <li><a href="/pub/2004/05/">May 2004 (7)</a></li>
        
    
        
            <li><a href="/pub/2004/04/">April 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/03/">March 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/02/">February 2004 (9)</a></li>
        
    
        
            <li><a href="/pub/2004/01/">January 2004 (7)</a></li>
        
    
        
            <li><a href="/pub/2003/12/">December 2003 (4)</a></li>
        
    
        
            <li><a href="/pub/2003/11/">November 2003 (7)</a></li>
        
    
        
            <li><a href="/pub/2003/10/">October 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2003/09/">September 2003 (6)</a></li>
        
    
        
            <li><a href="/pub/2003/08/">August 2003 (7)</a></li>
        
    
        
            <li><a href="/pub/2003/07/">July 2003 (9)</a></li>
        
    
        
            <li><a href="/pub/2003/06/">June 2003 (9)</a></li>
        
    
        
            <li><a href="/pub/2003/05/">May 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2003/04/">April 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2003/03/">March 2003 (10)</a></li>
        
    
        
            <li><a href="/pub/2003/02/">February 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2003/01/">January 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2002/12/">December 2002 (5)</a></li>
        
    
        
            <li><a href="/pub/2002/11/">November 2002 (9)</a></li>
        
    
        
            <li><a href="/pub/2002/10/">October 2002 (7)</a></li>
        
    
        
            <li><a href="/pub/2002/09/">September 2002 (11)</a></li>
        
    
        
            <li><a href="/pub/2002/08/">August 2002 (8)</a></li>
        
    
        
            <li><a href="/pub/2002/07/">July 2002 (8)</a></li>
        
    
        
            <li><a href="/pub/2002/06/">June 2002 (4)</a></li>
        
    
        
            <li><a href="/pub/2002/05/">May 2002 (6)</a></li>
        
    
        
            <li><a href="/pub/2002/04/">April 2002 (6)</a></li>
        
    
        
            <li><a href="/pub/2002/03/">March 2002 (7)</a></li>
        
    
        
            <li><a href="/pub/2002/02/">February 2002 (5)</a></li>
        
    
        
            <li><a href="/pub/2002/01/">January 2002 (8)</a></li>
        
    
        
            <li><a href="/pub/2001/12/">December 2001 (7)</a></li>
        
    
        
            <li><a href="/pub/2001/11/">November 2001 (5)</a></li>
        
    
        
            <li><a href="/pub/2001/10/">October 2001 (9)</a></li>
        
    
        
            <li><a href="/pub/2001/09/">September 2001 (7)</a></li>
        
    
        
            <li><a href="/pub/2001/08/">August 2001 (13)</a></li>
        
    
        
            <li><a href="/pub/2001/07/">July 2001 (8)</a></li>
        
    
        
            <li><a href="/pub/2001/06/">June 2001 (13)</a></li>
        
    
        
            <li><a href="/pub/2001/05/">May 2001 (11)</a></li>
        
    
        
            <li><a href="/pub/2001/04/">April 2001 (9)</a></li>
        
    
        
            <li><a href="/pub/2001/03/">March 2001 (8)</a></li>
        
    
        
            <li><a href="/pub/2001/02/">February 2001 (8)</a></li>
        
    
        
            <li><a href="/pub/2001/01/">January 2001 (8)</a></li>
        
    
        
            <li><a href="/pub/2000/12/">December 2000 (6)</a></li>
        
    
        
            <li><a href="/pub/2000/11/">November 2000 (10)</a></li>
        
    
        
            <li><a href="/pub/2000/10/">October 2000 (10)</a></li>
        
    
        
            <li><a href="/pub/2000/09/">September 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/2000/08/">August 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/2000/07/">July 2000 (5)</a></li>
        
    
        
            <li><a href="/pub/2000/06/">June 2000 (7)</a></li>
        
    
        
            <li><a href="/pub/2000/05/">May 2000 (7)</a></li>
        
    
        
            <li><a href="/pub/2000/04/">April 2000 (3)</a></li>
        
    
        
            <li><a href="/pub/2000/03/">March 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/2000/02/">February 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/2000/01/">January 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/1999/12/">December 1999 (6)</a></li>
        
    
        
            <li><a href="/pub/1999/11/">November 1999 (6)</a></li>
        
    
        
            <li><a href="/pub/1999/10/">October 1999 (5)</a></li>
        
    
        
            <li><a href="/pub/1999/09/">September 1999 (4)</a></li>
        
    
        
            <li><a href="/pub/1999/08/">August 1999 (3)</a></li>
        
    
        
            <li><a href="/pub/1999/07/">July 1999 (2)</a></li>
        
    
        
            <li><a href="/pub/1999/06/">June 1999 (3)</a></li>
        
    
        
            <li><a href="/pub/1999/04/">April 1999 (1)</a></li>
        
    
        
            <li><a href="/pub/1999/03/">March 1999 (1)</a></li>
        
    
        
            <li><a href="/pub/1999/01/">January 1999 (1)</a></li>
        
    
        
            <li><a href="/pub/1998/12/">December 1998 (1)</a></li>
        
    
        
            <li><a href="/pub/1998/11/">November 1998 (1)</a></li>
        
    
        
            <li><a href="/pub/1998/07/">July 1998 (2)</a></li>
        
    
        
            <li><a href="/pub/1998/06/">June 1998 (1)</a></li>
        
    
        
            <li><a href="/pub/1998/03/">March 1998 (1)</a></li>
        
        </ul>
    </div>
</div>
        
    

<div class="widget-powered widget">
    <div class="widget-content">
        <a href="http://www.movabletype.com/"><img src="/mt-static/images/bug-pbmt-white.png" alt="Powered by Movable Type 5.13-en" width="120" height="75" /></a>
    </div>
</div>



    </div>
</div>






                </div>
            </div>


            <div id="footer">
    <div id="footer-inner">
        <div id="footer-content">
            <div class="widget-powered widget">
                <div class="widget-content">
                    Powered by <a href="http://www.movabletype.com/" rel="generator">Movable Type Pro</a>
                </div>
            </div>

            <div class="widget-creative-commons widget">
                <div class="widget-content">
                    This blog is licensed under a <a href="http://creativecommons.org/licenses/by-nc-nd/3.0/">Creative Commons License</a>.
                </div>
            </div>

        </div>
    </div>
</div>



        </div>
    </div>
</body>
</html>
