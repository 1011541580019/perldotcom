
<!-- This week on perl5-porters (01--07 Oct 2000) -->

<br />
<!::field::date::><br /><ul>
  <li><a href="#Notes">Notes</a>
  <li><a href="#Self_tying_is_broken">Self-tying is broken</a>
  <li><a href="#Virtual_Values">Virtual values</a>
  <li><a href="#Why_is_unshift_slow">Why is unshift slow?</a>
  <li><a href="#More_Perl_hacking_guidelines">More Perl hacking guidelines</a>
  <li><a href="#Integer_and_floating_point_handling">Integer and floating-point handling</a>
 <li><a href="#bugfix"><code>printf %v</code> format bug fixed</a>
  <li><a href="#Jarkko_impersonates_me">Jarkko impersonates me</a>
  <li><a href="#Various">Various</a>
</ul>

      <H3><a name="Notes">Notes</a></H3>

</P>

<P>

First, the meta-news this week is that you have a new author.
I've taken over producing the perl5-porters summary from Mark-Jason
Dominus, so from now on, please send your corrections and additions
to simon@brecon.co.uk.
</P>


<P>
This week was relatively quiet, with just a couple of hundred mails.
<H3><a name="Self_tying_is_broken">Self-tying is broken</a></H3>

</P>

<P>

Alan Burlison noted that you can't create a self-tie anymore without
Perl going into nasty recursion. What's a self-tie? As you may guess, 
<CODE>tie</CODE>ing a variable to itself goes like this:
</P>

</P><PRE>
    package MyTie;
    sub TIEARRAY { bless $_[1], $_[0] }
</PRE>

</P><PRE>
    package main;
    my (@self);
    tie(@self, "MyTie", \@self);
</PRE>

<P>
The problem comes with how tying is implemented. Perl uses a structure
called &quot;magic&quot; attached to each tied variable to contain subs like 
<CODE>FETCH</CODE>. When you fetch a variable's value, Perl checks to see whether there's a 
<CODE>FETCH</CODE> sub stored in the variable's magic. If there is, Perl calls it to
determine the variable's value. If this sub tries to look at the variable
itself, Perl then calls the 
<CODE>FETCH</CODE> sub stored in the variable's magic to try and get its value, which, in turn, 
tries to look at the variable, and things end up in a mess. Alan then 
<a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2000-10/msg00003.html">investigated </a>and tentatively blamed Sarathy, but this turns out to have been a bad
call; the problem's much deeper than that and nobody could think of a
way of fixing it without breaking nested ties or threading. Part of the
problem appears to be that nobody really knows what self-ties are
supposed to do anyway. No patch was forthcoming, and the discussion
fizzled out.
</P>

<P>
Elsewhere, Daniel Chetlin fixed some bugs with tied filehandles. He
makes some other interesting points about what happened while he was
working on it.
<a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2000-10/msg00059.html">Read about it.</a></P>

<P>

<H3><a name="Virtual_Values">Virtual values</a></H3>

</P>

<P>
Jarkko came up with a new idea for copy-on-write sharing of scalars, but
said that it may have to wait until Perl 6 before anyone implements it.
Ilya popped up and characteristically said that he'd already done it.
<H3><a name="Why_is_unshift_slow">Why is unshift slow?</a></H3>

</P>

<P>

Ben Tilly started a discussion on 
<a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2000-10/msg00097.html">why unshift is so slow, </a>which didn't get much attention but contains a lot of juicy goodies for
people thinking about how to make array handling faster. No patches or
benchmarks came out of the discussion, but there's an opportunity for
someone to try some of the ideas there and see whether there's
any improvement.
<H3><a name="More_Perl_hacking_guidelines">More Perl hacking guidelines</a></H3>

</P>

<P>

Mark Fisher contributed a helpful patch for 
<CODE>perlhack</CODE> on 
<a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2000-10/msg00099.html">using Purify to debug Perl</a>, prompting people to promise to explain how to use their favourite code
checkers. None of the other patches has materialized, and the
discussion moved on to the fine print of 
<CODE>PERL_DESTRUCT_LEVEL</CODE>.
<H3><a name="Integer_and_floating_point_handling">Integer and floating-point handling.</a></H3>

</P>

<P>

Currently, putting together two variables which contain integers is
actually a floating-point operation, meaning that variables have to get
upgraded to hold floating-point values when they don't necessarily need
to. It was hard to see a good way around this, but Sarathy came up with
<a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2000-10/msg00175.html">a suggestion</a>. Someone with a few hours to spare should consider applying Sarathy's
idea and coming back with some benchmarks.
</P>

<P>
In other floating-point news, Nick Clark found some
<a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2000-10/msg00231.html">64-bit bugs</a> to do with the conversion between UVs and NVs. There was some
discussion, but no patch.

<H3><a name="bugfix"><code>printf %v</code> format bug fixed</a></H3>

<p>[This section of the report was written by Dominus.]</p>

<p>In an <a href="http://www.perl.com/pub/2000/07/p5pdigest/THISWEEK-20000702.html#More_Bug_Bounty">earlier report</a>, I mentioned a bug
in the <code>%v</code> format specifier for <code>printf</code> and suggested that 
this was a good candidate for fixing by someone who was just starting out fixing Perl bugs.
Avi F. stepped up to the challenge and provided a patch, which was accepted.  Unfortunately, Avi did this right after I
stopped doing p5p summaries, so never received proper credit. Thank you very much, Avi!</p>

<p><a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2000-07/msg00418.html">Read about it.</a></P>
</p>

<p>[We now return you to Simon Cozens.]</p>

<H3><a name="Jarkko_impersonates_me">Jarkko impersonates me</a></H3>

</P>

<P>

I noticed 
<a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2000-10/msg00122.html">a bug in split</a> which caused Unicode values to be denatured; Jarkko's worsening
influenza produced a delirium that caused him to not only babble to
himself but also 
<a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2000-10/msg00210.html">to impersonate me. </a></P>

<P>
But at least he fixed the bug. If I hack Unicode too long, will this
happen to me too? Find out next week!
<H3><a name="Various">Various</a></H3>

</P>

<P>

The usual collection of bug reports, test results, bug fixes, test
results, esoterica and more test results. The clown who was sending
duplicate copies of CCs to people has been ejected from the premises.
</P>

<P>
Until next week, I remain your humble and obedient servant,
</P>

<hr>

<a href="mailto:simon@brecon.co.uk">Simon Cozens</a>
