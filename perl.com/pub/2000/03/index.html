<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" id="sixapart-standard">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="generator" content="Movable Type Pro 5.13-en" />
<link rel="stylesheet" href="/pub/styles.css" type="text/css" />
<link rel="start" href="/pub/" title="Home" />
<link rel="alternate" type="application/atom+xml" title="Recent Entries" href="/pub/atom.xml" />
<script type="text/javascript" src="/pub/mt.js"></script>
<!--
<rdf:RDF xmlns="http://web.resource.org/cc/"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
<Work rdf:about="/pub/">
<dc:title>Perl.com</dc:title>
<dc:description>news and views of the Perl programming language</dc:description>
<license rdf:resource="http://creativecommons.org/licenses/by-nc-nd/3.0/" />
</Work>
<License rdf:about="http://creativecommons.org/licenses/by-nc-nd/3.0/">
</License>
</rdf:RDF>
-->

<script type="text/javascript">

 var _gaq = _gaq || [];
 _gaq.push(['_setAccount', 'UA-50555-22']);
 _gaq.push(['_trackPageview']);

 (function() {
   var ga = document.createElement('script'); ga.type =
   'text/javascript'; ga.async = true;
   ga.src = ('https:' == document.location.protocol ? 'https://ssl' :
   'http://www') + '.google-analytics.com/ga.js';
   var s = document.getElementsByTagName('script')[0];
   s.parentNode.insertBefore(ga, s);
 })();

</script>
<script type='text/javascript' src='http://partner.googleadservices.com/gampad/google_service.js'></script>
<script type='text/javascript'>
GS_googleAddAdSenseService("ca-pub-4136420132070439");
GS_googleEnableAllServices();
</script>
<script type='text/javascript'>
GA_googleAddSlot("ca-pub-4136420132070439", "Perl_728x90");
</script>
<script type='text/javascript'>GA_googleFetchAds();</script>
    <title>Perl.com: March 2000 Archives</title>


    <link rel="prev" href="/pub/2000/02/" title="February 2000" />
    <link rel="next" href="/pub/2000/04/" title="April 2000" />

</head>
<body id="perl-com" class="mt-archive-listing mt-datebased-monthly-archive layout-wt">
    <div id="container">
        <div id="container-inner">


            <div id="header">
    <div id="header-inner">
        <div id="header-content">
        <span id="top_advert"> 
<!-- Put any landscape advert in here -->
<!-- Perl_728x90 -->
<script type='text/javascript'>
GA_googleFillSlot("Perl_728x90");
</script>
        </span> 



            <div id="header-name"><a href="/pub/" accesskey="1">Perl.com</a></div>
            <div id="header-description">news and views of the Perl programming language</div>




        </div>
    </div>
</div>



            <div id="content">
                <div id="content-inner">


                    <div id="alpha">
                        <div id="alpha-inner">


                            <h1 id="page-title" class="archive-title">March 2000 Archives</h1>





                            
                            <div id="entry-1660" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2000/03/spam3.html" rel="bookmark">My Life With Spam: Part 3</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Mark-Jason Dominus</span> on <abbr class="published" title="2000-03-15T00:00:00-08:00">March 15, 2000 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            <P>
<!-- <A NAME="My_Life_with_Spam">My Life with Spam</A> -->

<H3><A NAME="How_I_Caught_the_Spam_and_What_I">How I Caught the Spam and What I Did With it When I Caught it</A></H3>


<br />
<P>This article is the third in a series; you may want to read <a href="http://www.plover.com/~mjd/perl/lp/Spam.html">Part 1</a> and <a
href="/pub/2000/02/spamfilter.html">Part 2</a>
if you haven't yet. Here's a short summary to refresh your memory:

<P>
I get a lot of spam mail, and I don't like that. I used to get upset every
time I read my mail and had to throw out a bunch of spam, so I decided to
put some effort into writing a program that would filter my email and
discard spam automatically. Then my blood pressure would stay low.

<P>
I decided that it was most important that nothing be thrown away for good,
because I knew that no filter was perfect, and I was afraid that important
business mail from a client might be silently discarded and I would lose my
job. I also decided I wasn't smart enough to filter on the actual content
of messages---the touchstone example is that if someone sends me a letter <EM>complaining</EM> about spam, and they say ``Gosh, these Green Card Lottery messages are
driving me crazy!'' I don't want to reject the message just because it
mentions green card lotteries. I couldn't figure out how to avoid that, so
I resolved that I would filter on header lines only.

<P>
My main strategy is to maintain a blacklist of `bad domains' that send a
lot of spam, such as <CODE>eastmail.com</CODE>. Mail from these domains is presumed to be spam. Mail from anyone I don't
know in one of these domains is returned to the sender, with an apology,
requesting them to re-send the message to a different address. Mail to that
address is forwarded directly into my mailbox, and also into a program that
adds their `From' address to the list of `people I know', so that next time
they send me mail, it gets through the filter. The `people I know' list is
called a `whitelist', and it's just a DBM file. The code is very simple.
After reading the message and parsing the header, as I described in Part 1,
I look to see if the subject contains a secret password. If so, I add the
message senders to my whitelist. Senders can also get on the whitelist by
sending a message to a special address; this address invokes the program
with a command-line argument that automatically enables whitelisting. The
code looks something like this:

<P>
<PRE>
        if ($ARGV{Mode} eq 'Whitelist'
         || $H{Subject} =~ /$PASSWORD/) {
          foreach $s (senders()) {
            $db{lc $s} = time;
          }
        }
</PRE>
<P>
<HR>
<H1><A NAME="Drawbacks_of_This_Approach">Drawbacks of This Approach</A></H1>
<P>
People occasionally ask what would happen if the spammers added the special
whitelisting address to their mailing lists. This has never happened, but
if they did, I would deal with it easily enough; I'd just change the
address. Nobody ever needs to send more than one message to the
whitelisting address, because once you're on the whitelist, you're on
forever. So I wouldn't be inconveniencing anyone by changing this address.

<P>
Of course, in the meantime, the spammer is still on the whitelist, and even
if they don't add the whitelist address to their address list, they might
get the apology back in the mail and just add themselves to the whitelist.
This has only happened a few times since I first started in late
1996---most spammers don't provide valid return addresses, and those that
do don't read the replies to their mail.

<P>
For the couple of dedicated spammers who <EM>did</EM> try to add themselves to my whitelist, I have a special super-blacklist
called the `losers list'. The filter rejects mail from losers no matter
what address it comes to. It returns the message to the sender, with a note
that says

<P>
<PRE>
        Hello.  I am an automatic reply.

        Your message is not welcome at this address.
        The recipient is not interested in hearing what
        you have to say.  Your mail being returned unread.

        Please do not send mail to this address in the future.

                Sincerely,

                The answering machine.
</PRE>
<P>
This has a side benefit: If I get really sick of someone I can add them to
my loser list even if they're not a spammer. It would probably be more
mature to just have the filter throw away the message, rather than
returning a note that says `I am ingoring you', but I'm a spiteful guy.

<P>
So the logic in the filter program looks something like this:

<dl>
<dt>        if the message is from a loser
<dd>            send it back with an `I am ignoring you' note

<dt>        else if the message is from someone on the whitelist
<dd>            accept it

<dt>        else if the message is from someone in a blacklisted domain
<dd>            send it back with instructions about how to get whitelisted

<dt>        else
<dd>            accept it
</dl>
<P>
The first two tests, for loserhood or whitelisting, are fast. The filter
program keeps one big DBM file for both lists. The keys are `From:'
addresses, and the value is <CODE>loser</CODE> if the user is a loser, and the date of whitelisting if they user is on the
whitelist. I keep the dates as an ASCII-formatted number of seconds since
1970, so the actual code looks something like this:

<P>
<PRE>
        if ($DB{$from} eq 'loser') {
          # they are a loser; reject mail
        } elsif ($DB{$from} &gt; 0) {
          # they are on the whitelist; accept
        } elsif (domain_is_bad()) {
          # reject
        } else { 
          # accept
        }
</PRE>
<P>
<CODE>domain_is_bad()</CODE> takes longer, because it does many pattern matches. I discussed it in 
<a href="/pub/2000/02/spamfilter.html">Part
2.</a>

<P>
<HR>
<H1><A NAME="A_Few_More_Heuristics">A Few More Heuristics</A></H1>
<P>
Checking the <CODE>From:</CODE>, <CODE>Reply-To:</CODE>, and <CODE>Received:</CODE> lines for the presence of domains that are `bad' is the main part of the
program. But there are a few extra miscellaneous rules I've put in that
have worked really well. The function <CODE>misc_bad_header</CODE> checks these rules, returning true if it sees something bad, and false
otherwise. For example:

<P>
<PRE>
  return 'Addressed To: &quot;you&quot; or &quot;friend&quot;' 
    if $H{To} =~ /(you|friend)/i;
</PRE>
<P>
This line looks at the <CODE>To:</CODE> line; if it's addressed to <CODE>you</CODE> or to
<CODE>friend</CODE>, it's bad.  <CODE>Friend@public.com</CODE> was particularly common in Spam for a while. The string returned by <CODE>misc_bad_header</CODE> is eventually entered in the log file as the reason for rejection.

<P>
At the end of the previous article, I asked what was wrong with the
following <CODE>Received:</CODE> line:

<P>
<PRE>
        Received: from login_2961.sayme2.net (mail.sayme2.net[103.12.210.92])
          by sayme2.net (8.8.5/8.7.3) with SMTP id XAA02040
          for creditc@aoI.net;  Thu, 28 August 1997 15:51:23 -0700 (EDT)
</PRE>
<P>
People found all sorts of things wrong that hadn't occurred to me! For
example, underscores are not allowed in domain names, so the name
<CODE>login_2961.sayme2.net</CODE> is illegal. However, many hosts do have illegal characters in their names,
so this is probably not a good reason to reject the message.  

<P>
Some people pointed out that the <CODE>Received:</CODE> line contains the dubious host name <CODE>aoI.net</CODE>, perhaps in hopes of fooling me into thinking that it actually said <CODE>aol.net</CODE>. Of course, they don't look similar to the computer at all.  

<P>
Jan-Pieter Cornet pointed out that the date is in the wrong format: It's
illegal to spell out <CODE>August</CODE>. It would be interesting to correlate the incidence of this sort of error
with the incidence of Spam, but I haven't done the analysis. 

<P>
For me, the really interesting thing about this line is the time zone.
<CODE>EDT</CODE> usually stands for `Eastern Daylight Time', and the -0700 means that it's
the time zone seven hours behind Universal Coordinated Time. Guess what?
EDT is <EM>four</EM> hours behind UTC, not seven. Similarly,
<CODE>EST</CODE> is `Eastern Standard Time', which is -0500. When messages like this started
to show up, I added these lines to <CODE>misc_bad_header()</CODE>:

<P>
<PRE>
  return 'Mangled time zone' if $H{Received} =~ /-0600 \(EST\)/
           || $H{Received} =~ /-0[57]00 \(EDT\)/;
</PRE>
<P>
I don't know what caused the errors in the first place, but for a long time
they were extremely reliable spam detectors. Neither one has come by in
almost a year though, which is a shame; I miss them.

<P>
<HR>
<H1><A NAME="Yet_More_Heuristics">Yet More Heuristics</A></H1>
<P>
Here are some good ones:

<P>
<PRE>
          return 'X-PMFLAGS header' if exists $H{'X-PMFLAGS'};
</PRE>
<P>
I don't know what an <CODE>X-PMFLAGS</CODE> line is, but it only seems to appear in spam. 

<P>
<PRE>
          return 'Message was handled by bulk.mail' 
            if $H{Received} =~ /bulk.mail/i ;
</PRE>
<P>
There's a bulk mailing program called <CODE>bulk_mailer</CODE> that identifies itself in the <CODE>Received:</CODE> line. 

<P>
<PRE>
          return 'Subject contains &quot;ad&quot;/&quot;adv&quot;'
            if $H{Subject} =~ /\badv?\b/i;
</PRE>
<P>
Some spammers actually put a string like <CODE>ADV:</CODE> into the subject line of their message. Of course, the law of evolution by
natural selection says that this trait will be selected against, and the
next generation of spammers won't do it as much. In the meantime, it works
well.

<P>

The next one is obvious:

<P>
<PRE>
          return 'Subject: line contains $$$ '
            if $H{Subject} =~ /\${3}/;
</PRE>
<P>
The next one isn't so obvious:

<P>
<PRE>
          return 'Username is all digits'
            if $H{From} =~ /^\d+\@/;
</PRE>
<P>
You'd be surprised at how often this comes up. Spammers seem to be moving
away from it, though; now I'm more likely to get spam mail from an address
like <CODE>23gfgd4@iperbole.bologna.it</CODE>. I'd like to add a heuristic to throw away messages from unlikely-sounding
usernames, but I don't feel confident that I will be able to identify them
reliably.

<P>
Finally, here's a big heuristic that works well: Make a list of `bad'
words, and reject any message that includes any of the `bad' words in any
of the X-headers:

<P>
<PRE>
          my $pat = join '|', @bad_words;
          foreach $h (keys %H) {
            next unless $h =~ /^X-/;
            return &quot;Header `$h' contains bad word $1&quot;
              if $H{$h} =~ /($pat)/io;
          }
</PRE>
<P>
What words are `bad'? Oh, the usual naughtiness. `Cyberpromo' heads the
list. (Am I allowed to say that on a public web site?) `stealth' is a good
one.

<P>
There's a trick here that you might not have seen before. You have a bunch
of patterns, in this case the items in <CODE>@bad_words</CODE>, and a bunch of strings, in this case the values of <CODE>%H</CODE>, and you want to see if any of the strings match any of the patterns. The
obvious technique is to use:

<P>
<PRE>
        foreach $string (values %H) { 
          foreach $pattern (@bad_words) {
            if ($string =~ /$pattern/) {
              return &quot;String $string matches pattern $pattern&quot;
            }
          }
        }
</PRE>
<P>
This is a mistake. Why? Because a regex ie like a little computer program:
It must to be compiled, and then it can be executed and given an input,
which is the string that you want to match against it. Compiling a regex is
relatively slow, but you only need to do it once, and then you can give it
many strings and see if any of them match, without recompiling.  

<P>
Perl normally compiles your regexes at the same time as it compiles the
rest of your program. But if the regexes change at run time, it can't do
that. Instead, it compiles each one just as it is about to be used. If
there are 42 strings in the string list, each regex gets compiled 42 times.  

<P>
Just reversing the order of the <CODE>foreach</CODE> loops speeds this
up by a factor of 18, because each pattern is compiled 
only once, and then used for all the strings:

<P>
<PRE>
        foreach $pattern (@bad_words) {
          foreach $string (values %H) { 
            if ($string =~ /$pattern/) {
              return &quot;String $string matches pattern $pattern&quot;
            }
          }
        }
</PRE>
<P>
(I ran a simple test with 16 strings and nine patterns.  If there were
more patterns, the speedup would be greater.)

<P>
If <CODE>misc_bad_header()</CODE> is called only once, then compiling each pattern once is the best you can
do. But if the loop just above is run twice, then all the patterns have to
be compiled again the second time around; this is wasteful.

<P>
The solution is to construct <EM>one</EM> pattern that never varies at all, and compile it exactly once. We can
construct one pattern by joining the real patterns together with <CODE>|</CODE>s in between. That's what

<P>
<PRE>
          my $pat = join '|', @bad_words;
</PRE>
<P>
does; it takes a <CODE>@bad_words</CODE> list that looks like <CODE>('cyberpromo',
'stealth', ...)</CODE> and turns it into a pattern that looks like
<CODE>cyberpromo|stealth|...</CODE>. Then we match against this pattern:

<P>
<PRE>
         return &quot;Header `$h' contains bad word $1&quot;
           if $H{$h} =~ /($pat)/io;
</PRE>
<P>
The <CODE>/o</CODE> modifier tells Perl that even though <CODE>$pat</CODE> looks like a variable, we're really using it as a constant. We promise perl
that
<CODE>$pat</CODE> will never change, and in return, Perl compiles the regex once, the first
time it is needed, and never compiles it again.

<P>
In this program, this clever hack is probably not worth doing, because the
filter program gets invoked once to handle one mail message, calls
<CODE>misc_bad_headers()</CODE> exactly once, and then exits. If I were doing it over, I would have left
out the trick---it comes under the heading of `premature optimization', and
premature optimization is the root of all evil. But the trick can be useful
in other contexts.

<P>
<HR>
<H1><A NAME="Heuristics_that_Didn_t_Work">Heuristics that Didn't Work</A></H1>
<P>
I got tired of getting mail titled
<CODE>RE: BIOTECH BARGAIN!</CODE> and <CODE>**LET YOUR COMPUTER MAKE MONEY WHILE YOU
SLEEP!**</CODE>, so I thought I'd try putting in a filter to reject mail whose
<CODE>Subject:</CODE> line was in all capitals:

<P>
<PRE>
             my $s = $H{Subject};
             # subject contains no lowercase letters
             return 'Subject: all capitals' if $s !~ /[a-z]/ ;
</PRE>
<P>
The very next email message I received was titled <CODE>FYI</CODE>. It was from my brother-in-law. The spam filter rejected it. I commented
out the `all capitals' test. 

<P>
A few months later, I was ready for more abuse. I tried this::

<P>
<PRE>
             $s = tr/A-Za-z//cd;
             return 'Subject: all capitals' if $s !~ /[a-z]/ ;
               &amp;&amp; length($s) &gt; 6;  # and at least six capitals
</PRE>
<P>
This removes non-letters from the subject, then rejects the message if
the subject is all capitals and is at least seven letters long. Soon after
I tried this, I got mail from one of my clients titled <CODE>URGENT FIX!!!</CODE>. That was the end of that experiment.

<P>
The all-capitals subject line does not hold the record for the biggest spam
filtering failure. That honor goes to this line:  

<P>
<PRE>
        return 'no To: line' if $H{To} eq '';
</PRE>
<P>
This seemed fairly innoccuous, and still does---In fact, I'm still using it. Last
November, when I was away in London, I received a bulk mail that fell afoul
of this test and was sent to the spam file. All spam goes into a file so
that I can glance over it later, just in case it turns out to be something
important. The subject lines are logged separately. Usually I glance over
the subject line log (which is short) looking for messages that might be
interesting; if I see any, I go look in the spam file to see if it really
is interesting.

<P>
When I got back from London, I glanced over the subject log, and saw that 

<P>
<PRE>
        Subject: A message from VA Linux Systems (Mostly in English)
</PRE>
<P>
had been rejected because there was no <CODE>To:</CODE> line. I peeked at the message in the spam file, but I didn't look at it
closely, because I had a ton of unanswered mail to get to. I forgot about
it until a couple of months later when I ran into Chris DiBona at a
conference. ``Did you get the letter?'' he asked.

<P>
``What letter?''

<P>
My spam filter had discarded VA Linux's extremely lucrative IPO
announcement.

<P>
Oops.

<P>
Why haven't I taken out the <CODE>To:</CODE> line rule? Because it worked! It was supposed to detect bulk mail, and
that's just what it did do. The moral here is that there's some bulk mail
that you actually want to receive.

<P>
<HR>
<H1><A NAME="Notes_From_Last_Time">Notes From Last Time</A></H1>
<P>
I got a lot of interesting mail about the last article in this series.
Several people wrote to me to suggest a different filtering strategy:
Simply throw away mail unless one of your own addresses is in the <CODE>To:</CODE> line.

<P>
A lot of people wrote in about this, so it must work well for some people,
but it won't work for me. 
As I mentioned in <a href="http://www.plover.com/~mjd/perl/lp/Spam.html">Part 1</a>,  I had considered this
back in 1996. I decided
that it would probably result in a lot of false positives, where non-spam
mail was discarded. (For example, the IPO mail would still have been
rejected under this regime.) And then I went through my archive of spam and
discovered that about 20% of it actually <EM>was</EM> addressed to me, so I would have a 20% false negative rate also, where spam
would get through to me because it was addressed to me. With the system I
do use, the false positive rate is well below 10%, and the false negative rate is
much lower.

<P>
Someone also wrote to suggest that whenever I got spam, I could send an
automatic complaint letter to the relevant ISP, demanding revocation of the
sender's account.

<P>
This is a perfectly terrible idea, for several reasons. Most obviously,
most spam I get these days has a fake return address anyway, and
complaining to the owners of <CODE>hapless.com</CODE> isn't going to accomplish anything if the mail wasn't actually sent from
<CODE>hapless.com</CODE>, except to harass the hapless owners. So it's at best useless and at worst
a serious nuisance to people who are already trying to deal with a huge
number of bogus bounced messages.

<P>
But the real reason I hate this idea so much is that it makes even a small
false positive rate into a disaster. I can't reliably identify all the
non-spam messages I get; even with three layers of backup, I still lost out
on the VA Linux IPO because I thought it was spam. But I can live with
that; I knew when I set up the filter that I might one day miss something
important because of it.  I made an informed decision to take that risk.

<P>
But my correspondents, the people who write to me, did not make an informed
decision. They are stuck with my policy whether they like it or not, and I
owe it to them to inconvenience them as little as possible. A legitimate
person who sends me mail and falls afoul of the spam filter has to send
their message to me again, and even though they only have to do it once,
it's inconvenient and annoying. That inconvenience and annoyance to
innocent people who have never done anything wrong other than to try to
communicate with me is the biggest problem with the whole filtering
strategy.

<P>
But if inconveniencing my correspondent by forcing them to re-send a
message is a selfish thing to do, how much more selfish is it to
inconvenience them by mailing their ISP to demand that their account be
shut down? I can apologize to someone for making them send a second
message. How could I apologize for demanding that their internet access be
revoked? I just don't have that much gall.

<P>
<HR>
<H1><A NAME="Notes_From_Next_Time">Notes From Next Time</A></H1>
<P>
Coming next month, the last article in this series: Why I got 85 spam
messages last Wednesday, why I'm not happy with filtering, and what I'm
doing about it. This involves, of all things, a hack to the Apache web
server.  

        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1662" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2000/03/p5pdigest/THISWEEK-20000305.html" rel="bookmark">This Week on p5p 2000/03/05</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Mark-Jason Dominus</span> on <abbr class="published" title="2000-03-05T00:00:00-08:00">March  5, 2000 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            
<!-- This week on perl5-porters (7 March 2000) -->

<br />
<br /><ul>
  <li><a href="#Notes">Notes</a>
  <li><a href="#Meta_Information_">Meta-Information </a>
  <li><a href="#Brief_Update">Brief Update</a>
  <li><a href="#Module_Warnings">Module Warnings</a>
  <li><a href="#POD_Changes">POD Changes</a>
  <li><a href="#Race_conditions_in_statndard_Perl_utilities">Race conditions in statndard Perl utilities</a>
  <li><a href="#open_Calls_not_checked_in_perldoc"><code>open</code> Calls not checked in <code>perldoc</code></a>
  <li><a href="#Big_Flame_Wars">Big Flame Wars</a>
  <li><a href="#Chip_and_Jarkko_Quit">Chip and Jarkko Quit</a>
  <li><a href="#Templates_in_pack_and_unpack">Templates in <code>pack</code> and <code>unpack</code></a>
  <li><a href="#use_strict_in_the_core_modules"><code>use strict</code> in the core modules</a>
  <li><a href="#Various">Various</a>
</ul>

<P>

<H3><a name="Notes">Notes</a></H3>

</P>

<P>
Well, my apologies to everyone for the long absence.  I'm going to try
to send out reports more frequently, and to let go some of my
obsession about being completely complete, and see if I can stay on
schedule.
</P>

<P>
This means that if you think I missed something of importance, I would
be more grateful than ever if you would bring it to my attention.

<H4><a name="Meta_Information_">Meta-Information</a></H4>

</P>

<P>

The most recent report will always be available at 
<a href="/p5pdigest.cgi">http://www.perl.com/p5pdigest.cgi </a>.
</P>

<P>
You can subscribe to an email version of this summary by sending an
empty message to 
<a href="mailto:p5p-digest-subscribe@plover.com"><tt>p5p-digest-subscribe@plover.com</tt>.</a></P>

<P>
Please send corrections and additions to 
<CODE>mjd-perl-thisweek-YYYYMM@plover.com</CODE> where 
<CODE>YYYYMM</CODE> is the current year and month.
<H3><a name="Brief_Update">Brief Update</a></H3>

</P>

<P>

Since last time, Perl has had three beta releases and now stands at
version 5.5.670.

<p>
<a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2000-03/msg00082.html">Announcement for version 5.5.670</a></P>

<P>

<a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2000-02/msg01319.html">Announcement for version 5.5.660</a></P>

<P>
In the wake of this, list traffic is very high with various small bug
reports and configuration problems.
<H3><a name="Module_Warnings">Module Warnings</a></H3>

</P>

<P>

Paul Marquess added functionality to the 
<CODE>warnings.pm</CODE> lexical warnings module so that a module could peek at the warnings
 that are enabled in its caller, and issue similar sorts of warnings.
For example, your function might issue a warning about a newline at
the end of its filename argument, but only if your function's caller has the 
<CODE>newline</CODE> category of warnings enabled.
</P>

<P>
Paul asked whether it would be a good idea to allow modules to be able
to register their own warning categories, and presented a possible
interface to such functionality.  Then you might say something like
</P>

</P><PRE>
        use Fred;
        use warnings 'Fred';
</PRE>

<P>
to turn on the warnings that were special to the 
<CODE>Fred</CODE> module.  Paul asked for comments from the list about this.
<a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2000-03/msg00440.html">Original message</a></P>

<P>

There was a lot of interesting discussion of this.  Paul said that he
had thought 
about making it possible for a module to define its own
<I>hierarchy</I> of warnings, but that that seemed like overkill.  Ron Kimball
suggested that 
<CODE>use warnings 'Fred'</CODE> or 
<CODE>no warnings 'Fred'</CODE> might enable or disable warnings from module 
<CODE>Fred</CODE> regardless of whether or not 
<CODE>Fred</CODE> had registed its own warning category.  Paul said he had considered
 this, but that it would suggest to people that doing 
<CODE>use warnings 'Some::Module'</CODE> would necessarily do something useful, when in fact 
<CODE>Some::Module</CODE> might not issue any warnings at all.
</P>

<P>
Yitzchak Scott-Thoennes pointed out that if module names are
warning categories, then you could put explanations of your warnings
into your module's POD and then 
<CODE>diagnostics</CODE> would be able to find the explanations or your own module's warnings.
<H3><a name="POD_Changes">POD Changes</a></H3>

</P>

<P>

5.5.670 brought with it some changes to the structure of POD.  In
particular, the old problem of putting angle brackets into 
<CODE>C<...></CODE> tags
is probably solved.  You can now write 
<CODE>C<< $var->method >></CODE> and the rule
is that the text to be output is delimited by the double-angle
brackets <I>and</I> whitespace.</P>

<P>
Changes went into 
<CODE>Pod::Man</CODE>, 
<CODE>Pod::Parser</CODE> and 
<CODE>Pod::HTML</CODE> to support this.  Robin Barker pointed out that 
<CODE>pod2latex</CODE> still did not support this and other changes, and rather than dig
 into the horrible squiggly guts of 
<CODE>pod2latex</CODE> to fix it, he wrote a preprocessor (using 
<CODE>Pod::Parser</CODE> which removes the new escape codes
from a pod document and yields an old-style POD.  He bolted this to
the front of 
<CODE>pod2latex</CODE>, which in my opinion was the right thing to do.  Way to cut that
gordian knot, dude.
<H3><a name="Race_conditions_in_statndard_Perl_utilities">Race conditions in statndard Perl utilities</a></H3>

</P>

<P>

Tom Christiansen posted a `Request for Hero' to fix the parts of the
Perl distribution that write files to 
<CODE>/tmp</CODE> in an unsafe way, laying themselves open to race condition exploits
and soforth.  A typical problem is that 
<CODE>/tmp</CODE> is world-writable, so a malicious person could remove the temporary
 file and replace it with a new one before the program notices.  
Worse, if the superuser is running the program, a malicious user might
remove the temporary file and replace it with a symbolic link to the
password file; when the program updates what it thinks is the
temporary file, it is really updating the password file.
</P>

<P>
Tom
listed several utilities that may have these problems, including 
<CODE>perlcc</CODE>, 
<CODE>perldoc</CODE>, 
<CODE>perlbug</CODE>, and 
<CODE>s2p</CODE> although he also said that none of these bugs were actually in the core.
<a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2000-03/msg00498.html">Read about it.</a></P>

<P>

Tom called for a core 
<CODE>File::Temp</CODE> module that would encapsulate safe temporary file creation functions.
</P>

<P>
Tim Jenness said that he had written such a thing about a year ago, and
he volunteered to be the hero.  Discussion of various
attacks via
<CODE>/tmp</CODE> ensued. 
<H3><a name="open_Calls_not_checked_in_perldoc"><code>open</code> Calls not checked in <code>perldoc</code></a></H3>

</P>

<P>

Tom posted a related note, showing about half a dozen places in 
<CODE>perldoc</CODE> where a system call, usually 
<CODE>open</CODE>, was performed with no check of the return code. 
<H3><a name="Big_Flame_Wars">Big Flame Wars</a></H3>

</P>

<P>

Somehow the `
<CODE>open</CODE> calls' discussion turned into a gigantic flame war. 
</P>

<P>
If it's not too late, I advise skipping it.  The subject is 
`security (and stupidity) bugs in perldoc'.
<H3><a name="Chip_and_Jarkko_Quit">Chip and Jarkko Quit</a></H3>

</P>

<P>

Chip Salzenberg and Jarkko Hietaniemi quit p5p, citing big flame wars
as the reasons.  Chip created a new mailing list, which is supposed to
be just like p5p, except that ``verbal abuse will not be tolerated.''
</P>

<P>
Leaving aside any questions of how Chip plans to enforce this, I
believe that forking p5p is an incredibly bad idea.  I can only hope
that the new list will turn out to be irrelevant, but I'm really
afraid that it will draw off just enough of the productive people from
the main list to prevent both groups from being effective.
</P>

<P>
I'd love to revisit this in a year and find out that I'm wrong.  
<H3><a name="Templates_in_pack_and_unpack">Templates in <code>pack</code> and <code>unpack</code></a></H3>

</P>

<P>

Way back in October, Ilya had an idea for making 
<CODE>pack</CODE> and 
<CODE>unpack</CODE> capable of automatically unpacking data in any format, even one that
 was not known in advance.  I wrote this up in October, but Ilya's new
 messages now suggest that I didn't understand the point.
Ilya says:
<blockquote><b>Ilya:</b> There were some initial objections due tomisunderstanding of the posted example: people thought that theexamples of serialization I initially posted for illustrationwere the <b>only</b> ways to serialize data.  </blockquote></P>

<P>

<a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2000-03/msg00392.html">Ilya's recent message</a></P>

<P>
is probably worth reading, but skip the rest of the thread.  It was a
waste of time even before the tail end of this thread was
sucked into the
flame zone.
</P>

<P>

<a href="/pub/1999/10/p5pdigest/THISWEEK-19991031.html#pack_t_Template">(Old news here)</a><H3><a name="use_strict_in_the_core_modules"><code>use strict</code> in the core modules</a></H3>

</P>

<P>

Peter Scott asked why 84/109 core modules did not use 
<CODE>strict</CODE>.   That is a good question, and I don't think the answer is going to
turn out to be `carelessness and hystorical accident'.  At least, not
in every case.
</P>

<P>
If someone <i>did</i> go around putting 
<CODE>use strict</CODE> into all the core modules, I think it would be a real good idea if
they also kept track of how many <I>actual</I> bugs they found andcorrected as a result, and how many non-bugs.
<H3><a name="Various">Various</a></H3>

</P>

<P>

A large collection of bug reports, bug fixes, non-bug reports,
questions, and answers.    Also spam.
</P>

<P>

Until next time I remain, your humble and obedient
servant, 
</P>

<P>

</P>

<hr>

<a href="mailto:mjd-perl-thisweek-200003+@plover.com">Mark-Jason Dominus</a>


        </div>



    </div>
    <div class="asset-footer"></div>
</div>




                            <div class="content-nav">
                                <a href="/pub/2000/02/">&laquo; February 2000</a> |
                                <a href="/pub/">Main Index</a> |
                                <a href="/pub/archives.html">Archives</a>
                                | <a href="/pub/2000/04/">April 2000 &raquo;</a>
                            </div>


                        </div>
                    </div>


                    <div id="beta">
    <div id="beta-inner">


    
    <div class="widget-what-is-perl widget">
    <div class="widget-content widget-content-what-is-perl">
       Visit the home of the  Perl programming language: <a href="http://www.perl.org/">Perl.org</a
    </div>
</div>
<div class="widget-find-out-more widget-archives widget">
    <div class="widget-content">
        <ul>
            <li><a href="http://www.perl.org/get.html">Download</a></li>
            <li><a href="http://perldoc.perl.org/">Documentation</a></li>
            <li><a href="http://blogs.perl.org/">Perl Bloggers</a></li>
            <li><a href="http://news.perlfoundation.org/">Foundation News</a></li>
        </ul>
    </div>
</div><div class="widget-tcpc widget">
<h3 class="widget-header">Sponsored by</h3>
    <div class="widget-content">
        <a href="http://training.perl.com/" alt="Perl Training" target="_blank"><img src="/i/tcpc.png" width="150" height="50"></a>
    </div>
</div>

<div class="widget-syndication widget">
    <div class="widget-content">
        <ul>
            <li><img src="/mt-static/images/status_icons/feed.gif" alt="Subscribe to feed" width="9" height="9" /> <a href="/pub/atom.xml">Subscribe to this website's feed</a></li>

        </ul>
    </div>
</div>
<div class="widget-archive-monthly widget-archive widget">
    <h3 class="widget-header">Monthly <a href="/pub/archives.html">Archives</a></h3>
    <div class="widget-content">
        <ul>
        
            <li><a href="/pub/2014/02/">February 2014 (1)</a></li>
        
    
        
            <li><a href="/pub/2014/01/">January 2014 (1)</a></li>
        
    
        
            <li><a href="/pub/2013/10/">October 2013 (1)</a></li>
        
    
        
            <li><a href="/pub/2013/01/">January 2013 (1)</a></li>
        
    
        
            <li><a href="/pub/2012/12/">December 2012 (1)</a></li>
        
    
        
            <li><a href="/pub/2012/11/">November 2012 (1)</a></li>
        
    
        
            <li><a href="/pub/2012/10/">October 2012 (2)</a></li>
        
    
        
            <li><a href="/pub/2012/08/">August 2012 (2)</a></li>
        
    
        
            <li><a href="/pub/2012/06/">June 2012 (11)</a></li>
        
    
        
            <li><a href="/pub/2012/05/">May 2012 (18)</a></li>
        
    
        
            <li><a href="/pub/2012/04/">April 2012 (17)</a></li>
        
    
        
            <li><a href="/pub/2012/02/">February 2012 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/12/">December 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/09/">September 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/08/">August 2011 (2)</a></li>
        
    
        
            <li><a href="/pub/2011/06/">June 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/05/">May 2011 (3)</a></li>
        
    
        
            <li><a href="/pub/2011/04/">April 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/03/">March 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/02/">February 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/01/">January 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2010/11/">November 2010 (1)</a></li>
        
    
        
            <li><a href="/pub/2010/10/">October 2010 (2)</a></li>
        
    
        
            <li><a href="/pub/2010/09/">September 2010 (1)</a></li>
        
    
        
            <li><a href="/pub/2010/08/">August 2010 (3)</a></li>
        
    
        
            <li><a href="/pub/2010/07/">July 2010 (2)</a></li>
        
    
        
            <li><a href="/pub/2010/04/">April 2010 (2)</a></li>
        
    
        
            <li><a href="/pub/2010/03/">March 2010 (4)</a></li>
        
    
        
            <li><a href="/pub/2008/05/">May 2008 (1)</a></li>
        
    
        
            <li><a href="/pub/2008/04/">April 2008 (2)</a></li>
        
    
        
            <li><a href="/pub/2008/03/">March 2008 (1)</a></li>
        
    
        
            <li><a href="/pub/2008/02/">February 2008 (1)</a></li>
        
    
        
            <li><a href="/pub/2008/01/">January 2008 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/12/">December 2007 (2)</a></li>
        
    
        
            <li><a href="/pub/2007/09/">September 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/08/">August 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/07/">July 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/06/">June 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/05/">May 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/04/">April 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/03/">March 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/02/">February 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/01/">January 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/12/">December 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/11/">November 2006 (2)</a></li>
        
    
        
            <li><a href="/pub/2006/10/">October 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/09/">September 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/08/">August 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/07/">July 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/06/">June 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/05/">May 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/04/">April 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/03/">March 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/02/">February 2006 (4)</a></li>
        
    
        
            <li><a href="/pub/2006/01/">January 2006 (4)</a></li>
        
    
        
            <li><a href="/pub/2005/12/">December 2005 (4)</a></li>
        
    
        
            <li><a href="/pub/2005/11/">November 2005 (3)</a></li>
        
    
        
            <li><a href="/pub/2005/10/">October 2005 (2)</a></li>
        
    
        
            <li><a href="/pub/2005/09/">September 2005 (2)</a></li>
        
    
        
            <li><a href="/pub/2005/08/">August 2005 (9)</a></li>
        
    
        
            <li><a href="/pub/2005/07/">July 2005 (8)</a></li>
        
    
        
            <li><a href="/pub/2005/06/">June 2005 (9)</a></li>
        
    
        
            <li><a href="/pub/2005/05/">May 2005 (8)</a></li>
        
    
        
            <li><a href="/pub/2005/04/">April 2005 (7)</a></li>
        
    
        
            <li><a href="/pub/2005/03/">March 2005 (6)</a></li>
        
    
        
            <li><a href="/pub/2005/02/">February 2005 (7)</a></li>
        
    
        
            <li><a href="/pub/2005/01/">January 2005 (6)</a></li>
        
    
        
            <li><a href="/pub/2004/12/">December 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/11/">November 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/10/">October 2004 (5)</a></li>
        
    
        
            <li><a href="/pub/2004/09/">September 2004 (9)</a></li>
        
    
        
            <li><a href="/pub/2004/08/">August 2004 (6)</a></li>
        
    
        
            <li><a href="/pub/2004/07/">July 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/06/">June 2004 (6)</a></li>
        
    
        
            <li><a href="/pub/2004/05/">May 2004 (7)</a></li>
        
    
        
            <li><a href="/pub/2004/04/">April 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/03/">March 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/02/">February 2004 (9)</a></li>
        
    
        
            <li><a href="/pub/2004/01/">January 2004 (7)</a></li>
        
    
        
            <li><a href="/pub/2003/12/">December 2003 (4)</a></li>
        
    
        
            <li><a href="/pub/2003/11/">November 2003 (7)</a></li>
        
    
        
            <li><a href="/pub/2003/10/">October 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2003/09/">September 2003 (6)</a></li>
        
    
        
            <li><a href="/pub/2003/08/">August 2003 (7)</a></li>
        
    
        
            <li><a href="/pub/2003/07/">July 2003 (9)</a></li>
        
    
        
            <li><a href="/pub/2003/06/">June 2003 (9)</a></li>
        
    
        
            <li><a href="/pub/2003/05/">May 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2003/04/">April 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2003/03/">March 2003 (10)</a></li>
        
    
        
            <li><a href="/pub/2003/02/">February 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2003/01/">January 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2002/12/">December 2002 (5)</a></li>
        
    
        
            <li><a href="/pub/2002/11/">November 2002 (9)</a></li>
        
    
        
            <li><a href="/pub/2002/10/">October 2002 (7)</a></li>
        
    
        
            <li><a href="/pub/2002/09/">September 2002 (11)</a></li>
        
    
        
            <li><a href="/pub/2002/08/">August 2002 (8)</a></li>
        
    
        
            <li><a href="/pub/2002/07/">July 2002 (8)</a></li>
        
    
        
            <li><a href="/pub/2002/06/">June 2002 (4)</a></li>
        
    
        
            <li><a href="/pub/2002/05/">May 2002 (6)</a></li>
        
    
        
            <li><a href="/pub/2002/04/">April 2002 (6)</a></li>
        
    
        
            <li><a href="/pub/2002/03/">March 2002 (7)</a></li>
        
    
        
            <li><a href="/pub/2002/02/">February 2002 (5)</a></li>
        
    
        
            <li><a href="/pub/2002/01/">January 2002 (8)</a></li>
        
    
        
            <li><a href="/pub/2001/12/">December 2001 (7)</a></li>
        
    
        
            <li><a href="/pub/2001/11/">November 2001 (5)</a></li>
        
    
        
            <li><a href="/pub/2001/10/">October 2001 (9)</a></li>
        
    
        
            <li><a href="/pub/2001/09/">September 2001 (7)</a></li>
        
    
        
            <li><a href="/pub/2001/08/">August 2001 (13)</a></li>
        
    
        
            <li><a href="/pub/2001/07/">July 2001 (8)</a></li>
        
    
        
            <li><a href="/pub/2001/06/">June 2001 (13)</a></li>
        
    
        
            <li><a href="/pub/2001/05/">May 2001 (11)</a></li>
        
    
        
            <li><a href="/pub/2001/04/">April 2001 (9)</a></li>
        
    
        
            <li><a href="/pub/2001/03/">March 2001 (8)</a></li>
        
    
        
            <li><a href="/pub/2001/02/">February 2001 (8)</a></li>
        
    
        
            <li><a href="/pub/2001/01/">January 2001 (8)</a></li>
        
    
        
            <li><a href="/pub/2000/12/">December 2000 (6)</a></li>
        
    
        
            <li><a href="/pub/2000/11/">November 2000 (10)</a></li>
        
    
        
            <li><a href="/pub/2000/10/">October 2000 (10)</a></li>
        
    
        
            <li><a href="/pub/2000/09/">September 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/2000/08/">August 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/2000/07/">July 2000 (5)</a></li>
        
    
        
            <li><a href="/pub/2000/06/">June 2000 (7)</a></li>
        
    
        
            <li><a href="/pub/2000/05/">May 2000 (7)</a></li>
        
    
        
            <li><a href="/pub/2000/04/">April 2000 (3)</a></li>
        
    
        
            <li><a href="/pub/2000/03/">March 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/2000/02/">February 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/2000/01/">January 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/1999/12/">December 1999 (6)</a></li>
        
    
        
            <li><a href="/pub/1999/11/">November 1999 (6)</a></li>
        
    
        
            <li><a href="/pub/1999/10/">October 1999 (5)</a></li>
        
    
        
            <li><a href="/pub/1999/09/">September 1999 (4)</a></li>
        
    
        
            <li><a href="/pub/1999/08/">August 1999 (3)</a></li>
        
    
        
            <li><a href="/pub/1999/07/">July 1999 (2)</a></li>
        
    
        
            <li><a href="/pub/1999/06/">June 1999 (3)</a></li>
        
    
        
            <li><a href="/pub/1999/04/">April 1999 (1)</a></li>
        
    
        
            <li><a href="/pub/1999/03/">March 1999 (1)</a></li>
        
    
        
            <li><a href="/pub/1999/01/">January 1999 (1)</a></li>
        
    
        
            <li><a href="/pub/1998/12/">December 1998 (1)</a></li>
        
    
        
            <li><a href="/pub/1998/11/">November 1998 (1)</a></li>
        
    
        
            <li><a href="/pub/1998/07/">July 1998 (2)</a></li>
        
    
        
            <li><a href="/pub/1998/06/">June 1998 (1)</a></li>
        
    
        
            <li><a href="/pub/1998/03/">March 1998 (1)</a></li>
        
        </ul>
    </div>
</div>
        
    

<div class="widget-powered widget">
    <div class="widget-content">
        <a href="http://www.movabletype.com/"><img src="/mt-static/images/bug-pbmt-white.png" alt="Powered by Movable Type 5.13-en" width="120" height="75" /></a>
    </div>
</div>



    </div>
</div>






                </div>
            </div>


            <div id="footer">
    <div id="footer-inner">
        <div id="footer-content">
            <div class="widget-powered widget">
                <div class="widget-content">
                    Powered by <a href="http://www.movabletype.com/" rel="generator">Movable Type Pro</a>
                </div>
            </div>

            <div class="widget-creative-commons widget">
                <div class="widget-content">
                    This blog is licensed under a <a href="http://creativecommons.org/licenses/by-nc-nd/3.0/">Creative Commons License</a>.
                </div>
            </div>

        </div>
    </div>
</div>



        </div>
    </div>
</body>
</html>
