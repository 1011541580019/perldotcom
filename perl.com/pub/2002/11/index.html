<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" id="sixapart-standard">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="generator" content="Movable Type Pro 5.13-en" />
<link rel="stylesheet" href="/pub/styles.css" type="text/css" />
<link rel="start" href="/pub/" title="Home" />
<link rel="alternate" type="application/atom+xml" title="Recent Entries" href="/pub/atom.xml" />
<script type="text/javascript" src="/pub/mt.js"></script>
<!--
<rdf:RDF xmlns="http://web.resource.org/cc/"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
<Work rdf:about="/pub/">
<dc:title>Perl.com</dc:title>
<dc:description>news and views of the Perl programming language</dc:description>
<license rdf:resource="http://creativecommons.org/licenses/by-nc-nd/3.0/" />
</Work>
<License rdf:about="http://creativecommons.org/licenses/by-nc-nd/3.0/">
</License>
</rdf:RDF>
-->

<script type="text/javascript">

 var _gaq = _gaq || [];
 _gaq.push(['_setAccount', 'UA-50555-22']);
 _gaq.push(['_trackPageview']);

 (function() {
   var ga = document.createElement('script'); ga.type =
   'text/javascript'; ga.async = true;
   ga.src = ('https:' == document.location.protocol ? 'https://ssl' :
   'http://www') + '.google-analytics.com/ga.js';
   var s = document.getElementsByTagName('script')[0];
   s.parentNode.insertBefore(ga, s);
 })();

</script>
<script type='text/javascript' src='http://partner.googleadservices.com/gampad/google_service.js'></script>
<script type='text/javascript'>
GS_googleAddAdSenseService("ca-pub-4136420132070439");
GS_googleEnableAllServices();
</script>
<script type='text/javascript'>
GA_googleAddSlot("ca-pub-4136420132070439", "Perl_728x90");
</script>
<script type='text/javascript'>GA_googleFetchAds();</script>
    <title>Perl.com: November 2002 Archives</title>


    <link rel="prev" href="/pub/2002/10/" title="October 2002" />
    <link rel="next" href="/pub/2002/12/" title="December 2002" />

</head>
<body id="perl-com" class="mt-archive-listing mt-datebased-monthly-archive layout-wt">
    <div id="container">
        <div id="container-inner">


            <div id="header">
    <div id="header-inner">
        <div id="header-content">
        <span id="top_advert"> 
<!-- Put any landscape advert in here -->
<!-- Perl_728x90 -->
<script type='text/javascript'>
GA_googleFillSlot("Perl_728x90");
</script>
        </span> 



            <div id="header-name"><a href="/pub/" accesskey="1">Perl.com</a></div>
            <div id="header-description">news and views of the Perl programming language</div>




        </div>
    </div>
</div>



            <div id="content">
                <div id="content-inner">


                    <div id="alpha">
                        <div id="alpha-inner">


                            <h1 id="page-title" class="archive-title">November 2002 Archives</h1>





                            
                            <div id="entry-1406" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2002/11/p6pdigest/20021127.html" rel="bookmark">This week on Perl 6 (11/17-11/23, 2002)</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Piers Cawley</span> on <abbr class="published" title="2002-11-27T00:00:00-08:00">November 27, 2002 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            
<!-- sidebar begins -->
<!-- don't move sidebars -->
<!-- sidebar ends -->


<p>And some rough beast, its hour come 'round at last
slouches toward...</p>
<p>And then the scansion goes to pot and I can't make a joke fit. Shame.</p>
<p>Anyhoo, it's time for another episode of the continuing saga of
Perl 6 development. When I say 'saga' I don't mean a long, long poem
of alliterative lines, but a bright, breezy and brisk tale of the bods
in the lists. Well, one week mayb, when we've been quiet...</p>
<p>We start, as usual with the internals list.</p>

<h4><a name="c#/parrot_status">C#/Parrot Status</a></h4>
<p>Rhys Weatherley, who has been absent from the internals list lo these
many days popped up again to ask about:</p>
<ul>
<li>
Object/class support</li>

<li>
Fixed-size integers and/or conversion opcodes</li>

<li>
Embedding of binary extension sections</li>
</ul>
<p>He noted that &quot;Not Done Yet&quot; was an acceptable answer. Which is good,
because, as Leopold T&ouml;tsch pointed out, none of them were done
yet.  Leo also reckoned that a start would be to implement fixed size
integers and conversion ops, and asked for details of what was
wanted. Iacob Alin wondered if the various types would be PMCs
(answer: Only those types which don't easily map to native types.)
Florian Weimer wondered about trapping integer arithmetic. Dan says
these will be handled using Parrots standard exception handling
mechanism (which doesn't actually exist yet, but signs in the wind
suggest we might be getting a Halt and Catch Fire op to raise an exception).</p>
<p><a href="http://groups.google.com/groups?threadm=3DD8CF6D.E831119C%40zip.com.au">http://groups.google.com/groups</a></p>

<h4><a name="parrot_0.0.9_status">Parrot 0.0.9 status</a></h4>
<p>According to Steve Fink: &quot;The basic status is that lots of people,
many of them coincidentally named Leopold T&ouml;tsch, have been fixing
zillions of things and implementing a number of new features. Nearly
everything needed for 0.0.9 has happened, and a lot else besides.&quot;</p>
<p>See his post for details of what's still to be done.</p>
<p>One of the most important items was that the tinderbox (a fleet of
machines that constantly make, test and remake the latest parrot
builds) was a beautiful shade of orange and red, which led to
discussion of what was going on (since most people's home boxen seem to
be making and testing okay...) Various remedies and patches were
tried, but I believe the tinderbox is still mostly the wrong colour.</p>
<p><a href="http://groups.google.com/groups?threadm=20021119074745.GH3637%40foxglove.digital-integrity.com">http://groups.google.com/groups</a></p>
<p><a href="http://groups.google.com/groups?threadm=20021120053310.GI3637%40foxglove.digital-integrity.com">http://groups.google.com/groups</a></p>

<h4><a name="unified_core.jit">Unified <em>core.jit</em></a></h4>
<p>Leopold T&ouml;tsch posted an RFC in which he proposed writing a
universal <em>core.jit</em> which provides the basic JIT framework and which
delegates the generation of native ops to processor specific
implementations. Daniel Grunblatt liked the basic idea, but thought
there might be a case for creating <em>cisc.jit</em> and <em>risc.jit</em> to
avoid piles of <code>#ifdef</code>s. Daniel, Leo and Nicholas Clark then spent a
few posts thrashing out issues to do with parameter naming and other
more or less arcane things.</p>
<p><a href="http://groups.google.com/groups?threadm=3DDA36CD.6010905%40toetsch.at">http://groups.google.com/groups</a></p>

<h4><a name="native_function_calls">Native Function calls</a></h4>
<p>Dan announced that he'd redone the native function call interface and
had added a new op, <code>bnc</code>, which stands for `build native call'. His
post has the details of how it all works (and how to use it). Well,
that's what he said at first, but apparently it's not true. What he's
actually done is altered the <code>dlfunc</code> opcode to behave like <code>bnc</code> he
described. (It's a shame you can't hit <code>s/bnc/dlfunc/</code> in your mailer
and have the world alter every single copy of the mail you just
sent. It would have been useful for some of my previous summaries.)</p>
<p>Brent Dax wondered if this was going to be the new XS or if there was
more coming. Answer: Sort of.</p>
<p>Leo T&ouml;tsch didn't like <em>nci.c</em>'s string functions, and wondered
too about places where you'd need to pass a pointer to the parrot
interpreter. Dan doesn't like the string functions either, noting that
the code is &quot;evil, crufty [and] embarrassing&quot;, but that it is at least
&quot;well encapsulated, so it can be ripped out, shot, and replaced with
something elegant and fast at some point in the future.&quot; As for parrot
interpreter pointers, Dan reckons that any code that needs to go so
far should install real extension sub PMCs.</p>
<p>Gopal V worried about the type safety (it's an obsession of his
apparently) or rather the complete lack of it, in this interface. Dan,
in a quote of the week post said yup, of course it's totally type
unsafe and he liked it that way, before confessing that he was getting
that `XML feeling. (You know the one--&quot;It seemed like a good idea
until I thought about it&quot;)' and started backpedalling. Gopal V made a
few suggestions, and that's about where we left it.</p>
<p><a href="http://groups.google.com/groups?threadm=a05200f04ba01842ac28c%40%5B63.120.19.221%5D">http://groups.google.com/groups</a></p>
<p><a href="http://groups.google.com/groups?threadm=a05200f03ba01ed3467cf%40%5B63.120.19.221%5D">http://groups.google.com/groups</a> -- the correction</p>

<h4><a name="leopold_ttsch,_still_the_patch_monster">Leopold T&ouml;tsch, still the patch monster</a></h4>
<p>Leo's contributions this week include:</p>
<ul>
<li>
Patches to the JIT which give a 370% speedup in <em>mops_p.pasm</em></li>

<li>
Patched strings to try and fix a GC issue.</li>

<li>
More patches to the JIT to tidy things up
<p>This patch set also added i386 support for JITted floating point,
which apparently makes <em>mandel.pasm</em> at least 10 times faster.</p></li>
</ul>
<p>And that's not counting his contributions in other threads. Once
again, I wonder where he finds the time.</p>
<p>Other patches this week from other keyboards that Leo's:</p>
<ul>
<li>
Op restarts
<p>Jason Gloudon's patch adds a new control flow flag to <em>op.h</em>
to mark which ops can cause interpreter restarts. This information can
apparently be used to improved performance in JITted code by removing
the need for unnecessary checks.</p></li>

<li>
Function &lt;=&gt; Data Pointer casts in <em>nci.h</em>
<p>Josh Wilmes's patch to try and correct warnings on some compilers (and
'outright breakage on tcc'). Steve Fink seemed to like it, and
produced an updated version and Dan suggested that they don't
worry about it too much right now as he was in the process of redoing
<em>nci.c</em> anyway.</p></li>

<li><strong><a name="item_befunge_now_supports_perlarray%27s_push%2fpop">Befunge now supports PerlArray's push/pop</a></strong><br />

Jerome Quelin is one of the &quot;let's implement a bunch of languages on
Parrot&quot; crew, and his pet language is Befunge. If you don't know about
Befunge, you're lucky, but if you don't want to stay lucky, Google
will probably be depressingly informative. Anyhow, Jerome has now
rewritten his Befunge interpreter to use PerlArray's push and pop
rather than his older, hand crafted Parrot assembler routines. Dan
committed the patch `with the appropriate amount of fear'.</li>

<li>
The return of Leon Brocard
<p>As regular listeners will know, I try to mention Leon Brocard at least
once a week. This has been tricky of late because Leon had been on
holiday. And when he returned he didn't actually say that much.</p>
<p>This week, he rectified that and offered a couple of patches, and a
minor dilemma. The first simply improves a set of error messages,
making it easier to track a couple or three problems down. However,
his second patch is a little trickier.</p>
<p>The thing is, Leon has implemented another programming language for
Parrot. He'd posted it to the list some time ago (before my time as a
summarizer I think), but it'd got out of sync with the state of the
avian, so this time he offered it as a patch with its own subdirectory
of <em>languages</em>. &quot;So? What's the problem?&quot; I hear you ask. The problem
is the name of this language, which some people may find offensive. In
a postscript to the patch, Leon suggests that a bit of creative
misspelling may be in order, so I'll go that route:</p>
<p>Last week, Leon Brocard posted a patch implementing a brianfuck
interpreter.</p>
<p>There, that was easy wasn't it?</p></li>
</ul>
<p>Coo, what a remarkably long section with no associated links.</p>
















<h3><a name="meanwhile,_on_perl6language">Meanwhile, on perl6-language</a></h3>
<p>The `Unifying invocant and topic naming syntax' thread rumbled
on. Adam Lopresto wondered what was wrong with <code>sub bar(;$foo is
given) {...}</code>. Damian wasn't sure and reiterated his suggestion of
<code>sub foo (;$foo = $def_foo) is given($def_foo) {...}</code>, but Larry
really didn't like that (and he's not alone -- Ed.) Larry spun off a
few other suggestions, one of which Damian shot down quite handily,
and one of which, after couple of modifications, he quite liked. Brent
Dax wondered what was wrong with just using <code>$CALLER::_</code> and having
done with it, which led to some muttering that the CALLER should
really be a namespace of last resort for people doing bad and/or
clever things and that using it just to import the caller's topic
seemed like overkill. And on it went for a total of 47 posts this
week. Highlights include: Damian's discussion of why it makes sense to
pass the topic into a function without it appearing on the argument
list illustrated with an example from Class::Contract; Andy Wardley's
almost universally disliked suggestion of using <code>$__</code>, <code>$___</code>,
... to access callers' topics up the call chain; Allison Randal's
handy restating of the details of what was being discussed; Andy
Wardley also brought up the Law of Demeter and got ignored for his
pains.</p>
<p>I have the feeling we haven't seen the last of this yet, things still
aren't quite resolved.</p>
<p><a href="http://groups.google.com/groups?threadm=200211171603.gAHG3ZfO009744%40express.cec.wustl.edu">http://groups.google.com/groups</a></p>
<p><a href="http://groups.google.com/groups?threadm=3DD9E81F.8000408%40conway.org">http://groups.google.com/groups</a></p>
<p><a href="http://groups.google.com/groups?threadm=20021119113811.GC89570%40cat.ourshack.com">http://groups.google.com/groups</a></p>
<p><a href="http://groups.google.com/groups?threadm=20021119203510.GJ7056%40shadowed.net">http://groups.google.com/groups</a> -- Allison's summary</p>
<p><a href="http://groups.google.com/groups?threadm=20021120092058.GH96234%40cat.ourshack.com">http://groups.google.com/groups</a> -- Law of Demeter</p>

<h4><a name="the_string_concatenation_operator">The string concatenation operator</a></h4>
<p>The mammoth operator thread continues on it's merry way with a
slightly morphed subject (It's now <em>called</em> the `string concatenation
operator' thread, but it can't fool me). I think it might be slowing
down though; there were only 31 posts in the thread this week.</p>
<p>Anyhow, Martin D Kealey opened proceedings for the week, talking about
parallel processing. (And people wonder why I find this thread hard to
summarize -- the subject line is almost always inaccurate, and it
always seems to be going off on tangents), and the benefits of
functional and applicative programming languages when compilers need
to notice possible parallelism. Simon Cozens talked about typing of
values (not variables), and reckoned that with reasonably strongly
typed values there seemed to be no reason why <code>+</code> shouldn't be used
for string concatenation. However, Larry reckons that not using <code>+</code>
to concatenate strings was one of the things he got right in Perl
1. He also had some interesting things to say about the Principle of
Least Astonishment.</p>
<p>Dan talked about threading (remember, this thread is about the string
concatenation operator), which led into a discussion of the various
ways of handling threading. Matt Diephouse wondered how to pass a
junction to a function. It turns out to be easy; <code>sub foo ($param
is junction) {...}</code>. But not that easy. The subthread that ensued
ended up talking about what happens when some members in junction
cause exceptions to be thrown when others don't, and I'm <em>still</em> not
sure what's going on.</p>
<p>I don't suppose someone would like to write an article on junctions
along the same lines as Allison's 'Topics' article? Or is it still way
too early to do that?</p>
<p><a href="http://groups.google.com/groups?threadm=E18Elau-0001AS-00%40ns0">http://groups.google.com/groups</a></p>
<p><a href="http://groups.google.com/groups?threadm=20021123210520.GA21248%40wall.org">http://groups.google.com/groups</a></p>
<p><a href="http://groups.google.com/groups?threadm=a05200f00b9fdb26fa549%40%5B63.120.19.221%5D">http://groups.google.com/groups</a></p>

<h4><a name="continuations">Continuations</a></h4>
<p>The misnamed coroutines thread continued, discussing the use of
coroutines as iterators in while and for loops, which then morphed
into a discussion of <code>&lt;&lt;</code>. You see, <code>&lt;&lt;...&gt;&gt;</code> is the ASCII
synonym for <code>&laquo;...&raquo;</code>, which is, in turn a (the?) new
way of saying <code>qw/.../</code> (and for vectorizing an op). Ken Fox worried
that using <code>&lt;&lt;</code> in this way would mean you couldn't use it for
introducing a HERE doc, but Damian assured him that it wasn't a
problem because <code>&quot;</code> (and presumably <code>'</code>) would be illegal as the
very first character of a <code>&lt;&lt;...&gt;&gt;</code> delimited list. This
worried Paul Johnson slightly who paged Simon Cozens (Champion of
Regularity! Smiter of the Unexpected!) who didn't show up.</p>
<p>Austin Hastings asked if we couldn't rename coroutine <code>next</code> to be
<code>bork</code> (standing for &quot;Break OR Kontinue&quot; or &quot;Brain On Raw Krack&quot;, you
decide) just so he could write</p>
<pre>
   my $cheffy = $recipe.iterator;
   $cheffy.bork.bork.bork;</pre>
<p>Damian appeared to take him seriously (well, not about the bork thing,
but the post wasn't just about the silliness).</p>
<p>All of which eventually led to Damian's rather sensible proposal on
the semantics of <code>&lt;...&gt;</code>, which is well worth a read. The rest of
the thread was spent with people asking for a few clarifications.</p>
<p>Quote of the Thread:</p>
<pre>
   Damian: &quot;Think Of It As Evolution In Action&quot;
   Austin: This coming from someone whose national bird is
       the platypus</pre>
<p>Hey, it made me laugh.</p>
<p><a href="http://groups.google.com/groups?threadm=3DD843FC.1030008%40conway.org">http://groups.google.com/groups</a></p>
<p><a href="http://groups.google.com/groups?threadm=3DD9AE1D.9020303%40vulpes.com">http://groups.google.com/groups</a></p>
<p><a href="http://groups.google.com/groups?threadm=20021118181622.3030.qmail%40web12307.mail.yahoo.com">http://groups.google.com/groups</a></p>
<p><a href="http://groups.google.com/groups?threadm=3DD9A74C.205%40conway.org">http://groups.google.com/groups</a> -- semantics of <code>&lt;...&gt;</code></p>

<h4><a name="superpositions_and_laziness">Superpositions and Laziness</a></h4>
<p>Piers Cawley failed to change the subject line as he asked about
runtime class creation. He wanted to know if one could do:</p>
<pre>
    class {
        push @ISA, $parent_class;
        ...
    }</pre>
<p>Damian sincerely hoped not. Frankly, so does Piers, what he really
wants is a nice interface to Class:</p>
<pre>
    Class.new( isa =&gt; $class ) {
        method { ... }
        method { ... }
    }</pre>
<p>But so far everybody has ignored that post...</p>
<p><a href="http://groups.google.com/groups?threadm=84of8kd2xk.fsf%40despairon.bofh.org">http://groups.google.com/groups</a></p>

<h4><a name="dynamic_scoping_(take_2)">Dynamic scoping (take 2)</a></h4>
<p>Ralph Mellor posted a summary of his understanding of dynamic scoping
with <code>temp</code> and <code>let</code> and went on to propose a system of implicit
argument passing, intended to get 'round the perceived problem of
threading and dynamic scope not playing well together. Larry pointed
out that Ralph seemed to have a misapprehension about Perl threads
where, unless a variable is explicitly marked as shared between
threads then dynamically scoped variables work just fine. Larry went
on to discuss some rather splendid extensions of the currying concept:</p>
<pre>
   use Dog.assuming(tail =&gt; &quot;cut short&quot;, ears =&gt; &quot;cut_long&quot;)
   my $little_dog = Dog.where_oh_where();</pre>
<p>Which is rather cute.</p>
<p><a href="http://groups.google.com/groups?threadm=0db401c29363%24a3d229a0%246601a8c0%40ralph">http://groups.google.com/groups</a></p>
<p><a href="http://groups.google.com/groups?threadm=20021125181919.GA10720%40wall.org">http://groups.google.com/groups</a></p>


<h3><a name="meanwhile,_on_the_documentation_list">Meanwhile, on the documentation list</a></h3>
<p>The Documentation list continued its mission to explain, spending the
week working on Numeric Literals, producing a 5th summary of what is
known.</p>
<p><a href="http://groups.google.com/groups?threadm=95AB858A-00A0-11D7-9C01-00050245244A%40cognitivity.com">http://groups.google.com/groups</a></p>


<h3><a name="in_brief">In brief</a></h3>
<p>Last week, Brent Dax stated that we'd have to write Perl6 in Perl
'because otherwise we can't have the self modifying grammars'. Which
caused Simon Cozens to wonder why he'd been spending so much time
writing self modifying parsers in C.</p>
<p>Joseph F. Ryan has been writing tests for numeric and string literals
and keeping them in sync with discussions on
perl6-documentation. Thanks Joseph.</p>
<p>David Robins wondered when the long double bug would be fixed. Nobody
quite knows, but Dan is working on it, once he gets a compiler back up
on his long double machine.</p>


<h3><a name="who's_who_in_perl_6">Who's Who in Perl 6?</a></h3>
<dl>
<dt><strong><a name="item_who_are_you%3f">Who are you?</a></strong><br />
</dt>
<dd>
Nicholas Clark
</dd>

<dt><strong><a name="item_what_do_you_do_for%2fwith_perl_6%3f">What do you do for/with Perl 6?</a></strong><br />
</dt>
<dd>
Lurk. Sadly I usually generate more e-mail than code. I sometimes dabble in
fixing compiler warnings, the ARM JIT, and anything else that seems
interesting to me. It's a good thing I'm not expected to do anything
important, as parrot would never get finished if were.
</dd>

<dt><strong><a name="item_where_are_you_coming_from%3f">Where are you coming from?</a></strong><br />
</dt>
<dd>
Well, porting Perl5 to RISC OS, then getting gradually sucked into being a
core Perl5 porter. I keep seeing things that look fun to implement which
no-one else seems to want to do, so I try to implement them myself.
</dd>

<dt><strong><a name="item_when_do_you_think_perl_6_will_be_released%3f">When do you think Perl 6 will be released?</a></strong><br />
</dt>
<dd>
Before perl 5.10
However, I doubt Perl 6 will be ready by 1st April next year :-(
</dd>
<dd>
<p>I believe that the parrot engine will become substantially useful by the
middle of next year. However, I expect that the Perl 6 language design will
not be complete by then, let alone implemented, let alone implemented
optimally. So I suspect that the first real users of the parrot engine will
be &quot;other&quot; languages. It's a shame that many of the major dynamic languages
which could be implemented on top of parrot don't have anywhere near the
level of regression tests that Perl does, as I'm told that this lack of
tests makes it much harder to go about writing a re-implementation.
I blame Schwern for making it too easy for Perl people to write tests :-)</p>
</dd>

<dt><strong><a name="item_why_are_you_doing_this%3f">Why are you doing this?</a></strong><br />
</dt>
<dd>
The perl5 internals are a complete mess. It's like Jenga - to get the perl5
tower taller and do something new you select a block somewhere in the middle,
with trepidation pull it out slowly, and then carefully balance it somewhere
new, hoping the whole edifice won't collapse as a result.
The only long term solution to the perl5 internals is a complete re-write,
and far too many corner cases of perl5 (as well as all of XS) actually
depend on how bits of the internals work, so an internals only re-write
isn't going to be possible without some changes at the language level.
And as the language itself has to change, then it might as well progress
too.
</dd>

<dt><strong><a name="item_you_have_5_words%2e_describe_yourself%2e">You have 5 words. Describe yourself.</a></strong><br />
</dt>
<dd>
incorrigible pragmatic noisy pedantic perfectionist
</dd>

<dt><strong><a name="item_do_you_have_anything_to_declare%3f">Do you have anything to declare?</a></strong><br />
</dt>
<dd>
I've probably just contradicted myself. It wouldn't be the first time.
On, and I can't code anywhere near as fast as I can talk. Sorry.
</dd>
</dl>


<h3><a name="acknowledgements">Acknowledgements</a></h3>
<p>Proofreading was once again provided by Aspell and myself. I really
should start writing this thing on Mondays again, then I'd have time
to get it properly proofread by other human beings. Ah well. Next
week.</p>
<p>I've been getting some interesting mail recently about Perl 6 and what
it's doing from people who aren't active on the mailing lists, to the
extent that I'm thinking of adding a `letters to the editor' section
(assuming I ever find the time). Is this a good idea? Am I even madder
than you thought I was? What day is this? Are you the nurse? Only they
tell me I'm not supposed to talk to strangers...</p>
<p>Ahem.</p>
<p>Here's the chorus once more:</p>
<p>If you didn't like the summary, what are you doing still reading it?
If you did like it, please consider one or both of the following
options:</p>
<ul>
<li>
Send money to the Perl Foundation at
<a href="http://donate.perl-foundation.org/">http://donate.perl-foundation.org/</a> and help support the ongoing
development of Perl 6.</li>

<li>
Send feedback, flames, money and/or a Nikon Coolscan 4000 ED to
<em><a href="mailto:pdcawley@bofh.org.uk">pdcawley@bofh.org.uk</a></em>. (One of these days, this is going to
work...)</li>
</ul>
<p>The fee paid for publication of these summaries on perl.com is paid
directly to the Perl Foundation.</p>

        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1396" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2002/11/27/classdbi.html" rel="bookmark">Class::DBI</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Tony Bowden</span> on <abbr class="published" title="2002-11-27T00:00:00-08:00">November 27, 2002 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            

<p>Several articles on Perl.com, including the recent 
<a href="/pub/a/2002/10/22/phrasebook.html">Phrasebook
Design Pattern</a>, have discussed the problems faced when writing
Perl code that interacts with a database. Terrence Brannon's 
<a href="/pub/a/2001/02/dbix.html">DBIx::Recordset</a>
article attempted to show how code dealing with databases can be made
simpler, and more maintainable. In this article, I will try to show how
<code>Class::DBI</code> can make this easier still.</p>

<p><code>Class::DBI</code> prizes laziness and simplicity. Its goal is to make simple
database interactions trivial, while leaving the hard ones possible.
For many simple applications, it replaces the need for writing SQL
entirely. On the other hand, it doesn't force you to build complex data
structures to specify a complex query; if you really need the power or
expressiveness of raw SQL, then it gets out of your way and lets you drop back
to that.</p>
<p>The easiest way to see <code>Class::DBI</code> in action is to build a simple
application with it. In this article, I'll build a tool for performing
analysis on my telephone bill.</p>

<csperl file="grab" domain="on" record="b/522" template="article_sidebar2.view">

<p><a href="http://search.cpan.org/author/TMTM/Data-BT-PhoneBill-0.94/">Data::BT::PhoneBill</a>
(available from CPAN), provides a simple interface to a phone bill
downloaded from the BT Web site. So, armed with this module, and a few
recent phonebills, let's store these details in a database, and see how
to extract useful information from them.
</p>

<p><code>Class::DBI</code> works on the basis that each table in your database has a
corresponding class. Although each class could set up its own connection
information, it's a better idea to encapsulate that connection in one
class, and have all the others inherit from that. So, we set up our
database, and create the base class for our application:</p>
<pre><code>
  package My::PhoneBill::DBI;

  use base 'Class::DBI';

  __PACKAGE__-&gt;set_db('Main', 'dbi:mysql:phonebill', 'u/n', 'p/w');

  1;</code></pre>
<p>We simply inherit from <code>Class::DBI</code> and use the '<code>set_db</code>' method to set up
the connection information for our database. That's all we need in this
class for now, so next we set up our table for storing the phone call
information:</p>
<pre><code>
  CREATE TABLE call (
    callid      MEDIUMINT UNSIGNED NOT NULL PRIMARY KEY AUTO_INCREMENT,
    number      VARCHAR(20) NOT NULL,
    destination VARCHAR(255) NOT NULL,
    calldate    DATE NOT NULL,
    calltime    TIME NOT NULL,
    type        VARCHAR(50) NOT NULL,
    duration    SMALLINT UNSIGNED NOT NULL,
    cost        FLOAT(8,1)
  );</code></pre>
<p>For this, we set up a corresponding class:</p>
<pre><code>
  package My::PhoneBill::Call;

  use base 'My::PhoneBill::DBI';

  __PACKAGE__-&gt;table('call');
  __PACKAGE__-&gt;columns(All   =&gt; 
    qw/callid number destination calldate calltime type duration cost/);

  1;</code></pre>
<p>We inherit our connection information from our base class, and then
specify what table we're dealing with, and what its columns are.
Now we have enough to populate the table.</p>
<p>So, we create a simple, &quot;<em>populate_phone_bill</em>&quot; script:</p>
<pre><code>
  #!/usr/bin/perl

  use Data::BT::PhoneBill;
  use My::PhoneBill::Call;

  my $file = shift or die &quot;Need a phone bill file&quot;;
  my $bill = Data::BT::PhoneBill-&gt;new($file) or die &quot;Can't parse bill&quot;;

  while (my $call = $bill-&gt;next_call) {
    My::PhoneBill::Call-&gt;create({
      number      =&gt; $call-&gt;number,
      calldate    =&gt; $call-&gt;date,
      calltime    =&gt; $call-&gt;time,
      destination =&gt; $call-&gt;destination,
      duration    =&gt; $call-&gt;duration,
      type        =&gt; $call-&gt;type,
      cost        =&gt; $call-&gt;cost,
    });
  }</code></pre>
<p>The <code>create()</code> call runs the SQL to <code>INSERT</code> the row for each call. As we're
using <code>Class::DBI</code>, and have defined our primary key column to be
<code>AUTO_INCREMENT</code>, we don't need to specify a value for that column. On databases
that support sequences, we could also inform <code>Class::DBI</code> what sequence
should be used to provide the primary key.</p>
<p>Now that we have a table populated with calls, we can begin to run
queries against it. Let's write a simple script that reports on all the
calls to a specified number:</p>
<pre><code>
  #!/usr/bin/perl
  
  use My::PhoneBill::Call;
  
  my $number = shift or die &quot;Usage: $0 &lt;number&gt;&quot;;
  
  my @calls = My::PhoneBill::Call-&gt;search(number =&gt; $number);
  my $total_cost = 0;
  
  foreach my $call (@calls) {
    $total_cost += $call-&gt;cost;
    printf &quot;%s %s - %d secs, %.1f pence\n&quot;,
      $call-&gt;calldate, $call-&gt;calltime, $call-&gt;duration, $call-&gt;cost;
  }
  printf &quot;Total: %d calls, %d pence\n&quot;, scalar @calls, $total_cost;</code></pre>
<p>Here we can see that <code>Class::DBI</code> provides a '<code>search</code>' method for us
to use. We supply a hash of column/value pairs, and we get back all the
records that matched. Each result is an instance of the <code>Call</code> class,
and each has an accessor method corresponding to each column. (It's also
a mutator method, so we can update that record, but we're only reporting
at this stage).</p>
<p>So, if we want to see how often we're calling the Speaking Clock, then
we run</p>
<pre><code>
  &gt; perl calls_to 123
  2002-09-17 11:06:00 - 5 secs, 8.5 pence
  2002-10-19 21:20:00 - 8 secs, 8.5 pence
  Total: 2 calls, 17 pence</code></pre>
<p>Similarly, if we want to see all the calls on a given date, then we could
have a '<code>calls_on</code>' script:</p>
<pre><code>
  #!/usr/bin/perl
  
  use My::PhoneBill::Call;
  
  my $date = shift or die &quot;Usage: $0 &lt;date&gt;&quot;;
  
  my @calls = My::PhoneBill::Call-&gt;search(calldate =&gt; $date);
  my $total_cost = 0;
  
  foreach my $call (@calls) {
    $total_cost += $call-&gt;cost;
    printf &quot;%s) %s - %d secs, %.1f pence\n&quot;,
      $call-&gt;calltime, $call-&gt;number, $call-&gt;duration, $call-&gt;cost;
  }
  printf &quot;Total: %d calls, %d pence\n&quot;, scalar @calls, $total_cost;</code></pre>
<p>Running it gives:</p>
<pre><code>
  &gt; perl calls_on 2002-10-19
  ...
  18:36:00) 028 9024 4222 - 41 secs, 4.2 pence
  21:20:00) 123 - 8 secs, 8.5 pence
  ...
  Total: 7 calls, 92 pence</code></pre>
<p>As promised, we've written a database application without writing any
SQL. OK, so we haven't really done anything very complicated yet, but
even for this simplistic use <code>Class::DBI</code> makes our life much easier.</p>
<p>
</p>
<h2><a name="building_a_phone_book">Building a Phone Book</a></h2>
<p>I used to have a good memory for phone numbers. But Nokia, Ericsson, et
al, have conspired against me. By giving my cell phone a built-in address
book, they ensured that the part of my brain responsible for remembering
10 or 11 digit numbers would gradually atrophy. Now, when I look at the
output of '<code>calls_on</code>', I have no idea who &quot;028 9024 4222&quot; represents. So,
let's build an address book that can store this information, and then
change our reports to use it.</p>
<p>The first thing we should do is arrange our information a little better.
We'll take the <code>number</code> and <code>destination</code> columns, and move them to a
&quot;recipient&quot; table, to which we'll add a <code>name</code> column. &quot;Destination&quot; doesn't
make as much sense when associated with the number, rather than the call,
so we'll rename it to &quot;location&quot;.</p>
<pre><code>
  CREATE TABLE recipient (
    recipid  MEDIUMINT UNSIGNED NOT NULL PRIMARY KEY AUTO_INCREMENT,
    number   VARCHAR(20) NOT NULL,
    location VARCHAR(255) NOT NULL,
    name     VARCHAR(255),
    KEY (number)
  );</code></pre>
<p>And then we create the relevant class for this table:</p>
<pre><code>
  package My::PhoneBill::Recipient;
  
  use base 'My::PhoneBill::DBI';
  
  __PACKAGE__-&gt;table('recipient');
  __PACKAGE__-&gt;columns(All =&gt; qw/recipid number location name/);

  1;</code></pre>
<p>We also need to modify the Call table:</p>
<pre><code>
  CREATE TABLE call (
    callid    MEDIUMINT UNSIGNED NOT NULL PRIMARY KEY AUTO_INCREMENT,
 *  recipient MEDIUMINT UNSIGNED NOT NULL,
    calldate  DATE NOT NULL,
    calltime  TIME NOT NULL,
    type      VARCHAR(50) NOT NULL,
    duration  SMALLINT UNSIGNED NOT NULL,
    cost      FLOAT(8,1),
 *  KEY (recipient)
  );</code></pre>
<p>and its associated class:</p>
<pre><code>
  package My::PhoneBill::Call;
  
  use base 'My::PhoneBill::DBI';
  
  __PACKAGE__-&gt;table('call');
  __PACKAGE__-&gt;columns(All   =&gt;
 *  qw/callid recipient calldate calltime type duration cost/);
  
  1;</code></pre>
<p>Then we can modify our script that populates the database:</p>
<pre><code>
  #!/usr/bin/perl

  use Data::BT::PhoneBill;
  use My::PhoneBill::Call;
 *use My::PhoneBill::Recipient;

  my $file = shift or die &quot;Need a phone bill file&quot;;
  my $bill = Data::BT::PhoneBill-&gt;new($file) or die &quot;Can't parse bill&quot;;

 *while (my $call = $bill-&gt;next_call) {
 *  my $recipient = My::PhoneBill::Recipient-&gt;find_or_create({
 *    number      =&gt; $call-&gt;number,
 *    location    =&gt; $call-&gt;destination,
 *  });
 *  My::PhoneBill::Call-&gt;create({
 *    recipient   =&gt; $recipient-&gt;id,
      calldate    =&gt; $call-&gt;date,
      calltime    =&gt; $call-&gt;time,
      duration    =&gt; $call-&gt;duration,
      type        =&gt; $call-&gt;type,
      cost        =&gt; $call-&gt;cost,
    });
  }</code></pre>
<p>This time we need to create the <code>Recipient</code> first, so we can link to it
from the <code>Call</code>. But we don't want to create a new <code>Recipient</code> for each call -
if we've ever rang this person before, there'll already be an entry
in the recipient table: so we use <code>find_or_create</code> to give us back the
existing entry if it's there, or else create a new one.</p>
<p>With the table repopulated we can return to our reporting scripts.</p>
<p>Our <code>calls_on</code> script now fails as we can can't ask a call for its
'number'. So, we change it to:</p>
<pre><code>
  #!/usr/bin/perl
  
  use My::PhoneBill::Call;
  
  my $date = shift or die &quot;Usage: $0 &lt;date&gt;&quot;;
  
  my @calls = My::PhoneBill::Call-&gt;search(calldate =&gt; $date);
  my $total_cost = 0;
  
  foreach my $call (@calls) {
    $total_cost += $call-&gt;cost;
    printf &quot;%s) %s - %d secs, %.1f pence\n&quot;,
 *    $call-&gt;calltime, $call-&gt;recipient, $call-&gt;duration, $call-&gt;cost;
  }
  printf &quot;Total: %d calls, %d pence\n&quot;, scalar @calls, $total_cost;</code></pre>
<p>However, running it doesn't really give us what we want:</p>
<pre><code>
  &gt; perl calls_on 2002-10-19
  ...
  18:36:00) 67 - 41 secs, 4.2 pence
  21:20:00) 47 - 8 secs, 8.5 pence
  ...
  Total: 7 calls, 92 pence</code></pre>
  
  













  
<p>Instead of getting the phone number, we now get the ID from the
recipient table, which is just an auto-incrementing value.</p>
<p>To turn this into a sensible value, we add the following line to the
<code>Call</code> class:</p>
<pre><code>
  __PACKAGE__-&gt;has_a(recipient =&gt; 'My::PhoneBill::Recipient');</code></pre>
<p>This tells it that the recipient method doesn't just return a simple
value, but that that value should be automatically turned into an instance
of the Recipient class.</p>
<p>Of course, calls_on still won't be correct:</p>
<pre><code>
  &gt; perl calls_on 2002-10-19
  ...
  18:36:00) My::PhoneBill::Recipient=HASH(0x835b6b8) - 41 secs, 4.2 pence
  21:20:00) My::PhoneBill::Recipient=HASH(0x835a210) - 8 secs, 8.5 pence
  ...
  Total: 7 calls, 92 pence</code></pre>
<p>But now all it takes is a small tweak to the script:</p>
<pre><code>
    printf &quot;%s) %s - %d secs, %.1f pence\n&quot;,
      $call-&gt;calltime, $call-&gt;recipient-&gt;number, $call-&gt;duration, $call-&gt;cost;</code></pre>
<p>And now everything is working perfectly again:</p>
<pre><code>
  &gt; perl calls_on 2002-10-19
  ...
  18:36:00) 028 9024 4222 - 41 secs, 4.2 pence
  21:20:00) 123 - 8 secs, 8.5 pence
  ...
  Total: 7 calls, 92 pence</code></pre>
<p>The <code>calls_to</code> script is slightly trickier, as the initial search is now
on the recipient rather than the call.</p>
<p>So, we change the initial search to:</p>
<pre><code>
  my ($recipient) = My::PhoneBill::Recipient-&gt;search(number =&gt; $number)
    or die &quot;No calls to $number\n&quot;;</code></pre>
<p>Then we need to get all the calls to that recipient. For this, we need to
inform <code>Recipient</code> of the relationship with calls. Unlike the <code>has_a</code> we
just set up in the <code>Call</code> class, the recipient table doesn't store any value
concerned with the call table that could be inflated on demand. Instead
we need to add a <code>has_many</code> declaration to Recipient:</p>
<pre><code>
  __PACKAGE__-&gt;has_many(calls =&gt; 'My::PhoneBill::Call');</code></pre>
<p>This creates a new method <code>calls</code> for each Recipient object, returning
a list of <code>Call</code> objects whose <code>recipient</code> method is our primary key.</p>
<p>So, having found our recipient in the <code>calls_to</code> script, we can simply
ask:</p>
<pre><code>
  my @calls = $recipient-&gt;calls;</code></pre>
<p>And now the script works just as before:</p>
<pre><code>
  #!/usr/bin/perl
  
  use My::PhoneBill::Recipient;
  
  my $number = shift or die &quot;Usage: $0 &lt;number&gt;&quot;;
  
  my ($recipient) = My::PhoneBill::Recipient-&gt;search(number =&gt; $number)
    or die &quot;No calls to $number\n&quot;;
  my @calls = $recipient-&gt;calls;
  
  my $total_cost = 0;
  
  foreach my $call (@calls) {
    $total_cost += $call-&gt;cost;
    printf &quot;%s %s - %d secs, %.1f pence\n&quot;,
      $call-&gt;calldate, $call-&gt;calltime, $call-&gt;duration, $call-&gt;cost;
  }
  printf &quot;Total: %d calls, %d pence\n&quot;, scalar @calls, $total_cost;</code></pre>
<p>And now we can get the old results again:</p>
<pre><code>
  &gt; perl calls_to 123
  2002-09-17 11:06:00 - 5 secs, 8.5 pence
  2002-10-19 21:20:00 - 8 secs, 8.5 pence
  Total: 2 calls, 17 pence</code></pre>
<p>Next we need a script to give a name to a number in our address book:</p>
<pre><code>
  #!/usr/bin/perl
  
  use My::PhoneBill::Recipient;
  
  my($number, $name) = @ARGV;
  die &quot;Usage $0 &lt;number&gt; &lt;name&gt;\n&quot; unless $number and $name;
  
  my $recip = My::PhoneBill::Recipient-&gt;find_or_create({number =&gt; $number});
  my $old_name = $recip-&gt;name;
  $recip-&gt;name($name);
  $recip-&gt;commit;
  
  if ($old_name) {
    print &quot;OK. $number changed from $old_name to $name\n&quot;;
  } else {
    print &quot;OK. $number is $name\n&quot;;
  }</code></pre>
<p>This lets us associate a number to a name:</p>
<pre><code>
  &gt; perl add_phone_number 123 &quot;Speaking Clock&quot;
  OK. 123 is Speaking Clock</code></pre>
<p>And now with a tiny change to our calls_on script we can output the name
where known:</p>
<pre><code>
    printf &quot;%s) %s - %d secs, %.1f pence\n&quot;,
      $call-&gt;calltime, $call-&gt;recipient-&gt;name || $call-&gt;recipient-&gt;number,
      $call-&gt;duration, $call-&gt;cost;

  &gt; perl calls_on 2002-10-19
  ...
  18:36:00) 028 9024 4222 - 41 secs, 4.2 pence
  21:20:00) Speaking Clock - 8 secs, 8.5 pence
  ...
  Total: 7 calls, 92 pence</code></pre>
<p>To allow the <code>calls_to</code> script to work if we give it either a name or a
number, we can use:</p>
<pre><code>
  my $recipient = My::PhoneBill::Recipient-&gt;search(name =&gt; $number)
               || My::PhoneBill::Recipient-&gt;search(number =&gt; $number)
               || die &quot;No calls to $number\n&quot;;</code></pre>
<p>However, as we've called search in scalar context, rather than the
normal list context, we get back an interator rather than an individual
<code>Recipient</code> object. As one name may map to multiple numbers, we need to
iterate over each of these in turn:</p>
<pre><code>
    my @calls;
    while (my $recip = $recipient-&gt;next) {
      push @calls, $recip-&gt;calls;
    }</code></pre>
<p>(Printing individual totals for each number is left as an exercise for
the reader.)</p>
<pre><code>
  &gt; perl calls_to &quot;Speaking Clock&quot;
  2002-09-17 11:06:00 - 5 secs, 8.5 pence
  2002-10-19 21:20:00 - 8 secs, 8.5 pence
  Total: 2 calls, 17 pence</code></pre>
<p>
</p>
<h2><a name="working_with_other_modules">Working With Other Modules</a></h2>
<p>Sometimes the information we store in the database can be used to work
with non-<code>Class::DBI</code> modules. For example, if we wanted to format the
dates of our calls differently, we might like to turn them into
<code>Date::Simple</code> objects. Again, <code>Class::DBI</code> makes this easy.</p>
<p>In the <code>Call</code> class, we again use <code>has_a</code> to declare this relationship:</p>
<pre><code>
  __PACKAGE__-&gt;has_a(recipient =&gt; 'My::PhoneBill::Recipient');
 *__PACKAGE__-&gt;has_a(calldate  =&gt; 'Date::Simple');</code></pre>
<p>Now, when we fetch the <code>calldate</code> it is automatically inflated to a
<code>Date::Simple</code> object. So, we can change the output of <code>calls_to</code> to print
the date in a nicer format:</p>
<pre><code>
  printf &quot;%s %s - %d secs, %.1f pence\n&quot;,
    $call-&gt;calldate-&gt;format(&quot;%d %b&quot;), $call-&gt;calltime,
    $call-&gt;duration, $call-&gt;cost;
 
  &gt; perl calls_to &quot;Speaking Clock&quot;
  17 Sep 11:06:00 - 5 secs, 8.5 pence
  19 Oct 21:20:00 - 8 secs, 8.5 pence
  Total: 2 calls, 17 pence</code></pre>
<p><code>Class::DBI</code> assumes that any non-<code>Class::DBI</code> class is inflated through a
<code>new</code> method, and can be deflated through stringification. As both of
these are true for <code>Date::Simple</code>, we didn't need to do anything more. If
this is not the case - for example, if you wanted to use <code>Time::Piece</code> instead
of <code>Date::Simple</code> - you need to tell <code>Class::DBI</code> how to do the inflating
and deflating as the value goes in and comes out of the database.</p>
<pre><code>
  __PACKAGE__-&gt;has_a(calldate =&gt; 'Time::Piece',
    inflate =&gt; sub { Time::Piece-&gt;strptime(shift, &quot;%Y-%m-%d&quot;) },
    deflate =&gt; 'ymd'
  );</code></pre>
<p>Deflating a <code>Time::Piece</code> object back to an ISO date string suitable for
MySQL is quite simple: you can just call its <code>ymd()</code> method. Thus we can
specify this as a string. Inflating is more difficult, as it requires a
two argument call to <code>strptime()</code>. Thus we need to specify this as a
subroutine reference. When inflating, this is called with the value from
the database as its one and only argument. Thus, we can pass that to
<code>Time::Piece</code>'s <code>strptime</code> method, specifying the format to instantiate
from.</p>
<p>Using <code>Time::Piece</code> instead of <code>Date::Time</code> requires one further change to
to our output script:</p>
<pre><code>
  printf &quot;%s %s - %d secs, %.1f pence\n&quot;,
 *  $call-&gt;calldate-&gt;strftime(&quot;%d %b&quot;), $call-&gt;calltime,
    $call-&gt;duration, $call-&gt;cost;</code></pre>
<p>
</p>
<h2><a name="most_called_numbers">MOST CALLED NUMBERS</a></h2>
<p>BT provide a service that allows you to save money on 10 numbers of your
choice. So it would be useful if we were able to find out which numbers
we spend the most money calling. We'll assume that any number we've only
ever called once isn't worth adding to our list, as it was probably a
one-off call. Thus we want the 10 numbers with the highest spend that
have had more than one call.</p>
<p>As we said earlier, <code>Class::DBI</code> doesn't attempt to provide a syntax to
express any arbitrary SQL, so there's no way of asking directly for
this information. Instead, we'll try a simple approach.</p>
<p>Firstly we'll add a method to the <code>Recipient</code> class to tell us the total
we've spent on calls to that number:</p>
<pre><code>
  use List::Util 'sum';

  sub total_spend {
    my $self = shift;
    return sum map $_-&gt;cost, $self-&gt;calls;
  }</code></pre>
<p>Then we can create a <code>top_ten</code> script:</p>
<pre><code>
  #!/usr/bin/perl
  
  use My::PhoneBill::Recipient;
  
  my @recipients = My::PhoneBill::Recipient-&gt;retrieve_all;
  my @regulars = grep $_-&gt;calls &gt; 1, @recipients;
  my @sorted = sort { $b-&gt;total_spend &lt;=&gt; $a-&gt;total_spend } @regulars;
  
  foreach my $recip (@sorted[0 .. 9]) {
    printf &quot;%s - %d calls = %d pence\n&quot;,
      $recip-&gt;name || $recip-&gt;number,
      scalar $recip-&gt;calls,
      $recip-&gt;total_spend;
  }</code></pre>
<p>This is very slow, however, once you have more than a few hundred calls
stored in your database. This is mainly because we're sorting based on a
method call. Replacing the sort above with a Schwartzian Transform
speeds everything up significantly:</p>
<pre><code>
  my @sorted = map $_-&gt;[0],
    sort { $b-&gt;[1] &lt;=&gt; $a-&gt;[1] }
    map [ $_, $_-&gt;total_spend ], @regulars;</code></pre>
<p>Now, until the database gets significantly bigger, this is probably fast
enough - especially as you probably won't be running the script very
often.</p>
<p>However, if this isn't enough, then we can always drop back to SQL. Of
course, when we need to optimize for speed, we usually lose something
else - in this case, portability. In this example, we're using MySQL, so I
would add the relevant MySQL-specific query to <em>Recipient.pm</em>:</p>
<pre><code>
  __PACKAGE__-&gt;set_sql(top_ten =&gt; qq{
    SELECT recipient.recipid,
           SUM(call.cost) AS spend,
           COUNT(call.callid) AS calls
      FROM recipient, call
     WHERE recipient.recipid = call.recipient
     GROUP BY recipient.recipid
    HAVING calls &gt; 1
     ORDER BY spend DESC
     LIMIT 10
  });</code></pre>
<p>Then we can set up a method that returns the relevant objects for these:</p>
<pre><code>
  sub top_ten {
    my $class = shift;
    my $sth = $class-&gt;sql_top_ten;
       $sth-&gt;execute;
    return $class-&gt;sth_to_objects($sth);
  }</code></pre>
<p>Any SQL set up using <code>set_sql</code> can be retrieved as a readily prepared DBI
statement handle by prepending its name with <code>sql_</code> - thus we fetch back
this <code>top_ten</code> using <code>my $sth = $class-&gt;sql_top_ten</code>;</p>
<p>Although we could happily execute this and then call any of the
traditional DBI commands (<code>fetchrow_array</code> etc.), we can also take a
shortcut. As one of the columns being returned from our query is the
primary key of the Recipient, we can simply feed the results into the
underlying method in <code>Class::DBI</code> that allows searches to return a list
of objects, <code>sth_to_objects</code>.</p>
<p>So, our script becomes simply:</p>
<pre><code>
  foreach my $recip (My::PhoneBill::Recipient-&gt;top_ten) {
    printf &quot;%s - %d calls = %d pence\n&quot;,
      $recip-&gt;name || $recip-&gt;number,
      scalar $recip-&gt;calls,
      $recip-&gt;total_spend;
  }</code></pre>
<p>As we have seen, <code>Class::DBI</code> makes it possible to perform many of the
common database tasks completely trivially - without writing a single
line of SQL. But, when you really need it, it's fairly easy to 
write the SQL that you need and execute it.</p>


        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1404" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2002/11/p6pdigest/20021121.html" rel="bookmark">This week on Perl 6 (11/10-11/17, 2002)</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Piers Cawley</span> on <abbr class="published" title="2002-11-21T00:00:00-08:00">November 21, 2002 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            <p>&quot;Oh! my ears and whiskers, I'm late!&quot;</p>
<p>It's 0650, it's 20021120 and I've only just started writing the
summary. Call me lazy, call me a shirker, call me anything you damn
well please, just don't interrupt me while I'm writing this.</p>
<p>Yup, it's past time for another peek into the lives of those strange
beings we call the Perl 6 development community, starting off, as
usual, with the perl6-internals crew.</p>


<h4><a name="quick_roadmap">Quick Roadmap</a></h4>
<p>Dan returned unscathed from this year's Lightweight Languages workshop
and presented a short roadmap for the next few miles. Dan reckons that
if we hit all those milestones, then we'll have a complete imperative
core -- which will be nice.</p>
<p><a href="http://groups.google.com/groups?threadm=a05200f02b9f4e530802a%40%5B63.120.19.221%5D">http://groups.google.com/groups</a></p>


<h4><a name="branch_dump">Branch Dump</a></h4>
<p>Michael Collins stuck his head above the parapet to report that using
<code>branch</code> provoked a core dump on his Linux setup. It turned out to be
a problem with his code. Dan debugged his code and offered a
reasonably full explanation of how parrot's <code>branch</code> actually works
(and why you should really use labels in hand written assembler.)
Gopal V worried that allowing branches to non-instructions was unsafe
and wondered whether, at least, a <code>parrot -fverify</code> switch might be in
order. Dan agreed, but his reasoning was somewhat different.</p>
<p>Elsewhere in the thread, Dan tells us that he wants safe interpreters
to be as safe as a locked down VMS system, but he's unsure as to
whether we'll reach that gaol. (Mmm ... nice typo there Piers, leave
it)</p>
<p><a href="http://groups.google.com/groups?threadm=3dcfc66e.132f.0%40bestweb.net">http://groups.google.com/groups</a></p>
<p><a href="http://groups.google.com/groups?threadm=a05200f06b9f57e64129f%40%5B63.120.19.221%5D">http://groups.google.com/groups</a></p>


<h4><a name="parrot_basic_2">Parrot BASIC 2</a></h4>
<p>Clinton A. Pierce announced his complete rewrite of BASIC for Parrot,
this time modeling his implementation on QuickBASIC. Here's a list of
the new features, lifted from Clint's announcement:</p>
<ul>
<li>
Compiled directly to Parrot Assembly</li>


<li>
Interpreted</li>


<li>
Richer syntax than Parrot BASIC 1.0, which was based on GW-BASIC</li>


<li>
Much, much faster than Parrot BASIC 1.0</li>


<li>
Support for user-defined types</li>


<li>
Support for variable scopes (but apparently, QuickBASIC scoping is
'bizarre')</li>

</ul>
<p>Nobody said anything -- I think they were rendered
speechless. However, I'd like to take the opportunity to use this
platform to say &quot;Yay Clint!&quot;. This is superb news. OK, so supporting
BASIC wasn't exactly Parrot's initial goal, but it's great to see that
a single hacker can implement such a complete language using Parrot.</p>
<p><a href="http://groups.google.com/groups?threadm=5.1.0.14.2.20021112001018.01c272c0%40www.geeksalad.org">http://groups.google.com/groups</a></p>


<h4><a name="scope_and_functions_in_languages/scheme">scope and functions in languages/scheme</a></h4>
<p>Not to be outdone by Clint's BASIC implementation, J&uuml;rgen
B&ouml;mmels has taken advantage of Jon Sillito's lexical scopes
patch to add functions to scheme (before it was just scheme syntax,
now it has some claim to being really scheme like). Bravo
J&uuml;rgen!</p>
<p><a href="http://groups.google.com/groups?threadm=rt-18379-41631.7.61250908467403%40bugs6.perl.org">http://groups.google.com/groups</a></p>


<h4><a name="leo_ttsch_is_the_patch_monster">Leo T&ouml;tsch is the Patch Monster</a></h4>
<p>This week, Leo has been mostly:</p>
<ul>
<li>
Fixing JIT to make it restartable</li>


<li>
Fixing JIT to make it play well with Perl 6</li>


<li>
Fixing JIT so you can see what's going on when you use gdb.</li>

</ul>
<p>And generally seeming to pop up with useful contributions in almost
every thread. Where does he find the time?</p>


<h4><a name="bootstrapping_perl_6">Bootstrapping Perl 6</a></h4>
<p>Marius Nita asked about the Perl 6 compiler, wondering what language
it'd be written in, Perl or C? Markus Laire thought it'd eventually
get written in Perl 6 or Parrot 'or something else which runs on
parrot.' Gopal V worried about the bootstrapping problem and asked
that the Perl 6 compiler be written in something other than Perl 6 in
an attempt to avoid a 'dependency hellhole'. Brent Dax pointed out
that we're pretty much obliged to write Perl 6 in Perl in order to get
the self modifying parser behaviour and noted that we'd ship it
as bytecode. Nicholas Clark pointed out that, strictly, you can't
build perl5 from scratch without an installation of perl5, but the
p5porters get 'round the problem by shipping the generated headers as
part of the perl5 tarball.</p>
<p>Dan points out that the goal is for Parrot to require a C compiler and
a platform shell or Make tool (either should do). Nicholas Clark
attempted to kick off a variant of Monty Python's 'Yorkshiremen' skit
(&quot;Make tool? Luxury! We 'ad to make do wi' a console and switches!&quot;
&quot;You were lucky! We used to 'ave to mek waves in' t'mercury delay line
wi' us tongues!&quot;), reckoning that it should be possible to get by with
just a C compiler and asked that we 'archive this message and hold it
against me when the time comes, and you're looking for someone to
prove it by making it work'.</p>
<p><a href="http://groups.google.com/groups?threadm=20021113004028.GA1013%40cs.pdx.edu">http://groups.google.com/groups</a></p>
<p><a href="http://groups.google.com/groups?threadm=20021113204703.GD287%40Bagpuss.unfortu.net">http://groups.google.com/groups</a> -- Archive this message</p>


<h4><a name="quick_note_on_jit_bits">Quick note on JIT bits</a></h4>
<p>Dan announced that he was about to 'do exceptions' and wanted to give
a heads up to everyone who does Odd Things (principally the
JITterbugs). The rule appears to be 'Don't monkey with the system
stack'. Leopold T&ouml;tsch wondered if that was actually the issue
Dan thought it was, but came up with a bunch of other issues to do
with register allocation, both at the parrot level and the processor
level. And then it all got too much for my brain to cope with.</p>
<p><a href="http://groups.google.com/groups?threadm=a05200f05b9f86159d071%40%5B63.120.19.221%5D">http://groups.google.com/groups</a></p>


<h4><a name="perl_6_test_organization">Perl 6 test organization</a></h4>
<p>Over in perl6-documentation, they're about to start producing Perl 6
language tests, so chromatic posted Brent Dax's suggestion about how
tests should be organized into sub directories. General response was
favourable (the current <em>languages/perl6</em> tests are somewhat
disorganized.)</p>
<p><a href="http://groups.google.com/groups?threadm=20021115045916.80260.qmail%40onion.perl.org">http://groups.google.com/groups</a></p>



<h3><a name="meanwhile,_in_perl6language">Meanwhile, in perl6-language</a></h3>
<p>The language list was relatively quiet this week. The Operator thread
seems to have reached a c&aelig;sura, but most of the current threads
seem to have spun off from issues raised in that monster.</p>


<h4><a name="unifying_invocant_and_topic_naming_syntax">Unifying invocant and topic naming syntax</a></h4>
<p>Discussion of ralph's proposals for changing the function declaration
syntax continued. Damian doesn't like the proposed changes, and has
been explaining to ralph why not. Nicholas Clark worries that a
function being able to access its caller's topic is 'an unrestricted
licence to commit action at a distance' (he says that like it's a bad
thing). Andrew Wilson pointed out that, unless you could access the
caller's topic you wouldn't be able to prototype things like <code>print</code>
(and if you can't get a prototype for something then you can't fully
override it). Damian added that it's also what Perl 5 does (except
Perl 5 does it without having the decency to declare anything)</p>
<p><a href="http://groups.google.com/groups?threadm=3DCF7C60.50206%40conway.org">http://groups.google.com/groups</a></p>


<h4><a name="superpositions_and_laziness">Superpositions and Laziness</a></h4>
<p>I'm not entirely sure why a thread titled 'Superpositions and
Laziness' should contain discussion of whether one should have a
'pure' property or a 'cached' one. Or both.</p>
<p>Meanwhile, in the 'laziness' side of the thread, Piers Cawley saw fit
to post a huge chunk of uncommented code which was described by Larry
as 'opaque, and not in a good way'. On rereading, I didn't think it
was <em>that</em> bad.</p>
<p>Larry also introduced the possibility of breaking the <code>operator:</code>
method of declaring operators up into <code>prefix:</code>, <code>infix:</code>,
<code>postfix:</code> and <code>circumfix:</code>.</p>
<p><a href="http://groups.google.com/groups?threadm=84lm3y5wmd.fsf%40despairon.bofh.org.uk">http://groups.google.com/groups</a></p>
<p><a href="http://groups.google.com/groups?threadm=3DCB8249.9000904%40conway.org">http://groups.google.com/groups</a></p>
<p><a href="http://groups.google.com/groups?threadm=20021113192627.GD14308%40wall.org">http://groups.google.com/groups</a></p>


<h4><a name="fmtwyentk_about_:=">FMTWYENTK about :=</a></h4>
<p>Last week, arcadi declined to expand 'FMTWYENTK about :='. This week we
discovered that it stands for 'Far More Than What You Ever Needed To
Know' (It was the 'what' that foxed me).</p>
<p>This week Damian supplied answers/clarifications. Next week, I'm
hoping for a lovely, consolidated document.</p>
<p><a href="http://groups.google.com/groups?threadm=3DCF951B.4090501%40conway.org">http://groups.google.com/groups</a></p>
<p><a href="http://homepages.tcp.co.uk/~nicholson/alice.html">http://homepages.tcp.co.uk/~nicholson/alice.html</a> -- Always worth a
read</p>


<h4><a name="continuations">Continuations</a></h4>
<p>Given the subject of the last link, I find it entirely appropriate
that the thread about coroutines and yield should be <em>called</em>
'Continuations', but I freely admit to an odd sense of humour.</p>
<p>It turns out that there are several different views as to what
coroutines should do, a few of the alternatives were discussed. Damian
thinks that the actual semantics chosen will probably have a good deal
to do with how Perl 6 iterators work. Luke Palmer, whose name should
live in infamy for this, declared that he was starting to like
coroutines because 'the elegantify stuff.'</p>
<p><a href="http://groups.google.com/groups?threadm=PGM.20021112143024.21223.2680%40edison.ioppublishing.com">http://groups.google.com/groups</a></p>
<p><a href="http://groups.google.com/groups?threadm=a05200f00b9fc8c449310%40%5B63.120.19.221%5D">http://groups.google.com/groups</a> -- Dan's expectations</p>
<p><a href="http://groups.google.com/groups?threadm=3DD6FF0B.7010901%40conway.org">http://groups.google.com/groups</a> -- Damian's initially preferred coroutines</p>
<p><a href="http://groups.google.com/groups?threadm=003f01c28e30%24e903a5e0%2402001aac%40t">http://groups.google.com/groups</a> -- 'Pythonic' coroutines</p>


<h4><a name="more_junctions_(or,_when_junctions_collapse)">More Junctions (or, When junctions collapse)</a></h4>
<p>Luke Palmer wondered about collapsing junctions. When a function
collapses a junction, does the junction collapse everywhere, or would
one have to make an explicit 'observation' to precipitate collapse?
Damian offered a reasonably complete discussion of the various
possibilities.</p>
<p>I offer the following without comment:</p>
<pre>
 When a junction hits a function and collapses down to one
 will it propagate the changes through the runtime? Oh, what fun!</pre>
<p><a href="http://groups.google.com/groups?threadm=20021113195049.88ECC2FD%40babylonia.flatirons.org">http://groups.google.com/groups</a></p>
<p><a href="http://groups.google.com/groups?threadm=3DD6DFBB.2000701%40conway.org">http://groups.google.com/groups</a></p>


<h4><a name="control_structures_i,_ii_and_iii">Control Structures I, II and III</a></h4>
<p>Timothy S. Nelson's suggested new control structures got discussed
this week. The general feeling seemed to be that what was proposed
didn't really offer much that was desperately useful over and above
the current control structures.</p>
<p><a href="http://groups.google.com/groups?threadm=Pine.LNX.4.44.0211150640020.2626-100000%40elphin.nelson.org.au">http://groups.google.com/groups</a></p>
<p><a href="http://groups.google.com/groups?threadm=Pine.LNX.4.44.0211150705590.2626-100000%40elphin.nelson.org.au">http://groups.google.com/groups</a></p>
<p><a href="http://groups.google.com/groups?threadm=Pine.LNX.4.44.0211150738130.2626-100000%40elphin.nelson.org.au">http://groups.google.com/groups</a></p>


<h4><a name="string_concatenation_operator">String concatenation operator</a></h4>
<p>Andy Wardley wondered whether we couldn't overload <code>+</code> to work as both
numeric addition and string concatenation. Answer: No.</p>
<p>Richard Proctor wondered if we couldn't get away with doing string
concatenation by juxtaposition ( <code>&quot;string &quot; &quot;foo&quot;</code> evaluates to
<code>&quot;string foo&quot;</code>.) Answer: No.</p>
<p>Larry had wise words the on subject of juxtapositional operators.</p>
<p><a href="http://groups.google.com/groups?threadm=20021114121947.GD90541%40cat.ourshack.com">http://groups.google.com/groups</a></p>
<p><a href="http://groups.google.com/groups?threadm=20021116054859.GA19489%40wall.org">http://groups.google.com/groups</a></p>



<h3><a name="meanwhile,_over_in_perl6documentation">Meanwhile, Over in perl6-documentation</a></h3>
<p>I'm still at something of a loss as to how to summarize this group
effectively. Essentially the goal of the perl6-documentation list is
to thrash out, in detail, the complete behaviour of Perl 6 and to
produce tests and documentation which amount to a detailed spec. Their
current project is 'literal values', and the work is ongoing.</p>
<p>There's been some debate as to documentation format of choice (current
thinking is 'POD with knobs'). Michael Lazzaro who, if he hasn't
officially been named documentation pumpking is doing a damn good job
as de facto 'Bey of the docs' has posted a working outline for Section
1 of the docs. Garrett Goebel appealed for some docs on writing good
tests for languages, which kicked off some debate about how tests
should communicate with the test harness. Angel Faus put up a first
cut at the 'literal values' subsection, and got a good amount of
feedback. Dave Storrs took on the 'glossary chap' role, and posted a
taster.</p>
<p>Dave is also the coordinator for 'Contributor License Forms', which
are rather important. Before you donate any docs to the Perl 6
Documentation project you must fill in the form assigning the license
to the Perl 6 project. Dave's post has the details.</p>
<p>Can you tell it was getting late when I wrote this section?</p>
<p><a href="http://groups.google.com/groups?threadm=68CCE3C1-F5A8-11D6-8B2E-00050245244A%40cognitivity.com">http://groups.google.com/groups</a> -- Section 1
outline</p>
<p><a href="http://groups.google.com/groups?threadm=71BEC0D4E1DED3118F7A009027B12028010BE60C%40EXCH_MISSION">http://groups.google.com/groups</a></p>
<p><a href="http://groups.google.com/groups?threadm=200211122103.30313.afaus%40corp.vlex.com">http://groups.google.com/groups</a> -- Literals, take 1</p>
<p><a href="http://groups.google.com/groups?threadm=200211131926.06428.afaus%40corp.vlex.com">http://groups.google.com/groups</a> -- Literals, take 2</p>
<p><a href="http://groups.google.com/groups?threadm=200211141958.55257.afaus%40corp.vlex.com">http://groups.google.com/groups</a> -- Numeric literals, take 1</p>
<p><a href="http://groups.google.com/groups?threadm=20021116221125.B31709%40megazone.bigpanda.com">http://groups.google.com/groups</a> -- Glossary</p>
<p><a href="http://groups.google.com/groups?threadm=20021117013117.D33607%40megazone.bigpanda.com">http://groups.google.com/groups</a> -- Contributor license forms</p>



<h3><a name="in_brief">In Brief</a></h3>
<p>Clinton A Pierce had problems building under Win32 -- I'm not entirely
sure the issue was resolved.</p>
<p>Jerome Quelin, backed up by Leon Brocard (Yay! I was wondering how I
was going to mention him this week) used his Befunge interpreter to
find bugs in PerlArray and string_append.</p>
<p>Daniel Grunblatt (or a better than reasonable facsimile) is back. This
made Leopold T&ouml;tsch and Steve Fink happy. And we like it when
they're happy. Welcome back Daniel.</p>
<p>The 'very complete lexical scopes' patch finally got applied this
week.</p>
<p>Tim Bunce pointed us at CCured, which looks interesting:
<a href="http://manju.cs.berkeley.edu/ccured/index.html">http://manju.cs.berkeley.edu/ccured/index.html</a></p>
<p>Jonathan Sillito offered a patch to turn Parrot subs into closures.</p>
<p>Arcadi wondered whether sigils were user extensible. Answer: Yes, but not
necessarily easily.</p>



<h3><a name="who's_who_in_perl_6">Who's Who in Perl 6?</a></h3>
<dl>
<dt><strong><a name="item_who_are_you%3f">Who are you?</a></strong>

</dt>
<dd>
Leopold T&ouml;tsch.  I'm an independent software developer, living in
Austria (this is the country near Liechtenstein w/o kangaroos).
</dd>


<dt><strong><a name="item_what_do_you_do_for%2fwith_perl_6%3f">What do you do for/with Perl 6?</a></strong>

</dt>
<dd>
I'm digging around in Parrot's core, closing holes and pushing new
ideas (or old ideas, which were already discussed before my time ;-).
</dd>


<dt><strong><a name="item_where_are_you_coming_from%3f">Where are you coming from?</a></strong>

</dt>
<dd>
I started working with computers in the late '70s (e.g. a hard
disc driver for a 10 Meg disc under CP/M 3). Via 8080/Z80 assembler,
Pascal, C, Perl 5 I finally arrived at Perl 6 development, where I
made this run under 5.005.03. While submitting patches toward Perl 6,
I realized that IMCC caused a lot of test failures, so I rewrote
IMCC substantially and added the Parrot engine. Running PBC inside
IMCC demanded a bunch of patches to the Parrot core, so here I am.
</dd>


<dt><strong><a name="item_when_do_you_think_perl_6_will_be_released%3f">When do you think Perl 6 will be released?</a></strong>

</dt>
<dd>
Sept. 16, 2004.
</dd>


<dt><strong><a name="item_why_are_you_doing_this%3f">Why are you doing this?</a></strong>

</dt>
<dd>
For fun, really a lot of.
</dd>


<dt><strong><a name="item_you_have_5_words%2e_describe_yourself%2e">You have five words. Describe yourself.</a></strong>

</dt>
<dd>
Parrot for a faster live.
</dd>


<dt><strong><a name="item_do_you_have_anything_to_declare%3f">Do you have anything to declare?</a></strong>

</dt>
<dd>
No customs here.
</dd>

</dl>



<h3><a name="acknowledgements,_requests_and_the_usual_muttering">Acknowledgements, requests and the usual muttering</a></h3>
<p>This summary was brought to you, late from the comforts of GNER's
First Class carriages, and from Mary Branscombe and Simon Bisson's
most excellent (if somewhat hard to stand up from) sofa. Distractions
were provided by the Kiseido Go Server, XMAME, Mary &amp; Simon's DVD
collection and a visit from Black Dog. Normal service will hopefully
be resumed next week.</p>
<p>Proofreading was once again down to Aspell and myself. We make a much
better team than we did.</p>
<p>A couple of months ago, I said of Leo T&ouml;tsch that 'he turned 44
on the 16th of September 2002, so not only does he contribute really
useful code, he makes Dan and I feel younger. Can this man do no
wrong?' I seems he can't, he's even found time to contribute his
answers for the summary questionnaire. Thanks, Leo. Once more, if you
participate in the lists and you've not sent me a set of answers, then I'd
be really grateful if you'd send your answers to:
<em><a href="mailto:mailto:5Ws@bofh.org.uk">mailto:5Ws@bofh.org.uk</a></em>, current names I'm targeting include Larry,
chromatic, Steve Fink, Clint Pierce, Daves Whipp &amp; Storrs (Hmm... Now
there's a name for a legal practice, 'Pierce, Whipp &amp; Fink') and
anyone else named in a summary who hasn't sent me answers. As I used
to say in my USENET days aTdHvAaNnKcSe.</p>
<p>Now, I hope you're in good voice as we all join in the chorus:</p>
<p>If you didn't like this summary, then what are you doing still reading it?
If you did like it, please consider one or both of the following
options:</p>
<ul>
<li>
Send money to the Perl Foundation at
<a href="http://donate.perl-foundation.org/">http://donate.perl-foundation.org/</a> and help support the ongoing
development of Perl 6.</li>


<li>
Send feedback, flames, money and/or a 1920s Vauxhall 30/98 to
<em><a href="mailto:mailto:pdcawley@bofh.org.uk">mailto:pdcawley@bofh.org.uk</a></em></li>

</ul>
<p>The fee paid for publication of these summaries on perl.com is paid
directly to the Perl Foundation.</p>


        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1392" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2002/11/20/dns.html" rel="bookmark">Managing Bulk DNS Zones with Perl</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Chris Josephes</span> on <abbr class="published" title="2002-11-20T00:00:00-08:00">November 20, 2002 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            <h3>A History of Forward and Reverse DNS</h3>

<p>
When an Internet server receives an incoming connection from 
a client, it may take a precaution of verifying the identity of the client.
Some protocols simply trust the client to provide proper credentials to 
their identification (like SMTP).  More complex protocols use a key exchange 
or a shared secret to communicate.  Other protocols rely on the process 
of verifying the hostname of the client.
</p>

<p>
To do this, a server would take the IP address of the client, and 
perform a reverse DNS lookup to get the PTR records.  Then, it would 
request the A record of the hostname returned from the PTR query.  If the 
hostname matched the IP address in both queries, then the host was considered 
to be trusted.
</p>

<p>
As a means of host authentication, it was a half-hearted process at best.  
It relied heavily on external DNS servers, and 
it could easily be circumvented if false records were returned to the DNS 
resolvers that sent the queries.  As such, it was only suitable for 
public Internet services like anonymous FTP or Web servers.
</p>

<p>
Another problem with this process was that it meant you would need to have 
matching forward and reverse DNS entries for all of your client hosts.  
Without the records, your logon could be delayed, or it could be refused 
altogether.
</p>

<p>
This became a burdeon for ISPs with large dial-up pools, or organizations 
with large LANs.  Dozens, if not hundreds of IP addresses suddenly 
needed to have two DNS entries.  DNS zones that originally 
contained 20 host records grew to hundreds of host records.
</p>

<p>
For example, let's say we work in a large university environment.  We 
have been given the 192.168.76.0/22 and 10.10.0.0/16 network blocks.  
Before any of these IP addresses are useful, we need to create forward 
and reverse DNS entries for them.
</p>

<p>
The network engineer writes a simple Perl script that will populate 
the zonefile with entries.  The output from the script is then put in 
the domain "ips.university.edu".
</p>

<pre><code>
$fmt="%s\tIN\tA%s\n";
foreach $block ("192.168.76.","192.168.77.","192.168.78.","192.168.79.")
{
	$host=$block;
	$host=~s/\./-/g;
	for ($n=0;$n&lt;=255;$n++)
	{
		printf($fmt,$host.$n,$block.$n);
	}
}
</code></pre>

<p>
As a result of a script such as this, you'd find out that you have a host record 
for your IP that looks like this.
</p>

<pre><code>
192-168-76-93.ips.university.edu
</code></pre>

<p>
It sure isn't pretty, but it gets the job done.
</p>

<p>
As far as the DNS server is concerned, there is nothing wrong with this 
record.  
Some experienced network engineers will probably point out a couple 
of causes for concern.
</p>

<p>
1. The record size is big. For each A record, we're using anywhere 
from eight to 15 characters to represent a 32-bit integer.
</p>

<p>
2. The repeated "192-168-" pattern is wasteful.  We could remove it 
from the entry, so 76-54.ips.university.edu points to 192.168.76.54, but 
that leads to a conflict when we create a DNS entry for 10.10.76.54?
</p>

<p>
We can correct that by creating seperate subdomains for both
networks.
</p>

<pre><code>
76-54.n1.ips.university.edu.	IN	A	192.168.76.54
76-54.n2.ips.university.edu.	IN	A	10.10.76.54
</code></pre>

<p>
Using separate subdomains, we've reduced the size of the record.  
The XXX-XXX.nX portion can be anywhere from six to 10 characters.  But 
we can still do a little more work to make it smaller.
</p>

<p>
The solution is to create a script that more accurately looks at the 
network block, and creates DNS entries based only on the host portion 
of the IP address in a block.
</p>

<h3>IP addresses and Net::Netmask</h3>

<p>
IPv4 addresses are 32-bit integers.  The IP address 192.168.76.55 can 
be represented in several ways:
</p>

<table>
<tr>
<td>Dottted Quad Notation</td>
<td>192.168.76.55</td>
</tr>
<tr>
<td>Base 10 integer</td>
<td>3232255031</td>
</tr>
<tr>
<td>Hexadecimal</td>
<td>c0a84c37</td>
</tr>
<tr>
<td>Binary</td>
<td>11000000101010000100110000110111</td>
</tr>
</table>

<p>
For future mathematicians out there, dotted quad notation is really 
base-256 notation.
</p>

<p>
Network masks are also 32-bit integers.  The 192.168.76.0/22 network 
number represents the following netmask:
</p>

<pre><code>
11111111111111111111110000000000
</code></pre>

<p>
For any IP address within this block, the first 22 bits represent the 
network, the remaining 10 bits represent the host within the network.
If we were to split the network and host values of the IP address 
192.168.76.55, then we find:
</p>

<table>
<tr>
<th><br/></th>
<th>Network</th>
<th>Host</th>
</tr>
<tr>
<td>Host IP</td>
<td>1100000010101000010011</td>
<td>0000110111</td>
</tr>
<tr>
<td>Netmask</td>
<td>1111111111111111111111</td>
<td>0000000000</td>
</tr>
<tr>
<td>Base 10</td>
<td>3156499</td>
<td>55</td>
</tr>
<tr>
<td>Base 16</td>
<td>302a13</td>
<td>37</td>
</tr>
</table>

<p>
For the IP address 192.168.76.5, the host portion of the IP address is five.
</p>

<table>
<tr>
<th><br/></th>
<th>Network</th>
<th>Host</th>
</tr>
<tr>
<td>Host IP</td>
<td>1100000010101000010011</td>
<td>1100000010101000010011</td>
</tr>
<tr>
<td>Netmask</td>
<td>1111111111111111111111</td>
<td>0000000000</td>
</tr>
<tr>
<td>Base 10</td>
<td>3156499</td>
<td>5</td>
</tr>
<tr>
<td>Base 16</td>
<td>c0a84c37</td>
<td>5</td>
</tr>
</table>

<p>
For the IP address 192.168.77.87, the host portion of the IP address is 343.
</p>

<table>
<tr>
<th><br/></th>
<th>Network</th>
<th>Host</th>
</tr>
<tr>
<td>Host IP</td>
<td>1100000010101000010011</td>
<td>0101010111</td>
</tr>
<tr>
<td>Netmask</td>
<td>1111111111111111111111</td>
<td>0000000000</td>
</tr>
<tr>
<td>Base 10</td>
<td>3156499</td>
<td>343</td>
</tr>
<tr>
<td>Base 16</td>
<td>c0a84c37</td>
<td>157</td>
</tr>
</table>

<p>
In order to get the host information about our address block, we will be 
using the Net::Netmask Perl module.
</p>

<p>
The Net::Netmask module was written to disseminate information about 
network blocks.  By giving it an IP address and a netmask, it can tell 
you the network address, the broadcast address, of a given network.  It 
can also tell us which IP address corresponds to which host number.
</p>

<pre><code>
use Net::Netmask;

$block=Net::Netmask-&gt;new("192.168.76.0/22");

print("Network can hold ",$block-&gt;size()," IP addresses\n");
print("Host 5   is IP ",$block-&gt;nth(5),"\n");
print("Host 343 is IP ",$block-&gt;nth(343),"\n");
</code></pre>

<p>
The output of the program is:
</p>

<pre><code>
Network can hold 1024 IP addresses
Host 5   is IP 192.168.76.5
Host 343 is IP 192.168.77.87
</code></pre>

<p>
The nth() method returns the IP address corresponding to the host number.
</p>

<h3>The Updated Script</h3>

<p>
This new script accomplishes the same thing as the old script, but 
this time we use Net::Netmask to keep track of IPs in the block.
</p>

<pre><code>
use Net::Netmask;

$network="192.168.76.0/22";
$fmt="%s\tIN\tA\t%s\n";

$block=Net::Netmask-&gt;new($network);
$size=$block-&gt;size()-2;
$index=1;
while ($index &lt;= $size)
{
	$host=sprintf("h%x",$index);
	printf($fmt,$host,$block-&gt;nth($index));
}
</code></pre>


<p>
Which produces the following zonefile.
</p>

<pre><code>
h1      IN      A       192.168.76.1
h2      IN      A       192.168.76.2
h3      IN      A       192.168.76.3
h4      IN      A       192.168.76.4
....
h35     IN      A       192.168.76.53
h36     IN      A       192.168.76.54
h37     IN      A       192.168.76.55
h38     IN      A       192.168.76.56
h39     IN      A       192.168.76.57
h3a     IN      A       192.168.76.58
....
h3fb    IN      A       192.168.79.251
h3fc    IN      A       192.168.79.252
h3fd    IN      A       192.168.79.253
h3fe    IN      A       192.168.79.254
</code></pre>

<p>
A couple of points to make.
</p>

<p>
1. In the host record itself, we choose to represent $index in 
hexadecimal.  This gives us a little more use out of the ASCII 
character set.  We save one character on integers between 99 
and 255.
</p>

<p>
2. A prefix of "h" (for host) is used on every record, so we don't have 
records that are just an integer.  For example,  a record like 
"1.n1.ips.university.edu" can be a problem depending on your resolver search 
settings.  If you try to run "ping 1" from a command prompt, then it's unclear 
whether you meant the host record "1," or the actual IP address "0.0.0.1".
</p>

<p>
3. The above script doesn't produce records for the network address or 
the broadcast address.   It is left for the DNS administrator to create 
them or just ignore them.
</p>

<p>
Using the example 192.168.76.0/22 network, the zonefile created by the 
second script is roughly 70 percent of the size of the zonefile created by 
the first script.
</p>

<h3>Creating the Reverse DNS</h3>

<p>
We can use Net::Netmask to create the reverse DNS as well, but the process 
is a little tricker.
</p>

<p>
Reverse DNS zones are delegated on the octet boundaries of the IP address, 
so it usually means that a zonefile will cover a full /24 network.  If your 
network is larger than a /24, then you'll need to create multiple zonefiles.  
If your network is smaller, then your data will probably be inserted to a 
zonefile that already exists for the other hosts in the network.
</p>

<p>
Note:  While it is possible for DNS reverse zones to be delegated for 
networks smaller than a /24, the discussion of setting up the CNAME or 
NS records for those situations is outside the scope of this article.
</p>

<p>
This makes the creation of reverse DNS a little tricky.  When you 
created the forward DNS, all of your data ended up 
in one zonefile.  For the reverse DNS, the data could be in one or 
more zonefiles depending on the size of the network.
</p>

<p>
The Net::Netmask module has a feature that makes it a little easier 
to work this out.  The inaddr() function returns data on the reverse 
DNS zones that the current netblock would occupy.  For each /24 
block your network covers, it returns the reverse DNS zone name, the 
starting IP address, and the ending IP address of the block.
</p>

<p>
So if we were looking at the 192.178.76.0/22 network, the inaddr() 
function would return:
</p>

<pre><code>
76.168.192.in-addr.arpa
0
255
77.168.192.in-addr.arpa.
0
255
78.178.192.in-addr.arpa
0
255
79.178.192.in-addr.arpa
0
255
</code></pre>

<p>
However, if we were looking at the 192.168.76.0/26 network, the inaddr()
function would return:
</p>

<pre><code>
76.178.192.in-addr.arpa
0
63
</code></pre>

<p>
Using this function, we can create a baseline program that at least 
tells us which zones we would need to create reverse DNS for.
</p>

<pre><code>
$block=Net::Netmask-&gt;new("192.168.76.0/22");

(@data)=$block-&gt;inaddr();
while (($zone,$start,$end)=splice(@data,0,3))
{
	print("; Reverse zone: $zone\n");
	for ($loop=$start;$loop&lt;=$end;$loop++)
	{
		# Create the individual entries
	}
}

</code></pre>

<p>
The outside loop runs once for every possible /24 network we will be 
filling with PTR records.  The inner loop begins an iteration from 
the starting IP address and the ending IP address.
</p>

<p>
If you remember, the nth() method of Net::Netmask returns an IP address 
based on a host number.  The match() method is the exact opposite;  it 
returns a host number based on an IP address.
</p>

<pre><code>
use Net::Netmask;

$block=Net::Netmask-&gt;new("192.168.76.0/22");

print("IP 192.168.76.5  is Host ",$block-&gt;match("192.168.76.5"),"\n");
print("IP 192.168.77.87 is Host ",$block-&gt;match("192.168.77.87"),"\n");
</code></pre>

<pre><code>
IP 192.168.76.5  is Host 5
IP 192.168.77.87 is Host 343
</code></pre>

<p>
In order to get the host number, we would need to provide the 
match() function with a full IP address.  This is the part where we 
have to do a little string cheating.
</p>

<pre><code>
$block=Net::Netmask-&gt;new("192.168.76.0/22");

sub flip
{
my ($zone)=shift;
my ($network,@rz,@ipc);
(@rz)=split(/\./,$zone);
(@ipc)=reverse(splice(@rz,0,3));
$network=join(".",@ipc);
return $network;
}

$domain=".n1.ips.university.edu.";
$fmt="%s\tIN\tPTR\t%s\n";
(@data)=$block-&gt;inaddr();

while (($zone,$start,$end)=splice(@data,0,3))
{
        print("; Reverse zone: $zone\n");
	$network=flip($zone);
        for ($loop=$start;$loop&lt;=$end;$loop++)
        {
		# Create the invidivual entries
		$ip="$network.$loop";
		$order=$block-&gt;match($ip);
		$host=sprintf("h%x%s",$order,$domain);
		printf($fmt,$loop,$host);
        }
}
</code></pre>

<p>
The confusing part is probably the flip() subroutine.  All that does is 
take a reverse DNS zone name (like 76.168.192.in-addr.arpa), and 
returns the quads in forward form (192.168.76).  We use this 
string as a prefix to combine with $loop so we have a valid IP address for 
the match() method.
</p>

<p>
The program run gives us:
</p>

<pre><code>
;Reverse Zone: 76.168.192.in-addr.arpa

1       IN      PTR     h1.n1.ips.university.edu.
2       IN      PTR     h2.n1.ips.university.edu.
3       IN      PTR     h3.n1.ips.university.edu.
4       IN      PTR     h4.n1.ips.university.edu.
5       IN      PTR     h5.n1.ips.university.edu.
6       IN      PTR     h6.n1.ips.university.edu
....
53      IN      PTR     h35.n1.ips.university.edu.
54      IN      PTR     h36.n1.ips.university.edu.
55      IN      PTR     h37.n1.ips.university.edu.
56      IN      PTR     h38.n1.ips.university.edu.
57      IN      PTR     h39.n1.ips.university.edu.
58      IN      PTR     h3a.n1.ips.university.edu.
;Reverse Zone: 79.168.192.in-addr.arpa

0       IN      PTR     h300.n1.ips.university.edu.
1       IN      PTR     h301.n1.ips.university.edu.
2       IN      PTR     h302.n1.ips.university.edu.
3       IN      PTR     h303.n1.ips.university.edu.
4       IN      PTR     h304.n1.ips.university.edu.
</code></pre>

<h3>Other Tricks</h3>

<p>
We used hexadecimal numbers in the host records to save space in the 
zonefile, and to make the record a little more obscure to the casual 
observer.  To make it a even more obscure, try using a subroutine 
that will create base32 numbers (0-9,a-v), or base36 (0-9,a-z) numbers.
</p>

<p>
To make it easier to identify the size of the network, create two 
A records for the zone itself, and populate it with the starting IP 
address, and the ending IP address.
</p>

<pre><code>
;
; Forward DNS for 192.168.96.0/21 network
$ORIGIN n3.ips.university.edu.

	IN	NS	ns1.university.edu.
	IN	NS	ns2.university.edu.

	IN	A	192.168.96.0
	IN	A	192.168.103.255

h1	IN	A	192.168.96.1
h2	IN	A	192.168.96.2
</code></pre>

<p>
Net::Netmask has two functions, base() and broadcast(), which can be used 
to obtain these values.
</p>

<h3>Conclusion</h3>

<p>
Your DNS records need to match in order to satisfy forward/reverse host 
authentication.  It doesn't matter what the values are, just as long as they 
agree.  It seems like a large hassel, especially when you consider that 
the practice of forward/reverse host authentication is considered highly 
untrustworthy by security administrators.  Some hostmasters would say that 
the process is a waste of time.  Keep in mind that there will always be one 
or two users that will demand that their desktop system be given forward 
and reverse DNS entries.
</p>

<p>
It's easy to automate the process of creating the zonefiles.  
Once the data is put in place, it almost never needs to be updated.  
I've seen a lot of DNS entries out there that simply replicate the IP 
address.  Check the logs of a popular Web server and see for yourself.
</p>

<p>
Unfortunately, it's unlikely that these records will change in the future, 
unless the network allocation actually changes to another entity.  In the 
meantime, the code examples above can be used to easily create new zones 
for future network allocations.
</p>

        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1402" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2002/11/p6pdigest/20021115.html" rel="bookmark">This week on Perl 6 (11/03-11/10, 2002)</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Piers Cawley</span> on <abbr class="published" title="2002-11-15T00:00:00-08:00">November 15, 2002 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            
<!-- sidebar begins -->
<!-- don't move sidebars -->
<!-- sidebar ends -->

<p>Far off in distant Newark, a figure muttering something about 'Leon
Brocard' shambles across a railway bridge and makes its way into a
waiting room. Time passes. After a while, a train arrives and the
figure shambles on board, takes its seat, pulls a laptop from its bag
and starts to type. This is what it types: '=head1 The Perl 6 Summary
for the week ending 20021110'.</p>
<p>Yes, it's time for another update on the japes and tomfoolery from the
world of Perl 6. We start, as usual, with perl6-internals.</p>
<h4><a name="the myth of fingerprints">The Myth of Fingerprints</a></h4>
<p>At the end of the previous week, Gregor posted an outline of his
proposal for fixing the fingerprinting issue with dynamic
loading. (The fingerprinting issue is that 'old' .pbc files may break
big time when run on newer Parrots. Ideally, we'd like Parrot to refuse
to run such files <em>before</em> bad things happen. It's proposed that this
be done by adding 'fingerprints' to .pbc to allow for identification
by Parrot.) Leopold T&ouml;tsch wasn't at all sure about Gregor's
approach, pointing out that it would have massive speed
implications, and lo, the thread got dragged off in the direction of a
discussion of optimizing Parrot for speed. How did that happen then?</p>
<p><a href="http://groups.google.com/groups?threadm=OFD709CD11.B32BE727-ON85256C66.0074F03C-85256C66.0077A25A%40kennedytech.com">http://groups.google.com/groups</a></p>
<h4><a name="on_exit not portable"><code>on_exit</code> not portable</a></h4>
<p>Andy Dougherty pointed out that Solaris doesn't have <code>on_exit</code>, which
is used by Parrot to clean up after itself, and suggested that
<em>interpreter.c</em> be reworked to use <code>atexit</code>. However, SunOS
has on_exit but doesn't have atexit. It's a quandary. Josh Wilmes
suggested implementing <code>Parrot_on_exit()</code> and <code>Parrot_exit()</code> in
<em>platform.c</em> and half promised a patch (unless somebody beat him to
it.) Leo T&ouml;tsch and Nicholas Clark both said, essentially &quot;Nice
idea, go do it.&quot;</p>
<p>Dan chimed in, pointing out that the current <code>on_exit</code> behavior
seemed to be there as a workaround for bugs in exceptions, and that
fixing those was probably the better idea. Leo turned off the
'on_exit' stuff, just as Josh was sending a patch implementing the
Parrot_* functions. I think that, as we now stand, we're back to doing
exit cleanup, but using the portable Parrot_* functions.</p>
<p><a href="http://groups.google.com/groups?threadm=200211050046.gA50jlJ2007961%40galactic.hitchhiker.org">http://groups.google.com/groups</a></p>
<p><a href="http://groups.google.com/groups?threadm=a05200f01b9ef129f93a9%40%5B63.120.19.221%5D">http://groups.google.com/groups</a></p>
<h4><a name="should memory be washed">Should Memory be Washed?</a></h4>
<p>Peter Gibbs was unsure of the guarantees given by <code>Parrot_allocate</code>
and friends regarding the contents of the memory supplied. Apparently,
some code appears to assume that it will get pre-washed memory, while
other code does its own cleaning. Which is right? Leo T&ouml;tsch
reckons that the current behavior (memory is zeroed at allocation
time) should be guaranteed. Dan wasn't so sure that this was a good
idea if we go for a 'malloc like' scheme and thought that it could be
argued that it was a bug for any code to assume that the memory it got
was zeroed.</p>
<p>The eventual consensus was that the basic allocator should not guarantee
zeroed memory, but that there should be a set of allocator functions
that <em>do</em> return zeroed memory. Leo checked in a patch to that
effect.</p>
<p>Then they started talking about performance.</p>
<p><a href="http://groups.google.com/groups?threadm=04a801c28440%248a85e7c0%240b01010a%40emkel.co.za">http://groups.google.com/groups</a></p>
<h4><a name="string_set is back"><code>string_set</code> Is Back</a></h4>
<p>Leopold T&ouml;tsch has added a 'string_set' function that allows
strings to be recycled instead of having to create new strings every
time. This can lead to substantial speed gains when used
appropriately. This led to a discussion on when it was appropriate to
use non destructive assignment and when to use a destructive
set. Somewhat to my surprise, nobody has yet suggested the lispish
<code>set</code> is nondestructive, <code>set!</code> is destructive split, allowing the
Parrot coder to choose. Looks like I just suggested it here.</p>
<p><a href="http://groups.google.com/groups?threadm=3DC8D805.2010804%40toetsch.at">http://groups.google.com/groups</a></p>
<h3><a name="meanwhile, over in perl6language">Meanwhile, Over in perl6-language</a></h3>
<p>Amazingly, the main topic of conversation this week wasn't the dreaded
operator thread ...</p>
<h4><a name="unifying invocant and topic naming syntax">Unifying Invocant and Topic-Naming Syntax</a></h4>
<p>Allison Randal has written an article about Perl 6 topics for
perl.com. 'Ralph' read this and didn't appear to like it very much,
particularly the <code>sub foo ($bar) is given($baz) { ... }</code> syntax
that sets <code>$baz</code> to the value of the caller's topic. (If you're not
sure what I'm talking about, then now would be a good time to read
Allison's article. Topics are great, you'll like them.) Ralph wanted
to do <code>sub foo ($baz : $bar is topic) { ... }</code>, and supplied
several further, terser and terser declaration forms, <code>method f
($self : $c : $a*, $b) {...}</code> anyone?</p>
<p>Allison thought Ralph was barking up the wrong tree, and explained the
thinking behind the topic related syntax and pointed out that Ralph
appeared to be conflating two 'independent but interacting features'
with his proposal, but Ralph didn't give up that easily. Eventually,
after comments from Damian and Allison he let the subject lie.</p>
<p><a href="/pub/a/2002/10/30/topic.html">http://www.perl.com/pub/a/2002/10/30/topic.html</a></p>
<p><a href="http://groups.google.com/groups?threadm=018701c283c1%247d18cfa0%246601a8c0%40ralph">http://groups.google.com/groups</a></p>
<h4><a name="utf8 and unicode faq">UTF-8 and Unicode FAQ</a></h4>
<p>Actually, I lied about the operator thread subsiding. It
fragmented. But at least now the various fragments got their own
subjects. In this particular subthread, the whole 'Unicode operators in
core' thing got discussed. There appears to be two camps. The first
camp maintains that Unicode operators in the core means Perl will
start looking dangerously like APL and will need a space cadet
keyboard to use. The second camp's argument for Unicode operators
appears to be 'Yeah, and your point was? We only want to use &laquo;
and &raquo;, and isn't it about time the world got with the Unicode
program?'</p>
<p>Me? I'm on the fence. I can see the reasoning behind wanting Unicode
operators, but I'm not entirely sure I like them (the 'email encoding'
problem is my major bugbear...)</p>
<p><a href="http://groups.google.com/groups?threadm=3DC68794.1040108%40vulpes.com">http://groups.google.com/groups</a></p>
<p><a href="http://groups.google.com/groups?threadm=26E3E3DB-F110-11D6-A3FD-00050245244A%40cognitivity.com">http://groups.google.com/groups</a> -- A decent
summation from Michael Lazzaro</p>
<h4><a name="supercomma!">Supercomma!</a></h4>
<p>At one point in the UTF-8 and Unicode thread, Larry wondered whether he
could raid Unicode for a better character than <code>;</code> for separating
parallel <code>for</code> loop streams. Michael Lazzaro responded with a couple
of suggestions for different supercommas which would have different
meanings. I couldn't tell you what the symbols are, my mailer rendered
'em as Latin-1 digraphs, neither of which looked much like a comma.</p>
<p>Larry then confessed that he was thinking of changing the declaration
of parallel for loops from:</p>
<pre><code>
  for @a ; @b ; @c -&gt; $a ; $b ; $c {...}</code></pre>
<p>to something like:</p>
<pre><code>
  for parallel(@a, @b, @c) -&gt; $a, $b, $c {...}</code></pre>
<p>Which has the advantage of not messing with the block signature at
all, which Larry reckons should make Simon Cozens happier. Damian
pointed out that doing things this way would probably mean we'd get a
bunch of useful functions for iterating over arrays (and then
implemented one such function). Others followed, implementing various
other useful functions before Damian capped them all with a nicely
generalized <code>zip</code> implementation.</p>
<p>Buddha Buck endeared himself to the summarizer with his summary of
<code>for</code> loop possibilities. Buddha also included a rather pretty
implementation of <code>for</code> as a recursive function, though Damian
reckoned he'd not quite got the signature right.</p>
<p><a href="http://groups.google.com/groups?threadm=20021104195838.GA24226%40london">http://groups.google.com/groups</a></p>
<p><a href="http://groups.google.com/groups?threadm=468E095E-F044-11D6-BC89-00050245244A%40cognitivity.com">http://groups.google.com/groups</a></p>
<p><a href="http://groups.google.com/groups?threadm=3DC83ACA.3070705%40conway.org">http://groups.google.com/groups</a></p>
<p><a href="http://groups.google.com/groups?threadm=3DC7F320.4020804%4014850.com">http://groups.google.com/groups</a></p>
<h4><a name="the interminable operator thread">The Interminable Operator Thread</a></h4>
<p>'Smylers' is my hero of the week for a message he posted summarizing
the various (12) options for changing the look of operators, with
particular reference to vectorization. Options range from 'as we were'
to the 'guillemot' option, which involves seabirds and a pathological
inability to spell 'guillemet.'</p>
<p><a href="http://groups.google.com/groups?threadm=20021104231339.80644.qmail%40onion.perl.org">http://groups.google.com/groups</a></p>
<h4><a name="fmtwyentk about :=">FMTWYENTK about <code>:=</code></a></h4>
<p>Bravely declining to expand the acronym in his subject, arcardi posted
a summary of his current understanding of the behavior of <code>:=</code>, the
binding operator, and peppered the post with questions. None of which
were answered this week.</p>
<p><a href="http://groups.google.com/groups?threadm=15816.1795.990706.339369%40figaro.weizmann.ac.il">http://groups.google.com/groups</a></p>
<h4><a name="junctions and laziness">Junctions and Laziness</a></h4>
<p>Junctions are what we're calling superpositions this week. Piers
Cawley had another crack (the operative word I think, on rereading) at
his non deterministic search algorithm using junctions and a subclass
of Function. Damian, of course, came up with a better possible syntax
for lazy functions:</p>
<pre><code>
    sub some_func(Num $n) is lazy returns Num {
      return $n ** $n;
    }</code></pre>
<p>Billy Naylor wondered if a similar notation could
be used for memoize:</p>
<pre><code>
    sub fib(Num $n) is memo returns Num {
      given $n {
        when 0    { 0 }
        when 1    { 1 }
        otherwise { fib($n-1) + $fib($n-2) }
      }
    }</code></pre>
<p>and Damian pointed out that this was covered in Apocalypse 2, but the
name of the property was yet to be decided. Which led to discussion of
appropriate names.</p>
<p><a href="http://groups.google.com/groups?threadm=84u1iueqpb.fsf%40despairon.bofh.org.uk">http://groups.google.com/groups</a></p>















<h4><a name="primitive vs. object types">Primitive vs. Object Types</a></h4>
<p>David Whipp was worried about the use of primitive types. He pointed
out that &quot;whenever a value passes through a primitive type, it loses
all its run-time properties; and [junctions] will collapse. I worry
that this could cause obscure bugs&quot;. He also worried that the
similarity of names (<code>Int</code> for an object vs. <code>int</code> for a primitive)
would make such problems harder to spot, and violated Larry's maxim
that 'Similar things should look different.' He proposed that, in
order to use primitive types, a module author should first do
something like <code>use primitives qw(int)</code>, and that maybe names like
<code>int</code> should be changed to names like <code>_prim_int32</code>.</p>
<p>Dan wasn't entirely sure that David's basic assumption about
properties/junctions was accurate, but Michael Lazzaro pointed
out that this had been strongly implied by things Larry and Damian had
said, though Michael later dug up a reference to Apocalypse 2 which
was ambiguous about runtime properties on primitive types. Dan started
making 'worried' noises about supporting primitive types and Larry,
while still keeping things fluid about what will actually happen,
explained more of his thoughts about them.</p>
<p>Garrett Goebel wondered about the difference between 'attribute' and
'property' in Perl 6. I assume everyone would like to know this. The
short answer goes something like: 'attribute' is the Perl 6 term
for an instance variable, a 'property' can be thought of as a
'yellow sticky note attached to an arbitrary object.' Dan has a better
explanation which doesn't avoid using a trademarked term.</p>
<p><a href="http://groups.google.com/groups?threadm=F0DF160193C9D511B7110050DA8B7C2457246B%40msexchange.intranet.fast-chip.com">http://groups.google.com/groups</a></p>
<p><a href="http://groups.google.com/groups?threadm=a05200f07b9f085dce400%40%5B63.120.19.221%5D">http://groups.google.com/groups</a></p>
<p><a href="http://groups.google.com/groups?threadm=a05200f02b9f093761431%40%5B63.120.19.221%5D">http://groups.google.com/groups</a> -- Dan's
attributes/properties explanation</p>
<h4><a name="perl6documentation was born">perl6-documentation was born</a></h4>
<p>On Wednesday, Michael Lazzaro (who has been doing some sterling
documentation work, check out his 'introduction to variables and
values' docs, linked below) proposed that now was the time to start
documenting (and finalizing) the detailed design of what we know about
Perl 6 so far. He is concerned that for all the discussion on the
language list, most of the decisions don't appear to be being
documented, nor reflected back in updated Apocalypses and other
documentation.</p>
<p>He proposed, therefore, that perl6-language 'focus on fleshing out
every last detail implied by Apocalypses 2-N, <em>in that order</em>' and hoped
that we could 'migrate perl6-language into a list that finalizes
aspects of the design, documents them, and revises them as needed'.</p>
<p>Allison Randal wasn't initially convinced that this was necessarily a
good idea. She worried that Larry (the Official Last Word on Perl 6)
would be snowed under by an RFCesque tide of new documentation, and
that reviewing such a tide would make him lose focus.</p>
<p>At this point, Michael threw the Virtual Coffee Mug.</p>
<p>After a further period of discussion, Dan pointed out that the key was
to 'Just Do It' (a phrase normally pronounced with four words), so we
created the perl6-documentation mailing list and your summarizer got a
bunch more work.</p>
<p>The thread is long. I've summarized the main line (badly) and
now provide some links to key posts, but if you want more detail I
suggest you follow the first link and read the thread. For those that
like drama and high emotion, the virtual CM chucking post is Michael's
response to Allison's reply. I'm not going to link directly to it;
trust me, context is better.</p>
<p><a href="http://cog.cognitivity.com/perl6/val.html">http://cog.cognitivity.com/perl6/val.html</a> -- vars and values intro</p>
<p><a href="http://groups.google.com/groups?threadm=76134CC0-F11E-11D6-A3FD-00050245244A%40cognitivity.com">http://groups.google.com/groups</a></p>
<p><a href="http://groups.google.com/groups?threadm=a05200f0cb9ef309c9ae1%40%5B63.120.19.221%5D">http://groups.google.com/groups</a> -- Dan talks sense</p>
<p><a href="http://groups.google.com/groups?threadm=87heeus32d.fsf%40simoncozens-2.dsl.easynet.co.uk">http://groups.google.com/groups</a> -- So does Simon
Cozens</p>
<p><a href="http://groups.google.com/groups?threadm=a05200f08b9ef2e9320f9%40%5B63.120.19.221%5D">http://groups.google.com/groups</a> -- The tests should be the
spec</p>
<h3><a name="meanwhile, in perldocumentation">Meanwhile, in perl-documentation</a></h3>
<p>The new baby got off to a flying start as Michael Lazzaro laid down
his goals for the project. Early discussion centered on the overall
structure of the intended documentation; what formats it should be
written in; the requirements for concrete, executable Perl 6 test
cases and the importance of fluidity. Michael repeatedly stressed that
it was vital that the documentation list retain focus; his goal is
that the entire list should work on one thing at a time.</p>
<p><a href="http://groups.google.com/groups?threadm=3DCC77DA.2704A44%40cognitivity.com">http://groups.google.com/groups</a></p>
<h4><a name="roll call">Roll Call</a></h4>
<p>Michael asked for a quick roll call of who was interested in the
documentation project. As an added bonus, he asked that even the
lurkers put their hands up if they were interested. Surprisingly, some
of them decloaked and did so.</p>
<p><a href="http://groups.google.com/groups?threadm=CB2CAEFE-F33C-11D6-AB2D-00050245244A%40cognitivity.com">http://groups.google.com/groups</a></p>
<h4><a name="project goals">Project Goals?</a></h4>
<p>Michael formally kicked off the discussion with the question &quot;How can
this documentation project best help with the overall goal of
producing a finished Perl 6?&quot; Answers on a piece of data to the list,
do not attempt to write on both sides of the data at once.</p>
<p><a href="http://groups.google.com/groups?threadm=49FFBC91-F351-11D6-AB2D-00050245244A%40cognitivity.com">http://groups.google.com/groups</a></p>
<h4><a name="project start: section 1">Project Start: Section 1</a></h4>
<p>Late Friday, Michael kicked off discussion of the first
section, most of the discussion took place during the
following week, which is when I'll summarize it.</p>
<p><a href="http://groups.google.com/groups?threadm=3DCEB72C.ED424915%40cognitivity.com">http://groups.google.com/groups</a></p>
<h3><a name="in brief">In Brief</a></h3>
<p>Leo T&ouml;tsch and Brent Dax have been working on ways of making
Parrot GC go faster by improving the performance of the 'destroy'
phase.</p>
<p>Andy Dougherty sent in a patch to ensure that the <em>languages/perl6</em>
build will work without bison. Andy found and fixed a compiler-specific bug introduced by someone using C++ style comments.</p>
<p>Richard Proctor suggested that miniparrot should be called 'budgie'.</p>
<p>Leo T&ouml;tsch showed off some numbers for the life generations/sec
test. JIT is looking very quick indeed, it's only about 25 percent slower
than a native C implementation.</p>
<p>Dan's back from Seattle and digging through his mail backlog.</p>
<p>Leo T&ouml;tsch has been thinking about regexes/patterns/rules and
thinks that we should reintroduce a regex state object, making regexes
reentrant once more.</p>
<h3><a name="who's who in perl 6">Who's who in Perl 6?</a></h3>
<dl>
<dt>
<strong><a name="item_Who_are_you%3F">Who are you?</a></strong></dt>
<dd>
Simon Glover

</dd>
<dt>
<strong><a name="item_What_do_you_do_for%2Fwith_Perl_6%3F">What do you do for/with Perl 6?</a></strong>
</dt>
<dd>
Write tests, stomp on compiler warnings, fix bugs (occasionally)...
<p>Basically, I try to help with some of the tedious but necessary
stuff in order to free other people to concentrate on design &amp;
implementation.</p>

</dd>
<dt>
<strong><a name="item_Where_are_you_coming_from%3F">Where are you coming from?</a></strong>
</dt>
<dd>
About this time last year, I started to get a bit frustrated at
what appeared to me to be the slow pace of Parrot development, when I
suddenly thought: 'You know, if you gave them a hand, they'd finish
sooner'. So I did (and we haven't... yet. Of course, I've now got a
better understanding of <em>why</em> this takes a long time).
<p>I'd also like to add that I'm proof that you don't have to be a C
coder in order to be useful on a project like this...</p>

</dd>
<dt>
<strong><a name="item_When_do_you_think_Perl_6_will_be_released%3F">When do you think Perl 6 will be released?</a></strong>
</dt>
<dd>
Depends what you mean by Perl 6 -- after all, we already have a subset
of it up and running on Parrot. Seriously, I think we'll have
something that's genuinely usable and useful well before the end of
2003, even if there are still a few loose ends to tie up.

</dd>
<dt>
<strong><a name="item_Why_are_you_doing_this%3F">Why are you doing this?</a></strong>
</dt>
<dd>
I like Perl - it matches the way I think. The problem is, Perl is too
slow for many of the things that I'd like to use it for, and too hard
to extend. Parrot should fix both of these problems.
<p>Also, it's nice to see one of my favourite features of F90 finally
make it into Perl :-)</p>

</dd>
<dt>
<strong><a name="item_You_have_5_words%2E_Describe_yourself%2E">You have 5 words. Describe yourself.</a></strong>
</dt>
<dd>
Mild-mannered English computational astrophysicist.

</dd>
<dt>
<strong><a name="item_Do_you_have_anything_to_declare%3F">Do you have anything to declare?</a></strong>
</dt>
<dd>
All the C I know I learnt from Parrot. (Well, OK, K&amp;R helped too, but
it's amazing how much you can learn from reading other people's code).
</dd>
</dl>
<h3><a name="acknowledgements, requests and general banter">Acknowledgements, requests and general banter</a></h3>
<p>This summary was again brought to you from the 0625 Newark on Trent to
Kings Cross and the 1720 Kings Cross to Newark on Trent trains. It was
fuelled by copious amounts of GNER coffee and, one one occasion, a
bacon and tomato toasted sandwich. I'd like to extend my thanks and
best wishes to Avril Hill, who's been bringing me morning tea for
months now, but who's about to escape the train and start working on
Leeds station.</p>
<p>Proofreading services were supplied by aspell and myself. Blame aspell
if it's really terrible.</p>
<p>I'm running short of questionnaire answers. If you've <em>ever</em> been
mentioned in a Perl 6 Summary, or if you haven't (yet), please
consider answering the questions Simon just answered and sending them
to <em><a href="mailto:mailto:5Ws@bofh.org.uk">mailto:5Ws@bofh.org.uk</a></em>. Thanks.</p>
<p>Now, if we all join in with the chorus:</p>
<p>If you didn't like this summary,  what are you doing still reading it?
If you did like it, please consider one or both of the following
options:</p>
<ul>
<li>
Send money to the Perl Foundation at
<a href="http://donate.perl-foundation.org/">http://donate.perl-foundation.org/</a> and help support the ongoing
development of Perl 6.</li>

<li>
Send feedback, flames, money and/or a Schneider 90mm f/5.6 Super
Angulon XL to <em><a href="mailto:mailto:pdcawley@bofh.org.uk">mailto:pdcawley@bofh.org.uk</a></em></li>
</ul>
<p>The fee paid for publication of these summaries on perl.com is paid
directly to the Perl Foundation.</p>

        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1390" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2002/11/14/exception.html" rel="bookmark">Object Oriented Exception Handling in Perl</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Arun Udaya Shankar</span> on <abbr class="published" title="2002-11-14T00:00:00-08:00">November 14, 2002 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            
<!-- sidebar begins -->
<!-- don't move sidebars -->
<!-- sidebar ends -->

<p>The main goal of this article is to discuss in detail about exception handling in Perl and how to implement it using Error.pm. On our way, we'll be touching upon the advantages of using exception-handling over traditional error-handling mechanisms, exception handling with eval {}, problems with eval {} and the functionalities available in Fatal.pm. But by and large, our focus we'll be on using Error.pm for exception handling.</p>

<h3>What Is an Exception ?</h3>

<p>An exception can be defined as an event that occurs during the execution of a program that deviates it from the normal execution path. Different types of errors can cause exceptions. They can range from serious errors such as running out of virtual memory to simple programming errors such as trying to read from an empty stack or opening an invalid file for reading.</p>

<csperl file="grab" domain="on" record="b/719" template="article_sidebar.view">

<p>An exception usually carries with it three important pieces of information:</p>
<ol>
	<li>The type of exception - determined by the class of the exception object</li>
	<li>Where the exception occurred - the stack trace</li>
	<li>Context information - error message and other state information</li>
</ol>

<p>An exception handler is a piece of code used to gracefully deal with the exception. In the rest of article, the terms exception handler and catch block will be used interchangeably.</p>

<p>By choosing exceptions to manage errors, applications benefit a lot over traditional error-handling mechanisms. All the advantages of using exception handling are discussed in detail in the next section.</p>

<h3>Advantages of Using Exception Handling</h3>

<p>Object-oriented exception handling allows you to separate error-handling code from the normal code. As a result, the code is less complex, more readable and, at times, more efficient. The code is more efficient because the normal execution path doesn't have to check for errors. As a result, valuable CPU cycles are saved.</p>

<p>Another important advantage of OO exception handling is the ability to propagate errors up the call stack. This happens automatically without you, the programmer, explicitly checking for return values and returning them to the caller. Moreover, passing return values up the call stack is error prone, and with every hop there is a tendency to lose vital bits of information.</p>

<p>Most of the time, the point at which an error occurs is rarely the best place to handle it. So, the error needs to be propagated up the call stack. But by the time the error reaches the place where it can be handled suitably, a lot of the error context is lost. This is a common problem with traditional error-handling mechanisms (i.e. checking for return values and propagating them to the caller). Exceptions come to the rescue by allowing contextual information to be captured at the point where the error occurs and propagate it to a point where it can be effectively used/handled.</p>

<p>For instance, if you have a function <em>processFile()</em> that is the fourth method in a series of method calls made by your application. And also <em>func1()</em> is the only method interested in the errors that occur within <em>processFile()</em>. With a traditional error-handling mechanism, you would do the following to propagate the error code up the call stack until the error finally reaches <em>func1()</em>.</p>
<pre><code>  sub func3
  {
    my $retval = processFile($FILE);
    if (!$retval) { return $retval; }
    else {
      ....
    }
  }

  sub func2
  {
    my $retval = func3();
    if (!$retval) { return $retval; }
    else {
      ....
    }
  }

  sub func1 
  {
    my $retval = func2();
    if (!$retval) { return $retval; }
    else {
      ....
    }
  }

  sub processFile
  {
    my $file = shift;
    if (!open(FH, $file)) { return -1; }
    else {
      # Process the file
      return 1;
    }
  }</code></pre>
<p>With OO exception handling, all you need to do is wrap the function call to <em>func2()</em> within the try block and handle the exceptions thrown from that block with an appropriate exception handler (catch block). The equivalent code with exception handling is shown below.</p>
   <pre><code>   sub func1
   {
     try {
       func2();
     }
     catch IOException with {
       # Exception handling code here
     };  
   }

   sub func2 { func3(); ... }
   sub func3 { processFile($FILE); ... }

   sub processFile
   {
     my $file = shift;
     if (!open(FH, $file)) { 
       throw IOException("Error opening file &lt;$file&gt; - $!");
     }
     else {
       # Process the file
       return 1;
     }     
   }</code></pre>
<p>Since <em>func1()</em> is the only function to possess a catch block, the exception that was thrown in the <em>processFile()</em> function is propagated all the way up to <em>func1()</em>, where it would be appropriately dealt with, by the catch block. The difference in the bloat factor and code obfuscation level between these two error handling techniques is obvious.</p>

<p>Finally, exceptions can be used to group related errors. By doing this, you will be able to handle related exceptions using a single exception handler. The inheritance hierarchy of the exception classes can be used to logically group exceptions. Thus, an exception handler can catch exceptions of the class specified by its parameter, or can catch exceptions of any of its subclass.</p>

<h3>Let's Do It in Perl</h3>
<h3>Perl's Built-In Exception Handling Mechanism</h3>
<p>Perl has a built-in exception handling mechanism, a.k.a the eval {} block. It is implemented by wrapping the code that needs to be executed around an eval block and the $@ variable is checked to see if an exception occurred. The typical syntax is:</p>
  <pre><code>  eval {
    ...
  };
  if ($@) {
    errorHandler($@);
  }</code></pre>
<p>Within the eval block, if there is a syntax error or runtime error, or a die statement is executed, then an undefined value is returned by eval, and $@ is set to the error message. If there was no error, then $@ is guaranteed to be a null string.</p> 
<p>What's wrong with this? Since the error message store in $@ is a simple scalar, checking the type of error that has occurred is error prone. Also, $@ doesn't tell us where the exception occurred. To overcome these issues, exception objects were incorporated in Perl 5.005.</p>

<p>From Perl 5.005 onward, you can do this:</p>
  <pre><code>  eval {
    open(FILE, $file) || 
      die MyFileException-&gt;new("Unable to open file - $file");
  };

  if ($@) {
    # now $@ contains the exception object of type MyFileException
    print $@-&gt;getErrorMessage();  
	# where getErrorMessage() is a method in MyFileException class
  }</code></pre>
<p>The exception class (MyFileException) can be built with as much functionality as desired. For example, you can get the calling context by using <em>caller()</em> in constructer of the exception class (typically <em>MyFileException::new()</em>).</p>

<p>It is also possible to test specific exception types as shown below:</p>
  <pre><code>  eval {
    ....
  };

  if ($@) {
    if ($@-&gt;isa('MyFileException')) {  # Specific exception handler
      ....
    }
    else { # Generic exception handler
      ....
    }
  }</code></pre>
<p>If the exception object implements stringification, by overloading the string operations, then the stringified version of the object would be available whenever $@ is used in string context. By constructing the overloading method appropriately, the value of $@ in string context can be tailored as desired.</p>
  <pre><code>  package MyException;

  use overload ('""' =&gt; 'stringify');
  ...
  ...
  sub stringify
  {
    my ($self) = @_;
    my $class = ref($self) || $self;

    return "$class Exception: " . $self-&gt;errMsg() . " at " . 
                                  $self-&gt;lineNo() . " in " . 
								  $self-&gt;file();
    # Assuming that errMsg(), lineNo() &amp; file() are methods 
	# in the exception class
    # to store &amp; return error message, line number and source 
	# file respectively.
  }</code></pre>
<p>When overloading the string operator '"', the overloading method (<em>stringify()</em> in our case) is expected to return a string representing the stringified form of the object. The stringify() method can return various context/state information about the exception object, as part of the string.</p>

<h3>Problems with eval</h3>

<p>The following are some of the issues in using the eval {} construct:</p>

<ul>
	<li>Similar looking syntactic constructs can mean different things, based on the context.</li>
	<li>eval blocks can be used for both, building dynamic code snippets as well as for exception handling</li>
	<li>No builtin provision for cleanup handler a.k.a finally block</li>
	<li>Stack trace if required, needs to maintained by writing custom code</li>
	<li>Aesthetically unappealing (Although this is very subjective)</li>
</ul>

<h3>Error.pm to the Rescue</h3>

<p>The Error.pm module implements OO exception handling. It mimics the try/catch/throw syntax available in other OO languages like Java and C++ (to name a few). It is also devoid of all the problems that are inherent when using eval. Since it's a pure perl module, it runs on almost all platforms where Perl runs.</p>

<h3>Use'ing Error.pm</h3>

<p>The module provides two interfaces:</p>
<ol>
	<li>Procedural interface for exception handling (exception handling constructs)</li>
	<li>Base class for other exception classes</li>
</ol>
<p>The module exports various functions to perform exception handling. They will be exported if the :try tag is used in the use statement.</p>

<p>A typical invocation would look like this:</p>

  <pre><code>  use Error qw(:try);

  try {
    some code;
    code that might thrown an exception;
    more code;
    return;
  }
  catch Error with {
    my $ex = shift;   # Get hold of the exception object
    handle the exception;
  }
  finally {
    cleanup code;
  };  # &lt;-- Remember the semicolon</code></pre>

<p>Don't forget to include the trailing semicolon (;) after the closing brace. For those of you who want to know why: All these functions accept a code reference as their first parameter. For example, in the try block the code that follows try is passed in as a code reference (anonymous function) to the function <em>try(</em>).</p>

<h3>try Block</h3>
<p>An exception handler is constructed by enclosing the statements that are likely to throw an exception within a try block. If an exception occurs within the try block, then it is handled by the appropriate exception handler (catch block), associated with the try block. If no exceptions are thrown, then try will return the result of block.</p> 

<p>The syntax is: <samp>try BLOCK EXCEPTION_HANDLERS</samp></p>

<p>A try block should have at least one (or more) catch block(s) or one finally block.</p>
















<h3>Catch Block</h3>
<p>The try block associates the scope of its associated exception handlers. You associate exception handlers with a try block by providing one or more catch blocks directly after the try block:</p>

<csperl file="grab" domain="on" record="b/515" template="article_sidebar.view">

  <pre><code>  try {
    ....
  }
  catch IOException with {
    ....
  }
  catch MathException with {
    ....
  };</code></pre>

<p>The syntax is: <samp>catch CLASS with BLOCK</samp></p>

<p>This enables all errors that satisfy the condition $ex-&gt;isa(CLASS) to be
handled by evaluating BLOCK.</p> 

<p>The BLOCK receives two parameters. The first is the exception being thrown and
the second is a scalar reference. If this scalar reference is set on return from the
catch block, then the try block continues as if there was no exception.</p>

<p>If the scalar referenced by the second parameter is not set, and no exceptions
are thrown (within the catch block), then the current try block will return with the result from the
catch block.</p>

<p>In order to propagate an exception, the catch block can choose to rethrow the
exception by calling <em>$ex-&gt;throw()</em></p>

<h3>Order of Catch Blocks Matter</h3>

<p>The order of exception handlers is important. It's all the more critical if you have handlers at different levels in the inheritance hierarchy. Exception handlers that are built to handle exception types that are furthermost from the root of the hierarchy (Error) should be placed first in the list of catch blocks.</p>

<p>An exception handler designed to handle a specific type of object may be pre-empted by another handler whose exception type is a superclass of that type. This happens if the exception handler for that exception type appears earlier in the list of exception handlers.</p>

<p>For example:</p>

  <pre><code>  try {
    my $result = $self-&gt;divide($value, 0);  
	# divide() throws DivideByZeroException
    return $result;  
  }
  catch MathException with {
    my $ex = shift;
    print "Error: Caught MathException occurred\n";
    return;
  }
  catch DivideByZeroException with {
    my $ex = shift;
    print "Error: Caught DivideByZeroException\n";
    return 0;
  };</code></pre>

<p>Assuming the Inheritance hierarchy:</p>
<pre>
  MathException <em>is-a</em> Error                 
       [ @MathException::ISA = qw(Error) ]
  DivideByZeroException <em>is-a</em> MathException 
       [ @DivideByZeroException::ISA = qw(MathException) ]
</pre>
<p>In the above code listing, the DivideByZeroException is caught by the first catch block instead of the second. That is because DivideByZeroException is a subclass of MathException. In other words, <em>$ex-&gt;isa('MathException')</em> returns true. Hence, the exception is handled by the code within the first catch block. Reversing the order of the catch blocks would ensure that the exception is caught by the correct exception handler.</p>   

<h3>Finally Block</h3>
<p>The final step in setting up an exception handler is providing a mechanism for cleaning up before control is passed to different part of the program. This can be achieved by enclosing the cleanup logic within the finally block. Code in the finally block is executed irrespective of what happens within the try block. Typical use of the finally block is to close files or in general to release any system resource.</p>

<p>If no exceptions are thrown, then none of the code in the catch block(s) gets executed. But the code in the finally block is always executed.</p> 

<p>If an exception is thrown, then code in the appropriate catch block is executed. Once the execution of that code is complete, the finally block is executed.</p>

  <pre><code>  try {
    my $file = join('.', '/tmp/tempfile', $$);

    my $fh = new FileHandle($file, 'w');
    throw IOException("Unable to open file - $!") if (!$fh);

    # some code that might throw an exception
    return;
  }
  catch Error with {
    my $ex = shift;
    # Exception handling code
  }
  finally {
    close($fh) if ($fh);    # Close the temporary file
    unlink($file);          # Delete the temporary file
  };</code></pre>

<p>In the above code listing, a temporary file is created in the try block and the block also has some code that can potentially throw an exception. Irrespective of whether the try block succeeds, the temporary file has to be closed and deleted from the file system. This is accomplished by closing and deleting the file in the finally block.</p>

<p>Remember, only one finally block is allowed per try block.</p>

<h3>Throw Statement</h3>

<p>throw() creates a new "Error" object and throws an exception. This exception
would be caught by a surrounding try block, if there is one. Otherwise the
program will exit.</p>

<p>throw() can also be called on an existing exception to rethrow it.
The code listing below illustrates how to rethrow an exception:</p>
  <pre><code>  try {
    $self-&gt;openFile();
    $self-&gt;processFile();
    $self-&gt;closeFile();
  }
  catch IOException with {
    my $ex = shift;
    if (!$self-&gt;raiseException()) {
      warn("IOException occurred - " . $ex-&gt;getMessage());
      return;
    }
    else { 
      $ex-&gt;throw(); # Re-throwing exception
    }
  };</code></pre>
<h3>Building Your Own Exception Class</h3>
<p>Setting the value of the $Error::Debug package variable to true, enables
the capturing of stack trace for later retrieval using the stacktrace()
method. (In case you are not familiar, stacktrace is a list of all the methods
executed in sequence that lead to the exception).</p>

<p>The code snippet below creates the exception classes MathException, DivideByZero and OverFlowException. Where the latter two are subclasses of MathException and MathException by itself is derived from Error.pm</p>
  <pre><code>  package MathException;

  use base qw(Error);
  use overload ('""' =&gt; 'stringify');

  sub new
  {
    my $self = shift;
    my $text = "" . shift;
    my @args = ();

    local $Error::Depth = $Error::Depth + 1;
    local $Error::Debug = 1;  # Enables storing of stacktrace

    $self-&gt;SUPER::new(-text =&gt; $text, @args);
  }
  1;
	  
  package DivideByZeroException;
  use base qw(MathException);
  1;

  package OverFlowException;
  use base qw(MathException);
  1;</code></pre>
<h3>And More ...</h3>

<p>The error modules has other special exception handling blocks, such as <em>except</em> and <em>otherwise</em>. They are deliberately not covered here because they are specific to Error.pm, and you won't find them in other OO languages. For those who are interested, please refer the POD documentation that is embedded within Error.pm.</p>

<h3>Fatal.pm</h3>

<p>If you have some functions that return false on error and a true value on success, then you can use Fatal.pm to convert them into functions that throw exceptions on failure. It is possible to do this to both user defined functions as well as built-in functions (with some exceptions).</p> 
  <pre><code>  use Fatal qw(open close);

  eval { open(FH, "invalidfile") }; 
  if ($@) {
    warn("Error opening file: $@\n");
  }
  
  ....
  ....
  
  eval { close(FH); }; 
  warn($@) if ($@);</code></pre>

<p>By default, Fatal.pm catches every use of the fatalized functions i.e.</p>
  <pre><code>  use Fatal qw(chdir);
  if (chdir("/tmp/tmp/")) {
    ....
  }
  else { 
    # Execution flow never reaches here
  }</code></pre>
<p>If you are fortunate enough to have Perl 5.6 or later, then you can circumvent this by adding :void in the import list. All functions named after this in that import list will raise an exception only when they are called in void context i.e. when their return values are being ignored.</p>

<p>By changing the use statement, as shown below we can be sure that the code in the else block is executed when chdir() fails</p>
  <pre><code>  use Fatal qw(:void chdir);</code></pre>  
<p>The code listing below illustrates the use of Fatal.pm in conjunction with Error.pm.</p>

  <pre><code>  use Error qw(:try);
  use Fatal qw(:void open);

  try {
    open(FH, $file);
    ....
    openDBConnection($dsn);
    return;
  }
  catch DBConnectionException with {
    my $ex = shift;
    # Database connection failed
  }
  catch Error with {
    my $ex = shift;
    # If the open() fails, then we'll be here  
  };</code></pre>
<h3>The Perl6 Connection</h3>

<p>Since the exception handling syntax in Perl 6 is expected to be modeled closely against Error.pm as detailed in the Perl 6 RFC 63 Exception handling syntax - <cite>http://dev.perl.org/rfc/63.pod</cite>, also in RFC 80 and RFC 88. It would make sense for developers to make use of OO-ish exception handling capabilities in their code and later on migrate to the exception handling syntax in Perl 6, as and when it is available.</p>

<h3>Conclusion</h3>
<p>The following are some of the key reasons to choose exception-handling mechanism over the traditional error-handling mechanisms:</p>
<ul>
	<li>Error handling code can be separated from normal code</li>
	<li>Less complex, more readable and more efficient code</li>
	<li>Ability to propagating errors up the call stack</li>
	<li>Ability to persist contextual information for the exception handler</li>
	<li>Logical grouping of error types</li>
</ul>

<strong><p>So, stop returning error codes and start throwing exceptions.</p>

<p>Have an exceptional time !!</p>
</strong>


        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1400" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2002/11/p6pdigest/20021107.html" rel="bookmark">This week on Perl 6 (10/28-11/03, 2002)</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Piers Cawley</span> on <abbr class="published" title="2002-11-06T00:00:00-08:00">November  6, 2002 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            
<!-- sidebar begins -->
<!-- don't move sidebars -->
<!-- sidebar ends -->


<p>Welcome to the latest of the ongoing series of Perl 6 summaries, in
which your arrogant moderator does battle with the forces of prolixity
in a Brobdingnagian attempt to tame the tortuously tangled threads of
Perl 6's design and development mailing lists. And if I keep up the
purple prose at that rate, then it'll *still* be clearer than the tangle
that is this week's perl6-language discussion.</p>
<p>However, because it's customary and because the language list scares
me, we'll start with the comparatively tame perl6-internals.</p>

<h4><a name="fun_with_file_formats">Fun With File Formats</a></h4>
<p>Toward the end of last week, Rhys Weatherley had asked about being
able to insert arbitrary chunks of metadata into parrot bytecode
files. Dan ended up producing a `draft sketch' of the bytecode
generation facilities and the ability to add arbitrary chunks of
metadata was conspicuous by its absence. People didn't seem to be
happy about this, lamenting a lack of flexibility, both in the overall
file structure and in what one could stick into the bytecode. Dan
mounted a sturdy defense, pointing out that we want `a file format
that does what we need it to -- present executable bytecode data to the
interpreter -- as fast as possible. Everything else is secondary to
that.'</p>
<p>Kv Org wondered whether it would be a good idea to worry about sandbox
issues in the bytecode format, but nothing came of that
question. Well, not this week anyway.</p>
<p><a href="http://groups.google.com/groups?threadm=00ab01c27cb2%24bb206300%247b01a8c0%40deepblue">http://groups.google.com/groups</a></p>
<p><a href="http://groups.google.com/groups?threadm=20021027211330.71710.qmail%40onion.perl.org">http://groups.google.com/groups</a></p>
<p><a href="http://groups.google.com/groups?threadm=a05111b09b9e46aae3b80%40%5B63.120.19.221%5D">http://groups.google.com/groups</a></p>
<p><a href="http://groups.google.com/groups?threadm=20021030221715.73307.qmail%40web13206.mail.yahoo.com">http://groups.google.com/groups</a></p>

<h4><a name="portable_linking_issues">Portable Linking Issues</a></h4>
<p>Andy Dougherty is having portability problems. He wants to portably
compile and link three files, and he's having problems and wondered what
the best way was to get an early test compiling properly on
all platforms. Help was supplied, the build was fixed, and the world
remained safe for democracy. (Modulo a few local difficulties.)</p>
<p><a href="http://groups.google.com/groups?threadm=Pine.SOL.4.10.10210281229360.23168-100000%40maxwell.phys.lafayette.edu">http://groups.google.com/groups</a></p>

<h4><a name="implicit_stack_direction_probe">Implicit Stack Direction Probe</a></h4>
<p>Meanwhile, Jason Gloudon's patch to move the stack direction probe
back to initialization time rather than compile time was offered. I'm
assuming that Nicholas Clark's suggested speedup trick from last week
was implemented as part of it, but I'm no great understander of C.</p>
<p><a href="http://rt.perl.org/rt2/Ticket/Display.html?id=18127">http://rt.perl.org/rt2/Ticket/Display.html</a></p>

<h4><a name="of_mops_and_microops">Of MOPS and Microops</a></h4>
<p>There's been some discussion of granting a small number of Parrot
registers 'most favored' status. The idea being that a small number
of registers would actually be held in global (possibly real register)
variables, with the rest being accessed through via indirection
through the interpreter. Apparently, the JIT core already does some
optimization along these lines, and Dan doesn't seem to be sure that
doing it for the main interpreter would actually be much of
win. Discussion continues.</p>
<p><a href="http://groups.google.com/groups?threadm=a05111b03b9e358db9680%40%5B63.120.19.221%5D">http://groups.google.com/groups</a></p>

<h4><a name="very_complete_lexical_scopes">Very Complete Lexical Scopes</a></h4>
<p>Jonathan Sillito has submitted a patch that `implements a very
complete set of lexical scope semantics.' It looks pretty cool to my
untutored eye. General response was positive, though J&uuml;rgen
B&ouml;mmels did have a query about how to create a new scope.</p>
<p><a href="http://rt.perl.org/rt2/Ticket/Display.html?id=18170">http://rt.perl.org/rt2/Ticket/Display.html</a></p>

<h4><a name="miniparrot,_a_first_attempt"><em>miniparrot</em>, a First Attempt</a></h4>
<p>If you've been paying attention to the Parrot build process, then you aware that it was always a goal to use a cut-down variant of Parrot
itself to run the configuration tests. The plan is that this
<em>miniparrot</em> should be buildable with nothing more than an ANSI-compliant C compiler. Josh Wilmes thinks we're about ready to start
building said miniparrot, and offered his first cut to the
list. Response was positive, with quibbles, which is about what one
would expect.</p>
<p><a href="http://groups.google.com/groups?threadm=200211010345.gA13jUJ2005602%40galactic.hitchhiker.org">http://groups.google.com/groups</a></p>


<h3><a name="meanwhile,_over_in_perl6language_(or_the_horror!_the_horror!)">Meanwhile, Over in perl6-language (or &quot;The Horror! The
Horror!&quot;)</a></h3>
<p>The dreaded `Operator Reshuffle' thread continues apace -- of the 450
posts last week I'd say about 400 of 'em were discussing various
aspects. Bear in mind, too, that the path of discussion could be
described as helical (sort of like circular, but getting more and more
wound up with each go 'round). There are at least two factions
involved, roughly caricatured as `Simon Cozens versus the rest of the
world.' Simon can be thought of as the voice of conservatism (or
Reason, depending on whether you agree with him or not), generally
arguing against stuff he considers massively ugly or
confusing. Simon's allies vary depending on which issue he's
discussing and his worries include:</p>
<ul>
<li>
Perl 6 is going to be even harder to parse than Perl 5</li>

<li>
Unicode operators in the core language are just wrong. Many people
agree with him.</li>

<li>
Superpositional operators will be too rare to justify giving them
precious one character operators.</li>
</ul>
<p>This is, of course, a gross simplification of what's going on in the
various operator threads, but it does cover a fair number of the
issues that are arising in the attempt to get <code>^</code> back as exclusive
or (which then frees <code>~</code> up to become string concatenate,
which... ah, go read last week's summary, I already did this...)</p>
<p>BTW, 'Vectorizing' is the new 'Hyperizing' (or did I do that last
week?)</p>
<p>Here's the various threads involved in the kerfuffle, along with
Michael Lazzaro's utterly wonderful summaries of the current core
operator list as he sees it.</p>
<p><a href="http://groups.google.com/groups?threadm=3DBC5347.6DB387E4%40cognitivity.com">http://groups.google.com/groups</a> -- Op list, Take 3.</p>
<p><a href="http://groups.google.com/groups?threadm=C3D428ED-EABB-11D6-A0B2-00050245244A%40cognitivity.com">http://groups.google.com/groups</a> -- Take 4</p>
<p><a href="http://groups.google.com/groups?threadm=43215E86-EBA5-11D6-AC84-00050245244A%40cognitivity.com">http://groups.google.com/groups</a> -- Take 5</p>
<p><a href="http://groups.google.com/groups?threadm=63ED27DD-EBA5-11D6-AC84-00050245244A%40cognitivity.com">http://groups.google.com/groups</a> -- Take 5a</p>
<p><a href="http://groups.google.com/groups?threadm=E3FD6D2B-EC68-11D6-B3E1-00050245244A%40cognitivity.com">http://groups.google.com/groups</a> -- Take 5b</p>
<p><a href="http://groups.google.com/groups?threadm=8964D98F-EDD7-11D6-8B40-00050245244A%40cognitivity.com">http://groups.google.com/groups</a> -- Take 6</p>
<p><a href="http://groups.google.com/groups?threadm=00A132CC-ECF7-11D6-9717-00050245244A%40cognitivity.com">http://groups.google.com/groups</a> -- Pointers to
Unicode stuff</p>
<p><a href="http://groups.google.com/groups?threadm=20021031111328.A6143%40rama.comp.pge.com">http://groups.google.com/groups</a> -- Someone coming in late</p>
<p><a href="http://groups.google.com/groups?threadm=847kg1ol2a.fsf%40despairon.bofh.org.uk">http://groups.google.com/groups</a> -- Questioning the value of
infix superpositions</p>

<h4><a name="smalltalk_type_collection_classes">Smalltalk-Type Collection Classes?</a></h4>
<p>One of the subthreads of the mammoth operator thread covered whether it
might be a good idea to include a set of collection classes in the
style of the Smalltalk Collection hierarchy to the Perl 6 core dist.</p>
<p><a href="http://groups.google.com/groups?threadm=20021030094931.Y32444-100000%40megazone23.bigpanda.com">http://groups.google.com/groups</a></p>

<h4><a name="persistence_of_superpositions">Persistence of superpositions</a></h4>
<p>Buddha Buck wondered how pervasive superpositions were, and for how
long they would remain entangled. Damian thinks they should be all
pervading and fully propagating. This thread didn't really stay 
on topic ... .</p>
<p><a href="http://groups.google.com/groups?threadm=3DBEF820.3040502%4014850.com">http://groups.google.com/groups</a></p>

<h4><a name="proposal:_vector_operators_for_hashes">Proposal: Vector Operators for Hashes</a></h4>
<p>Arcadi made some proposals about how to extend the concept of vector
operators to hashes as well as lists and arrays. Discussion
ensued. People seem to like the idea of extending vector ops to cover
hashes, but weren't necessarily sure that Arcadi's approach was the
right one. 'Adverbial' control of how the vector ops work was also
discussed, though Larry gave the impression that he thought this might
be a generalization ... .</p>
<p><a href="http://groups.google.com/groups?threadm=15808.18541.314762.704302%40figaro.weizmann.ac.il">http://groups.google.com/groups</a></p>

<h4><a name="plaintive_whine_about_for_syntax">Plaintive Whine About <code>for</code> Syntax</a></h4>
<p>Dave Storrs really doesn't like the syntax of the `parallel streams'
variant of <code>for</code>:</p>
<pre>
    # This iterates over @a and @b in parallel</pre>
<pre>
    for @a; @b -&gt; $x is rw; $y { $x = $y[5] }</pre>
<p>and he offered a list of suggestions, though I think more people
disliked his alternatives (even among those who didn't like the
current syntax) than liked 'em. Damian pointed out that a little
finesse with the editor could be of some assistance:</p>
<pre>
    for @a      ; @b       
     -&gt; $x is rw; $y { ... }</pre>
<p>Ed Peshko wondered what happened when you had a lot of parallel
streams, and Damian obliged with:</p>
<pre>
    for  @a;  @b;  @c;  @d;  @e
     -&gt;  $a_var1 is rw, $a_var2 is rw;
              $b_var is rw;
                   $c_var is rw;
                        $d_var is rw;
                             $e_var1 is rw, $e_var2 is rw 
    {
        ...
    }</pre>
<p>But this is a somewhat pathological case. Damian also mentioned that
he and Larry had thought long and hard about whether to
interleave sources and iterators before deciding on the current
syntax.</p>
<p><a href="http://groups.google.com/groups?threadm=20021030102958.U32444-100000%40megazone23.bigpanda.com">http://groups.google.com/groups</a></p>
<p><a href="http://groups.google.com/groups?threadm=3DC19847.7040100%40conway.org">http://groups.google.com/groups</a></p>















<h4><a name="nondeterministic_algorithms,_flexops,_and_stuff">Nondeterministic Algorithms, Flexops and Stuff</a></h4>
<p>Piers Cawley made heads hurt (his included) when he posted a question
about using superpositions (aka flexops) to implement nondeterministic
algorithms. The particular example given was an algorithm to find a
path between two nodes of an acyclic-directed graph (lifted from a
text on lisp). Jonathan Scott Duff thought the idea was 'neat.' For an
encore, Piers redid the function without flexops, using a continuation-based implementation of <code>choose</code> and <code>fail</code> (which hurts my head
more than the superposition-based version, frankly).</p>
<p><a href="http://groups.google.com/groups?threadm=84hef4j96p.fsf%40despairon.bofh.org.uk">http://groups.google.com/groups</a></p>

<h4><a name="primitive_boolean_type">Primitive Boolean Type?</a></h4>
<p>Michael Lazzaro asked a tricky question: Can a <code>bit</code> be undefined? If
so, then it leads to the somewhat counterintuitive assumption that one
would need two bits to store a single `bit.' Which is certainly
odd. However, it turns out that native types like <code>bit</code>, <code>int</code>, cannot be undefined; so that's all right. This then branched off into
a discussion of whether Perl 6 would have an explicit Boolean
type. It won't. Unless Larry changes his mind.</p>
<p><a href="http://groups.google.com/groups?threadm=31FAE3A3-ED22-11D6-8C8F-00050245244A%40cognitivity.com">http://groups.google.com/groups</a></p>

<h4><a name="labelled_if_blocks">Labeled If Blocks</a></h4>
<p>Last week, Steve Canfield wondered whether Perl 6 would have labeled if
blocks, which would allow one to jump out of arbitrary levels of
nested ifs. It seems the answer is `no,' but this led to a discussion
of possible control statements that affect the flow of control in
different sorts of blocks (subs, conditionals, loops, etc.). It's
looking like we may end up with a <code>leave</code> statement. The other
possibility would be to make return a method, allowing one to do:</p>
<pre>
    Loop.return($x)</pre>
<p>or whatever.</p>
<p><a href="http://groups.google.com/groups?threadm=Pine.LNX.4.44.0210280903190.15960-100000%40london.wall.org">http://groups.google.com/groups</a></p>
<p><a href="http://groups.google.com/groups?threadm=Pine.LNX.4.44.0210281614510.18296-100000%40london.wall.org">http://groups.google.com/groups</a></p>


<h3><a name="in_brief">In Brief</a></h3>
<p>There was some discussion on the internals list about what functions
need to have an interpreter argument. The basic rule appears to be: `If
it's going to allocate memory, it needs an interpreter.'</p>
<p>Leopold Toetsch has rejigged the startup procedure so that we will
always have a valid interpreter, making patches like the one that
allowed for a NULL interpreter in <code>sprintf</code> unnecessary.</p>
<p>Discussion of the Parrot Copyright/License changes was subdued,
bordering on the nonexistent. Let's hope it stays as smooth.</p>
<p>Leo Toetsch has been doing various refactorings of Parrot ops.</p>
<p>There was discussion about how to generate the MD5 hashes for Parrot
bytecode `fingerprints.' The catch is that the Perl module
<strong>Digest::MD5</strong> isn't guaranteed to be available on all Perl
installations ... .</p>
<p>Josh Wilmes did a massive 'indentation cleanup' patch (2000+ line
patch).</p>
<p>Allison Randal has a fascinating article all about Perl 6 topics and
topicalizers at <a href="/pub/a/2002/10/30/topic.html">http://www.perl.com/pub/a/2002/10/30/topic.html</a>,
which is well worth the read.</p>
<p>Paul Johnson had some thoughts about using properties on statements
and the like as a way of providing metadata to things like code-coverage tools.</p>


<h3><a name="who's_who_in_perl_6">Who's Who in Perl 6?</a></h3>
<dl>
<dt><strong><a name="item_who_are_you%3f">Who are you?</a></strong><br />
</dt>
<dd>
Mike Lazzaro.  My wife and I own a company called Cognitivity
(http://www.cognitivity.com/) in Burbank, California. We met at
Caltech, in Pasadena.  We use Perl5 for our commercial e-learning
software (online, customizable corporate training software).  This is
the first company we actually own, after working as
consultants/contractors/employees for years at other places.  It's
great.
</dd>

<dt><strong><a name="item_what_do_you_do_for%2fwith_perl_6%3f">What do you do for/with Perl 6?</a></strong><br />
</dt>
<dd>
Originally, I just wanted to document Perl6's OO behaviours, but I soon
found that to be impossible without documenting everything else first,
so that's what I'm doing.  I'm going piece-by-piece through all the
early Apocalypses, attempting to fill in all the details and
implications, which I am writing up in book-like form.  As I get them
done, I'll post them for review and feedback -- but before that, I'll
have a lot of little questions and inconsistencies that I need to pin
down.
</dd>
<dd>
<p>My feeling is, because I'm *not* on the design team, and I *don't*
know all the thinking on how and why things are decided, I'm a good
test person to write newbie-level documentation.  If you can explain
it to me, that's a pretty good indication that you and I can explain
it to someone else.  I think the disconnection between designer and
documenter will be important, in this case, because we want Perl6 to
be heavily adopted by mere mortals, not just experts.</p>
</dd>

<dt><strong><a name="item_where_are_you_coming_from%3f">Where are you coming from?</a></strong><br />
</dt>
<dd>
I've been using Perl since the 4 to 5 migration.  Before that, I was
mainly a C/C++ person.  Before that, assembler.  Perl5 is the best
language I've ever used, but lately it's had some enterprise-level
scalability problems that I need to solve, if I'm going to keep using
it.  Hence, I'm helping with Perl6.
</dd>

<dt><strong><a name="item_when_do_you_think_perl_6_will_be_released%3f">When do you think Perl 6 will be released?</a></strong><br />
</dt>
<dd>
Sooner than people think ... maybe a robust alpha within six months, I
bet.  People are worried about the length of time it's taking to get
through the initial decisions, but most of the hard ones have already
been done.  It's going to pick up dramatically after the next two or
three Apocalypses.
</dd>

<dt><strong><a name="item_why_are_you_doing_this%3f">Why are you doing this?</a></strong><br />
</dt>
<dd>
Because I've had to work in five different languages over the past few
years, and they all suck, each in their own special way.  Horribly.
If I'm going to continue programming as a career, I want to work in a
language that, as much as possible, takes the grunt work out.  I don't
like re-solving the same design patterns umpteen times.  That's
something a computer should do for me.
</dd>
<dd>
<p>Why am I volunteering for documentation?  Dunno, seemed like that
effort was falling behind, since everyone keeps asking the same
questions, over and over (like me, for example).  And I can type fast.
And I've got lots of experience at herding cats, which can't hurt ... .</p>
</dd>

<dt><strong><a name="item_you_have_5_words%2e_describe_yourself%2e">You have five words. Describe yourself.</a></strong><br />
</dt>
<dd>
Programmer. Manager. Writer. Optimist. Cynic.
</dd>

<dt><strong><a name="item_do_you_have_anything_to_declare%3f">Do you have anything to declare?</a></strong><br />
</dt>
<dd>
I've grown to hate most technical terms, because nobody uses them to
mean the same way.  So I have an allergic reaction to descriptions
that use a lot of big words to explain something that should be Much
More Obvious.  You'll find I post a lot of &quot;please clarify&quot; messages,
to try to beat that out of people.  :-) It doesn't <em>always</em> mean I'm
dense, though sometimes it does.  Sometimes it means &quot;No -- really.
Is that your final answer?&quot;
</dd>
</dl>


<h3><a name="acknowledgements,_requests_and_the_third_thing.">Acknowledgements, Requests and the Third Thing.</a></h3>
<p>This summary was once again brought to you from the comfort and
security of a GNER Express train running between Newark and London,
and from the greater comfort and security of my armchair at
home. Production was abetted by industrial quantities of site tea (in
the case of GNER) and Earl Grey China Moon tea (in the armchair).</p>
<p>Proofreading was mostly done by Piers Cawley, so you can blame him if
there are any outrageous typos.</p>
<p>And, as the postamble usually goes, if you didn't like this summary,
then what are you doing still reading it? If you did like it, then please
consider one or both of the following options:</p>
<ul>
<li>
Send money to the Perl Foundation at
<a href="http://donate.perl-foundation.org/">http://donate.perl-foundation.org/</a> and help support the ongoing
development of Perl 6.</li>

<li>
Send feedback, flames, money and/or a tenchi-masa goban with a set of
thickish yuki grade shell and slate stones in Shimakuwa bowls to
<em><a href="mailto:mailto:pdcawley@bofh.org.uk">mailto:pdcawley@bofh.org.uk</a></em>.</li>
</ul>
<p>The fee paid for publication of these summaries on perl.com is paid
directly to the Perl Foundation.</p>


        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1388" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2002/11/06/review.html" rel="bookmark">Writing Perl Modules for CPAN</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Simon Cozens</span> on <abbr class="published" title="2002-11-06T00:00:00-08:00">November  6, 2002 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            <p>As Andy Lester points out in this month's Perl Review, one big advantage
of there being so many Perl books around is that the publishers can now
get around to putting out books on some of the more &quot;niche&quot; areas of
Perl. Finally, we can explore many areas that haven't really been
written down and codified before.</p>
<p>Sam Tregar's &quot;Writing Perl Modules For CPAN&quot; certainly does this, and in
a good way; most hints and strategies for designing, creating and
maintaining Perl modules, including the sometimes arduous community
interaction that this entails, have been handed down wordlessly through
observation of the old hands. I tried my best in the core <code>perlnewmod</code>
documentation to explain some of the issues involved, but Sam - a bit of
an old hand himself, with the <code>HTML::Template</code> and <code>Devel::Profiler</code>
modules amongst his output
- takes the time to cover all the bases: from how to create a module
distribution and how to get your PAUSE ID and so on to how
to handle feature creep, setting up mailing lists and CVS servers, and
with &quot;bonus&quot; chapters on XS programming and CGI applications.</p>
<p>Don't be put off by the book's title; even if you're not planning on
making your modules public, we've found that the techniques of good
distribution management and source control explained in this book are
assets even when you're developing modules internal to a company or
specific application.</p>
<p>Frequent readers of my reviews will know that one of my favorite
subjects is introductory filler, and this book doesn't get off lightly
either; chapter 1, the history and motivation of the CPAN, really ought
to go in the foreword, and chapter 2, Perl module basics, should be
required knowledge.</p>
<p>The writing style is friendly but direct, although I occasionally feel
that the author tends to overuse footnotes a little, (Chapter 7 has 25
footnotes in 10 pages) and has a good mix of practical and philosophical
discussion appropriate for this topic. The code style is perfectly fine,
although I would like to have seen <code>use strict</code> a little more
prominently, and some discussion of error handling and checking would not
have gone amiss.</p>
<p>On the down side: typography. For some reason, the book's designer is
enamoured of bold and italic typewriter faces for headings, which
frankly looks horrible. Sadly, typos are rife, and there are some
surprising omissions, too: The wonderful cpan-upload script is not
mentioned, nor is the <a href="http://rt.cpan.org">CPAN bug-tracking system</a>,
and coverage of testing, one of the recent obsessions of the Perl module
community, is quite thin.</p>
<p>On the other hand, I was surprised by the XS chapters; they work. Sam
somehow manages to pack just enough information into two relatively slim
chapters at the end of the book to allow some pretty complex XS modules
to be created by the adventurous reader, but then follows it with quite
a bit of repetition in the following chapter, on <code>Inline::C</code>.</p>
<p>Similarly, the chapter on Great CPAN Modules was an unexpectedly good
read - I'd never before sat down and thought about why one particular
XML parsing module (say) should be more popular than another, and this
is a good summary of the issues involved.</p>
<p>If you're thinking about writing a Perl module, whether or not it's for
public consumption, then I'd certainly recommend getting a copy of this
book; I certainly learned a few things about module maintainance from
it, and I'm sure you will too.</p>
<hr /><p><a href="http://www.apress.com/book/bookDisplay.html?bID=14"><em>Writing Perl Modules for CPAN</em></a> is published by Apress.</p>


        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1398" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2002/11/p6pdigest/20021027.html" rel="bookmark">This week on Perl 6 (10/20-27, 2002)</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Piers Cawley</span> on <abbr class="published" title="2002-11-04T00:00:00-08:00">November  4, 2002 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            
<p>You may have noticed that this summary is late. Um ... [looks sheepish,
shuffles feet], the dog ate my homework. I did a tiny bit of
procrastination at the beginning of the week and then got totally
overtaken by events involving failed AC adaptors and general
confusion. Sorry folks, it will probably happen again, but hopefully
not in the near future.</p>
<p>So, kicking off, as is customary, with perl6-internals before getting
down to attempting to summarize the monster that was perl6-language:</p>

<h4><a name="c#_and_parrot" id="c#_and_parrot">C# and Parrot</a></h4>
<p>The dialogue with Rhys Weatherley and Gopal V from the DotGNU project
continues apace, mostly to do with clarifying what C# needs in the way
of datatypes and the like. It appears that Leon Brocard is the go to
guy if you need to know the exact details of almost anything in a
language spec. Maybe he's just really good with Google.</p>
<p>Gopal V wondered whether there was someone involved in p5i who would mind
acting as a liaison with the DotGNU people and who could give them a heads
up when, for example, the packfile format changed. Leopold Toetsch wondered
what type of changes were potential C# breakers, as there were
probably things that we thought of as `internal' that the C# team
could be depending on. Leo also thought that the liaison person should
probably be Dan.</p>
<p><a href="http://groups.google.com/groups?threadm=20021026223952.A6708%40md3.vsnl.net.in">http://groups.google.com/groups</a></p>

<h4><a name="scratchpad_confusion" id="scratchpad_confusion">Scratchpad Confusion</a></h4>
<p>At the end of last week, Allen Short pointed out some discrepancies
between the implementation of scratchpads and the description of them
in PDD6. John Sillito reckoned that PDD6 was waiting on a rewrite from
Dan, especially where Scratchpad PMCs were concerned as there were a
couple of different patches waiting on Dan's say so. Dan also offered
some clarification, but hasn't ruled on the Scratchpad PMCs yet.</p>
<p><a href="http://groups.google.com/groups?threadm=20021020.165144.233688742.washort%40twistedmatrix.com">http://groups.google.com/groups</a></p>

<h4><a name="help!_bugs!_crawling_all_over_me!_or_the_road_to_0.0.9" id="help!_bugs!_crawling_all_over_me!_or_the_road_to_0.0.9">Help! Bugs! Crawling All Over Me! OR the Road to 0.0.9</a></h4>
<p>Steve Fink wants the GC bugs ironed out before he goes adding much in
the way of new features, and he wants to start putting together a
0.0.9 with working GC, too. To that end, he deliberately broke all
the tests by turning GC_DEBUG on for tests. There's a certain amount
of cleverness involved in how he did this; read his post if you're
interested. Peter Gibbs found what he thought was a fix for a couple
of the failures and pointed to the possibility of a fundamental
problem in MultiArray as the culprit for the remaining failure. Steve
applied this patch with much rejoicing, and then came up with a trial
patch that seemed to fix the multiarray-triggered failure. This patch
had not been finalized by the end of the week.</p>
<p>Steve also kicked off discussion of the forthcoming 0.0.9 release,
when he posted his list of prerequisites and sparked off a decent
amount of discussion of various points. Steve's overarching goal for
this release appears to be 'bug reduction and general consolidation.'</p>
<p><a href="http://groups.google.com/groups?threadm=20021021085217.GH2030%40foxglove.digital-integrity.com">http://groups.google.com/groups</a></p>
<p><a href="http://groups.google.com/groups?threadm=20021023162722.GI2103%40foxglove.digital-integrity.com">http://groups.google.com/groups</a></p>

<h4><a name="keyed_ops,_the_return." id="keyed_ops,_the_return.">Keyed ops, the Return.</a></h4>
<p>I think it's safe to say that some people aren't entirely happy with
keyed ops as they stand now in Parrot. The week before, Leopold
Toetsch had written a proposal for keyed ops. This week, he supplied a
proof of concept patch. J&uuml;rgen B&ouml;mmels liked it but Dan
took a little more convincing. I'm not sure he is entirely convinced
yet, but he's willing to live with it.</p>
<p><a href="http://groups.google.com/groups?threadm=3DB4216B.1080409%40toetsch.at">http://groups.google.com/groups</a></p>

<h4><a name="64bit_ints_and_noncapable_hardware" id="64bit_ints_and_noncapable_hardware">64-bit ints and Noncapable Hardware</a></h4>
<p>Dan announced that he was about to bite the bullet and declare that
INTVALS have to be 64-bit integers and wanted to know of any
(plausible) platforms that have neither native nor emulated 64-bit
integers. Martin D Kealey pointed at what sounds like a scary proposal
from C99 involving declarations and clever compilers and wondered whether
it might be a way forward for Parrot. Rhys wondered how well the idea
would play with something as dynamic as Parrot and the languages
expected to run on it, but Martin didn't seem to think it would be
much of a problem.</p>
<p><a href="http://groups.google.com/groups?threadm=a05111b0db9da0181ab77%40%5B63.120.19.221%5D">http://groups.google.com/groups</a></p>
<p><a href="http://wwwold.dkuug.dk/JTC1/SC22/WG14/docs/c9x/extended-integers/">http://wwwold.dkuug.dk/JTC1/SC22/WG14/docs/c9x/extended-integers/</a></p>

<h4><a name="configuring_and_dod" id="configuring_and_dod">Configuring and DOD</a></h4>
<p>Erik Lechak couldn't get the latest parrot to build on WinXP. Josh
Wilmes diagnosed a problem with the way the configuration tools probed
for stack direction, and patched things so that stack direction
detection was done at runtime once more. Jason Gloudon, who had moved
the detection phase out into configuration time wasn't sure that this
was a good idea 'cos it would lead to a performance hit in the stack
walking code. Nicholas Clark, with his clever head on, came up with
three different ways of doing things at runtime without a performance
hit, and Dan blessed the third choice.</p>
<p><a href="http://groups.google.com/groups?threadm=200210240323.g9O3NQN3010652%40galactic.hitchhiker.org">http://groups.google.com/groups</a></p>

<h4><a name="execute_in_place" id="execute_in_place">Execute in place?</a></h4>
<p>Rhys Weatherley has been taking a look at our packfile format code,
and thinks it could be improved by designing the format in such a way
that it can be <code>mmap</code>ped into a block of memory and executed immediately,
as opposed to the way parrot currently does it, which involves moving
stuff around in memory before starting execution. Dan said that that's
how things were originally done, and if it wasn't still possible, then
that was a bug.</p>
<p><a href="http://groups.google.com/groups?threadm=3DB927BB.8D19D9C9%40zip.com.au">http://groups.google.com/groups</a></p>

<h4><a name="copyright_notices_and_license_stuff" id="copyright_notices_and_license_stuff">Copyright Notices and License Stuff</a></h4>
<p>Toward the end of the week, Dan announced that he was about to
straighten out the copyright and licensing situation. As a first
step, he would be marking everything in the core as Copyright YAS. It
looks like Parrot itself will be moving to an MIT-style license `Over
no objections whatsoever from the FSF.'</p>
<p>If you've made any contributions to Parrot's code base, then you've
probably already been contacted, but if you haven't and have an
objection, then you should contact Dan.</p>
<p>Most of the discussion of this happened during the next week, and I'll
return to it in my next summary, but response was generally favorable
after some clarifications from Dan.</p>
<p><a href="http://groups.google.com/groups?threadm=a05111b13b9e097305b07%40%5B63.120.19.221%5D">http://groups.google.com/groups</a></p>

<h4><a name="allow_a_null_interpreter_in_sprintf_like_functions" id="allow_a_null_interpreter_in_sprintf_like_functions">Allow a NULL Interpreter in <code>sprintf</code> Like Functions</a></h4>
<p>J&uuml;rgen B&ouml;mmels sent in a patch that allowed the use of a
NULL interpreter in <code>sprintf</code> like functions. Leo Toetsch applied it,
but wondered whether it was actually the right thing. Dan seemed to think
that, in the long run, it probably wasn't and that, if something went
horribly wrong before an interpreter got properly set up, then it was
probably best to use the standard library functions.</p>
<p><a href="http://groups.google.com/groups?threadm=rt-18097-40584.7.52416404410681%40bugs6.perl.org">http://groups.google.com/groups</a></p>
<p><a href="http://groups.google.com/groups?threadm=a05111b23b9e1be83d6b3%40%5B63.120.19.221%5D">http://groups.google.com/groups</a></p>

<h4><a name="draft_sketch_of_bytecode_generation" id="draft_sketch_of_bytecode_generation">Draft Sketch of Bytecode Generation</a></h4>
<p>Dan offered a `<em>very</em> sketchy' draft of his thoughts on what we need
from our bytecode generation system. Initial reaction seemed positive.</p>
<p><a href="http://groups.google.com/groups?threadm=a05111b25b9e1ca2991c4%40%5B63.120.19.221%5D">http://groups.google.com/groups</a></p>















<h3><a name="meanwhile,_in_perl6language" id="meanwhile,_in_perl6language">Meanwhile, in perl6-language</a></h3>

<h4><a name="won't_someone_please_think_of_the_summarizer" id="won't_someone_please_think_of_the_summarizer">Won't someone <em>please</em> think of the summarizer?</a></h4>
<p>There were about 150 messages in perl6-language this week. The *vast*
majority of them discussing the Perl 6 built in operator list. It all
started weeks ago, when Damian wanted <code>|</code>, <code>&amp;</code> and
<code>the_as_yet_unnamed_xor_operator</code> as superposition generating
operators. But that meant we'd need somewhere else to put the bitwise
operators. And people like <code>^</code> as xor, but that's not likely
because of hyper ops. And <em>nobody</em> likes <code>_</code> as a concatenation
operator. It's all become very complicated.</p>
<p>However, in answer to a summarizer's prayer, Michael Lazzaro has taken
to posting a scorecard of his understanding of what the current list
of built in ops is. (A list of diffs between these would be interesting
to see...). Things that appear to be set in stone:</p>
<ul>
<li>
<code>~</code> is the new <code>_</code>, which was the new <code>.</code> and which nobody liked.</li>

<li>
<code>~~</code> is the new <code>=~</code>. (Otherwise <code>=~</code> -&gt; match, and <code>~=</code>
-&gt; string append could get somewhat confused...) <code>!~</code> stays the same.</li>

<li>
<code>|</code> and <code>&amp;</code> make <code>any</code> and <code>all</code> type superpositions,
respectively. Damian has an article on why superpositions are such a
good idea forthcoming for perl.com. The phrase `in constant time' will
probably not be used.</li>

<li>
Nobody has any idea what xor will end up as.</li>

<li>
Some people are worried that changing things too radically from old
Perl/Algol type syntax will make for a harder learning curve. Other people
tend to think that not many programmers use bitwise ops in Perl at the
moment, so the change shouldn't matter too much.</li>

<li>
It's a real shame that so many Unicode characters are so hard to type.</li>
</ul>
<p>Here's a list of Michael's various opcode lists. They're usually good
entry points to the discussion. (Which is kind of fascinating...)</p>
<p><a href="http://groups.google.com/groups?threadm=7A748E43-E847-11D6-A7D4-00050245244A%40cognitivity.com">http://groups.google.com/groups</a></p>
<p><a href="http://groups.google.com/groups?threadm=F574FCCE-E86E-11D6-A7D4-00050245244A%40cognitivity.com">http://groups.google.com/groups</a></p>
<p><a href="http://groups.google.com/groups?threadm=3DBC5347.6DB387E4%40cognitivity.com">http://groups.google.com/groups</a></p>

<h4><a name="character_properties" id="character_properties">Character Properties</a></h4>
<p>Luke Palmer wondered whether we were planning on having properties on
individual characters on a string; something he felt was an essential
feature. There was a certain amount of debate about the use of the
word `essential' in this context, leading Luke to give some more
information about what he was driving at before he was eventually
convinced that what he wanted was an ideal candidate for a module.</p>
<p><a href="http://groups.google.com/groups?threadm=20021021050943.9C0E9287%40babylonia.flatirons.org">http://groups.google.com/groups</a></p>
<p><a href="http://groups.google.com/groups?threadm=20021021202056.DCECF289%40babylonia.flatirons.org">http://groups.google.com/groups</a></p>

<h4><a name="perl6_built_in_types" id="perl6_built_in_types">Perl6 Built-in Types</a></h4>
<p>Michael Lazzaro asked for a list of Perl6 built-in types and offered
his own first cut at such a list. Larry offered some corrections, but
reckoned that the list Michael had just posted was the nearest thing
we had to a definitive list.</p>
<p><a href="http://groups.google.com/groups?threadm=EF53A634-E6B1-11D6-A0A5-00050245244A%40cognitivity.com">http://groups.google.com/groups</a></p>

<h4><a name="power_of_lisp_macros" id="power_of_lisp_macros">Power of Lisp Macros</a></h4>
<p>Adriano Nagelschmidt has been reading Paul Graham's articles about
Lisp and its advantages, especially the macro system, and wanted to
know whether the macros were really as useful as Mr. Graham claimed, and
whether it was worth adding something like them to Perl. General
consensus appears to be ``Yes, they're really good, and yes, Perl 6
will probably have something similar.'' Larry had an interesting post
on the subject (no surprise there then...)</p>
<p><a href="http://groups.google.com/groups?threadm=20021023214308.GA746%40chianti">http://groups.google.com/groups</a></p>
<p><a href="http://www.paulgraham.com">http://www.paulgraham.com</a></p>
<p><a href="http://groups.google.com/groups?threadm=Pine.LNX.4.44.0210250839030.17544-100000%40london.wall.org">http://groups.google.com/groups</a></p>


<h3><a name="in_brief" id="in_brief">In Brief</a></h3>
<p>There was a minor kerfuffle early in the week when the Parrot CVS
repository ended up with the wrong permissions. Oops.</p>
<p>Leopold Toetsch has implemented the <code>splice</code> vtable method based on
the semantics in PDD2. This sparked a short discussion about copying
vs.  cloning.</p>
<p>It looks like native types are going to get type numbers just like
PMCs, but native types will be negative.</p>
<p>Rhys Weatherley added a bunch of infix operators to IMCC's syntax.</p>
<p>J&uuml;rgen B&ouml;mmels added `fingerprinting' to .PBC files. The
idea being that Parrot can fail at load time if it tries to load a
.PBC file that was generated with a different version of
<em>core.ops</em>. The previous behavior involved weird, hard-to-track-down runtime errors.</p>
<p>Some spam got past the perl6-internals filters. We were shocked.</p>
<p>Michael Lazzaro announced an updated Perl6 OO Cookbook at
<a href="http://cog.cognitivity.com/perl6/">http://cog.cognitivity.com/perl6/</a>.</p>


<h3><a name="who's_who_in_perl_6" id="who's_who_in_perl_6">Who's Who in Perl 6?</a></h3>
<p>Apparently, nobody is this week. I appear to have run out of answer
sets for the questionnaire. If you've been mentioned in this, or any
previous summary and you've not already answered, then please drop me a
line and I'll send you the questions.</p>


<h3><a name="acknowledgement,_apologies_and_all_that_good_stuff" id="acknowledgement,_apologies_and_all_that_good_stuff">Acknowledgement, Apologies and All That Good Stuff</a></h3>
<p>This summary was once again brought to you from my office on board the
0625 from Newark to London and from my comfy chair at
home. Distractions were provided by Xmame, Perls of the North, broken
AC Adaptors and my own natural `Procrastinate now!' instincts.</p>
<p>Proofreading services were provided by me. Having left it as late as I
did, I just want to get this summary out of the door before next
week's is due. So any speeling mistooks are orl myne.</p>
<p>And, the old refrain: If you enjoyed this summary, then please consider one
or both of the following options:</p>
<ul>
<li>
Send money to the Perl Foundation at
<a href="http://donate.perl-foundation.org/">http://donate.perl-foundation.org/</a> where your money will be used to
support the ongoing development of Perl and Perl 6.</li>

<li>
Send feedback, flames and/or an original BeBox to me,
<em><a href="mailto:mailto:pdcawley@bofh.org.uk">mailto:pdcawley@bofh.org.uk</a></em>.</li>
</ul>
<p>Any fee paid for publication of these summaries on perl.com is paid
directly to the Perl Foundation.</p>



        </div>



    </div>
    <div class="asset-footer"></div>
</div>




                            <div class="content-nav">
                                <a href="/pub/2002/10/">&laquo; October 2002</a> |
                                <a href="/pub/">Main Index</a> |
                                <a href="/pub/archives.html">Archives</a>
                                | <a href="/pub/2002/12/">December 2002 &raquo;</a>
                            </div>


                        </div>
                    </div>


                    <div id="beta">
    <div id="beta-inner">


    
    <div class="widget-what-is-perl widget">
    <div class="widget-content widget-content-what-is-perl">
       Visit the home of the  Perl programming language: <a href="http://www.perl.org/">Perl.org</a
    </div>
</div>
<div class="widget-find-out-more widget-archives widget">
    <div class="widget-content">
        <ul>
            <li><a href="http://www.perl.org/get.html">Download</a></li>
            <li><a href="http://perldoc.perl.org/">Documentation</a></li>
            <li><a href="http://blogs.perl.org/">Perl Bloggers</a></li>
            <li><a href="http://news.perlfoundation.org/">Foundation News</a></li>
        </ul>
    </div>
</div><div class="widget-tcpc widget">
<h3 class="widget-header">Sponsored by</h3>
    <div class="widget-content">
        <a href="http://training.perl.com/" alt="Perl Training" target="_blank"><img src="/i/tcpc.png" width="150" height="50"></a>
    </div>
</div>

<div class="widget-syndication widget">
    <div class="widget-content">
        <ul>
            <li><img src="/mt-static/images/status_icons/feed.gif" alt="Subscribe to feed" width="9" height="9" /> <a href="/pub/atom.xml">Subscribe to this website's feed</a></li>

        </ul>
    </div>
</div>
<div class="widget-archive-monthly widget-archive widget">
    <h3 class="widget-header">Monthly <a href="/pub/archives.html">Archives</a></h3>
    <div class="widget-content">
        <ul>
        
            <li><a href="/pub/2014/02/">February 2014 (1)</a></li>
        
    
        
            <li><a href="/pub/2014/01/">January 2014 (1)</a></li>
        
    
        
            <li><a href="/pub/2013/10/">October 2013 (1)</a></li>
        
    
        
            <li><a href="/pub/2013/01/">January 2013 (1)</a></li>
        
    
        
            <li><a href="/pub/2012/12/">December 2012 (1)</a></li>
        
    
        
            <li><a href="/pub/2012/11/">November 2012 (1)</a></li>
        
    
        
            <li><a href="/pub/2012/10/">October 2012 (2)</a></li>
        
    
        
            <li><a href="/pub/2012/08/">August 2012 (2)</a></li>
        
    
        
            <li><a href="/pub/2012/06/">June 2012 (11)</a></li>
        
    
        
            <li><a href="/pub/2012/05/">May 2012 (18)</a></li>
        
    
        
            <li><a href="/pub/2012/04/">April 2012 (17)</a></li>
        
    
        
            <li><a href="/pub/2012/02/">February 2012 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/12/">December 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/09/">September 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/08/">August 2011 (2)</a></li>
        
    
        
            <li><a href="/pub/2011/06/">June 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/05/">May 2011 (3)</a></li>
        
    
        
            <li><a href="/pub/2011/04/">April 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/03/">March 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/02/">February 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/01/">January 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2010/11/">November 2010 (1)</a></li>
        
    
        
            <li><a href="/pub/2010/10/">October 2010 (2)</a></li>
        
    
        
            <li><a href="/pub/2010/09/">September 2010 (1)</a></li>
        
    
        
            <li><a href="/pub/2010/08/">August 2010 (3)</a></li>
        
    
        
            <li><a href="/pub/2010/07/">July 2010 (2)</a></li>
        
    
        
            <li><a href="/pub/2010/04/">April 2010 (2)</a></li>
        
    
        
            <li><a href="/pub/2010/03/">March 2010 (4)</a></li>
        
    
        
            <li><a href="/pub/2008/05/">May 2008 (1)</a></li>
        
    
        
            <li><a href="/pub/2008/04/">April 2008 (2)</a></li>
        
    
        
            <li><a href="/pub/2008/03/">March 2008 (1)</a></li>
        
    
        
            <li><a href="/pub/2008/02/">February 2008 (1)</a></li>
        
    
        
            <li><a href="/pub/2008/01/">January 2008 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/12/">December 2007 (2)</a></li>
        
    
        
            <li><a href="/pub/2007/09/">September 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/08/">August 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/07/">July 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/06/">June 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/05/">May 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/04/">April 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/03/">March 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/02/">February 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/01/">January 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/12/">December 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/11/">November 2006 (2)</a></li>
        
    
        
            <li><a href="/pub/2006/10/">October 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/09/">September 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/08/">August 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/07/">July 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/06/">June 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/05/">May 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/04/">April 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/03/">March 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/02/">February 2006 (4)</a></li>
        
    
        
            <li><a href="/pub/2006/01/">January 2006 (4)</a></li>
        
    
        
            <li><a href="/pub/2005/12/">December 2005 (4)</a></li>
        
    
        
            <li><a href="/pub/2005/11/">November 2005 (3)</a></li>
        
    
        
            <li><a href="/pub/2005/10/">October 2005 (2)</a></li>
        
    
        
            <li><a href="/pub/2005/09/">September 2005 (2)</a></li>
        
    
        
            <li><a href="/pub/2005/08/">August 2005 (9)</a></li>
        
    
        
            <li><a href="/pub/2005/07/">July 2005 (8)</a></li>
        
    
        
            <li><a href="/pub/2005/06/">June 2005 (9)</a></li>
        
    
        
            <li><a href="/pub/2005/05/">May 2005 (8)</a></li>
        
    
        
            <li><a href="/pub/2005/04/">April 2005 (7)</a></li>
        
    
        
            <li><a href="/pub/2005/03/">March 2005 (6)</a></li>
        
    
        
            <li><a href="/pub/2005/02/">February 2005 (7)</a></li>
        
    
        
            <li><a href="/pub/2005/01/">January 2005 (6)</a></li>
        
    
        
            <li><a href="/pub/2004/12/">December 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/11/">November 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/10/">October 2004 (5)</a></li>
        
    
        
            <li><a href="/pub/2004/09/">September 2004 (9)</a></li>
        
    
        
            <li><a href="/pub/2004/08/">August 2004 (6)</a></li>
        
    
        
            <li><a href="/pub/2004/07/">July 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/06/">June 2004 (6)</a></li>
        
    
        
            <li><a href="/pub/2004/05/">May 2004 (7)</a></li>
        
    
        
            <li><a href="/pub/2004/04/">April 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/03/">March 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/02/">February 2004 (9)</a></li>
        
    
        
            <li><a href="/pub/2004/01/">January 2004 (7)</a></li>
        
    
        
            <li><a href="/pub/2003/12/">December 2003 (4)</a></li>
        
    
        
            <li><a href="/pub/2003/11/">November 2003 (7)</a></li>
        
    
        
            <li><a href="/pub/2003/10/">October 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2003/09/">September 2003 (6)</a></li>
        
    
        
            <li><a href="/pub/2003/08/">August 2003 (7)</a></li>
        
    
        
            <li><a href="/pub/2003/07/">July 2003 (9)</a></li>
        
    
        
            <li><a href="/pub/2003/06/">June 2003 (9)</a></li>
        
    
        
            <li><a href="/pub/2003/05/">May 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2003/04/">April 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2003/03/">March 2003 (10)</a></li>
        
    
        
            <li><a href="/pub/2003/02/">February 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2003/01/">January 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2002/12/">December 2002 (5)</a></li>
        
    
        
            <li><a href="/pub/2002/11/">November 2002 (9)</a></li>
        
    
        
            <li><a href="/pub/2002/10/">October 2002 (7)</a></li>
        
    
        
            <li><a href="/pub/2002/09/">September 2002 (11)</a></li>
        
    
        
            <li><a href="/pub/2002/08/">August 2002 (8)</a></li>
        
    
        
            <li><a href="/pub/2002/07/">July 2002 (8)</a></li>
        
    
        
            <li><a href="/pub/2002/06/">June 2002 (4)</a></li>
        
    
        
            <li><a href="/pub/2002/05/">May 2002 (6)</a></li>
        
    
        
            <li><a href="/pub/2002/04/">April 2002 (6)</a></li>
        
    
        
            <li><a href="/pub/2002/03/">March 2002 (7)</a></li>
        
    
        
            <li><a href="/pub/2002/02/">February 2002 (5)</a></li>
        
    
        
            <li><a href="/pub/2002/01/">January 2002 (8)</a></li>
        
    
        
            <li><a href="/pub/2001/12/">December 2001 (7)</a></li>
        
    
        
            <li><a href="/pub/2001/11/">November 2001 (5)</a></li>
        
    
        
            <li><a href="/pub/2001/10/">October 2001 (9)</a></li>
        
    
        
            <li><a href="/pub/2001/09/">September 2001 (7)</a></li>
        
    
        
            <li><a href="/pub/2001/08/">August 2001 (13)</a></li>
        
    
        
            <li><a href="/pub/2001/07/">July 2001 (8)</a></li>
        
    
        
            <li><a href="/pub/2001/06/">June 2001 (13)</a></li>
        
    
        
            <li><a href="/pub/2001/05/">May 2001 (11)</a></li>
        
    
        
            <li><a href="/pub/2001/04/">April 2001 (9)</a></li>
        
    
        
            <li><a href="/pub/2001/03/">March 2001 (8)</a></li>
        
    
        
            <li><a href="/pub/2001/02/">February 2001 (8)</a></li>
        
    
        
            <li><a href="/pub/2001/01/">January 2001 (8)</a></li>
        
    
        
            <li><a href="/pub/2000/12/">December 2000 (6)</a></li>
        
    
        
            <li><a href="/pub/2000/11/">November 2000 (10)</a></li>
        
    
        
            <li><a href="/pub/2000/10/">October 2000 (10)</a></li>
        
    
        
            <li><a href="/pub/2000/09/">September 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/2000/08/">August 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/2000/07/">July 2000 (5)</a></li>
        
    
        
            <li><a href="/pub/2000/06/">June 2000 (7)</a></li>
        
    
        
            <li><a href="/pub/2000/05/">May 2000 (7)</a></li>
        
    
        
            <li><a href="/pub/2000/04/">April 2000 (3)</a></li>
        
    
        
            <li><a href="/pub/2000/03/">March 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/2000/02/">February 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/2000/01/">January 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/1999/12/">December 1999 (6)</a></li>
        
    
        
            <li><a href="/pub/1999/11/">November 1999 (6)</a></li>
        
    
        
            <li><a href="/pub/1999/10/">October 1999 (5)</a></li>
        
    
        
            <li><a href="/pub/1999/09/">September 1999 (4)</a></li>
        
    
        
            <li><a href="/pub/1999/08/">August 1999 (3)</a></li>
        
    
        
            <li><a href="/pub/1999/07/">July 1999 (2)</a></li>
        
    
        
            <li><a href="/pub/1999/06/">June 1999 (3)</a></li>
        
    
        
            <li><a href="/pub/1999/04/">April 1999 (1)</a></li>
        
    
        
            <li><a href="/pub/1999/03/">March 1999 (1)</a></li>
        
    
        
            <li><a href="/pub/1999/01/">January 1999 (1)</a></li>
        
    
        
            <li><a href="/pub/1998/12/">December 1998 (1)</a></li>
        
    
        
            <li><a href="/pub/1998/11/">November 1998 (1)</a></li>
        
    
        
            <li><a href="/pub/1998/07/">July 1998 (2)</a></li>
        
    
        
            <li><a href="/pub/1998/06/">June 1998 (1)</a></li>
        
    
        
            <li><a href="/pub/1998/03/">March 1998 (1)</a></li>
        
        </ul>
    </div>
</div>
        
    

<div class="widget-powered widget">
    <div class="widget-content">
        <a href="http://www.movabletype.com/"><img src="/mt-static/images/bug-pbmt-white.png" alt="Powered by Movable Type 5.13-en" width="120" height="75" /></a>
    </div>
</div>



    </div>
</div>






                </div>
            </div>


            <div id="footer">
    <div id="footer-inner">
        <div id="footer-content">
            <div class="widget-powered widget">
                <div class="widget-content">
                    Powered by <a href="http://www.movabletype.com/" rel="generator">Movable Type Pro</a>
                </div>
            </div>

            <div class="widget-creative-commons widget">
                <div class="widget-content">
                    This blog is licensed under a <a href="http://creativecommons.org/licenses/by-nc-nd/3.0/">Creative Commons License</a>.
                </div>
            </div>

        </div>
    </div>
</div>



        </div>
    </div>
</body>
</html>
