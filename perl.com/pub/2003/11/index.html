<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" id="sixapart-standard">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="generator" content="Movable Type Pro 5.13-en" />
<link rel="stylesheet" href="/pub/styles.css" type="text/css" />
<link rel="start" href="/pub/" title="Home" />
<link rel="alternate" type="application/atom+xml" title="Recent Entries" href="/pub/atom.xml" />
<script type="text/javascript" src="/pub/mt.js"></script>
<!--
<rdf:RDF xmlns="http://web.resource.org/cc/"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
<Work rdf:about="/pub/">
<dc:title>Perl.com</dc:title>
<dc:description>news and views of the Perl programming language</dc:description>
<license rdf:resource="http://creativecommons.org/licenses/by-nc-nd/3.0/" />
</Work>
<License rdf:about="http://creativecommons.org/licenses/by-nc-nd/3.0/">
</License>
</rdf:RDF>
-->

<script type="text/javascript">

 var _gaq = _gaq || [];
 _gaq.push(['_setAccount', 'UA-50555-22']);
 _gaq.push(['_trackPageview']);

 (function() {
   var ga = document.createElement('script'); ga.type =
   'text/javascript'; ga.async = true;
   ga.src = ('https:' == document.location.protocol ? 'https://ssl' :
   'http://www') + '.google-analytics.com/ga.js';
   var s = document.getElementsByTagName('script')[0];
   s.parentNode.insertBefore(ga, s);
 })();

</script>
<script type='text/javascript' src='http://partner.googleadservices.com/gampad/google_service.js'></script>
<script type='text/javascript'>
GS_googleAddAdSenseService("ca-pub-4136420132070439");
GS_googleEnableAllServices();
</script>
<script type='text/javascript'>
GA_googleAddSlot("ca-pub-4136420132070439", "Perl_728x90");
</script>
<script type='text/javascript'>GA_googleFetchAds();</script>
    <title>Perl.com: November 2003 Archives</title>


    <link rel="prev" href="/pub/2003/10/" title="October 2003" />
    <link rel="next" href="/pub/2003/12/" title="December 2003" />

</head>
<body id="perl-com" class="mt-archive-listing mt-datebased-monthly-archive layout-wt">
    <div id="container">
        <div id="container-inner">


            <div id="header">
    <div id="header-inner">
        <div id="header-content">
        <span id="top_advert"> 
<!-- Put any landscape advert in here -->
<!-- Perl_728x90 -->
<script type='text/javascript'>
GA_googleFillSlot("Perl_728x90");
</script>
        </span> 



            <div id="header-name"><a href="/pub/" accesskey="1">Perl.com</a></div>
            <div id="header-description">news and views of the Perl programming language</div>




        </div>
    </div>
</div>



            <div id="content">
                <div id="content-inner">


                    <div id="alpha">
                        <div id="alpha-inner">


                            <h1 id="page-title" class="archive-title">November 2003 Archives</h1>





                            
                            <div id="entry-1228" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2003/11/p6pdigest/20031130.html" rel="bookmark">This week on Perl 6, week ending 2003-11-30</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Piers Cawley</span> on <abbr class="published" title="2003-11-30T00:00:00-08:00">November 30, 2003 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            
<!-- sidebar begins -->
<!-- don't move sidebars -->
<!-- sidebar ends -->

<p>Welcome back to the weekly Perl 6 Summary,
which I'm hoping to keep on a weekly cycle for the foreseeable future.</p>

<p>It's been a relatively low volume week this week,
I'm assuming that Thanksgiving had something to do with it (I hope those of you who celebrate it had a jolly good extended weekend),
and for the first time in ages perl6-language saw almost as much traffic as perl6-internals.
We're still going to start with perl6-internals though.</p>

<h4><a name="Some_PIR_&quot;How_do_I?&quot;_questions"
>Some PIR &quot;How do I?&quot; questions</a></h4>

<p>Last week Dan put up a list of questions about IMCC,
intending it as a bit of grit.
This week Melvin Smith added a couple of layers of nacre by checking in an initial IMCC FAQ (you'll find it at <em lang='und' xml:lang='und'>imcc/docs/imcfaq.pod</em> in your parrot directory if you're following with CVS).
After an initial flurry of work on adding to the FAQ,
the discussion seems to have drifted off into discussions of bike shed pigmentation.
Yes,
the FAQ may need to be split eventually,
but splitting an FAQ into sub documents is trivial compared to actually answering the questions.
Ahem.
Editorial ends.</p>

<p><a href='http://groups.google.com/groups?selm=5.1.1.6.2.20031123011917.03503858@pop.mindspring.com'>http://groups.google.com/groups?selm=5.1.1.6.2.20031123011917.03503858@pop.mindspring.com</a></p>

<p><a href='http://www.parrotcode.org/faq/imcc'>http://www.parrotcode.org/faq/imcc</a> -- The FAQ</p>

<h4><a name="PIO_eof"
>PIO_eof</a></h4>

<p>Vladimir Lipsky had a few questions about how the Parrot IO subsystem (PIO) handles error conditions.
This sparked a discussion of whether the various PIO functions should make some assertions up front about their arguments.
Consensus said &quot;yes&quot;,
they help with debugging,
and the performance 'hit' is minuscule.</p>

<p><a href='http://groups.google.com/groups?selm=006c01c3b267$7e683500$6b9d943e@87w5ovc8gmxcahy'>http://groups.google.com/groups?selm=006c01c3b267$7e683500$6b9d943e@87w5ovc8gmxcahy</a></p>

<csperl file="grab" domain="on" record="b/940" template="b/article_sidebar2.view">

<h4><a name="Freezing_and_Thawing"
>Freezing and Thawing</a></h4>

<p>Discussion of the details of object serialization continued this week.
Judging by the amount of clarification traffic that's been going on in this thread (and others),
I find myself wondering if the time has come for some generous benefactor to sponsor the principals to get together in a conference room with copious whiteboard acreage.
Sponsors welcome.</p>

<p><a href='http://groups.google.com/groups?selm=Pine.LNX.4.58.0311240851430.31299@sprite.sidhe.org'>http://groups.google.com/groups?selm=Pine.LNX.4.58.0311240851430.31299@sprite.sidhe.org</a></p>

<h4><a name="Segfault_warning_boxes"
>Segfault warning boxes</a></h4>

<p>Consider a system of test machines,
all of them happily running in unattended mode,
constantly checking out the latest version of parrot,
compiling everything,
running the tests and reporting the results to some central webserver that displays a status report for all to see.
It's not just a good idea,
it's the Parrot tinderbox.</p>

<p>Now,
consider an operating system that takes it upon itself to throw up a modal dialog box when a program segfaults.</p>

<p>The two don't sit well together do they?
Which is why Dan has committed a patch to disable the &quot;Your program has crashed,
want to send a report to Microsoft?&quot; box that pops up on Win32 when Parrot segfaults.
Still,
at least it can be disabled.</p>

<p>Dan asked for opinions on whether the (non tinderbox) default should be to put up a dialog box or not.
And it appears that,
if you disable the dialog box,
there's no other notification (apart from the failed test,
obviously) that there was a segfault.
I am sure I'm not alone in boggling at this,
but it looks like the default will be to display the dialog.</p>

<p><a href='http://groups.google.com/groups?selm=Pine.LNX.4.58.0311251153350.19018@sprite.sidhe.org'>http://groups.google.com/groups?selm=Pine.LNX.4.58.0311251153350.19018@sprite.sidhe.org</a></p>

<h4><a name="Perl_6_updated"
>Perl 6 updated</a></h4>

<p>Allison Randal sent in a patch to update the Perl 6 compiler to use
the right operators (<code lang='und' xml:lang='und'>^+</code> becomes
<code lang='und' xml:lang='und'>&gt;&gt;+&lt;&lt;</code>,
<code lang='und' xml:lang='und'>~~</code> (meant xor) becomes <code lang='und' xml:lang='und'>^^</code>,
making way for <code lang='und' xml:lang='und'>=~</code> to become <code lang='und' xml:lang='und'>~~</code>).
She's still working on other tweaks to get the semantics of what's already been implemented right,
and claims to be sufficiently annoyed by the failing regex tests that she might have to go and make them work to remove the annoyance.
Which would be good.
(I'm afraid that the tantalizing code I mentioned last week has actually been there for ages,
as I feared it had).
That capital fellow,
chromatic applied the patch.</p>

<p><a href='http://groups.google.com/groups?selm=rt-24559-67828.1.16647251862517@rt.perl.org'>http://groups.google.com/groups?selm=rt-24559-67828.1.16647251862517@rt.perl.org</a></p>

<h4><a name="String_formatting_and_transformation"
>String formatting and transformation</a></h4>

<p>Dan got around to specifying some details about string formatting and transformation.
Essentially there will be various case changing transformations and a couple of different formatting approaches,
one <code lang='und' xml:lang='und'>sprintf</code> like and another more like traditional COBOL style formatting.
Dan's not sure yet whether these formatters will get ops or simply be implemented in the standard library.</p>

<p><a href='http://groups.google.com/groups?selm=a06010202bbebfb35bca6@[10.0.1.3]'>http://groups.google.com/groups?selm=a06010202bbebfb35bca6@[10.0.1.3]</a></p>

<h4><a name="AUTOLOAD_anyone?"
>AUTOLOAD anyone?</a></h4>

<p>Someone calling itself ibotty wondered if there would be a default PMC method that gets automagically called whenever a method call isn't found.
To which the answer is &quot;Yes,
when it's done&quot;.</p>

<p><a href='http://groups.google.com/groups?selm=20031127235646.20556.qmail@onion.perl.org'>http://groups.google.com/groups?selm=20031127235646.20556.qmail@onion.perl.org</a></p>

<h4><a name="Determining_PMC_memory_addresses"
>Determining PMC memory addresses</a></h4>

<p>Cory Spencer wanted to know if there was a PASM way of finding whether two PMCs share the same memory address.
&quot;Not yet&quot;,
said Leo T&#246;tsch,
&quot;but there are entries in the vtable to do it&quot;.
This sparked a discussion of the meaning of 'equal'.
It was suggested that Parrot use Lisp's triple equality test operators (one tests if two things are the same thing,
the second if two things have the same value,
and the third tests that they have the same structure).
Jos Visser argued (convincingly I thought) that having three operators with the same semantics might be a Good Thing,
but using Lisp's names (<code lang='und' xml:lang='und'>eq</code>,
<code lang='und' xml:lang='und'>eql</code> and <code lang='und' xml:lang='und'>equal</code>) for them would definitely be a Bad Thing.</p>

<p><a href='http://groups.google.com/groups?selm=Pine.LNX.4.58.0311272124130.31738@okcomputer.antiflux.org'>http://groups.google.com/groups?selm=Pine.LNX.4.58.0311272124130.31738@okcomputer.antiflux.org</a></p>

<h3><a name="Meanwhile,_on_perl6-language"
>Meanwhile,
on perl6-language</a></h3>

<h4><a name="'Core'_language_philosophy"
>'Core' language philosophy</a></h4>

<p>Branching off from a thread about using <code lang='und' xml:lang='und'>catch</code> as a statement modifier <i>&#225; la</i> <code lang='und' xml:lang='und'>if</code>,
<code lang='und' xml:lang='und'>unless</code> etc.,
Michael Lazzaro waxed philosophical about the distinction between core and library.
He wondered if putting syntactic sugar into CP6AN and then having almost everyone install it anyway wasn't a false economy.
He went on to defend the idea of the <code lang='und' xml:lang='und'>catch</code> modifier.</p>

<p>Larry didn't agree.
He suggested that a better way would be to look at some kind of pragma which would make <code lang='und' xml:lang='und'>err</code> (the low priority form of <code lang='und' xml:lang='und'>//</code>,
aka 'defined or') put an implicit <code lang='und' xml:lang='und'>try</code> around its left hand argument.
Michael still wasn't keen,
but he wants to use <code lang='und' xml:lang='und'>undef</code> to stand for a SQLesque NULL.</p>

<p><a href='http://groups.google.com/groups?selm=479C7C28-2048-11D8-A666-000A277AA894@cognitivity.com'>http://groups.google.com/groups?selm=479C7C28-2048-11D8-A666-000A277AA894@cognitivity.com</a></p>

<h4><a name="The_C_Comma"
>The C Comma</a></h4>

<p>Luke Palmer doesn't like the C Comma -- the one that lets you write:</p>

<pre><code>    while $n++, $foo &gt; $bar {...}</code></pre>

<p>He does like the semantics though, so he proposed renaming the C comma and calling it <code lang='und' xml:lang='und'>then</code>. People liked the idea of changing the name because, if nothing else, it would mean one could write <code lang='und' xml:lang='und'>@foo = 1,2,3;</code> and get a list with three elements rather than a one element list containing the number 3. However, they weren't necessarily keen on <code lang='und' xml:lang='und'>then</code> as the new name. Damian wondered if we shouldn't just insist on</p>

<pre><code>   while do { $n++; $foo &gt; $bar } {...}</code></pre>

<p>And then people started coming up various synonyms for 'and' in Latin like <i>ac</i>, <i>cum</i> et cetera. Larry hasn't ruled on any of the options yet.</p>

<p><a href='http://groups.google.com/groups?selm=20031125000038.GA30028@babylonia.flatirons.org'>http://groups.google.com/groups?selm=20031125000038.GA30028@babylonia.flatirons.org</a></p>

<h4><a name="Properties"
>Properties</a></h4>

<p>Luke Palmer once again demonstrated his mastery of the telling question by asking a series of questions about runtime properties. Larry's answers, both to the immediate question and in the thread that followed make for fascinating reading and leave us all waiting with bated breath for Apocalypse 12 on Objects.</p>

<p>I'm afraid I'm going to punt on attempting to summarize the thread though; Larry's always hard to summarize when he's introducing anything new. You really should (at least) read his initial sketch though -- role based object orientation looks (to this reader at least) like a brilliant idea.</p>

<p><a href='http://groups.google.com/groups?selm=20031127070230.GA8488@babylonia.flatirons.org'>http://groups.google.com/groups?selm=20031127070230.GA8488@babylonia.flatirons.org</a></p>

<p><a href='http://groups.google.com/groups?selm=20031127212123.GA24862@wall.org'>http://groups.google.com/groups?selm=20031127212123.GA24862@wall.org</a> -- Larry outlines his current thinking</p>

<h3><a name="Acknowledgements,_Apologies,_Announcements"
>Acknowledgements, Apologies, Announcements</a></h3>

<p>I've still not got 'round to getting the link shortening in place I'm afraid. For some reason the appropriate modules don't seem to want to install on my G5. Maybe next week.</p>

<p>Leon Brocard has taken on the role of Pumpking for Perl 5.004 and will not be appearing in these summaries for the duration of his reign out of respect. After all, being a pumpking requires a kind of dignity that would be incompatible with being a running joke.</p>

<p>If you find these summaries useful or enjoyable, please consider contributing time and/or money to the Perl Foundation to help support the Perl 6 effort. You might also like to send me feedback at <a href='TODO'>p6summarizer@bofh.org.uk</a>, or drop by my website.</p>

<p><a href='http://donate.perl-foundation.org/'>http://donate.perl-foundation.org/</a> -- The Perl Foundation</p>

<p><a href='http://dev.perl.org/perl6/'>http://dev.perl.org/perl6/</a> -- Perl 6 Development site</p>

<p><a href='http://www.bofh.org.uk:8080/'>http://www.bofh.org.uk:8080/</a> -- My website, &quot;Just a Summary&quot;</p>


        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1226" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2003/11/p6pdigest/20031123.html" rel="bookmark">This fortnight on Perl 6, week ending 2003-11-23</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Piers Cawley</span> on <abbr class="published" title="2003-11-23T00:00:00-08:00">November 23, 2003 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            
<!-- sidebar begins -->
<!-- don't move sidebars -->
<!-- sidebar ends -->

<p>Right,
hopefully things are back to normal(ish) after the disk crashes that rather spoilt the last summary.
I've managed to fill in my mail archive too so this summary will cover the events of the last fortnight (that's two weeks for those whose version of English lacks this vital unit of time).</p>

<p>We start,
as usual,
with all the action in perl6-internals.</p>

<h4><a name="Unifying_call_and_return"
>Unifying call and return</a></h4>

<p>It's been a long time coming,
but Dan returned from LL3 suitably refreshed by his dealings with academics (&quot;You can [...] consider a a sub PMC as a frozen semi-stateless continuation&quot;) and set about unifying Parrot's call and return conventions.
The strange thing is that everyone's been wanting this for months now,
but that didn't mean there wasn't discussion.</p>

<p>Meanwhile Melvin Smith set about making this discussion moot (from the point of view of someone targeting Parrot) by hiding the details behind IMCC directives (which already happens admittedly,
but Melvin's in the process of renaming the <code lang='und' xml:lang='und'>.pcc_*</code> directives to get rid of the <code lang='und' xml:lang='und'>.pcc_</code> and (eventually) allowing for pluggable calling conventions.</p>

<p><a href='http://groups.google.com/groups?selm=Pine.LNX.4.58.0311100905190.15737@sprite.sidhe.org'>http://groups.google.com/groups?selm=Pine.LNX.4.58.0311100905190.15737@sprite.sidhe.org</a> -- Dan's heads up</p>

<p><a href='http://groups.google.com/groups?selm=Pine.LNX.4.58.0311121141090.28619@sprite.sidhe.org'>http://groups.google.com/groups?selm=Pine.LNX.4.58.0311121141090.28619@sprite.sidhe.org</a> -- Changes,
draft 1</p>

<p><a href='http://groups.google.com/groups?selm=a06010201bbdd728d2b16@[10.0.1.2]'>http://groups.google.com/groups?selm=a06010201bbdd728d2b16@[10.0.1.2]</a> -- Dan puts his foot down</p>

<p><a href='http://groups.google.com/groups?selm=5.1.1.6.2.20031115234124.020a7f60@pop.mindspring.com'>http://groups.google.com/groups?selm=5.1.1.6.2.20031115234124.020a7f60@pop.mindspring.com</a> -- Melvin Makes it Moot</p>

<h4><a name="Reviewing_a_book_about_VMs"
>Reviewing a book about VMs</a></h4>

<p>St&#233;phane Payrard bought a copy of &quot;Virtual Machine Design and Implementation in C++&quot; and reviewed it for perl6-internals.
He didn't like it.
Which is putting it mildly.</p>

<p>This led to the inevitable questions about finding good books on VM design.
St&#233;phane quoted Leon Brocard's preemption of this question from London.pm: &quot;No,
there's surprisingly little out there on virtual machine design and development&quot;.</p>

<p><a href='http://groups.google.com/groups?selm=20031113173044.GB5924@stefp.dyndns.org'>http://groups.google.com/groups?selm=20031113173044.GB5924@stefp.dyndns.org</a></p>

<h4><a name="IMCC_gets_high_level_sub_call_syntax"
>IMCC gets high level sub call syntax</a></h4>

<p>Melvin Smith continues to make PIR less like Assembly language and more like pseudo code.
You can now write code like:</p>

<pre><code>   _foo()
   var = _foo()
   var = _foo(a, b)
   (var1, var2) = _foo(a, b)</code></pre>

<p>and IMCC will do the Right Thing. Go Melvin.</p>

<p><a href='http://groups.google.com/groups?selm=5.1.1.6.2.20031116195005.03c2c488@pop.mindspring.com'>http://groups.google.com/groups?selm=5.1.1.6.2.20031116195005.03c2c488@pop.mindspring.com</a></p>

<h4><a name="IMCC_problems_with_library_loading"
>IMCC problems with library loading</a></h4>

<p>Jeff Clites pointed out some issues with IMCC's behaviour when loading external libraries and wondered about definitive docs on the macro syntax (I think the current definitive docs may well be the source code). Leo T&#246;tsch seemed to accept that there were issues with the current state of IMCC in this context, but implied that fixing it wasn't an immediate priority.</p>

<p><a href='http://groups.google.com/groups?selm=C5EC6699-18A1-11D8-92BE-000393A6B9DA@mac.com'>http://groups.google.com/groups?selm=C5EC6699-18A1-11D8-92BE-000393A6B9DA@mac.com</a></p>

<h4><a name="A_new_list_proposal"
>A new list proposal</a></h4>

<p>Melvin Smith proposed creating a parrot-compilers mailing list as a general purpose list for any and all language development targeting Parrot. He even went so far as to volunteer to maintain and distribute the FAQ.</p>

<p>The immediate response was positive, but Leo and others didn't really think the volume of traffic currently warranted it (which, I think, was part of Melvin's point, Parrot is reaching the point where it can just be <i>used</i> without necessarily needing to worry over much about its internals. I think Melvin is concerned that the technical level (and implicit Perlcentricity) of the current internals list is putting potential compiler developers off participating).</p>

<p>So, if you're reading this because you're interested in using Parrot as a target platform, but you don't subscribe to the internals list but would subscribe to a parrot-compilers list, could you let me, Melvin, or the list know? I've already committed to including any such list in my summaries (at least until traffic reaches the point where someone decides to do a dedicated summary). Let us know if you think it's a terrible idea too of course.</p>

<p><a href='http://groups.google.com/groups?selm=5.1.1.6.2.20031117135818.021515f8@pop.mindspring.com'>http://groups.google.com/groups?selm=5.1.1.6.2.20031117135818.021515f8@pop.mindspring.com</a></p>

<h4><a name="Parrot_Documentation_Review"
>Parrot Documentation Review</a></h4>

<p>Michael Scott posted a review of Parrot documentation with pointers of where to find existing docs and a discussion of where people <i>should</i> be looking. Somewhat bizarrely, he failed to give the URL of the Parrot Wiki, his favoured source of documentation (favoured for the very good reason that it's excellent). However, you'll find the URL below.</p>

<p><a href='http://groups.google.com/groups?selm=47906C10-1959-11D8-AC7B-0050E479991D@mac.com'>http://groups.google.com/groups?selm=47906C10-1959-11D8-AC7B-0050E479991D@mac.com</a></p>

<p><a href='http://www.vendian.org/parrot/wiki/'>http://www.vendian.org/parrot/wiki/</a> -- The very lovely and worthwhile parrot Wiki</p>

<h4><a name="Freeze_is_in"
>Freeze is in</a></h4>

<p>Dan announced that he's checked in Leo's preliminary patch implementing freeze/thaw, commenting that it's likely to change dramatically internally and that the vtable/low-level API wasn't final, but that the op-level interface would be stable. Jeff Clites was initially concerned that the patch used things he was expecting to be able to use for his (in progress) ordered destruction patch. However, after some discussion, he and Leo seem to be confident that the two things can be unified.</p>

<p><a href='http://groups.google.com/groups?selm=Pine.LNX.4.58.0311191201490.7503@sprite.sidhe.org'>http://groups.google.com/groups?selm=Pine.LNX.4.58.0311191201490.7503@sprite.sidhe.org</a></p>

<h4><a name="Warning_Patrol"
>Warning Patrol</a></h4>

<p>J&#252;rgen B&#246;mmels has been doing a little warning patrol of parrot and finds that only a very few fixes to IMCC are required to get a warning-free compile and posted a patch with them in. Leo applied it immediately, reasoning that, whilst IMCC's under heavy development, there's no excuse for throwing compile warnings, and every time the perpetrators have to integrate such patches they'll become more likely to try not to generate the warnings in the first place.</p>

<p>Inspired by this, Jonathan Worthington posted a similar patch to eliminate warnings when building for win32, which Leo also applied.</p>

<p><a href='http://groups.google.com/groups?selm=m24qwzgj0y.fsf@helium.physik.uni-kl.de'>http://groups.google.com/groups?selm=m24qwzgj0y.fsf@helium.physik.uni-kl.de</a></p>

<h4><a name="Finished/stable_parts_of_Parrot?"
>Finished/stable parts of Parrot?</a></h4>

<p>Robin Redeker wondered which bits of Parrot and IMCC could be considered stable enough to use in implementing a language. Leo opined that existing syntax will not change much, most of the expected changes relate to things like adding support for calling conventions and simplifications like replacing <code lang='und' xml:lang='und'>.pcc_sub</code> with <code lang='und' xml:lang='und'>.sub</code>. Melvin Smith pitched in with rather more detail about what was expected to change and the kind of changes that could be expected in the future. Reading this it's apparent that we've reached the point where almost any conceivable extension to IMCC will be backward compatible with earlier versions. Famous last words I know, but it is looking that way.</p>

<p><a href='http://groups.google.com/groups?selm=20031120192528.GA6967@x-paste.de'>http://groups.google.com/groups?selm=20031120192528.GA6967@x-paste.de</a></p>

<h4><a name="Do_Steve_Fink's_debugging_for_him"
>Do Steve Fink's debugging for him</a></h4>

<p>Steve Fink had a problem with some generated code throwing a segfault when it was run and, having hit the debugging wall himself, posted the code to the list and asked help. Leo tracked down the bug in Parrot and fixed it. However, that's not why this made the summary, what's interesting is the sample of code that the problem code was generated from. Here it is:</p>

<pre><code>  rule thing() {
      &#60;[a-z]&#62;+
  }

  rule parens() {
      { print &quot;entering parens\n&quot;; }
      \( [ &#60;thing&#62; | &#60;parens&#62; | \s ]* \)
      { print &quot;leaving parens\n&quot;; }
  }

  sub main() {
      my $t = &quot;()()(((blah blah () blah))(blah))&quot;;
      my $t2 = $t _ &quot;)&quot;;
      print &quot;ok 8\n&quot; if $t2 !~ /^ &#60;parens&#62; $/;
  }</code></pre>

<p>Looks tantalizing doesn't it? Someone's now going to tell me that the code in question has been there forever, but I'm still tantalized.</p>

<p><a href='http://groups.google.com/groups?selm=20031121071225.GI26642@foxglove'>http://groups.google.com/groups?selm=20031121071225.GI26642@foxglove</a></p>

<h4><a name="Another_minor_tasks_for_the_interested"
>Another minor tasks for the interested</a></h4>

<p>Dan discovered that a <code lang='und' xml:lang='und'>make -j 4</code> dies quickly and horribly, which seems to imply that there's a dependency or two missing from the nest of twisty makefiles that make up the Parrot build system. He asked for volunteers to fix things. There's been some work done on this, but no definitive fix so far.</p>

<p><a href='http://groups.google.com/groups?selm=Pine.LNX.4.58.0311211058540.29189@sprite.sidhe.org'>http://groups.google.com/groups?selm=Pine.LNX.4.58.0311211058540.29189@sprite.sidhe.org</a></p>

<h4><a name="Some_PIR_&quot;How_do_I?&quot;_questions"
>Some PIR &quot;How do I?&quot; questions</a></h4>

<p>Dan threw a list of questions about IMCC out to the list as things that would really benefit from being documented. Sterling Hughes added a question or two, and Melvin Smith volunteered to get the answers written up real soon now.</p>

<p><a href='http://groups.google.com/groups?selm=Pine.LNX.4.58.0311211515220.29189@sprite.sidhe.org'>http://groups.google.com/groups?selm=Pine.LNX.4.58.0311211515220.29189@sprite.sidhe.org</a></p>

<h4><a name="Bytecode_portability_and_word/int_sizes"
>Bytecode portability and word/int sizes</a></h4>

<p>Now that Parrot has the beginnings of freeze/thaw support, Melvin Smith restarted discussion of ensuring that Parrot's bytecode format is portable. He pointed at several issues that need resolving. Discussion continues.</p>

<p><a href='http://groups.google.com/groups?selm=5.1.1.6.2.20031122120034.02236230@pop.mindspring.com'>http://groups.google.com/groups?selm=5.1.1.6.2.20031122120034.02236230@pop.mindspring.com</a></p>

<h3><a name="Meanwhile,_in_perl6-language"
>Meanwhile, in perl6-language</a></h3>

<h4><a name="Fun_with_'multi'"
>Fun with 'multi'</a></h4>

<p>Discussion of multi dispatch rolled on into the current summary period. Luke Palmer pointed out that <code lang='und' xml:lang='und'>multi</code> is no longer a declarator but a modifier, allowing for fine-grained control of the 'scope' of a method/function/whatever. Larry pointed out that 'multi' is orthogonal to scope, saying simply &quot;I'm putting multiple names into a spot that would ordinarily demand a unique name.&quot; and went on to explain precisely what that implied.</p>

<p><a href='http://groups.google.com/groups?selm=20031110094753.GA14948@babylonia.flatirons.org'>http://groups.google.com/groups?selm=20031110094753.GA14948@babylonia.flatirons.org</a></p>

<p><a href='http://groups.google.com/groups?selm=20031119025313.GA10300@wall.org'>http://groups.google.com/groups?selm=20031119025313.GA10300@wall.org</a> -- Larry Clarifies</p>

<h4><a name="The_Perl_6_design_process"
>The Perl 6 design process</a></h4>

<p>Rod Adams worried that all of the design of Perl 6 seems to come from Larry and Damian, with the language list being relegated to asking questions about how stuff works in more detail and in sniffing out tricky bits. Taken in combination with the real world's nasty habit of saddling Larry and Damian with health and financial problems, well, Rod worries, and wonders if there's anything that can be done to improve matters.</p>

<p>The redoubtable chromatic (who prefers it if I always render his name in all lower case, even at the beginning of sentences, hence his becoming redoubtable) gave the Standard Answer to such questions, pointing out that the reason things are going through Larry is because, well, Larry's bloody good at it. However, he did suggest that we're now at the point where we can probably start turning existing design docs into story cards and programmer tests for Perl 6, which should make implementation a good deal easier, and pointed to the Perl XP Training Wiki as a good place to look into how such tools are used to develop code.</p>

<p><a href='http://groups.google.com/groups?selm=4.2.0.58.20031114234841.00aa39e0@rodadams.net'>http://groups.google.com/groups?selm=4.2.0.58.20031114234841.00aa39e0@rodadams.net</a></p>

<p><a href='http://xptrain.perl-cw.com/'>http://xptrain.perl-cw.com/</a> -- The Perl XP Training Wiki</p>

<h4><a name="Control_flow_variables"
>Control flow variables</a></h4>

<p>Luke Palmer doesn't like the repetition and ugliness inherent in code like:</p>

<pre><code>  my $is_ok = 1;
  for 0..6 -&#62; $t
    { if abs(@new[$t] = @new[$t+1]) &#62; 3 { $is_ok = 0; last } }

  if $is_ok { push @moves: [$i, $j] }</code></pre>

<p>and wondered if there was a Perl6ish way of eliminating <code lang='und' xml:lang='und'>$is_ok</code>. He suggested something like:</p>

<pre><code>  for 0..6 -&#62; $t
    { if abs(@new[$t] - @new [$t+1]) &#62; 3 { last }}
  FINISH 
    { push @moves: [$i, $j] }</code></pre>

<p>Simon Cozens made a plea to eschew adding syntax to the language when it would be better to find a general mechanism. He wondered if a better approach may be to have <code lang='und' xml:lang='und'>for</code> return a status, by analogy with Perl 6's <code lang='und' xml:lang='und'>if</code>, which would allow one to write:</p>

<pre><code>  for 0..6 -&#62; $t { 
    last if abs(@new[$t] - @new[$t+1] &#62; 3; 
  } or push @moves: [$i, $j];</code></pre>

<p>Which wasn't really well liked (I'm practicing my understatement here, okay?) However, Simon's point about distinguishing between Perl 6 the language and stuff that belongs in CP6AN (CPAN for Perl 6) was well made and taken.</p>

<p>The thread's almost unsummarizable, it went off in so many different directions, and elicited some good stuff from Larry about the thinking behind Perl 6, along with a horde of solutions to Luke's problem. Some of 'em even work in Perl 5, at the expense of some seriously ugly looking code. Piers Cawley wrapped one solution, based on a guard clause approach, up in a higher order function, but fumbled the ball on working out the macro syntax, which pulled the discussion in another direction. Meanwhile other subthreads led to discussions of generators, coroutines, Mathematica's <code lang='und' xml:lang='und'>Sow[]</code> and <code lang='und' xml:lang='und'>Reap[]</code> and legitimate uses of <code lang='und' xml:lang='und'>goto</code>.</p>

<p>And Larry emphasised that nested modifiers are still quite illegal in Standard Perl 6.</p>

<p><a href='http://groups.google.com/groups?selm=20031118142052.GA5735@babylonia.flatirons.org'>http://groups.google.com/groups?selm=20031118142052.GA5735@babylonia.flatirons.org</a></p>

<p><a href='http://groups.google.com/groups?selm=20031119181906.GD10300@wall.org'>http://groups.google.com/groups?selm=20031119181906.GD10300@wall.org</a> -- Larry on language design</p>

<h4><a name="s///_in_string_context_should_return_the_string"
><code lang='und' xml:lang='und'>s///</code> in string context should return the string</a></h4>

<p>In another of those deceptively 'pregnant' posts, St&eacute;phane Payrard proposed that <code lang='und' xml:lang='und'>s///</code> in string context should return the string after substitution. Austin Hastings proposed something scary, which led to Larry contemplating making</p>

<pre><code>  $x.s/foo/bar/.s/moo/goo/;</code></pre>

<p>work somehow. (Which is actually less scary than Austin's original proposal). I think he rejected the idea for the time being though.</p>

<p>Piers Cawley suggested that it should return the substituted string, with an appropriate boolean property set depending on whether any substitutions were made. But then there issues of how you strip such properties off if you want to use the standard boolean interpretations of a string. Luke Palmer suggested the rather lovely <code lang='und' xml:lang='und'>but nothing</code> meta property.</p>

<p>I have the feeling that what's actually going to happen is that we'll end up with a supplementary, non destructive form of <code lang='und' xml:lang='und'>s///</code> which doesn't alter the original string, but returns a new string with the substitutions made.</p>

<p><a href='http://groups.google.com/groups?selm=20031118171859.GH3887@stefp.dyndns.org'>http://groups.google.com/groups?selm=20031118171859.GH3887@stefp.dyndns.org</a></p>

<h3><a name="Acknowledgements,_Apologies,_Announcements"
>Acknowledgements, Apologies, Announcements</a></h3>

<p>Sorry, we're a tad late again, sorry too to those of you reading this on the mailing lists, I've not got 'round to reimplementing the software to shorten the article URLs.</p>

<p>If you find these summaries useful or enjoyable you might like to show your appreciation by contributing money or time to the Perl Foundation and the Perl 6 effort. , or you could give me feedback directly at <a href='TODO'>p6summarizer@bofh.org.uk</a>, or stop by at my website.</p>

<p><a href='http://donate.perl-foundation.org/'>http://donate.perl-foundation.org/</a> -- The Perl Foundation</p>

<p><a href='http://dev.perl.org/perl6/'>http://dev.perl.org/perl6/</a> -- Perl 6 Development site</p>

<p><a href='http://www.bofh.org.uk:8080/'>http://www.bofh.org.uk:8080/</a> -- My website, &quot;Just a Summary&quot;</p>

        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1220" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2003/11/21/slurp.html" rel="bookmark">Perl Slurp-Eaze</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Uri Guttman</span> on <abbr class="published" title="2003-11-21T00:00:00-08:00">November 21, 2003 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            
<!-- sidebar begins -->
<!-- don't move sidebars -->
<!-- sidebar ends -->

<p>One of the common Perl idioms is processing text files line by line:</p>
<pre><code>
while( &lt;FH&gt; ) {
    do something with $_
}</code></pre>
<p>This idiom has several variants, but the key point is that it reads in
only one line from the file in each loop iteration. This has several
advantages, including limiting memory use to one line, the ability to
handle any size file (including data piped in via STDIN), and it is
easily taught to and understood by Perl beginners. Unfortunately, it
means they then go on to do things like this:</p>
<pre><code>
while( &lt;FH&gt; ) {
    push @lines, $_ ;
}

foreach ( @lines ) {
    do something with $_
}</code></pre>
<p>Line by line processing is fine, but it isn't the only way to deal with
reading files. The other common style is reading the entire file into a
scalar or array, and that is commonly known as slurping. Now, slurping has
somewhat of a poor reputation, and this article is an attempt at
rehabilitating it.</p>
<p>Slurping files has advantages and limitations, and is not something you
should just do when line by line processing is fine. It is best when you
need the entire file in memory for processing all at once. Slurping with
in memory processing can be faster and lead to simpler code than line by
line if done properly.</p>
<p>The biggest issue to watch for with slurping is file size. Slurping very
large files or unknown amounts of data from STDIN can be disastrous to
your memory usage and cause swap disk thrashing.  You can slurp STDIN if
you know that you can handle the maximum size input without
detrimentally affecting your memory usage, and so I advocate slurping only
disk files and only when you know their size is reasonable and you have
a real reason to process the file as a whole.</p>

<csperl file="grab" domain="on" record="b/515" template="b/article_sidebar.view">

<p>Note that &quot;reasonable&quot; size these days is larger than it was in the bad
old days of limited RAM. Slurping in a megabyte is not an issue on most
systems. But most of the files I tend to slurp in are much smaller than
that. Typical files that work well with slurping are configuration
files, (mini-)language scripts, some data (especially binary) files, and
other files of known sizes which need fast processing.</p>
<p>Another major win for slurping over line by line is speed. Perl's IO
system (like many others) is slow. Calling <code>&lt;&gt;</code> for each line
requires a check for the end of line, checks for EOF, copying a line,
munging the internal handle structure, etc. Plenty of work for each line
read in. On the other hand, slurping, if done correctly, will usually
involve only one I/O call and no extra data copying. The same is true
for writing files to disk, and we will cover that as well.</p>
<p>Finally, when you have slurped the entire file into memory, you can do
operations on the data that are not possible or easily done with line by
line processing. These include global search/replace (without regard for
newlines), grabbing all matches with one call of <code>//g</code>, complex parsing
(which in many cases must ignore newlines), processing *ML (where line
endings are just white space) and performing complex transformations
such as template expansion.</p>

<h3><a name="global operations">Global Operations</a></h3>
<p>Here are some simple global operations that can be done quickly and
easily on an entire file that has been slurped in. They could also be
done with line by line processing but that would be slower and require
more code.</p>
<p>A common problem is reading in a file with key/value pairs. There are
modules which do this but who needs them for simple formats? Just slurp
in the file and do a single parse to grab all the key/value pairs.</p>
<pre><code>
my $text = read_file( $file ) ;
my %config = $test =~ /^(\w+)=(.+)$/mg ;</code></pre>
<p>That matches a key which starts a line (anywhere inside the string
because of the <code>/m</code> modifier), the '=' char and the text to the end of the
line (again, <code>/m</code> makes that work). In fact the ending <code>$</code> is not even needed
since <code>.</code> will not normally match a newline. Since the key and value are
grabbed and the <code>m//</code> is in list context with the <code>/g</code> modifier, it will
grab all key/value pairs and return them. The <code>%config</code> hash will be
assigned this list and now you have the file fully parsed into a hash.</p>
<p>Various projects I have worked on needed some simple templating and I
wasn't in the mood to use a full module (please, no flames about your
favorite template module :-). So I rolled my own by slurping in the
template file, setting up a template hash and doing this one line:</p>
<pre><code>
$text =~ s/&lt;%(.+?)%&gt;/$template{$1}/g ;</code></pre>
<p>That only works if the entire file was slurped in. With a little
extra work it can handle chunks of text to be expanded:</p>
<pre><code>
$text =~ s/&lt;%(\w+)_START%&gt;(.+)&lt;%\1_END%&gt;/ template($1, $2)/sge ;</code></pre>
<p>Just supply a <code>template</code> sub to expand the text between the markers and
you have yourself a simple system with minimal code. Note that this will
work and grab over multiple lines due the the <code>/s</code> modifier. This is
something that is much trickier with line by line processing.</p>
<p>Note that this is a very simple templating system, and it can't directly
handle nested tags and other complex features. But even if you use one
of the myriad of template modules on the CPAN, you will gain by having
speedier ways to read and write files.</p>
<p>Slurping in a file into an array also offers some useful advantages. 
One simple example is reading in a flat database where each record has
fields separated by a character such as <code>:</code>:</p>
<pre><code>
my @pw_fields = map [ split /:/ ], read_file( '/etc/passwd' ) ;</code></pre>
<p>Random access to any line of the slurped file is another advantage. Also
a line index could be built to speed up searching the array of lines.</p>

<h3><a name="traditional slurping">Traditional Slurping</a></h3>
<p>Perl has always supported slurping files with minimal code. Slurping of
a file to a list of lines is trivial, just call the <code>&lt;&gt;</code> operator
in a list context:</p>
<pre><code>
my @lines = &lt;FH&gt; ;</code></pre>
<p>and slurping to a scalar isn't much more work. Just set the built in
variable <code>$/</code> (the input record separator) to the undefined value and read
in the file with <code>&lt;&gt;</code>:</p>
<pre><code>
{
    local( $/, *FH ) ;
    open( FH, $file ) or die &quot;sudden flaming death\n&quot;
    $text = &lt;FH&gt;
}</code></pre>
<p>Notice the use of <code>local()</code>. It sets <code>$/</code> to <code>undef</code> for you and when
the scope exits it will revert <code>$/</code> back to its previous value (most
likely &quot;\n&quot;).</p>
<p>Here is a Perl idiom that allows the <code>$text</code> variable to be declared,
and there is no need for a tightly nested block. The <code>do</code> block will
execute <code>&lt;FH&gt;</code> in a scalar context and slurp in the file named by
<code>$file</code>:</p>
<pre><code>
    local( *FH ) ;
    open( FH, $file ) or die &quot;sudden flaming death\n&quot;
    my $text = do { local( $/ ) ; &lt;FH&gt; } ;</code></pre>
<p>Both of those slurps used localized filehandles to be compatible with
5.005. Here they are with 5.6.0 lexical autovivified handles:</p>
<pre><code>
{
    local( $/ ) ;
    open( my $fh, $file ) or die &quot;sudden flaming death\n&quot;
    $text = &lt;$fh&gt;
}

        open( my $fh, $file ) or die &quot;sudden flaming death\n&quot;
        my $text = do { local( $/ ) ; &lt;$fh&gt; } ;</code></pre>
<p>And this is a variant of that idiom that removes the need for the open
call:</p>
<pre><code>
my $text = do { local( @ARGV, $/ ) = $file ; &lt;&gt; } ;</code></pre>
<p>The filename in <code>$file</code> is assigned to a localized <code>@ARGV</code> and the
null filehandle is used which reads the data from the files in <code>@ARGV</code>.</p>
<p>Instead of assigning to a scalar, all the above slurps can assign to an
array and it will get the file but split into lines (using <code>$/</code> as the
end of line marker).</p>
<p>There is one common variant of those slurps which is very slow and not
good code. You see it around, and it is almost always cargo cult code:</p>
<pre><code>
my $text = join( '', &lt;FH&gt; ) ;</code></pre>
<p>That needlessly splits the input file into lines (<code>join</code> provides a
list context to <code>&lt;FH&gt;</code>) and then joins up those lines again. The
original coder of this idiom obviously never read <em>perlvar</em> and learned
how to use <code>$/</code> to allow scalar slurping.</p>

<h3><a name="write slurping">Write Slurping</a></h3>
<p>While reading in entire files at one time is common, writing out entire
files is also done. We call it &quot;slurping&quot; when we read in files, but
there is no commonly accepted term for the write operation. I asked some
Perl colleagues and got two interesting nominations: Peter Scott said to
call it &quot;burping&quot; (rhymes with &quot;slurping&quot; and suggests movement in
the opposite direction); others suggested &quot;spewing&quot; which has a
stronger visual image :-) Tell me your favorite or suggest your own. I
will use both in this section so you can see how they work for you.</p>
<p>Spewing a file is a much simpler operation than slurping. You don't have
context issues to worry about and there is no efficiency problem with
returning a buffer. Here is a simple burp subroutine:</p>
<pre><code>
sub burp {
    my( $file_name ) = shift ;
    open( my $fh, &quot;&gt;$file_name&quot; ) || 
        die &quot;can't create $file_name $!&quot; ;
    print $fh @_ ;
}</code></pre>
<p>Note that it doesn't copy the input text but passes @_ directly to
print. We will look at faster variations of that later on.</p>

<h3><a name="slurp on the cpan">Slurp on the CPAN</a></h3>
<p>As you would expect there are modules in the CPAN that will slurp files
for you. The two I found are called Slurp.pm (by Rob Casey - ROBAU on
CPAN) and File::Slurp.pm (by David Muir Sharnoff - MUIR on CPAN).</p>
<p>Here is the code from Slurp.pm:</p>
<pre><code>
sub slurp { 
    local( $/, @ARGV ) = ( wantarray ? $/ : undef, @_ ); 
    return &lt;ARGV&gt;;
}

sub to_array {
    my @array = slurp( @_ );
    return wantarray ? @array : \@array;
}

sub to_scalar {
    my $scalar = slurp( @_ );
    return $scalar;
}</code></pre>
<p>The subroutine <code>slurp()</code> uses the magic undefined value of <code>$/</code> and
the magic file handle <code>ARGV</code> to support slurping into a scalar or
array. It also provides two wrapper subs that allow the caller to
control the context of the slurp. And the <code>to_array()</code> subroutine will
return the list of slurped lines or a anonymous array of them according
to its caller's context by checking <code>wantarray</code>. It has 'slurp' in
<code>@EXPORT</code> and all three subroutines in <code>@EXPORT_OK</code>.</p>
<p>File::Slurp.pm has this code:</p>
<pre><code>
sub read_file
{
    my ($file) = @_;

    local($/) = wantarray ? $/ : undef;
    local(*F);
    my $r;
    my (@r);

    open(F, &quot;&lt;$file&quot;) || croak &quot;open $file: $!&quot;;
    @r = &lt;F&gt;;
    close(F) || croak &quot;close $file: $!&quot;;

    return $r[0] unless wantarray;
    return @r;
}</code></pre>
<p>This module provides several subroutines including <code>read_file()</code> (more
on the others later). <code>read_file()</code> behaves similarly to
<code>Slurp::slurp()</code> in that it will slurp a list of lines or a single
scalar depending on the caller's context. It also uses the magic
undefined value of <code>$/</code> for scalar slurping but it uses an explicit
open call rather than using a localized <code>@ARGV</code> and the other module
did. Also it doesn't provide a way to get an anonymous array of the
lines but that can easily be rectified by calling it inside an anonymous
array constructor <code>[]</code>.</p>
<p>Both of these modules make it easier for Perl coders to slurp in
files. They both use the magic <code>$/</code> to slurp in scalar mode and the
natural behavior of <code>&lt;&gt;</code> in list context to slurp as lines. But
neither is optimized for speed nor can they handle <code>binmode()</code> to
support binary or unicode files. See below for more on slurp features
and speedups.</p>

<h3><a name="slurping api design">Slurping API Design</a></h3>
<p>The slurp modules on CPAN are have a very simple API and don't support
<code>binmode()</code>. This section will cover various API design issues such as
efficient return by reference, <code>binmode()</code> and calling variations.</p>
<p>Let's start with the call variations. Slurped files can be returned in
four formats: as a single scalar, as a reference to a scalar, as a list
of lines or as an anonymous array of lines. But the caller can only
provide two contexts: scalar or list. So we have to either provide an
API with more than one subroutine (as Slurp.pm did) or just provide one
subroutine which only returns a scalar or a list (not an anonymous
array) as File::Slurp does.</p>
<p>I have used my own <code>read_file()</code> subroutine for years and it has the
same API as File::Slurp: a single subroutine that returns a scalar or a
list of lines depending on context. But I recognize the interest of
those that want an anonymous array for line slurping. For one thing, it
is easier to pass around to other subs and, for another, it eliminates
the extra copying of the lines via <code>return</code>. So my module will support
multiple subroutines with one that returns the file based on context, and
the other returns only lines (either as a list or as an anonymous
array). So this API is in between the two CPAN modules. There is no need
for a specific slurp-in-as-a-scalar subroutine as the general <code>slurp()</code>
will do that in scalar context. If you wanted to slurp a scalar into an
array, just select the desired array element and that will provide
scalar context to the <code>read_file()</code> subroutine.</p>
<p>The next area to cover is what to name these subs. I will go with
<code>read_file()</code> and <code>read_file_lines()</code>. They are descriptive, simple and don't
use the 'slurp' nickname (though that nickname is in the module name).</p>
<p>Another critical area when designing APIs is how to pass in
arguments. The <code>read_file*()</code> subroutines takes one required argument
which is the file name. To support <code>binmode()</code> we need another optional
argument. A third optional argument is needed to support returning a
slurped scalar by reference. My first thought was to design the API with
3 positional arguments - file name, buffer reference and binmode. But if
you want to set the binmode and not pass in a buffer reference, you have
to fill the second argument with <code>undef</code> and that is ugly. So I decided
to make the filename argument positional and the other two named. The
subroutine starts off like this:</p>
<pre><code>
sub read_file {

    my( $file_name, %args ) = @_ ;

    my $buf ;
    my $buf_ref = $args{'buf'} || \$buf ;</code></pre>
<p>The binmode argument will be handled later (see code below).</p>
<p>The other sub (<code>read_file_lines()</code>) will only take an optional binmode
(so you can read files with binary delimiters). It doesn't need a buffer
reference argument since it can return an anonymous array if the called
in a scalar context. So this subroutine could use positional arguments,
but to keep its API similar to the API of <code>read_file()</code>, it will also
use pass by name for the optional arguments. This also means that new
optional arguments can be added later without breaking any legacy
code. A bonus with keeping the API the same for both subs will be seen
how the two subs are optimized to work together.</p>
<p>Write slurping (or spewing or burping <code>:-)</code>) needs to have its API
designed as well. The biggest issue is not only needing to support
optional arguments but a list of arguments to be written is needed. Perl
6 will be able to handle that with optional named arguments and a final
slurp argument. Since this is Perl 5, we have to do it using some
cleverness. The first argument is the file name and it will be
positional as with the <code>read_file</code> subroutine. But how can we pass in
the optional arguments and also a list of data? The solution lies in the
fact that the data list should never contain a reference.
Burping/spewing works only on plain data. So if the next argument is a
hash reference, we can assume it contains the optional arguments and
the rest of the arguments is the data list. So the <code>write_file()</code>
subroutine will start off like this:</p>
<pre><code>
sub write_file {

    my $file_name = shift ;

    my $args = ( ref $_[0] eq 'HASH' ) ? shift : {} ;</code></pre>
	
<p>Whether or not optional arguments are passed in, we leave the data list
in <code>@_</code> to minimize any more copying. You call <code>write_file()</code> like this:</p>
<pre><code>
write_file( 'foo', { binmode =&gt; ':raw' }, @data ) ;
write_file( 'junk', { append =&gt; 1 }, @more_junk ) ;
write_file( 'bar', @spew ) ;</code></pre>













<h3><a name="fast slurping">Fast Slurping</a></h3>
<p>Somewhere along the line, I learned about a way to slurp files faster
than by setting $/ to undef. The method is very simple, you do a single
read call with the size of the file (which the -s operator provides).
This bypasses the I/O loop inside perl that checks for EOF and does all
sorts of processing. I then decided to experiment and found that
sysread is even faster as you would expect. sysread bypasses all of
Perl's stdin and reads the file from the kernel buffers directly into a
Perl scalar. This is why the slurp code in File::Slurp uses
sysopen/sysread/syswrite. All the rest of the code is just to support
the various options and data passing techniques.</p>
<p></p>


<h3>Benchmarks</h3>
<p>Benchmarks can be enlightening, informative, frustrating and
deceiving. It would make no sense to create a new and more complex slurp
module unless it also gained significantly in speed. So I created a
benchmark script which compares various slurp methods with differing
file sizes and calling contexts. This script can be run from the main
directory of the tarball like this:</p>
<pre><code>
perl -Ilib extras/slurp_bench.pl</code></pre>
<p>If you pass in an argument on the command line, it will be passed to
<code>timethese()</code> and it will control the duration. It defaults to -2 which
makes each benchmark run to at least 2 seconds of CPU time.</p>
<p>The following numbers are from a run I did on my 300Mhz sparc. You will
most likely get much faster counts on your boxes but the relative speeds
shouldn't change by much. If you see major differences on your
benchmarks, please send me the results and your Perl and OS
versions. Also you can play with the benchmark script and add more slurp
variations or data files.</p>
<p>The rest of this section will be discussing the results of the
benchmarks. You can refer to extras/slurp_bench.pl to see the code for
the individual benchmarks. If the benchmark name starts with cpan_, it
is either from Slurp.pm or File::Slurp.pm. Those starting with new_ are
from the new File::Slurp.pm. Those that start with file_contents_ are
from a client's code base. The rest are variations I created to
highlight certain aspects of the benchmarks.</p>
<p>The short and long file data is made like this:</p>
<pre><code>
my @lines = ( 'abc' x 30 . &quot;\n&quot;)  x 100 ;
my $text = join( '', @lines ) ;

@lines = ( 'abc' x 40 . &quot;\n&quot;)  x 1000 ;
$text = join( '', @lines ) ;</code></pre>
<p>So the short file is 9,100 bytes and the long file is 121,000
bytes.</p>

<h4><a name="scalar slurp of short file">Scalar Slurp of Short File</a></h4>
<pre><code>
file_contents        651/s
file_contents_no_OO  828/s
cpan_read_file      1866/s
cpan_slurp          1934/s
read_file           2079/s
new                 2270/s
new_buf_ref         2403/s
new_scalar_ref      2415/s
sysread_file        2572/s</code></pre>

<h4><a name="scalar slurp of long file">Scalar Slurp of Long File</a></h4>
<pre><code>
file_contents_no_OO 82.9/s
file_contents       85.4/s
cpan_read_file       250/s
cpan_slurp           257/s
read_file            323/s
new                  468/s
sysread_file         489/s
new_scalar_ref       766/s
new_buf_ref          767/s</code></pre>
<p>The primary inference you get from looking at the numbers above is that
when slurping a file into a scalar, the longer the file, the more time
you save by returning the result via a scalar reference. The time for
the extra buffer copy can add up. The new module came out on top overall
except for the very simple sysread_file entry which was added to
highlight the overhead of the more flexible new module which isn't that
much. The file_contents entries are always the worst since they do a
list slurp and then a join, which is a classic newbie and cargo culted
style which is extremely slow. Also the OO code in file_contents slows
it down even more (I added the file_contents_no_OO entry to show this).
The two CPAN modules are decent with small files but they are laggards
compared to the new module when the file gets much larger.</p>

<h4><a name="list slurp of short file">List Slurp of Short File</a></h4>
<pre><code>
cpan_read_file          589/s
cpan_slurp_to_array     620/s
read_file               824/s
new_array_ref           824/s
sysread_file            828/s
new                     829/s
new_in_anon_array       833/s
cpan_slurp_to_array_ref 836/s</code></pre>

<h4><a name="list slurp of long file">List Slurp of Long File</a></h4>
<pre><code>
cpan_read_file          62.4/s
cpan_slurp_to_array     62.7/s
read_file               92.9/s
sysread_file            94.8/s
new_array_ref           95.5/s
new                     96.2/s
cpan_slurp_to_array_ref 96.3/s
new_in_anon_array       97.2/s</code></pre>
<p>This is perhaps the most interesting result of this benchmark. Five
different entries have effectively tied for the lead. The logical
conclusion is that splitting the input into lines is the bounding
operation, no matter how the file gets slurped. This is the only
benchmark where the new module isn't the clear winner (in the long file
entries - it is no worse than a close second in the short file
entries).</p>
<p>Note: In the benchmark information for all the spew entries, the extra
number at the end of each line is how many wall-clock seconds the whole
entry took. The benchmarks were run for at least 2 CPU seconds per
entry. The unusually large wall-clock times will be discussed below.</p>

<h4><a name="scalar spew of short file">Scalar Spew of Short File</a></h4>
<pre><code>
cpan_write_file 1035/s  38
print_file      1055/s  41
syswrite_file   1135/s  44
new             1519/s  2
print_join_file 1766/s  2
new_ref         1900/s  2
syswrite_file2  2138/s  2</code></pre>

<h4><a name="scalar spew of long file">Scalar Spew of Long File</a></h4>
<pre><code>
cpan_write_file 164/s   20
print_file      211/s   26
syswrite_file   236/s   25
print_join_file 277/s   2
new             295/s   2
syswrite_file2  428/s   2
new_ref         608/s   2</code></pre>
<p>In the scalar spew entries, the new module API wins when it is passed a
reference to the scalar buffer. The <code>syswrite_file2</code> entry beats it
with the shorter file due to its simpler code. The old CPAN module is
the slowest due to its extra copying of the data and its use of print.</p>

<h4><a name="list spew of short file">List Spew of Short File</a></h4>
<pre><code>
cpan_write_file  794/s  29
syswrite_file   1000/s  38
print_file      1013/s  42
new             1399/s  2
print_join_file 1557/s  2</code></pre>

<h4><a name="list spew of long file">List Spew of Long File</a></h4>
<pre><code>
cpan_write_file 112/s   12
print_file      179/s   21
syswrite_file   181/s   19
print_join_file 205/s   2
new             228/s   2</code></pre>
<p>Again, the simple <code>print_join_file</code> entry beats the new module when
spewing a short list of lines to a file. But is loses to the new module
when the file size gets longer. The old CPAN module lags behind the
others since it first makes an extra copy of the lines and then it calls
<code>print</code> on the output list and that is much slower than passing to
<code>print</code> a single scalar generated by join. The <code>print_file</code> entry
shows the advantage of directly printing <code>@_</code> and the
<code>print_join_file</code> adds the join optimization.</p>
<p>Now about those long wall-clock times. If you look carefully at the
benchmark code of all the spew entries, you will find that some always
write to new files and some overwrite existing files. When I asked David
Muir why the old File::Slurp module had an <code>overwrite</code> subroutine, he
answered that by overwriting a file, you always guarantee something
readable is in the file. If you create a new file, there is a moment
when the new file is created but has no data in it. I feel this is not a
good enough answer. Even when overwriting, you can write a shorter file
than the existing file and then you have to truncate the file to the new
size. There is a small race window there where another process can slurp
in the file with the new data followed by leftover junk from the
previous version of the file. This reinforces the point that the only
way to ensure consistent file data is the proper use of file locks.</p>
<p>But what about those long times? Well it is all about the difference
between creating files and overwriting existing ones. The former have to
allocate new inodes (or the equivalent on other file systems) and the
latter can reuse the existing inode. This mean the overwrite will save on
disk seeks as well as on cpu time. In fact when running this benchmark,
I could hear my disk going crazy allocating inodes during the spew
operations. This speedup in both cpu and wall-clock is why the new module
always does overwriting when spewing files. It also does the proper
truncate (and this is checked in the tests by spewing shorter files
after longer ones had previously been written). The <code>overwrite</code>
subroutine is just an typeglob alias to <code>write_file</code> and is there for
backwards compatibility with the old File::Slurp module.</p>

<h4><a name="benchmark conclusion">Benchmark Conclusion</a></h4>
<p>Other than a few cases where a simpler entry beat it out, the new
File::Slurp module is either the speed leader or among the leaders. Its
special APIs for passing buffers by reference prove to be very useful
speedups. Also it uses all the other optimizations including using
<code>sysread/syswrite</code> and joining output lines. I expect many projects
that extensively use slurping will notice the speed improvements,
especially if they rewrite their code to take advantage of the new API
features. Even if they don't touch their code and use the simple API
they will get a significant speedup.</p>

<h3><a name="error handling">Error Handling</a></h3>
<p>Slurp subroutines are subject to conditions such as not being able to
open the file, or I/O errors. How these errors are handled, and what the
caller will see, are important aspects of the design of an API. The
classic error handling for slurping has been to call <code>die()</code> or even
better, <code>croak()</code>. But sometimes you want the slurp to either
<code>warn()</code>/<code>carp()</code> or allow your code to handle the error. Sure, this
can be done by wrapping the slurp in a <code>eval</code> block to catch a fatal
error, but not everyone wants all that extra code. So I have added
another option to all the subroutines which selects the error
handling. If the 'err_mode' option is 'croak' (which is also the
default), the called subroutine will croak. If set to 'carp' then carp
will be called. Set to any other string (use 'quiet' when you want to
be explicit) and no error handler is called. Then the caller can use the
error status from the call.</p>
<p><code>write_file()</code> doesn't use the return value for data so it can return a
false status value in-band to mark an error. <code>read_file()</code> does use its
return value for data, but we can still make it pass back the error
status. A successful read in any scalar mode will return either a
defined data string or a reference to a scalar or array. So a bare
return would work here. But if you slurp in lines by calling it in a
list context, a bare <code>return</code> will return an empty list, which is the
same value it would get from an existing but empty file. So now,
<code>read_file()</code> will do something I normally strongly advocate against,
i.e., returning an explicit <code>undef</code> value. In the scalar context this
still returns a error, and in list context, the returned first value
will be <code>undef</code>, and that is not legal data for the first element. So
the list context also gets a error status it can detect:</p>
<pre><code>
my @lines = read_file( $file_name, err_mode =&gt; 'quiet' ) ;
your_handle_error( &quot;$file_name can't be read\n&quot; ) unless
    @lines &amp;&amp; defined $lines[0] ;</code></pre>

<h3><a name="the implementation">The implementation</a></h3>
<p>Here's the whole code which implements my faster slurp:</p>
<pre><code>
sub read_file {

    my( $file_name, %args ) = @_ ;

    my $buf ;
    my $buf_ref = $args{'buf_ref'} || \$buf ;

    my $mode = O_RDONLY ;
    $mode |= O_BINARY if $args{'binmode'} ;

    local( *FH ) ;
    sysopen( FH, $file_name, $mode ) or
        carp &quot;Can't open $file_name: $!&quot; ;

    my $size_left = -s FH ;

    while( $size_left &gt; 0 ) {

        my $read_cnt = sysread( FH, ${$buf_ref},
            $size_left, length ${$buf_ref} ) ;

        unless( $read_cnt ) {

            carp &quot;read error in file $file_name: $!&quot; ;
            last ;
        }

            $size_left -= $read_cnt ;
    }

# handle void context (return scalar by buffer reference)
    return unless defined wantarray ;

# handle list context
    return split m|?&lt;$/|g, ${$buf_ref} if wantarray ;

# handle scalar context
    return ${$buf_ref} ;
}

sub read_file_lines {
# handle list context
return &amp;read_file if wantarray;
# otherwise handle scalar context
return [ &amp;read_file ] ;
}

sub write_file {

    my $file_name = shift ;

    my $args = ( ref $_[0] eq 'HASH' ) ? shift : {} ;
    my $buf = join '', @_ ;

    my $mode = O_WRONGLY ;
    $mode |= O_BINARY if $args-&gt;{'binmode'} ;
    $mode |= O_APPEND if $args-&gt;{'append'} ;

    local( *FH ) ;
    sysopen( FH, $file_name, $mode ) or
        carp &quot;Can't open $file_name: $!&quot; ;

    my $size_left = length( $buf ) ;
    my $offset = 0 ;

    while( $size_left &gt; 0 ) {

        my $write_cnt = syswrite( FH, $buf,
                $size_left, $offset ) ;

        unless( $write_cnt ) {

            carp &quot;write error in file $file_name: $!&quot; ;
            last ;
        }

        $size_left -= $write_cnt ;
        $offset += $write_cnt ;
    }

    return ;
}</code></pre>

<h3><a name="in summary">In Summary</a></h3>
<p>We have compared classic line-by-line processing with munging a whole
file in memory. Slurping files can speed up your programs and simplify
your code, if done properly. You must still be aware to not slurp
humongous files (logs, DNA sequences, and so forth), or STDIN, where you don't
know how much data you will read in. But slurping megabyte-size files
is not a major issue on today's systems with the typical amount of RAM
installed. When Perl was first being used in-depth (Perl 4), slurping
was limited by the smaller RAM size of ten years ago. Now, you should be
able to slurp almost any reasonably sized file, whether it contains
configuration, source code, or data.</p>

        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1218" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2003/11/17/lmsolve.html" rel="bookmark">Solving Puzzles with LM-Solve</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Shlomi Fish</span> on <abbr class="published" title="2003-11-17T00:00:00-08:00">November 17, 2003 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            
<!-- sidebar begins -->
<!-- don't move sidebars -->
<!-- sidebar ends -->

<p>
        Suppose you encounter a (single-player) riddle or a puzzle that
        you don't know how to solve. Let's also suppose that this puzzle involves
        moving between several states of the board with an enumerable number 
        of moves emerging from one state. In this case, <a href="http://vipe.technion.ac.il/~shlomif/lm-solve/">LM-Solve</a> 
        (or Games::LMSolve on CPAN) may be of help.
        </p>

        <p>
        LM-Solve was originally written to tackle various types of the
        so-called <a href="http://www.logicmazes.com/">logic mazes</a>
        that can be found online. Nevertheless, it can be extended to 
        support many other types of single-player puzzles.
        </p>
        
        <p>
        In this article, I will demonstrate how to use LM-Solve to solve a type of 
        puzzle that it does not know yet to solve.
        </p>
        
        <h2>Installation</h2>
<csperl file="grab" domain="on" record="b/515" template="b/article_sidebar.view">
        <p>
        Use the CPAN.pm module <code>install Games::LMSolve</code> command to 
        install LM-Solve. For instance, invoke the following command
        on the command line: 
        </p>

<pre><code>$ perl -MCPAN -e 'install Games::LMSolve'</code></pre>

        <p>
        That's it! (LM-Solve does not require any non-base modules, and should
        run on all recent versions of Perl.)
        </p>

        <h2>The Puzzle in Question</h2>

        <p>
        The puzzle in question is called "Jumping Cards" and is taken from
        the <a href="http://mathforum.org/wagon/spring02/p949.html">Macalester
            College Problem of the Week No. 949</a>. In this puzzle, we start
        with eight cards in a row (labeled 1 to 8). We have to transform it into
        the 8 to 1 sequence, by swapping two cards at a time, as long as the following
        condition is met: at any time, two neighboring cards must be in
        one, two, or three spaces of each other.
        </p>

        <p>
        Let's experience with this puzzle a bit. We start with the following
        formation:
        </p>

        <pre><code>1 2 3 4 5 6 7 8</code></pre>

        <p>
        Let's swap 1 and 3, and see what it gives us:
        </p>

        <pre><code>3 2 1 4 5 6 7 8</code></pre>

        <p>
        Now, we cannot exchange 1 and 4, because then, 1 would be close to
        the 5, and 5-1 is 4, which is more than 3. So let's exchange 2 and
        1:
        </p>

        <pre><code>3 1 2 4 5 6 7 8</code></pre>

        <p>
        Now we can exchange 2 and 4:
        </p>

        <pre><code>3 1 4 2 5 6 7 8</code></pre>

        <p>
        And so on.
        </p>

        <h2>Let's Start ... Coding!</h2>

        <p>
        The <code>Games::LMSolve::Base</code> class tries to solve a game by iterating
        through its various positions, recording every one it passes through,
        and trying to reach the solution. However, it does not know in advance
        what the games rules are, and what the meaning of the positions
        and moves are. In order for it to know that, we need to inherit it and
        code several methods that are abstract in the base class.
        </p>

        <p>
        We will code a derived class that will implement the logic specific
        to the Jumping Cards game. It will implement the following methods,
        which, together with the methods of the base class, enable the solver
        to solve the game:
        </p>

        <ol>
            <li><code>input_board</code></li>
            <li><code>pack_state</code></li>
            <li><code>unpack_state</code></li>
            <li><code>display_state</code></li>
            <li><code>check_if_final_state</code></li>
            <li><code>enumerate_moves</code></li>
            <li><code>perform_move</code></li>
            <li><code>render_move</code></li>            
        </ol>

        <p>
        Here's the beginning of the file where we put the script:
        </p>
<pre><code>package Jumping::Cards;

use strict;

use Games::LMSolve::Base;

use vars qw(@ISA);

@ISA=qw(Games::LMSolve::Base);</code></pre>

        <p>
        As can be seen, we declared a new package, <code>Jumping::Cards</code>,
        imported the <code>Games::LMSolve::Base</code> namespace, and inherited
        from it. Now let's start declaring the methods. First, a method to
        input the board in question.
        </p>
        <p>
        Since our board is constant, we just return an array reference that 
        contains the initial sequence.
        </p>
<pre><code>sub input_board
{
    my $self = shift;

    my $filename = shift;

    return [ 1 .. 8 ];
}</code></pre>
        <p>
        When <code>Games::LMSolve::Base</code> iterates over the states, it stores data
        about each state in a hash. This means we're going to have to provide a
        way to convert each state from its expanded form into a uniquely 
        identifying string. The <code>pack_state</code> method does this, and in 
        our case, it will look like this:
        </p>

<pre><code># A function that accepts the expanded state (as an array ref)
# and returns an atom that represents it.
sub pack_state
{
    my $self = shift;
    my $state_vector = shift;
    return join(",", @$state_vector);
}</code></pre>

        <p>
        It is a good idea to use functions like <code>pack</code>, <code>join</code>
        or any other serialization mechanism here. In our case, we simply
        used <code>join</code>.
        </p>

        <p>
        It is not very convenient to manipulate a packed state, and so we need
        another function to expand it. <code>unpack_state</code> does the 
        opposite of <code>pack_state</code> and expands a packed state.
        </p>

<pre><code># A function that accepts an atom that represents a state 
# and returns an array ref that represents it.
sub unpack_state
{
    my $self = shift;
    my $state = shift;
    return [ split(/,/, $state) ];
}</code></pre>
        <p>
        <code>display_state()</code> converts a packed state to a user-readable string. This
        is so that it can be displayed to the user. In our case, the comma-delimited 
        notation is already readable, so we leave it as that.        
        </p>

<pre><code># Accept an atom that represents a state and output a 
# user-readable string that describes it.
sub display_state
{
    my $self = shift;
    my $state = shift;
    return $state;
}</code></pre>
        <p>
        We need to determine when we have reached our goal and can terminate the
        search with a success. The <code>check_if_final_state</code> function 
        accepts an expanded state and checks if it qualifies as a final 
        state. In our case, it is final if it's the 8-to-1 sequence.
        </p>

<pre><code>sub check_if_final_state
{
    my $self = shift;

    my $coords = shift;
    return join(",", @$coords) eq "8,7,6,5,4,3,2,1";
}</code></pre>
        <p>
        Now we need a function that will tell the solver what subsequent
        states are available from each state. This is done by enumerating a 
        set of moves that can be performed on the state. The 
        <code>enumerate_moves</code> function does exactly that.
        </p>
<pre><code># This function enumerates the moves accessible to the state.
sub enumerate_moves
{
    my $self = shift;

    my $state = shift;

    my (@moves);
    for my $i (0 .. 6)
    {
        for my $j (($i+1) .. 7)
        {
            my @new = @$state;
            @new[$i,$j]=@new[$j,$i];
            my $is_ok = 1;
            for my $t (0 .. 6)
            {
                if (abs($new[$t]-$new[$t+1]) &gt; 3)
                {
                    $is_ok = 0;
                    last;
                }
            }
            if ($is_ok)
            {
                push @moves, [$i,$j];
            }
        }
    }
    return @moves;
}</code></pre>
        <p>
        What <code>enumerate_moves</code> does is iterate over the indices of the 
        locations twice, and checks every move for the validity of the 
        resultant board. If it's OK, it pushes the exchanged indices to the 
        array <code>@moves</code>, which is returned at the end.
        </p>

        <p>
        We also need a function that will translate an origin state and
        a move to a resultant state. The <code>perform_move</code> function 
        performs a move on a state and returns the new state. In our case, 
        it simply swaps the cards in the two indices specified by the move.
        </p>

<pre><code># This function accepts a state and a move. It tries to perform the
# move on the state. If it is successful, it returns the new state.
sub perform_move
{
    my $self = shift;

    my $state = shift;
    my $m = shift;

    my @new = @$state;

    my ($i,$j) = @$m;
    @new[$i,$j]=@new[$j,$i];
    return \@new;
}</code></pre>
        <p>
        Finally, we need a function that will render a move into a 
        user-readable string, so it can be displayed to the user.
        </p>

<pre><code>sub render_move
{
    my $self = shift;

    my $move = shift;

    if (defined($move))
    {
        return join(" &lt;=&gt; ", @$move);
    }
    else
    {
        return "";
    }
}</code></pre>
        <h2>Invoking the Solver</h2>

        <p>
        To make the solver invokable, create an instance of it in the
        main namespace, and call its <code>main()</code> function. This will
        turn it into a script that will solve the board. The code is this:
        </p>
<pre><code>package main;

my $solver = Jumping::Cards-&gt;new();
$solver-&gt;main();</code></pre>
        <p>
        Now save everything to a file, <i>jumping_cards.pl</i> (or
        download <a href="http://t2.technion.ac.il/~shlomif/solving-with-lms/jumping_cards.pl">the complete one</a>), and invoke 
        it like this: <code>perl jumping_cards.pl --norle --output-states</code>. 
        The <code>--norle</code> option means not to run-length encode the moves.
        In our case, run-length encoding will do no good, because a move can
        appear only once (or else its effect will be reversed). 
        <code>--output-states</code> causes the states to be displayed in the
        solution.
        </p>
        <p>
        The program thinks a little and then outputs:
        </p>
<pre><code>solved
solved
1,2,3,4,5,6,7,8: Move = 0 &lt;=&gt; 1
2,1,3,4,5,6,7,8: Move = 1 &lt;=&gt; 2
2,3,1,4,5,6,7,8: Move = 1 &lt;=&gt; 3
2,4,1,3,5,6,7,8: Move = 4 &lt;=&gt; 5
2,4,1,3,6,5,7,8: Move = 0 &lt;=&gt; 4
6,4,1,3,2,5,7,8: Move = 2 &lt;=&gt; 3
6,4,3,1,2,5,7,8: Move = 0 &lt;=&gt; 1
4,6,3,1,2,5,7,8: Move = 0 &lt;=&gt; 7
8,6,3,1,2,5,7,4: Move = 6 &lt;=&gt; 7
8,6,3,1,2,5,4,7: Move = 3 &lt;=&gt; 5
8,6,3,5,2,1,4,7: Move = 2 &lt;=&gt; 7
8,6,7,5,2,1,4,3: Move = 1 &lt;=&gt; 2
8,7,6,5,2,1,4,3: Move = 4 &lt;=&gt; 6
8,7,6,5,4,1,2,3: Move = 5 &lt;=&gt; 7
8,7,6,5,4,3,2,1</code></pre>

        <p>
        Which is a correct solution to the problem. If you want to see
        a run-time display of the solving process, add the <code>--rtd</code> 
        switch.
        </p>

        <h2>Conclusion</h2>

        <p>
        LM-Solve is a usable and flexible framework for writing your own
        solvers for various kind of puzzles such as the above. Puzzles that
        are good candidates for implementing solvers 
        have a relatively limited number of states and a small number of
        states emerging from each origin state.
        </p>
        <p>
        I found several solitaire games, such as Freecell, to be solvable
        by methods similar to the above. On the other hand, Klondike
        and other games with <code>talon</code>, are very hard to solve using
        such methods, because the <code>talon</code> expands the number of states
        a great deal.
        </p>
        <p>
        Still, for most "simple-minded" puzzles, LM-Solve is very attractive
        as a solver framework. Have fun!
        </p>

        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1224" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2003/11/p6pdigest/20031109.html" rel="bookmark">This week on Perl 6, week ending 2003-11-09</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Piers Cawley</span> on <abbr class="published" title="2003-11-09T00:00:00-08:00">November  9, 2003 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            
<p>Traditionally this paragraph concerns itself with a few words on what
I've been up to before finally settling down to get the summary
written. But despite the fact that it's nearly four o'clock, it's been
one of those days where I seem to have done almost as much as Leon
Brocard generally does to warrant a mention each week.</p>
<p>So, here's what's been happening in perl6-internals to make up for the
lack of guff about breadmaking or whatever. (If you're interested, the
raisin borodinsky I mentioned last week was an unmitigated
disaster. The focaccia was fabulous though).</p>

<h4><a name="new glossary entries">New glossary entries</a></h4>
<p>Gregor N. Purdy has added a few entries to the Parrot glossary, so if
you've been bursting to know what PIR, IMCC and other Parrot specific
clusters of capitals stand for, check out <em>docs/glossary.pod</em> in the
parrot distribution.</p>
<p><a href="http://groups.google.com/groups?threadm=1067835080.21332.28.camel%40borg.focusresearch.com">http://groups.google.com/groups</a></p>

<h4><a name="string encodings hurt my head!">String Encodings hurt my head!</a></h4>
<p>Peter Gibbs is attempting to implement the DBCS encoding (whatever
that is) and has discovered that he can't implement <code>skip_backward</code>
for it because of the mixture of 1-byte and 2-byte characters. He
offered seven suggestions for the right thing to do at this impasse.</p>
<p>Michael Scott didn't have any suggestions about the Right Thing, but
he did point to a page on his very lovely Parrot Wiki which discussed
most things Unicode for parrot, and made a plea for Dan (or whoever)
to produce a Strings PDD.</p>
<p><a href="http://groups.google.com/groups?threadm=065301c3a1f3%24be905240%24c701010a%40peter">http://groups.google.com/groups</a></p>
<p><a href="http://www.vendian.org/parrot/wiki/bin/view.cgi/Main/ParrotDistributionUnicodeSupport">http://www.vendian.org/parrot/wiki/bin/view.cgi/Main/ParrotDistributionUnicodeSupport</a> - Michael's WikiWord</p>

<csperl file="grab" domain="on" record="b/940" template="b/article_sidebar.view">

<h4><a name="perl 6 patches">Perl 6 patches</a></h4>
<p>Allison Randal posted a couple of patches to the current (very) mini
Perl 6 that comes with Parrot (in <em>languages/perl6</em>. A little later
in the week, Joseph F. Ryan contributed a Perl 6 patch. It's good to
see this receiving attention again.</p>
<p><a href="http://groups.google.com/groups?threadm=rt-24391-66978.5.70748361274084%40rt.perl.org">http://groups.google.com/groups</a></p>

<h4><a name="documentation">Documentation</a></h4>
<p>Nick Kostirya wondered why <em>docs/parrot_assembly.pod</em> appeared to be
simply an old version of <em>docs/pdds/pdd06_pasm.pod</em>. He also worried
that <em>docs/ops/</em> appeared to be empty in the 0.0.13 release of
Parrot. Dan noted that both of the parrot assembly docs were wrong,
and that what would probably happen would be that the PDD would be
updated and <em>docs/parrot_assembly.pod</em> would be retired. J&uuml;rgen
B&ouml;mmels said that the empty <em>docs/ops</em> was because during the
Great Move, the Makefile that generated those POD files didn't get
updated to cope with the new location of the .ops files. Nick wondered
which other POD files might be going away so he'd not have to go
through the process of translating obsolete docs into Russian.</p>
<p><a href="http://groups.google.com/groups?threadm=003201c3a223%24dc0becf0%242701010a%40han.kherson.ua">http://groups.google.com/groups</a></p>
<p><a href="http://www.parrotcode.ks.ua/docs">http://www.parrotcode.ks.ua/docs</a> -- Why can't I type in Cyrillic?</p>

<h4><a name="from the interesting, but is it useful department">From the &quot;Interesting, but is it useful?&quot; department</a></h4>
<p>Melvin Smith has been playing with an uncommitted version of <code>invoke</code>
which allows you to invoke a function by name not address. He outlined
the ideas behind it (and the workaround to make it play nice with the
GC system), but wondered if it was actually of any use. Dan and Leo
both agreed that it wasn't because of issues with threading and the
JIT.</p>
<p><a href="http://groups.google.com/groups?threadm=5.1.1.6.2.20031103121019.028a5488%40pop.mindspring.com">http://groups.google.com/groups</a></p>

<h4><a name="freeze/thaw data format and pbc">Freeze/thaw data format and PBC</a></h4>
<p>Leo T&ouml;tsch is working on the data serialization/deserialization
(aka Freeze/Thaw) system discussed over the last few weeks. He
wondered if there were any plans for the frozen image data
format. Leo's plan is to use PBC constant format (with possible
extensions) so things integrate neatly into bytecode. Dan had a bunch
of comments, but the PBC based format idea seemed to be well received,
with the caveat that it should be a 'dense' format.</p>
<p><a href="http://groups.google.com/groups?threadm=3FA76052.5020700%40toetsch.at">http://groups.google.com/groups</a></p>

<h4><a name="opening files on other layers">Opening files on other layers</a></h4>
<p>J&uuml;rgen B&ouml;mmels asked for comments on a patch for opening
files on different layers which had a few issues that he felt needed
clarifying. He and Melvin Smith spent some time discussing things.</p>
<p>Apologies for not doing a better job in summarizing this thread, but
I'm hamstrung by not quite knowing what 'layer' means in this
context.</p>
<p><a href="http://groups.google.com/groups?threadm=m2r80o2p50.fsf%40helium.physik.uni-kl.de">http://groups.google.com/groups</a></p>

<h4><a name="parrot has php">Parrot Has PHP</a></h4>
<p>Okay, so the subject line's not quite true (yet), but who could resist
the recursive acronyminess of it? Anyhow:</p>
<p>Thies C. Arntzen and Sterling Hughes, core PHP hackers, popped up to
discuss the work they're doing on porting PHP to Parrot. Specifically,
they've hit a performance snag where PHP's typeless nature meant using
a PMC where they would rather be using a native type for speed. Thies
proposed a new datatype to get 'round the issue.</p>
<p>The general response was &quot;Hey! Fabulous! Someone's making a serious
effort to port a real language to Parrot! But that new type suggestion
is just reinventing the PMC. Oh, and if you could change your
generated code slightly you'd get much faster execution&quot;.</p>
<p>It's definitely fabulous though.</p>
<p><a href="http://groups.google.com/groups?threadm=20031105195432.GA32697%40thieso.net">http://groups.google.com/groups</a></p>
<p><a href="http://www.edwardbear.org/pap.pdf">http://www.edwardbear.org/pap.pdf</a> -- Thies and Sterling's presentation</p>

<h4><a name="newsub and implicit registers"><code>newsub</code> and implicit registers</a></h4>
<p>Melvin Smith was concerned about the version of <code>newsub</code> that
implicitly sets P0 and P1, which can give IMCC's register tracking
code something of a headache. He proposed getting rid of the implicit
version and simply using IMCC to hide things. Leo agreed that the
implicit form of <code>newsub</code> wasn't really necessary, but pointed out
that there were plenty more ops out there that had implicit registers
that IMCC needed to track. Leo has a patch in his tree that deals with
the issue.</p>
<p><a href="http://groups.google.com/groups?threadm=5.1.1.6.2.20031106021636.01c43e80%40pop.mindspring.com">http://groups.google.com/groups</a></p>

<h4><a name="hash changes">HASH changes</a></h4>
<p>J&uuml;rgen B&ouml;mmels wasn't entirely happy with some recent
changes to HASH in <em>src/hash.c</em> which make the hash tests fail. Nor
was he happy with the asymmetry of <code>hash_put</code> and <code>hash_get</code>, where
you <code>hash_put</code> a <code>void *value</code> but <code>hash_get</code> back a
<code>HASHBUCKET</code>. Leo apologised for breaking the tests, but defended the
asymmetry because it allows for distinguishing between a value of NULL
and a nonexistent key. J&uuml;rgen wasn't impressed, sometimes the
ambiguity is exactly what you want.</p>
<p>J&uuml;rgen ended up submitting a patch which implements a new,
extended hash querying API:</p>
<pre><code>
  HashBucket *hash_get_bucket(...);
  void       *hash_get(...);
  INTVAL      hash_exists(...);</code></pre>
<p><a href="http://groups.google.com/groups?threadm=m2d6c5zo1q.fsf%40helium.physik.uni-kl.de">http://groups.google.com/groups</a></p>

<h4><a name="nci broken on win32">NCI broken on Win32</a></h4>
<p>NCI, the Native Call Interface, tries to help its users by adding the
appropriate 'loadable library' extension to any library it's asked to
load. This turns out to be the wrong thing to do when you're trying to
use the NCI from Win32, where there's more than one possible extension
for a loadable library (this turns out to be true for Mac OS X as
well). Jonathan Worthington let slip the fact that he was working on a
library to give Parrot access to the entire Win32 API, and that this
would involve loading a file with a <em>.drv</em> extension, which isn't
currently possible with Parrot on Win32.</p>
<p>The catch is that, in a lot of cases, you need to be able to leave the
extension unspecified because different Unix like OSes use the same
basic library name, but a different extension. (For instance, a Linux
box uses '.so', and OS X uses '.dynlib'). Leo proposed a workaround of
only adding the default extension if the file name didn't already
include a . in the filepart. Jonathan thought that sounded workable,
but suggested that simply trying to load the library with the name as
given, then trying with the default extension and only if that fails
throwing an exception, but Leo thought that that would slow down
opening libraries quite substantially.</p>
<p><a href="http://groups.google.com/groups?threadm=011f01c3a4c1%24fd9b4280%24aa866f83%40jwcsjw">http://groups.google.com/groups</a></p>

<h4><a name="regular expressions">Regular expressions</a></h4>
<p>It's been a busy old week this week. First we hear of an effort to
port PHP to Parrot, and then St&eacute;phane Payrard announces that
he's started working on implementing Perl 6 Regular expressions. Which
is nice.</p>
<p><a href="http://groups.google.com/groups?threadm=20031105175019.GA3838%40stefp.dyndns.org">http://groups.google.com/groups</a></p>


<h3><a name="meanwhile in perl6language">Meanwhile in perl6-language</a></h3>

<h4><a name="nested modules">Nested modules</a></h4>
<p>Luke Palmer noted that, as with Perl 5, there was no need for modules
named Foo and Foo::Bar to be related. However, he wondered if it would
be possible to do</p>
<pre><code>
   module Foo;
   module Bar {...}</code></pre>
<p>and refer to the inner module as, say, 'Foo.Bar'. He also wondered
about scary things like anonymous modules.</p>
<p>Larry came up with answers, essentially you could get the semantics
Luke was after but not necessarily with the same syntax.</p>
<p><a href="http://groups.google.com/groups?threadm=20031103025005.GA25752%40babylonia.flatirons.org">http://groups.google.com/groups</a></p>

<h4><a name="how to get environment variables">How to get environment variables</a></h4>
<p>Andrew Shitov wanted to know how to get at environment variables from
the Perl 6 mini language that comes with Parrot. Judging by the error
report that he pasted on his second post, it looks like that's not
supported in the current Perl 6 implementation.</p>
<p><a href="http://groups.google.com/groups?threadm=20031103083007.12455.qmail%40onion.perl.org">http://groups.google.com/groups</a></p>


<h3><a name="announcements, apologies, acknowledgements">Announcements, Apologies, Acknowledgements</a></h3>
<p>As I said earlier, it's been a busy week. It's fabulous to see things
like the PHP porting effort and St&eacute;phane's work on Perl 6
regular expressions getting underway.</p>
<p>I'm afraid that anyone who thought I'd manage two Monday summaries in
a row has been sadly disappointed. Sorry.</p>
<p>Despite that, if you found this summary valuable, please consider the
following ways of showing your appreciation:</p>

<ul>
<li>
Take part. There's new, shiny projects to get involved with now, maybe
you have exactly the knowledge and skills they
need. <a href="http://dev.perl.org/perl6/">http://dev.perl.org/perl6/</a> and <a href="http://www.parrotcode.org/">http://www.parrotcode.org/</a>
are good starting points. Hopefully once the PHP porting effort gets
further down the road I'll be able to point you at a website for that
too.</li>

<li>
Take out your wallet and donate some good hard cash to the Perl
Foundation <a href="http://donate.perl-foundation.org/">http://donate.perl-foundation.org/</a> to help support
Larry, Dan and Damian.</li>

<li>
Take the time to drop me a line at <em><a href="mailto:pdcawley@bofh.org.uk">pdcawley@bofh.org.uk</a></em> letting me
know what you think. I was enormously pleased last week to get some
mail from someone at the Sanger Institute thanking me for the
summaries. Personally, I reckon the Sanger Institute deserves far more
thanks from all of us for keeping the genome free, but it's always
nice to be appreciated.</li>
</ul>

        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1216" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2003/11/07/java.html" rel="bookmark">Bringing Java into Perl</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Phil Crow</span> on <abbr class="published" title="2003-11-07T00:00:00-08:00">November  7, 2003 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            <p>In this article, I will show how to bring Java code into a Perl program
with <code>Inline::Java</code>.  I won't probe the internals of <code>Inline</code> or
<code>Inline::Java</code>, but I will tell you what you need to make a Java class
available in a program or module.  The program/module distinction is important
only in one small piece of syntax, which I will point out.</p>
<p>The article starts with the Java code to be glued into Perl, then shows
several approaches for doing so.  First, the code is placed directly into
a Perl program.  Second, the code is placed into a module used by a program.
Finally, the code is accessed via a small Perl proxy in the module.</p>




<h3><a name="the_java_code">The Java Code</a></h3>
<p>Consider the following Java class:</p>
<pre><code>
    public class Hi {

        String greeting;

        public Hi(String greeting) {
            this.greeting = greeting;
        }

        public void setGreeting(String newGreeting) {
            greeting = newGreeting;
        }

        public String getGreeting() {
            return greeting;
        }
    }</code></pre>
<p>This class is for demonstration only.  Each of its objects is nothing but 
a wrapper for the string passed to the constructor.  The only operations
are accessors for that one string.  Yet with this, we will learn most of
what we need to know to use Java from Perl.  Later, we will add a few
features, to show how arrays are handled.  That's not as interesting as
it sounds, since <code>Inline::Java</code> almost always does all of the work without help.</p>




<h3><a name="a_program">A Program</a></h3>
<p>Since we're talking about Perl, there is more than one way to
incorporate our trivial Java class into a Perl program. (Vocabulary
Note: Some people call Perl programs "scripts."  I try not to.) Here,
I'll show the most direct approach. Subsequent sections move to more and
more indirect approaches, which are more often useful in practice.</p>
<p>Not surprisingly, the most direct approach is the simplest to understand.
See if you can follow this:</p>
<pre><code>
    #!/usr/bin/perl
    use strict; use warnings;

    use Inline Java =&gt; &lt;&lt;'EOJ';
    public class Hi {
        // The class body is shown in the Java Code above
    }
    EOJ

    my $greeter = Hi-&gt;new(&quot;howdy&quot;);
    print $greeter-&gt;getGreeting(), &quot;\n&quot;;</code></pre>

<p>The Java class is the one above, so I have omitted all but the class
declaration.  The Perl code just wraps it, so it is tiny.
To use <code>Inline::Java</code>, say <code>use Inline Java =&gt; code</code> where <code>code</code> tells
<code>Inline</code> where to look for the code.  In this case, the code follows
inline (clever naming, huh?).  Note that single-quote context is safest here.
There are other ways to include the code; we'll see my favorite way later.
The overly curious are welcome to consult the perldoc for all of the others.</p>
<p>Once <code>Inline::Java</code> has worked its magic -- and it is highly magical --
we can use the Java <code>Hi</code> class as if it was a Perl package.  <code>Inline::Java</code>
provides several ways to construct Java objects.  I usually use the
one shown here; namely, I pretend the Java constructor is called <code>new</code>,
just like many Perl constructors are.  In honor of Java, you might rather say
<code>my $greeter = new Hi(&quot;howdy&quot;);</code>, but I usually avoid this indirect
object form.  You can even call the constructor by the class name as in
<code>my $greeter = Hi-&gt;Hi(&quot;howdy&quot;);</code> (or, you could even say the pathological
<code>my $greeter = Hi Hi(&quot;howdy&quot;);</code>).  Class methods are accessed just
like the constructor, except that their names are the Java method names.
Instance methods are called through an object reference, as if the reference
were a Perl object.</p>
<p>Note that <code>Inline::Java</code> performs type conversions for us, so we can
pass and receive Java primitive types in the appropriate Perl variables.
This carries over to arrays, etc.  When you think about what must be
going on under the hood, you'll realize what a truly magical module
this is.</p>




<h3><a name="a_module">A Module</a></h3>
<p>I often say that most Perl code begins life in a program.  As time
goes by, the good parts of that code, the ones that can be reused, are
factored out into modules.  Suppose our greeter is really popular, so
many programs want to use it.  We don't want to have to include the Java
code in each one (and possibly require each program to compile its own
copy of the class file).  Hence, we want a module.  My module looks a
lot like my earlier program, except for two features.  First, I changed
the way <code>Inline</code> looks for the code, which has nothing to do with whether
the code is in a program or a module.  Second, reaching class methods from
any package other than <code>main</code> requires careful -- though not particularly
difficult -- qualification of the method name.</p>
<pre><code>
    package Hi;
    use strict; use warnings;

    use Inline Java =&gt; &quot;DATA&quot;;

    sub new {
        my $class    = shift;
        my $greeting = shift;
        return Hi::Hi-&gt;new($greeting);
    }

    1;

    __DATA__
    __Java__
    public class Hi {
        // The class body is shown in The Java Code above
    }</code></pre>

<p>The package starts like all good packages, by using <code>strict</code> and <code>warnings</code>.
The <code>use Inline</code> statement is almost like the previous one, but the code
lives in the <code>__DATA__</code> segment instead of actually being inline.  Note that
when you put the code in the <code>__DATA__</code> segment, you must include a marker
for your language so that <code>Inline</code> can find it.  There are usually several
choices for each language's marker; I chose <code>__Java__</code>.  This allows
<code>Inline</code> to glue from multiple languages into one source file.</p>
<p>The constructor is needed so that the caller does not need to know they are
interfacing with <code>Inline::Java</code>.  They call the constructor with
<code>Hi->new(&quot;greeting&quot;)</code> as they would for a typical package called <code>Hi</code>.
Yet, the module's constructor must do a bit of work to get the right object
for the caller.  It starts by retrieving the arguments, then returns the
result of the unusual call <code>Hi::Hi->new(...)</code>.  The first <code>Hi</code> is for
the Perl package and the second is for the Java class; both are required.
Just as in the program from the last section, there are multiple ways
to call the constructor.  I chose the direct method with the name <code>new</code>.
You could use the indirect object form and/or call the method
by the class name.  The returned object can be used as normal, so I just
pass it back to the caller.  All instance methods are passed directly through
<code>Inline::Java</code> without help from <code>Hi.pm</code>.  If there were class methods
(declared with the <code>static</code> keyword in Java), I would either have to
provide a wrapper, or the caller would have to qualify the names.  Neither
solution is particularly difficult, but I favor the wrapper, to keep the
caller's effort to a minimum.  This is my typical laziness at work.  Since
there will likely be several callers, and I will have to write them, I want
to push any difficult parts into the module.</p>
<p>If you need to adapt the behavior of the Java object for your Perl audience,
you may insert routines in <code>Hi.pm</code> to do that.  For instance, perhaps
you want a more typical Perl accessor, instead of the <code>get</code>/<code>set</code> pair used
in the Java code.  In this case, you must make your own genuine Perl object
and proxy through it to the Java class.  That might look something like this:</p>
<pre><code>
    package Hi2;
    use strict; use warnings;

    use Inline Java =&gt; &quot;DATA&quot;;

    sub new {
        my $class    = shift;
        my $greeting = shift;
        bless { OBJECT =&gt; Hi2::Hi-&gt;new($greeting) }, $class;
    }

    sub greeting {
        my $self      = shift;
        my $new_value = shift;
        if (defined $new_value) {
            $self-&gt;{OBJECT}-&gt;setGreeting($new_value);
        }
        return $self-&gt;{OBJECT}-&gt;getGreeting();
    }

    1;

    __DATA__
    __Java__
    public class Hi {
        // Body omitted again
    }</code></pre>

<p>Here, the object returned from <code>Inline::Java</code>, which I'll call the Java
object for short, is stored in the <code>OBJECT</code> key of a hash-based <code>Hi2</code> object that is returned to the caller.  The distinction between the Perl
package and the Java class is clear in this constructor call.  The Perl
package comes first, then the Java class, then the class method to call.</p>
<p>The <code>greeting</code> method, shifts in the <code>$new_value</code>, which the caller supplies
if she wants to change the value.  If <code>$new_value</code> is defined, <code>greeting</code>
passes the <code>set</code> message to the Java object.  In either case, it returns the
current value to the caller, as Perl accessors usually do.</p>




<h3><a name="a_pure_proxy">A Pure Proxy</a></h3>
<p>In the last section, we saw how to make a Perl module access Java code.  We
also saw how to make the Perl module adapt between the caller's expectation
of Perl objects and the underlying Java objects.  Here, we will see how
to access Java classes that can't be included in the Perl code.</p>
<p>There are a lot of Java libraries.  These are usually distributed in compiled
form in so-called <em>.jar</em> (<strong>j</strong>ava <strong>ar</strong>chive) files.  This is good design on the part
of the Java community, just as using modules is good design on the part of
the Perl community.  Just as we wanted to make the <code>Hi</code> Java class available
to lots of programs -- and thus placed it in a module -- so the Java people
put reusable code in .jars.  (Yes, Java people share the bad pun heritage of
the Unix people, which brought us names like <code>yacc</code>, <code>bison</code>, <code>more</code>, and <code>less</code>.)</p>
<p>Suppose that our humble greeter is so popular that it has been greatly
expanded and .jarred for worldwide use.  Unless we provide an adapter like
the one shown earlier, the caller must use the .jarred code from Perl in a
Java-like way.  So I will now show three pieces of code: 1) an
expanded greeter, 2) a Perl driver that uses it, and 3) a mildly
adapting Perl module the driver can use.</p>
<p>Here's the expanded greeter; the two Perl pieces follow later:</p>

<pre><code>
    import java.util.Random;
    public class Higher {
        private static Random myRand = new Random();
        private String[] greetings;

        public Higher(String[] greetings) {
            this.greetings = greetings;
        }

        public void setGreetings(String[] newGreetings) {
            greetings = newGreetings;
        }

        public String[] getGreetings() {
            return greetings;
        }

        public void setGreeting(int index, String newGreeting) {
            greetings[index] = newGreeting;
        }

        public String getGreeting() {
            float randRet = myRand.nextFloat();
            int   index   = (int) (randRet * greetings.length);
            return greetings[index];
        }
    }</code></pre>

<p>Now there are multiple greetings, so the constructor takes an array of
<code>Strings</code>.  There are <code>get</code>/<code>set</code> pairs for the whole list of greetings
and for single greetings.  The single <code>get</code> accessor returns one greeting
at random.  The single <code>set</code> accessor takes the index of the greeting
to replace and its new value.</p>  
<p>Note that Java arrays are fixed-size;
don't let <code>Inline::Java</code> fool you into thinking otherwise.  It is very
good at making you think Java works just like Perl, even though this
is not the case.  Calling <code>setGreeting</code> with an out-of-bounds index will
be fatal unless trapped.  Yes, you can trap Java exceptions with <code>eval</code>
and the <code>$@</code> variable.</p>
<p>This driver uses the newly expanded greeter through <code>Hi3.pm</code>:</p>
<pre><code>
    #!/usr/bin/perl
    use strict; use warnings;

    use Hi3;

    my $greeter = Hi3-&gt;new([&quot;Hello&quot;, &quot;Bonjour&quot;, &quot;Hey Y'all&quot;, &quot;G'Day&quot;]);
    print $greeter-&gt;getGreeting(), &quot;\n&quot;;
          $greeter-&gt;setGreeting(0, &quot;Howdy&quot;);
    print $greeter-&gt;getGreeting(), &quot;\n&quot;;</code></pre>

<p>The <code>Hi3</code> module (directly below) provides access to the Java code.  I
called the constructor with an anonymous array.  An array reference
also works, but a simple list does not.  The constructor returns a Java
object (at least, it looks that way to us); the other calls just provide
additional examples.  Note, in particular, that <code>setGreeting</code> expects
an <code>int</code> and a <code>String</code>.  <code>Inline::Java</code> examines the arguments and
coerces them into the best types it can.  This nearly always works as expected.
When it doesn't, you need to look in the documentation for "CASTING."</p>
<p>Finally, this is <code>Hi3.pm</code> (behold the power of Perl and the work of the
<code>Inline</code> developers):</p>

<pre><code>
    package Hi3;
    use strict; use warnings;

    BEGIN {
        $ENV{CLASSPATH} .= &quot;:/home/phil/jar_home/higher.jar&quot;;
    }
    use Inline Java  =&gt; 'STUDY',
               STUDY =&gt; ['Higher'];

    sub new {
        my $class = shift;
        return Hi3::Higher-&gt;new(@_);
    }

    1;</code></pre>

<p>To use a class hidden in a .jar I need to do three things:</p>
<ol>
<li>
Make sure an absolute path to the .jar file is in the <code>CLASSPATH</code>,
<em>before</em> using <code>Inline</code>.  A well-placed <code>BEGIN</code> block makes
this happen.</li>


<li>
Use <code>STUDY</code> instead of providing Java source code.</li>


<li>
Add the <code>STUDY</code> directive to the <code>use Inline</code> statement.  This tells
<code>Inline::Java</code> to look for named classes.  In this case, the list has
only one element: <code>Higher</code>.  Names in this list must be fully qualified
if the corresponding class has a Java package.</li>

</ol>
<p>The constructor just calls the <code>Higher</code> constructor through <code>Inline::Java</code>, as we have seen before.</p>
<p>Yes, this is the whole module, all 15 lines of it.</p>
<p>If you need an adapter between your caller and the Java library, you can
put it in either Perl or Java code.  I prefer to code such adapters in Perl
when possible, following the plan we saw in the previous section.  Yet
occasionally, that is too painful, and I resort to Java.  For example,
the glue module <code>Java::Build::JVM</code> uses both a Java and a Perl adapter
to ease communication with the genuine <code>javac</code> compiler.  Look at
the <code>Java::Build</code> distribution from CPAN for details.</p>




<h3><a name="anatomy_of_automated_compiling__a_brief_discussion">Anatomy of Automated Compiling: A Brief Discussion</a></h3>
<p>So what is <code>Inline::Java</code> doing for us?  When it finds our Java code,
it makes a copy in the .java file of the proper name (<code>javac</code> is adamant
that class names and file names match).  Then it uses our Java compiler to
build a compiled version of the program.  It puts that version in a
directory, using an MD5 sum to ensure that recompiling happens when and only
when the code changes.</p>
<p>You can cruise through the directories looking at what it did.  If something
goes wrong, it will even give you hints about where to look.  Here's a tour
of some of those directories.  First, there is a base directory.  If you
don't do anything special, it will be called <i>_Inline</i>, under
the working directory from which you launched the program.
If you have a <i>.Inline</i> directory in your home directory, all <code>Inline</code>
modules will use it.  If you use the <code>DIRECTORY</code> directive in your
<code>use Inline</code> statement, its value will be used instead.  For ease of
discussion, I'll call the directory <i>_Inline</i>.</p>
<p>Under <i>_Inline</i>  is a config file that describes the various <code>Inline</code>
languages available to you.  More importantly, there are two subdirectories:
<i>build</i> and <i>lib</i>.  If your code compiles, the <i>build</i> directory will
be cleaned.  (That's the default behavior; you can include directives in your
<code>use Inline</code> statement to control this.)  If not, the <i>build</i> directory
has a subdirectory for your program, with part of the MD5 sum in its name.
That directory will hold the code in its .java file and the error output
from javac in <i>cmd.out</i>.</p>
<p>Code that successfully compiles ends up in <i>lib/auto</i>.  The actual .class
files end up in a subdirectory, which is again named by class and
MD5 sum.  Typically, there will be three files there.  The .class file
is as normal.  The other files describe the class.  The .inl file
has an <code>Inline</code> description of the class.  It contains the full MD5 sum,
so code does not need to be recompiled unless it changes.  It also says
when the code was compiled, along with a lot of other information about
the <code>Inline::Java</code> currently installed.  The .jdat file is specific
to <code>Inline::Java</code>.  It lists the signatures of the methods available
in the class.  <code>Inline::Java</code> finds these using Java's reflection system
(reflection is the Java term for symbolic references).</p>




<h3><a name="see_also">See Also</a></h3>
<p>For more information on <code>Inline</code> and <code>Inline::Java</code> and the other
inline modules, see their perldoc.  If you want to join in, sign up
for the <a href="mailto:inline@perl.org">inline@perl.org</a> mailing list, which is archived at
<a href="http://nntp.x.perl.org/group/perl.inline">nntp.x.perl.org/group/perl.inline</a>.</p>




<h3><a name="acknowledgements">Acknowledgements</a></h3>
<p>Thanks to Brian Ingerson for <code>Inline</code> and Patrick LeBoutillier for
<code>Inline::Java</code>.  These excellent modules have saved me much time and
heartache.  In fact, I doubt I would have had the courage to use Java
in Perl without them.  Double thanks to Patrick LeBoutillier, since
he took the time to read this article and correct some errors (including
my failure to put "Bonjour" in the greetings list).</p>


        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1222" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2003/11/p6pdigest/20031102.html" rel="bookmark">This week on Perl 6, week ending 2003-11-02</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Piers Cawley</span> on <abbr class="published" title="2003-11-02T00:00:00-08:00">November  2, 2003 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            
<!-- sidebar begins -->
<!-- don't move sidebars -->
<!-- sidebar ends -->

<p>It's Monday morning, the croissants have been baked, the focaccia is
glistening with all the extra virgin olive oil I poured on it as it
left the oven and, in the airing cupboard, a raisin borodinsky
slouches towards full proof (thought at the rate it's currently rising
it'll probably be Tuesday before I can bake it off), what better time
could there be to pause and write a summary?</p>
<p>So, I'll kick off with perl6-internals because, well, it's on the
summary checklist (which goes something like: 1. Wibble about the
weather or something before; 2. Start with perl6-internals;
3. Continue with perl6-language if it saw any traffic; 4. Make
announcements, suggest people give money to the Perl Foundation;
5. Make sure Leon Brocard gets a mention; 6. Aspell; 7. Mail PODs to
<a href="http://perl.com">http://perl.com</a> and a text version to perl6-announce; 8. Profit!)</p>

<h4><a name="null px proposal">NULL Px Proposal</a></h4>
<p>Right at the end of the previous week, Melvin Smith suggested having
the initial 'empty' PMC registers all point at a global PMCNull which
would throw an exception if you tried to invoke any of its
methods. Which sounds weird, but it does mean that you get a real
exception instead of a segfault, and exceptions are so much more
trappable. Dan liked the idea.</p>
<p>Melvin later posted a patch implementing the idea, which Leo
T&ouml;tsch fixed up slightly an applied.</p>
<p><a href="http://groups.google.com/groups?threadm=Pine.LNX.4.58.0310270957360.16137%40sprite.sidhe.org">http://groups.google.com/groups</a></p>
<p><a href="http://groups.google.com/groups?threadm=5.1.1.6.2.20031027223024.030e2f28%40pop.mindspring.com">http://groups.google.com/groups</a></p>
<csperl file="grab" domain="on" record="b/940" template="b/article_sidebar.view">
<h4><a name="parrot calling convention confusion">Parrot Calling Convention Confusion</a></h4>
<p>Steve Fink is having problems using an unprototyped call to a
prototyped function, which he thinks is a reasonable thing to do (and
I think I agree with him; I can imagine cases where you have a
function pointer or something where you don't know its exact
prototype, but you do want to make a call to it so you'd be forced to
make an unprototyped call.). Melvin Smith disagrees with him. Steve
then went on to point out that he's still getting failures when the
function is both declared and called in an unprototyped
fashion. According to Leo, this is because unprototyped returns are
neither defined nor implemented. Which is odd really -- I thought they
were exactly the same as an unprototyped call, but you invoke the
return continuation (P1) instead of P0, the other registers are set up
exactly as if you were making an unprototyped function call.</p>
<p><a href="http://groups.google.com/groups?threadm=20031027022503.GC26642%40foxglove">http://groups.google.com/groups</a></p>

<h4><a name="a clash of symbols">A clash of symbols</a></h4>
<p>Arthur Bergman, Ponie stablemaster, popped up to point out that
definitions like</p>
<pre><code>#define version obj.version</code></pre>
<p>(found in <em>include/parrot/pobj.h</em> if you're interested) did some
scary things to <code>Perl_utilize</code> in the Perl 5 core. Steve Fink stuck
his hand up to being the person who added the version field (which is
apparently rather handy if you're debugging the Garbage Collection
(GC) system. Leo fixed things by applying a
<code>s/version/pobj_version/g</code> patch.</p>
<p><a href="http://groups.google.com/groups?threadm=B28BFBAA-0872-11D8-AC29-000A95A2734C%40nanisky.com">http://groups.google.com/groups</a></p>

<h4><a name="storing external data in pmcs">Storing external data in PMCs</a></h4>
<p>Arthur popped up again asking for help with implementing a
Perl5LVALUE PMC. It turns out that the API doesn't quite support what
he needs. After a certain amount of discussion of various options
Arthur proposed a <code>Parrot_PMC_attach_data(Parrot, PMC, *void)</code>
extension to the API. He didn't *quite* get what he wanted, but he
got something very like it later in the week.</p>
<p>I did like Arthur's reasons for starting the serious Ponie effort by
working on Perl5LVALUEs though: ``[because] it is so obscure that it's
hardly used anywhere and is limited to a few small areas in the
core''.</p>
<p><a href="http://groups.google.com/groups?threadm=BF3DE234-088D-11D8-AC29-000A95A2734C%40nanisky.com">http://groups.google.com/groups</a></p>

<h4><a name="screaming pumpkins ahoy!">Screaming Pumpkins Ahoy!</a></h4>
<p>On Monday, Leo declared that yes, Melvin Smith's proposed Halloween
'Screaming Pumpkin' Parrot release would be happening. Various people
promised extra goodies, and a few problems were sorted out with some
platforms.</p>
<p>Features were frozen on Wednesday and Parrot 0.0.13 ``Screaming
Pumpkin'' was released upon a cowering world at 2003103114:11:46
precisely. For all the astonishing speed of the release cycle, there's
a lot of good stuff to be had in the screaming pumpkin, check out
Leo's announcement for details.</p>
<p><a href="http://groups.google.com/groups?threadm=200310271653.h9RGrSv18022%40thu8.leo.home">http://groups.google.com/groups</a></p>
<p><a href="http://groups.google.com/groups?threadm=3FA26DA2.8030000%40toetsch.at">http://groups.google.com/groups</a> -- Leo's announcement</p>

<h4><a name="header dependencies">Header Dependencies</a></h4>
<p>J&uuml;rgen B&ouml;mmels wasn't entirely happy with the way
Parrot's headers are set up. Apparently there are some nasty
dependency (and crypto dependency) issues. He proposed fixing up the
headers as much as possible to eliminate these issues. Dan and Leo
thought it would be nice, but Dan thought there wouldn't be that much
point in doing it as things would probably decay, and pretty much
everything internal should just be using <em>parrot.h</em>, and
everything external should be using <em>extend.h</em> or <em>embed.h</em>.</p>
<p><a href="http://groups.google.com/groups?threadm=m2ekwysiyb.fsf%40helium.physik.uni-kl.de">http://groups.google.com/groups</a></p>

<h4><a name="tinderboxen">Tinderboxen</a></h4>
<p>J&uuml;rgen B&ouml;mmels triggered a quick bout of tinderbox
fixing, as various different hardware experts helped to figure out
why several of the tinderboxes weren't building and testing
successfully. Jonathan Worthington submitted a few patches to clean
up the various Win32 warnings. David Robins submitted similar patches
to clean up some Solaris warnings.</p>
<p><a href="http://groups.google.com/groups?threadm=m2ad7msdym.fsf%40helium.physik.uni-kl.de">http://groups.google.com/groups</a></p>

<h4><a name="wrapping c/c++ libraries">Wrapping C/C++ libraries</a></h4>
<p>Anuradha Ratnaweera asked a bunch of questions about how Parrot and
Perl 6 would interface to external C and C++ libraries. The Leo and
Dan provided the answers.</p>
<p><a href="http://groups.google.com/groups?threadm=1067318653.12593.48.camel%40aratnaweera.enetsl.virtusa.com">http://groups.google.com/groups</a></p>

<h4><a name="broken windows">Broken Windows</a></h4>
<p>(Sorry about the heading, I couldn't resist). Jonathan Worthington
reported some breakage of NCI on Win32. He and Leo worked through the
issues in search of a fix.</p>
<p><a href="http://groups.google.com/groups?threadm=007301c39d78%243dd6a7a0%24aa866f83%40jwcsjw">http://groups.google.com/groups</a></p>

<h4><a name="garbagecollecting classes">Garbage-collecting classes</a></h4>
<p>Luke Palmer responded to the comment in last week's summary about the
way to instantiate an object in class Foo being:</p>
<pre><code>new P5, .Foo</code></pre>
<p>He worried that, because classes are now simply integers, there was
no way to garbage collect class objects if anonymous classes were
used heavily. Jeff Clites, Leo and Dan all rushed to reassure him.</p>
<p><a href="http://groups.google.com/groups?threadm=20031028235628.GA14714%40babylonia.flatirons.org">http://groups.google.com/groups</a></p>

<h4><a name="parrot io fun">Parrot IO Fun</a></h4>
<p>On Thursday, Melvin Smith announced that Parrot had fetched its first
web page. Your parrot can fetch webpages too, just update to the
latest, check out <em>examples/io/http.imc</em> and the world is
yours. Everyone made impressed noises.</p>
<p><a href="http://groups.google.com/groups?threadm=5.1.1.6.2.20031030014814.08673e80%40pop.mindspring.com">http://groups.google.com/groups</a></p>

<h4><a name="melvin smith, tease of the week">Melvin Smith, tease of the week</a></h4>
<p>Melvin announced that, in his personal copy of Parrot he has most of
the Class metadata declaration support working, but that he wouldn't
release it 'til after the Screaming Pumpkin release. If it's as good
as he promised, I guess we can wait.</p>
<p><a href="http://groups.google.com/groups?threadm=5.1.1.6.2.20031031010024.08e72a30%40pop.mindspring.com">http://groups.google.com/groups</a></p>

<h4><a name="character classification functions">Character classification functions</a></h4>
<p>Noting the presence of the <code>is_digit</code> function, Peter Gibbs wondered
if it would be useful to have a set of <code>is_foo</code> functions, or better
to have a single <code>is_ctype</code> function with an enum parameter. He
preferred the <code>is_ctype</code> option, and set about implementing it. Ever
the speed demon, Dan thought it best to have a reasonable set of
<code>is_foo</code> functions for 'common' chartypes and a fallback <code>is_ctype</code>
function for the rest. Once they were all wrapped up in sensible
macros that would mean that you didn't have the possibility of a very
small speed hit getting multiplied up in the middle of a tight loop,
but the programmer wouldn't have to worry about which types were
checked in which fashion.</p>
<p><a href="http://groups.google.com/groups?threadm=046a01c3a08e%2403fdf100%24c701010a%40peter">http://groups.google.com/groups</a></p>

<h4><a name="moving to a new pmc compiler">Moving to a new PMC compiler</a></h4>
<p>Leo T&ouml;tsch posted a patch to switch Parrot over to using
pmc2c2, the new version of the PMC compiler, but didn't commit it
because his Makefile was playing up. He asked for some help to fix
that before the patch could be committed.</p>
<p><a href="http://groups.google.com/groups?threadm=rt-24388-66958.8.08917746394357%40rt.perl.org">http://groups.google.com/groups</a></p>

<h4><a name="summary suggestion">Summary suggestion</a></h4>
<p>Ron Grunwald suggested that it might be a good idea to include a
glossary with each summary explaining what IMCC, PMC and PIR stand for
(um... Incredibly Magnificent Compiler Compiler(?), Parrot Magic
Cookie and Parrot Intermediate <code>Representation(?)</code> respectively) and
maybe giving some explanation of other bits of Parrot jargon. Which
is a jolly good idea. But laziness dictates that, instead I point you
all at <em>docs/glossary.pod</em> which, following a gentle nudge on the
mailing list, covers the above acronyms and more (but sadly some of
'em are missing from the Screaming Pumpkin release).</p>
<p><a href="http://groups.google.com/groups?threadm=m2ekwqlofv.fsf%40huge.bofh.org.uk">http://groups.google.com/groups</a></p>


<h3><a name="meanwhile, in perl6language">Meanwhile, in perl6-language</a></h3>
<p>There was some real traffic. With questions. And Answers! What is the
world coming to? Admittedly, there were only 10 posts in the week,
but it's the <em>quality</em> that counts.</p>

<h4><a name="alternately named arguments">Alternately named arguments</a></h4>
<p>Remember last week, when Luke ``Edgecase finder general'' Palmer asked
about named return values and made David Storrs boggle? This week he
was answered. By Damian. And Larry. Any question that elicits a
``Please, no!'' from Damian has got to be a good question methinks.</p>
<p>The question revolves around the statement in Apocalypse 6 that a
list on the left hand side of a binding operator (<code>:=</code>) is
interpreted in the same way as a function signature. Which means that
you can use 'named' binding:</p>
<pre><code>(who =&gt; $name, why =&gt; $reason) := (why =&gt; $because, who =&gt; &quot;me&quot;);
   # ($name == &quot;me&quot;) &amp;&amp; ($reason = $because)</code></pre>
<p>What elicited the ``Please, no!'' was Luke's logical conclusion that
this could also mean that you could do:</p>
<pre><code>(+$name, +$id) := getinfo();</code></pre>
<p>and the unary <code>+</code> would be treated as a 'named only' marker in the
same way it would be in a function signature.</p>
<p>Interestingly, Larry was less convinced that this was inherently a
bad thing, though he did propose that, under most forms of stricture
that it should only work in the case of:</p>
<pre><code>my(+$name, +$id) := getinfo();</code></pre>
<p>because the <code>my</code> helps the reader to realise that <code>+</code> may not be in
Kansas any more without having to reach the <code>:=</code> and then
reinterpret everything that went before. (If you've heard Damian,
Allison or possibly even Larry talking about Perl 6, you've almost
certainly come up against the concept of ``end weight''; this is an
example).</p>
<p><a href="http://groups.google.com/groups?threadm=3F9C6F5C.3020906%40conway.org">http://groups.google.com/groups</a></p>

<h4><a name="state of the conway">State of the Conway</a></h4>
<p>It's been a while since Damian said anything in perl6-language, so
David Wheeler welcomed both him and Larry back. Damian thanked him,
and posted a short status report. While he's not been in quite the
same state as Larry, ``mild influenza and a little light pneumonia''
don't sound like a barrel of laughs either. Anyway, he's back on the
case when he can spare the time from putting food on the table.</p>
<p><a href="http://groups.google.com/groups?threadm=3F9DA3BB.9080106%40conway.org">http://groups.google.com/groups</a></p>

<h4><a name="questions about currying">Questions about currying</a></h4>
<p>Joe Gottman had some questions about currying. Luke Palmer and
Jonathan Scott Duff answered 'em. I'm getting quite good at this
summarizing malarkey aren't I?</p>
<p><a href="http://groups.google.com/groups?threadm=002d01c39e85%24b74fb8c0%2442404a18%40carolina.rr.com">http://groups.google.com/groups</a></p>


<h3><a name="acknowledgements, announcements, apologies">Acknowledgements, Announcements, Apologies</a></h3>
<p>Whee! Monday is this week's Monday! What's the betting I can keep it
up?</p>
<p>Those of you who've been reading this summary since almost the
beginning will remember that I copped the basic 'chunks of text
followed by a link or two' format/structure(hah!) of these summaries
from NTK. Well, this Friday's NTK had some coverage of the state of
Larry and Damian's health in their HARD NEWS section
(<a href="http://www.ntk.net/2003/10/31/">http://www.ntk.net/2003/10/31/</a>).</p>
<p>If you found this summary valuable, please consider one or more of:</p>
<ul>
<li>
Join in! The project needs people. <a href="http://dev/perl.org/perl6/">http://dev/perl.org/perl6/</a> and
<a href="http://www.parrotcode.org/">http://www.parrotcode.org/</a> are good starting points for
information.</li>

<li>
Chip in! Money helps keep the wheels turning, programmers like Larry,
Dan and Damian have families to feed and medical bills to pay,
finding that money takes time away from getting Perl 6 out of the
door. By donating money to The Perl Foundation
<a href="http://donate.perl-foundation.org/">http://donate.perl-foundation.org/</a> you can help.</li>

<li>
Chime in! It's always good to get direct feedback from readers. Drop
me a line to let me know what you think at
<em><a href="mailto:mailto:p6summarizer@bofh.org.uk">mailto:p6summarizer@bofh.org.uk</a></em>, I promise I'll reply (assuming it's
not spam, in which case I shall simply wish recurrent hemorrhoids on
you).</li>
</ul>
        </div>



    </div>
    <div class="asset-footer"></div>
</div>




                            <div class="content-nav">
                                <a href="/pub/2003/10/">&laquo; October 2003</a> |
                                <a href="/pub/">Main Index</a> |
                                <a href="/pub/archives.html">Archives</a>
                                | <a href="/pub/2003/12/">December 2003 &raquo;</a>
                            </div>


                        </div>
                    </div>


                    <div id="beta">
    <div id="beta-inner">


    
    <div class="widget-what-is-perl widget">
    <div class="widget-content widget-content-what-is-perl">
       Visit the home of the  Perl programming language: <a href="http://www.perl.org/">Perl.org</a
    </div>
</div>
<div class="widget-find-out-more widget-archives widget">
    <div class="widget-content">
        <ul>
            <li><a href="http://www.perl.org/get.html">Download</a></li>
            <li><a href="http://perldoc.perl.org/">Documentation</a></li>
            <li><a href="http://blogs.perl.org/">Perl Bloggers</a></li>
            <li><a href="http://news.perlfoundation.org/">Foundation News</a></li>
        </ul>
    </div>
</div><div class="widget-tcpc widget">
<h3 class="widget-header">Sponsored by</h3>
    <div class="widget-content">
        <a href="http://training.perl.com/" alt="Perl Training" target="_blank"><img src="/i/tcpc.png" width="150" height="50"></a>
    </div>
</div>

<div class="widget-syndication widget">
    <div class="widget-content">
        <ul>
            <li><img src="/mt-static/images/status_icons/feed.gif" alt="Subscribe to feed" width="9" height="9" /> <a href="/pub/atom.xml">Subscribe to this website's feed</a></li>

        </ul>
    </div>
</div>
<div class="widget-archive-monthly widget-archive widget">
    <h3 class="widget-header">Monthly <a href="/pub/archives.html">Archives</a></h3>
    <div class="widget-content">
        <ul>
        
            <li><a href="/pub/2014/02/">February 2014 (1)</a></li>
        
    
        
            <li><a href="/pub/2014/01/">January 2014 (1)</a></li>
        
    
        
            <li><a href="/pub/2013/10/">October 2013 (1)</a></li>
        
    
        
            <li><a href="/pub/2013/01/">January 2013 (1)</a></li>
        
    
        
            <li><a href="/pub/2012/12/">December 2012 (1)</a></li>
        
    
        
            <li><a href="/pub/2012/11/">November 2012 (1)</a></li>
        
    
        
            <li><a href="/pub/2012/10/">October 2012 (2)</a></li>
        
    
        
            <li><a href="/pub/2012/08/">August 2012 (2)</a></li>
        
    
        
            <li><a href="/pub/2012/06/">June 2012 (11)</a></li>
        
    
        
            <li><a href="/pub/2012/05/">May 2012 (18)</a></li>
        
    
        
            <li><a href="/pub/2012/04/">April 2012 (17)</a></li>
        
    
        
            <li><a href="/pub/2012/02/">February 2012 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/12/">December 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/09/">September 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/08/">August 2011 (2)</a></li>
        
    
        
            <li><a href="/pub/2011/06/">June 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/05/">May 2011 (3)</a></li>
        
    
        
            <li><a href="/pub/2011/04/">April 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/03/">March 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/02/">February 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/01/">January 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2010/11/">November 2010 (1)</a></li>
        
    
        
            <li><a href="/pub/2010/10/">October 2010 (2)</a></li>
        
    
        
            <li><a href="/pub/2010/09/">September 2010 (1)</a></li>
        
    
        
            <li><a href="/pub/2010/08/">August 2010 (3)</a></li>
        
    
        
            <li><a href="/pub/2010/07/">July 2010 (2)</a></li>
        
    
        
            <li><a href="/pub/2010/04/">April 2010 (2)</a></li>
        
    
        
            <li><a href="/pub/2010/03/">March 2010 (4)</a></li>
        
    
        
            <li><a href="/pub/2008/05/">May 2008 (1)</a></li>
        
    
        
            <li><a href="/pub/2008/04/">April 2008 (2)</a></li>
        
    
        
            <li><a href="/pub/2008/03/">March 2008 (1)</a></li>
        
    
        
            <li><a href="/pub/2008/02/">February 2008 (1)</a></li>
        
    
        
            <li><a href="/pub/2008/01/">January 2008 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/12/">December 2007 (2)</a></li>
        
    
        
            <li><a href="/pub/2007/09/">September 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/08/">August 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/07/">July 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/06/">June 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/05/">May 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/04/">April 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/03/">March 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/02/">February 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/01/">January 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/12/">December 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/11/">November 2006 (2)</a></li>
        
    
        
            <li><a href="/pub/2006/10/">October 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/09/">September 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/08/">August 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/07/">July 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/06/">June 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/05/">May 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/04/">April 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/03/">March 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/02/">February 2006 (4)</a></li>
        
    
        
            <li><a href="/pub/2006/01/">January 2006 (4)</a></li>
        
    
        
            <li><a href="/pub/2005/12/">December 2005 (4)</a></li>
        
    
        
            <li><a href="/pub/2005/11/">November 2005 (3)</a></li>
        
    
        
            <li><a href="/pub/2005/10/">October 2005 (2)</a></li>
        
    
        
            <li><a href="/pub/2005/09/">September 2005 (2)</a></li>
        
    
        
            <li><a href="/pub/2005/08/">August 2005 (9)</a></li>
        
    
        
            <li><a href="/pub/2005/07/">July 2005 (8)</a></li>
        
    
        
            <li><a href="/pub/2005/06/">June 2005 (9)</a></li>
        
    
        
            <li><a href="/pub/2005/05/">May 2005 (8)</a></li>
        
    
        
            <li><a href="/pub/2005/04/">April 2005 (7)</a></li>
        
    
        
            <li><a href="/pub/2005/03/">March 2005 (6)</a></li>
        
    
        
            <li><a href="/pub/2005/02/">February 2005 (7)</a></li>
        
    
        
            <li><a href="/pub/2005/01/">January 2005 (6)</a></li>
        
    
        
            <li><a href="/pub/2004/12/">December 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/11/">November 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/10/">October 2004 (5)</a></li>
        
    
        
            <li><a href="/pub/2004/09/">September 2004 (9)</a></li>
        
    
        
            <li><a href="/pub/2004/08/">August 2004 (6)</a></li>
        
    
        
            <li><a href="/pub/2004/07/">July 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/06/">June 2004 (6)</a></li>
        
    
        
            <li><a href="/pub/2004/05/">May 2004 (7)</a></li>
        
    
        
            <li><a href="/pub/2004/04/">April 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/03/">March 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/02/">February 2004 (9)</a></li>
        
    
        
            <li><a href="/pub/2004/01/">January 2004 (7)</a></li>
        
    
        
            <li><a href="/pub/2003/12/">December 2003 (4)</a></li>
        
    
        
            <li><a href="/pub/2003/11/">November 2003 (7)</a></li>
        
    
        
            <li><a href="/pub/2003/10/">October 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2003/09/">September 2003 (6)</a></li>
        
    
        
            <li><a href="/pub/2003/08/">August 2003 (7)</a></li>
        
    
        
            <li><a href="/pub/2003/07/">July 2003 (9)</a></li>
        
    
        
            <li><a href="/pub/2003/06/">June 2003 (9)</a></li>
        
    
        
            <li><a href="/pub/2003/05/">May 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2003/04/">April 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2003/03/">March 2003 (10)</a></li>
        
    
        
            <li><a href="/pub/2003/02/">February 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2003/01/">January 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2002/12/">December 2002 (5)</a></li>
        
    
        
            <li><a href="/pub/2002/11/">November 2002 (9)</a></li>
        
    
        
            <li><a href="/pub/2002/10/">October 2002 (7)</a></li>
        
    
        
            <li><a href="/pub/2002/09/">September 2002 (11)</a></li>
        
    
        
            <li><a href="/pub/2002/08/">August 2002 (8)</a></li>
        
    
        
            <li><a href="/pub/2002/07/">July 2002 (8)</a></li>
        
    
        
            <li><a href="/pub/2002/06/">June 2002 (4)</a></li>
        
    
        
            <li><a href="/pub/2002/05/">May 2002 (6)</a></li>
        
    
        
            <li><a href="/pub/2002/04/">April 2002 (6)</a></li>
        
    
        
            <li><a href="/pub/2002/03/">March 2002 (7)</a></li>
        
    
        
            <li><a href="/pub/2002/02/">February 2002 (5)</a></li>
        
    
        
            <li><a href="/pub/2002/01/">January 2002 (8)</a></li>
        
    
        
            <li><a href="/pub/2001/12/">December 2001 (7)</a></li>
        
    
        
            <li><a href="/pub/2001/11/">November 2001 (5)</a></li>
        
    
        
            <li><a href="/pub/2001/10/">October 2001 (9)</a></li>
        
    
        
            <li><a href="/pub/2001/09/">September 2001 (7)</a></li>
        
    
        
            <li><a href="/pub/2001/08/">August 2001 (13)</a></li>
        
    
        
            <li><a href="/pub/2001/07/">July 2001 (8)</a></li>
        
    
        
            <li><a href="/pub/2001/06/">June 2001 (13)</a></li>
        
    
        
            <li><a href="/pub/2001/05/">May 2001 (11)</a></li>
        
    
        
            <li><a href="/pub/2001/04/">April 2001 (9)</a></li>
        
    
        
            <li><a href="/pub/2001/03/">March 2001 (8)</a></li>
        
    
        
            <li><a href="/pub/2001/02/">February 2001 (8)</a></li>
        
    
        
            <li><a href="/pub/2001/01/">January 2001 (8)</a></li>
        
    
        
            <li><a href="/pub/2000/12/">December 2000 (6)</a></li>
        
    
        
            <li><a href="/pub/2000/11/">November 2000 (10)</a></li>
        
    
        
            <li><a href="/pub/2000/10/">October 2000 (10)</a></li>
        
    
        
            <li><a href="/pub/2000/09/">September 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/2000/08/">August 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/2000/07/">July 2000 (5)</a></li>
        
    
        
            <li><a href="/pub/2000/06/">June 2000 (7)</a></li>
        
    
        
            <li><a href="/pub/2000/05/">May 2000 (7)</a></li>
        
    
        
            <li><a href="/pub/2000/04/">April 2000 (3)</a></li>
        
    
        
            <li><a href="/pub/2000/03/">March 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/2000/02/">February 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/2000/01/">January 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/1999/12/">December 1999 (6)</a></li>
        
    
        
            <li><a href="/pub/1999/11/">November 1999 (6)</a></li>
        
    
        
            <li><a href="/pub/1999/10/">October 1999 (5)</a></li>
        
    
        
            <li><a href="/pub/1999/09/">September 1999 (4)</a></li>
        
    
        
            <li><a href="/pub/1999/08/">August 1999 (3)</a></li>
        
    
        
            <li><a href="/pub/1999/07/">July 1999 (2)</a></li>
        
    
        
            <li><a href="/pub/1999/06/">June 1999 (3)</a></li>
        
    
        
            <li><a href="/pub/1999/04/">April 1999 (1)</a></li>
        
    
        
            <li><a href="/pub/1999/03/">March 1999 (1)</a></li>
        
    
        
            <li><a href="/pub/1999/01/">January 1999 (1)</a></li>
        
    
        
            <li><a href="/pub/1998/12/">December 1998 (1)</a></li>
        
    
        
            <li><a href="/pub/1998/11/">November 1998 (1)</a></li>
        
    
        
            <li><a href="/pub/1998/07/">July 1998 (2)</a></li>
        
    
        
            <li><a href="/pub/1998/06/">June 1998 (1)</a></li>
        
    
        
            <li><a href="/pub/1998/03/">March 1998 (1)</a></li>
        
        </ul>
    </div>
</div>
        
    

<div class="widget-powered widget">
    <div class="widget-content">
        <a href="http://www.movabletype.com/"><img src="/mt-static/images/bug-pbmt-white.png" alt="Powered by Movable Type 5.13-en" width="120" height="75" /></a>
    </div>
</div>



    </div>
</div>






                </div>
            </div>


            <div id="footer">
    <div id="footer-inner">
        <div id="footer-content">
            <div class="widget-powered widget">
                <div class="widget-content">
                    Powered by <a href="http://www.movabletype.com/" rel="generator">Movable Type Pro</a>
                </div>
            </div>

            <div class="widget-creative-commons widget">
                <div class="widget-content">
                    This blog is licensed under a <a href="http://creativecommons.org/licenses/by-nc-nd/3.0/">Creative Commons License</a>.
                </div>
            </div>

        </div>
    </div>
</div>



        </div>
    </div>
</body>
</html>
