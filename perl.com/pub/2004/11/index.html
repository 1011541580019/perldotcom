<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" id="sixapart-standard">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="generator" content="Movable Type Pro 5.13-en" />
<link rel="stylesheet" href="/pub/styles.css" type="text/css" />
<link rel="start" href="/pub/" title="Home" />
<link rel="alternate" type="application/atom+xml" title="Recent Entries" href="/pub/atom.xml" />
<script type="text/javascript" src="/pub/mt.js"></script>
<!--
<rdf:RDF xmlns="http://web.resource.org/cc/"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
<Work rdf:about="/pub/">
<dc:title>Perl.com</dc:title>
<dc:description>news and views of the Perl programming language</dc:description>
<license rdf:resource="http://creativecommons.org/licenses/by-nc-nd/3.0/" />
</Work>
<License rdf:about="http://creativecommons.org/licenses/by-nc-nd/3.0/">
</License>
</rdf:RDF>
-->

<script type="text/javascript">

 var _gaq = _gaq || [];
 _gaq.push(['_setAccount', 'UA-50555-22']);
 _gaq.push(['_trackPageview']);

 (function() {
   var ga = document.createElement('script'); ga.type =
   'text/javascript'; ga.async = true;
   ga.src = ('https:' == document.location.protocol ? 'https://ssl' :
   'http://www') + '.google-analytics.com/ga.js';
   var s = document.getElementsByTagName('script')[0];
   s.parentNode.insertBefore(ga, s);
 })();

</script>
<script type='text/javascript' src='http://partner.googleadservices.com/gampad/google_service.js'></script>
<script type='text/javascript'>
GS_googleAddAdSenseService("ca-pub-4136420132070439");
GS_googleEnableAllServices();
</script>
<script type='text/javascript'>
GA_googleAddSlot("ca-pub-4136420132070439", "Perl_728x90");
</script>
<script type='text/javascript'>GA_googleFetchAds();</script>
    <title>Perl.com: November 2004 Archives</title>


    <link rel="prev" href="/pub/2004/10/" title="October 2004" />
    <link rel="next" href="/pub/2004/12/" title="December 2004" />

</head>
<body id="perl-com" class="mt-archive-listing mt-datebased-monthly-archive layout-wt">
    <div id="container">
        <div id="container-inner">


            <div id="header">
    <div id="header-inner">
        <div id="header-content">
        <span id="top_advert"> 
<!-- Put any landscape advert in here -->
<!-- Perl_728x90 -->
<script type='text/javascript'>
GA_googleFillSlot("Perl_728x90");
</script>
        </span> 



            <div id="header-name"><a href="/pub/" accesskey="1">Perl.com</a></div>
            <div id="header-description">news and views of the Perl programming language</div>




        </div>
    </div>
</div>



            <div id="content">
                <div id="content-inner">


                    <div id="alpha">
                        <div id="alpha-inner">


                            <h1 id="page-title" class="archive-title">November 2004 Archives</h1>





                            
                            <div id="entry-1020" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2004/11/24/debugger_ref.html" rel="bookmark">Perl Debugger Quick Reference</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Richard Foley</span> on <abbr class="published" title="2004-11-24T00:00:00-08:00">November 24, 2004 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            <p>Perl's debugger is powerful but somewhat esoteric.  The core <a href="http://www.perlpod.com/5.8.4/pod/perldebtut.html">perldebtut</a> tutorial is a good introduction, but who wants to skim through pages of documentation when you only need a quick refresher on the syntax of a command?</p>

<p>Let this printable (PDF) <a href="/2004/11/24/debugger_ref.pdf">Perl Debugger Quick Reference</a> card, excerpted from Richard Foley's <a href="http://www.oreilly.com/catalog/perldebugpr/index.html">Perl Debugger Pocket Reference</a>, be your guide instead.</p>

<p><em>Editor's note: Unix users, we've had reports that Adobe Acrobat 5 has trouble opening this file.  We're looking into this.  In the meantime, xpdf and other tools appear to work correctly.</em></p>

<!-- sidebar begins -->
 <csperl file="grab" domain="on" record="b/970" template="b/article_sidebar2.view">
<!-- sidebar ends -->






        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1024" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2004/11/p6pdigest/20041115.html" rel="bookmark">This Week in Perl 6, November 9 - 15 2004</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Matt Fowles</span> on <abbr class="published" title="2004-11-18T00:00:00-08:00">November 18, 2004 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            <p>All~</p>

<p>Welcome to yet another Monday summary. This would have been a Sunday
summary, but <a href="http://www.avernum.com/avernum/">Avernum</a> (from
Spiderweb Software) forcibly prevented it. As usual, we will start out with
Perl 6 Language.</p>

<h3>Perl 6 Language</h3>

<h4><a href="http://xrl.us/dy47">Modules and Exports</a></h4>

<p>Aaron Sherman wanted to know some specifics about exporting things from
modules. In particular, he did not want to have to retype a whole bunch of
things. Larry gave an answer indicating that some of what Aaron wants should
occur, but some things are difficult for good reason.</p>

<h4><a href="http://xrl.us/dy48"><code>AUTOCLASS(DEF)?</code> Hooks</a></h4>

<p>Rod Adams wanted to know if he could get <code>AUTOCLASS</code> and
<code>AUTOCLASSDEF</code> hooks. Larry told him that he probably could. Rod
also wanted module name aliasing. Larry told him that he could. Rod wanted to
have module names with arbitrary strings. Larry told him that he could. Rod
wanted to be able to load multiple versions of the same module. Larry told him
that he could.  The summarizer wanted each question of a different focus to be in
a different message. Hopefully, Larry will tell him that they should...</p>

<h4><a href="http://xrl.us/dy49">Matching the <em>n</em>th Occurrences</a></h4>

<p>Sudarshan Gaikaiwari wanted to know how to match the "second last"
occurrence in Perl 6 rules. I think he might have posted directly to Google
Groups, as I did not receive it in my email and nobody replied. The example Sudarshan gave matches the seconded occurrence. As I am not sure what Sudarshan meant by
"2nd last", I will answer the question I do know.  <code>m:2nd/foo/</code> will
match the second occurrence of foo.  You can access the nth occurrence
similarly.</p>
<csperl file="grab" domain="on" record="b/1424" template="b/article_sidebar.view">
<h3>Perl 6 Compilers</h3>

<p>Once again it is a race to see whether someone posts a comment to, or Google
picks up, Perl 6 Compilers first.</p>

<h3>Parrot</h3>

<p>Welcome to the week of the continuation. If continuations make your head
hurt overly, I advise taking a few Advils before continuing. If continuations
are the way you naturally think, I advise you to stop playing with LISP
compilers.</p>

<h4><a href=">http://xrl.us/dy5a">String Pinning</a></h4>

<p>Bernhard Schmalhofer wanted to pass the same C string into two different
external functions so that the first could do things to it that the second
required. However, the solution that he found kept eating his string after the
first invocation. Dan and Leo concluded that using the <code>b</code> parameter
for NCI is correct in this situation.</p>

<h4><a href=">http://xrl.us/dy5b">GC Invocation</a></h4>

<p>Last week Leo posted a radical idea about GC invocation. I decided not to
invoke Warnock's Dilemma too soon. This week, I invoke it.</p>

<h4><a href=">http://xrl.us/dy5c"><code>perl</code> vs.
<code>/usr/bin/perl</code></a></h4>

<p>Gerd Pokorra requested that <code>#! perl</code> change to <code>#!
/usr/bin/perl</code>. Although Warnock applied, I think this will likely
not happen.  Not all systems have Perl installed in <em>/usr/bin/</em> and
people might want to change which <code>perl</code> to invoke by changing their
paths.</p>

<h4><a href="http://xrl.us/dy5d">Command Line Support for Various Compilers</a></h4>

<p>Will Coleda added a TODO item so that Parrot can take various compiler
arguments on the command line. What are you waiting for?</p>

<h4><a href="http://xrl.us/dy5e">Register Stomping</a></h4>

<p>Matt Diephouse had troubles with his newly updated Forth compiler. The
verdict seems to be that he has uncovered a bug. To quote Matt, "*sigh*."</p>

<h4><a href="http://xrl.us/dy5f">Calling Continuations, Basic Blocks, and Register Allocation</a></h4>

<p>Either Leo or Jeff Clites (I don't recall who) started what is probably the
largest thread for this week, focusing on register allocation and continuation
troubles. Apparently the presence of continuations can unduly extend the lifetime of registers (as can try-catch things, but they seem less important). The
suggested solutions all have some shortcomings, although it appears that only
using lexicals is winning.</p>

<h4><a href="http://xrl.us/dy5h">Basic Compilation Example</a></h4>

<p>Jeff Clites wondered how something like <code>(a + b)</code> would compile.
The answer is to initialize an intermediate PMC to <code>Undef</code>, which
will morph as appropriate.</p>

<h4><a href="http://xrl.us/dy5i"><code>Eval</code> Changes</a></h4>

<p>Leo updated the implementation of <code>eval</code> to make it even cooler, or
possibly just clean it up and fix some bugs ... I forget.</p>

<h4><a href="http://xrl.us/dy5j">Basic Operations for MMD</a></h4>

<p>Dan asked for volunteers to spec out the basic vtable and MMD functions for
CLS (common language specification-or-other). Sam Ruby said he would be willing
to take a stab at it in a few weeks. One week has gone by and Sam grows ever
closer to stabbing things.</p>

<h4><a href="http://xrl.us/dy5k">No Limit on IMCC Identifier Length</a></h4>

<p>Will Coleda noted that there was no limit on the length of IMCC identifiers.
Here come the <code>eval</code> buffer overflow attacks....</p>

<h4><a href="http://xrl.us/dy5m">Duplicate Local Labels Break PASM</a></h4>

<p>Will noticed that duplicate local labels cause IMCC to output broken PASM. I
could be mistaken, but I though that IMCC -&gt; PASM has been broken for a
while...</p>

<h4><a href="http://xrl.us/dy5n">Parrot API</a></h4>

<p>Leo wondered if the <code>parrot_api.pl</code> could be less strict about
what it thinks is and is not public. Jarkko Hietaniemi responded that this was
not his call to make, and silence reigned supreme.</p>

<h4><a href="http://xrl.us/dy5o">Empty Sub Troubles</a></h4>

<p>Will Colleda posted a bug for empty subs in IMCC. St&eacute;phane Payrard
provided a fix. Leo applied it.</p>

<h4><a href="http://xrl.us/dy5p">Languages with Object Support? </a></h4>

<p>Jeff Horwitz wondered if there were any languages with object support
that he could bend to the evil ends of mod_parrot. While no one answered, I
think Parakeet might be such a language....</p>

<h4><a href="http://xrl.us/dy5q">WinXP Problems</a></h4>

<p>Christian Lott has been having troubles with WinXP, in particular with
<em>ops2vim.pl</em>. Read on for the blow-by-blow.</p>

<h4><a href="http://xrl.us/dy5r">Strings + Working Correctly = Pain</a></h4>

<p>In his noble efforts to make Parrot respect foreign languages and cultures,
while not necessitating ICU, Dan has massively reworked strings. He reports ... progress.  He also posed a question for all to ponder: "How global should the
defaults be?"</p>

<h4><a href="http://xrl.us/dy5v"></code>runtime/parrot/library/config.pbc</code></a></h4>

<p>Nicholas Clark wondered what would generate this file. Leo answered.
Nicholas tracked his problem down to a quirk in FreeBSD <code>make</code> and
fixed it.</p>

<h4><a href="http://xrl.us/dy5w"><code>#line</code> Directives from PMC
Files</a></h4>

<p>Nicholas Clark announced his triumph over <code>#line</code> directives in
<em>pmc2c2.pl</em>.  People were impressed, but promptly asked how to turn it
off. Kids these days don't appreciate what they have. ;-)</p>

<h4><a href="http://xrl.us/dy5x">Tail Calls</a></h4>

<p>Jeff Clites asked about tail calls in the presence of continuations.  After
much debate, the consensus seems to be that they don't affect each other much
at all. In fact, continuations make tail calls easier.  However, the topic was broached as to whether these were an optimization that IMCC should detect, or should compilers generate them explicitly.  I think the final decision was compiler generated,
although I doubt I would be alone in not minding if IMCC had a flag to allow it
to add them as it saw fit....</p>

<h4><a href="http://xrl.us/dy5y">Character Classes</a></h4>

<p>Patrick R. Michaud wanted to know if Parrot had character class support
(that is, checking membership). Leo responded that it would after Dan's
aforementioned string stuff.</p>

<h4><a href="http://xrl.us/dy5z"><code>POSTCOMP</code> vs.
<code>LOAD</code></a></h4>

<p>Leo asked about the differences between <code>POSTCOMP</code> and
<code>LOAD</code>. Dan provided the answer: <code>POSTCOMP</code> runs only
when (and as soon as) the sub is compiled. <code>LOAD</code> runs when the sub
is loaded. This need not be the same time if the source is used to generate
bytecode that is later executed.</p>

<h4><a href="http://xrl.us/dy52">Register
Allocation/Spilling/Volatility</a></h4>

<p>Jeff Clites suggested using variable-size register frames with explicit, volatile and non-volatile sections. Leo responded that this would cause serious
code bloat, and pointed him to his and Miroslav Silovic's "watermark" scheme.
Others voiced support for this as well as removing the implicit operands. Dan
said no.</p>

<h4><a href="http://xrl.us/dy53">AIX JIT Gnomes</a></h4>

<p>Adam Thomason observed that the AIX JIT problems have gone away and thanked
the gnomes responsible. Remember, the proper sacrifice for little people like
gnomes are mini-Milanos or other reduced-size cookies (nothing from Keebler as
the gnomes and elves have long-unresolved issues).</p>

<h4><a href="http://xrl.us/dy54">Register Allocation (Again)</a></h4>

<p>Bill Coffman's register allocator (or should I say his implementation of the
Matula/Chaitin/Briggs algorithm) grows ever closer to being committed (although
my initial prediction of two weeks ago was clearly wrong). In fact, his
algorithm is so good that it even turned up bugs from other pieces of the code.
Dan started a test run on his evil code, so we should have truly stressed
performance numbers within the next several fortnights.</p>

<h4><a href="http://xrl.us/dy56">IMCC Segfault on Bad <code>if</code></a></h4>

<p>Gopal V found a way to make IMCC segfault. I think it is still waiting for a
fix....</p>

<h4><a href="http://xrl.us/dy57">No <code>perldoc</code> == BIG FAT
WARNING</a></h4>

<p>James deBoer submitted a patch to fail if the configuration step did not
find <code>perldoc</code> last week. This week the request has gone out to
modify it to warn in a big and preferably fat way. No answer yet.</p>

<h4><a href="http://xrl.us/dy58">RT Clean Up</a></h4>

<p>Will Coleda, whose diligent minding of the RT queue is much appreciated,
closed a few tickets that no longer apply.</p>

<h4><a href="http://xrl.us/dy6a">BASIC Compiler</a></h4>

<p>Will "Dr. Frankenstein" Coleda has attempted to resurrect the basic compiler
with some major surgery. He is making progress. Joshua Gatcomb put out a
request for a new maintainer.</p>

<h4><a href="http://xrl.us/dy6c">Config Provides Slightly More Info</a></h4>

<p>Luke Palmer provided a patch for making <em>Configure.pl</em> slightly more
informative. Brent "Dax" Royal-Gordon applied it.</p>

<h4><a href="http://xrl.us/dy6d">Find-Method Inheritance</a></h4>

<p>Sam Ruby asked for comment before committing a patch to allow calling of
attributes as methods and to allow inheritance of attributes. When no one
commented, he committed.</p>

<h4><a href="http://xrl.us/dy6e">Threads, Events, Win32</a></h4>

<p>Gabe Schaffer pointed out some issues with threads and events from a Win32
perspective. Leo pointed out that this has not yet been fully
implemented/abstracted/documented and observed that Gabe would be a welcome
volunteer.</p>

<h4><a href="http://xrl.us/dy6f">Core Dump on <code>japh16</code></a></h4>

<p>Bernhard Schmalhofer noticed that <code>japh16</code> core dumps. He also
submitted a simplistic fix.</p>

<h3>The Usual Footer</h3>

<p>If you find these summaries useful or enjoyable, please consider
contributing to the Perl Foundation to help support the development of Perl.
You might also like to <csperl file="mailmunge" arg_email="ubermatt@gmail.com" arg_display="send feedback" arg_ending="."></p>

<ul>

<li><a href="http://donate.perl-foundation.org/">The Perl Foundation</a></li>
<li><a href="http://dev.perl.org/perl6/">Perl 6 Development site</a></li>
<li><a href="http://planet.parrotcode.org/">Parrot Blog aggregator</a></li>

</ul>



        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1018" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2004/11/18/mod_perlservice.html" rel="bookmark">Cross-Language Remoting with mod_perlservice</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Michael Collins</span> on <abbr class="published" title="2004-11-18T00:00:00-08:00">November 18, 2004 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            <h3>Mod_perlservice? What is That?</h3>

<p><code>Mod_perlservice</code> is a cool, new way to do remoting -- sharing
data between server and client processes -- with Perl and Apache. Let's start
by breaking that crazy name apart: mod + perl + service.</p>

<p><em>Mod</em>
means that it's a module for the popular and ubiquitous Apache HTTP Server.
<em>Perl</em> represents the popular and ubiquitous programming language.
<em>Service</em> is the unique part.  It's the new ingredient that unifies
Apache, Perl, and XML into an easy-to-use web services system.</p>

<p>With mod_perlservice, you can write Perl subs and packages on your server
and call them over the internet from client code. Clients can pass scalars,
arrays, and hashes to the server-side subroutines and obtain the return value
(scalar, array, or hash) back from the remote code. Some folks refer to this
functionality as "remoting" or "RPC," so if you like you can say
mod_perlservice is remoting with Perl and Apache. You can write client programs
in a variety of languages; libraries for C, Perl, and Flash Action Script are
all ready to go.</p>

<p>Now that you know what mod_perlservice is, let's look at why it
is. I believe that mod_perlservice has
a very clean, easy-to-use interface when compared with
other RPC systems. Also, because it builds on the Apache
platform it benefits from Apache's ubiquity, security,
and status as a standard.  Mod_perlservice sports an
embedded Perl interpreter to offer high performance for demanding
applications.</p>
<img src="/pub/2004/11/18/graphics/mod_perlservicelogo.jpg" alt="mod_perlservice" width="200" height="120" alt="mod_perlservice" align="left" hspace="6" vspace="6" />
<h3>How Can I Use mod_perlservice?</h3>

<p>Mod_perlservice helps create networked applications that require
client-server communication, information processing, and
sharing. Mod_perlservice is for applications, not
for creating dynamic content for your HTML pages. However, you
surely can use it for Flash remoting with Perl. Here are some usage
examples:</p>

<ul>

<li>A desktop application (written using your favorite C++ GUI library) that
records the current local air temperature and sends it to an online database
every 10 minutes.  Any client can query the server to obtain the current and
historical local air temperature of any other participating client.</li>

<li>A Flash-based stock portfolio management system. You can create model stock
portfolios and retrieve real-time stock quote information and news.</li>

<li>A command-line utility in Perl that accepts English sentences on standard
input and outputs the sentences in French. Translation occurs in server-side
Perl code. If the sentence is idiomatic and the translation is incorrect, the
user has the option of sending the server a correct translation to store in an
online idiom database.</li>

</ul>

<h3>How Do I Start?</h3>

<p>Let's move on to the fun stuff and set up a working installation.  Before we
begin, make sure you have everything you need! You need <a
href="http://httpd.apache.org/">Apache HTTPD</a>, <a
href="http://www.perl.org/">Perl</a>, <a
href="http://expat.sourceforge.net/">Expat</a>, <a
href="http://www.ivorycity.com/mod_perlservice/">mod_perlservice</a>, and a
mod_perlservice client library (<a
href="http://www.ivorycity.com/mod_perlservice/perl_client.html">Perl
Client</a> | <a href="http://www.ivorycity.com/mod_perlservice/c_client.html">C
Client</a> | <a
href="http://www.ivorycity.com/mod_perlservice/flash_client.html">Flash
Client</a>).   You must download a client library separately, as the
distribution does not include any clients!  In your build directory:</p>

<pre><code>myhost$ tar -xvzf mod_perlservice.tar.gz 
myhost$ cd mod_perlservice
myhost$ ./configure
myhost$ make
myhost$ make install</code></pre>

<p>  If everything goes to plan, you'll end up with a fresh
<em>mod_perlservice.so</em> in your Apache modules directory, (usually
<em>/etc/apache/modules</em>).  Now it's time to configure Apache to use
mod_perlservice. <code>cd</code> into your Apache configuration directory
(usually <em>/etc/apache/conf</em>) Add the following lines to the file
<em>apache.conf</em> (or <em>httpd.conf</em>, if you have only a single
configuration file):</p>

<pre>LoadModule perlservice_module modules/mod_perlservice.so
AddModule mod_perlservice.c</code></pre>

<p>Add the following lines to <em>commonapache.conf</em>, if you have it and
<em>httpd.conf</em> if you don't:</p>

<pre><code>&lt;IfModule mod_perlservice.c&gt;  
&lt;Location /perlservice&gt;   SetHandler
mod_perlservice   
   Allow From All PerlApp
   myappname /my/app/dir
   #Examples
   PerlApp stockmarket /home/services/stockmarket   
   PerlApp temperature /home/services/temperature  
&lt;/Location&gt;
&lt;/IfModule&gt;</code></pre>

<p><em>Pay close attention to the <code>PerlApp</code> directive.</em> For every
mod_perlservice application you want to run, you need a <code>PerlApp</code>
directive. If I were creating a stock market application, I might create a
directory: <em>/home/services/stockmarket</em> and add the following
<code>PerlApp</code> directive:</p>

<pre><code>PerlApp stockmarket /home/services/stockmarket</code></pre>

<p>This tells mod_perlservice to
host an application called <code>stockmarket</code>
with the Perl code files located in
the <em>/home/services/stockmarket</em> directory.
You may run
as many service applications as you wish and you may organize them
however you wish.</p>

<p>With the configuration files updated, the next step is to restart
Apache:</p>

<pre><code>myhost$ /etc/init.d/apache restart
<em>or</em>
myhost$ apachectl restart</code></pre>

<p>Now if everything went as planned, mod_perlservice should be installed. Congratulations!</p>

<h3>An Example</h3>

<p>Let's create that stock portfolio example mentioned earlier. It won't
support real-time quotes, but will instead create a static database of common
stock names and historical prices. The application will support stock
information for General Electric (GE), Red Hat (RHAT), Coca-Cola (KO), and
Caterpillar (CAT).</p>

<p>The application will be <em>stockmarket</em> and will keep all of the Perl
files in the stock market application directory
(<em>/home/services/stockmarket</em>). The first file will be
<em>quotes.pm</em>, reading as follows:</p>

<pre><code>our $lookups = {
    "General Electric" =&gt; "GE",
    "Red Hat"          =&gt; "RHAT",
    "Coca Cola"        =&gt; "KO",
    "Caterpillar Inc"  =&gt; "CAT"
};
our $stocksymbols = {
    "GE" =&gt; {
        "Price"            =&gt; 33.91,
        "EarningsPerShare" =&gt; 1.544
    },
    "RHAT" =&gt; {
		"Price" =&gt; 14.96,
		"EarningsPerShare" =&gt; 0.129
	},
    "KO"   =&gt; {
        "Price"            =&gt; 42.84,
        "EarningsPerShare" =&gt; 1.984
    },
    "CAT" =&gt; {
        "Price"            =&gt; 75.74,
        "EarningsPerShare" =&gt; 4.306
    }
};

package quotes;

sub lookupSymbol {
    my $companyname = shift;
    return $lookups-&gt;{$company_name};
}

sub getLookupTable {
    return $lookups;
}

sub getStockPrice {
    my $stocksymbol = shift;
    return $stocksymbols-&gt;{$stocksymbol}-&gt;{"Price"};
}
sub getAllStockInfo {
    my $stocksymbol = shift;
    return $stocksymbols{$stocksymbol};
}
1;</code></pre>

<p>That's the example of the server-side program. Basically, two static "databases"
(<code>$lookups</code> and <code>$stocksymbols</code>) provide information
about a limited universe of stocks. The above methods query the static
databases; the behavior should be fairly self-explanatory.</p>

<p>You may have as many <em>.pm</em> files in your application as you wish and
you may also define as many packages within a <em>.pm</em> file as you wish.
An extension to this application might be a file called <em>news.pm</em> that
enables you to fetch current and historical news about your favorite
stocks.</p>

<p>Now let's talk some security. As it stands, this code won't work;
mod_perlservice will restrict access to any file and method you don't
explicitly export for public use.  Use the <em>.serviceaccess</em> file to
export things. Create this file in each application directory you declare with
mod_perlservice or you'll have no access.  An example file might read:</p>

<pre><code>&lt;ServiceAccess&gt;
  &lt;AllowFile name="quotes.pm"&gt;
    Allow quotes::*
  &lt;/AllowFile&gt;
&lt;/ServiceAccess&gt;</code></pre>

<p>In the stock market example, this file should be
<em>/home/services/stockmarket/.serviceaccess</em>.  Be sure that the
<code>apache</code> user does not own this file; that could be bad for
security. This file allows access to the file <em>quotes.pm</em> and allows
public access to all (<code>*</code>) the methods in package
<em>quotes</em>.</p>

<p>If I want to restrict access only to <code>getStockPrice</code>, I would
have written <code>Allow quotes::getStockPrice</code>.  After that, I could add
access to <code>lookupSymbol</code> with <code>Allow
quotes::lookupSymbol</code>.  To make <em>quotes.pm</em> public carte blanche,
use <em>Allow *</em>.  You won't need to restart Apache when you make changes
to this file as it reloads automatically.</p>

<h3>Client Code</h3>

<p>Well, so far I've only shown you half the story. It's time to create some
client-side code. This client example uses the Flash "PerlService" library,
just one of the client-side interfaces to mod_perlservice. The Flash client
works well for browser interfaces while the Perl and C clients can create command-line or GUI (ie, GTK or Qt) applications. This article is on the
web, so we'll give the Flash interface a spin and then go through an example in
Perl.</p>

<p>The first code smidgen should go in the first root frame of your Flash
application. It instantiates the global <code>PerlService</code> object and
creates event handlers for when remote method calls return from the server. The
event handlers output the requested stock information to the display box.</p>

<pre><code>#include "PerlService-0.0.2.as"
// Create a global PerlService object
// Tell the PerlService object about the remote code we want to use:
// arg1) host: www.ivorycity.com
// arg2) application: stockmarket
// arg3) file: quotes.pm
// arg4) package: quotes
_global.ps = new PerlService("www.ivorycity.com","stockmarket","quotes.pm","quotes");
// First declare three callback functions to handle return values
function onStockPrice(val) { 
	output.text = "StockPrice: " + symbolInput.text + " " + val + "\n" + output.text;
}

function onAllStockInfo(val) { 
    output.text = "Stock Info: " + allInfoInput.text + "\n" + "\tPrice: "
	              + val.Price + "\n" + "\tEarnings Per Share: "
				  + val.EarningsPerShare + "\n" + output.text;
}

function onLookupSymbol(val) { 
	output.text = "Lookup Result: " + symbolInput.text + " " + val + "\n"
	              + output.text;
}

// Register callback handlers for managing return values from remote  methods
// ie, onStockPrice receives the return value from remote method getStockPrice

ps.registerReplyHandler( "getStockPrice", onStockPrice );
ps.registerReplyHandler( "getAllStockInfo", onAllStockInfo );
ps.registerReplyHandler( "lookupSymbol", onLookupSymbol );</code></pre>

<p>Now for the code that makes things happen.  The following code attaches to
three separate buttons. When clicked, the buttons call the remote Perl methods
using the global <code>PerlService</code> object. Flash Action Script is an
event-driven system, so click event-handlers will call the remote code and
return event-handlers will do something with those values.</p>

<p><img src="/pub/2004/11/18/graphics/flashclientdgm.jpg" width="400" height="206" alt="buttons and code associations" /><br
/><em>Figure 1.  Button and code associations.</em></p>

<p>When a user presses Button 1, call the remote method
<code>getStockPrice</code> and pass the text in the first input box as an
argument.</p>

<pre><code>on (release) {
	ps.getStockPrice(box1.text);
}</code></pre>

<p>When the user presses Button 2, call the remote method
<code>getAllStockInfo</code> and pass the text in the second input box as an
argument.</p>

<pre><code>on (release) {
	ps.getAllStockInfo(box2.text);
}</code></pre>

<p>When the user presses Button 3, call the remote method
<code>lookupSymbol</code> and pass the text in the third input box as an
argument.</p>

<pre><code>on (release) {
	ps.lookupSymbol(box3.text);
}</code></pre>

<p>That's the entire Flash example. Here is the finished product.</p>

<embed src="/pub/2004/11/18/graphics/fooxwsp.swf" width="400" height="200">

<h4>Perl Client</h4>

<p>Not everyone uses Flash, especially in the Free Software community.  The
great thing about mod_perlservice is that everyone can join the party. Here's a
Perl Client that uses the same server-side stock market API.</p>

<pre><code>
use PService;

my $hostname = "www.ivorycity.com";
my $appname  = "stockmarket";
my $filename = "quotes.pm";
my $package  = "quotes";              

#Create the client object with following arguments:      
#1) The host you want to use
#2) The application on the host
#3) The perl module file name
#4) The package you want to use

my $ps = PSClient-&gt;new( $hostname, $appname, $filename, $package );

# Just call those remote methods and get the return value
my $price  = $ps-&gt;getStockPrice("GE");
my $info   = $ps-&gt;getAllStockInfo("RHAT");
my $lookup = $ps-&gt;lookupSymbol("Coca Cola");                   

#Share your exciting new information with standard output
print "GE Price: " . $price . "\n";
print "Red Hat Price: " . $info-&gt;{Price} . "\n";
print "Red Hat EPS: " . $info-&gt;{EarningsPerShare} . "\n";
print "Coca-Cola's ticker symbol is " . $lookup . "\n";</code></pre>

<p>Using the <em>PSClient</em> object to call remote methods might feel a
little awkward if you expect to call them via
<code>quotes::getStockPrice()</code>, but think of the <code>$ps</code>
instance as a proxy class to your remote methods, if you like.</p>

<p>If things don't work, use <code>print $ps-&gt;get_errmsg();</code> to print
an error message.  $ps-&gt;get_errmsg();</code> That's a local reserved
function, so it doesn't call the server.  It's one of a few reserved functions
detailed in the <a
href="http://www.ivorycity.com/mod_perlservice/perl_client.html">Perl client
reference</a>.</p>

<p>As you can see, it requires much less work to create an example with the
Perl client. You simply instantiate the PSClient object, call the remote
methods, and do something with the return values. That's it. There is no
protocol decoding, dealing with HTTP, CGI arguments, or any of the old
annoyances. Your remote code may as well be local code.</p>

<h3>Thanks for Taking the Tour</h3>

<p>That's mod_perlservice. I'm sure many of you who are developing client-server
applications can see the advantages of this system. Personally, I've always
found the existing technologies to be inflexible and/or too cumbersome. The
mod_perlservice system offers a clean, simple, and scalable interface that
unites client-side and server-side code in the most sensible way yet.</p>

<p>What's next? mod_parrotservice!</p>




        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1012" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2004/11/test.html" rel="bookmark">TEST</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">perl.com</span> on <abbr class="published" title="2004-11-15T00:00:00-08:00">November 15, 2004 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            <h2> This is a test </h2>

Again...
        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1022" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2004/11/p6pdigest/20041108.html" rel="bookmark">This Week in Perl 6, November 2 - 8 2004</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Matt Fowles</span> on <abbr class="published" title="2004-11-11T00:00:00-08:00">November 11, 2004 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            
<!-- sidebar begins -->
<!-- don't move sidebars -->
<!-- sidebar ends -->

<p>Welcome to yet another summary, brought to you (once again) with the aid of
the musical stylings of Dar Williams and Soul Coughing and a small, stuffed
elephant name Aliya. And, without further ado, I give you Perl 6 Language
(whose traffic has picked up a little).</p>

<h3>Perl 6 Language</h3>

<h4><a href="http://xrl.us/dvi2">What Was that Anonymous Thing?</a></h4>

<p>Juerd wondered what things could be named and what could be anonymous.  Larry
provided the answer: Subtypes, Enums, Lists (Lazy and Eager), Grammars, and
Packages, but then threatened to attack Juerd with hot grits.</p>

<h4><a href="http://xrl.us/dvi3">Updated Apocalypses and Synopses</a></h4>

<p>Larry proved links to the current versions of the various Apocalypses and
Synopses. Unfortunately he forgot to start a new thread with his message....</p>

<ul>

<li><a href="http://www.wall.org/~larry/apo">apocalypses</a></li>
<li><a href="http://www.wall.org/~larry/syn">synopses</a></li>

</ul>

<h4><a href="http://xrl.us/dvi4">Suggested Warning for Overriding Operators</a></h4>

<p>Aaron Sherman wanted to receive a warning for defining things like
<code>multi sub *infix:+(...) {...}</code>. But Larry reasoned that anyone who'd
use the <code>*</code> there does not care for warnings.</p>

<h3>Perl 6 Compiler</h3>

<p>Last week, I bemoaned my lack of Google (and thus links). But a couple kind
souls pointed out that I could get links straight from the horses mouth at <a
href="http://nntp.perl.org/">nntp.perl.org</a>. All I can say is, ::shrug::
"Who knew that there was an Internet outside of Google?" Fortunately, I do not
have to admit to its existence as there were no messages this week.</p>

<h3>Parrot Internals</h3>

<h4><a href="http://xrl.us/dvi5">She-bangs for None!!</a></h4>

<p>Last week James deBoer offered a patch to remove all of the shebang lines
from <em>config/*.pl</em> (after his initial patch to add them to all of them
was turned away). Warnock applies.</p>

<h4>Solaris 9 Troubles</h4>

<p>Christian Aperghis-Tramoni has some trouble while trying to install on
Solaris 9. Warnock applies.</p>

<h4><a href="http://xrl.us/dvi6">More Vtables</a></h4>

<p>Leo wanted to add a finalize vtable entry (in addition to destroy, which is
apparently used for free memory and not active resources). Jeff commented on the
difficulties implicit in finalizing stuff, and the thread ran out of gas.</p>

<h4><a href="http://xrl.us/dvi7">Build Dynclasses by Default</a></h4>

<csperl file="grab" domain="on" record="b/1424" template="b/article_sidebar.view">

<p>Last week, Leo was stalling to hear about success and failures before adding
them to the default build. Brent "Dax" Royal-Gordon and Sam Ruby both chimed in
with success. And so they did.</p>

<h4><a href="http://xrl.us/dvi9">Register Frame Recycling</a></h4>

<p>Leo added in some basic continuation recycling. Dan didn't like that it
required the user to clone return continuations into full ones. Leo agreed, but
felt that a <code>returncc</code> function would be needed first. I wondered
why we needed this recycling and couldn't just let the DOD/GC do it for us. The
answer: speed.</p>

<h4><a href="http://xrl.us/dvja">Upcase Binary Strings</a></h4>

<p>Dan wondered what should happen if you tried to play with the case of a
binary encoded string. The consensus seems to be either throw an exception or
nothing, depending on settings.</p>

<h4><a href="http://xrl.us/dvjb">Setref Poorly Named</a></h4>

<p>Sam Ruby was initially confused by the strange behavior of setref. Leo told
him that it was intended to set a reference inside a reference type and noted
that classes needs a clean up. With the advent of dynclasses, this sounds like
a job for some adventurous lurker...</p>

<h4><a href="http://xrl.us/dvjc">Tracebacks PMC v. Ops</a></h4>

<p>Leo wondered if we should have a PMC that could access the entire call chain
and do whatever evil it wanted. Dan conjectured that this sort of thing was
evil enough that ops might be well advised. Leo initially put some methods into
the continuation to do this, but later thought about putting them into the
interpreter instead. I like the interp idea.</p>

<h4><a href="http://xrl.us/dvjd"><code>Parrot -t</code> Memory Leaks</a></h4>

<p>Last week our fearless leader notice some significant memory leaks with
<code>parrot -t</code>. This week our fearless pumpking fixed them.</p>

<h4><a href="http://xrl.us/dvje">Performance Graphs</a></h4>

<p>Matt Diephouse (assisted by Joshua Gatcomb) provided a pointer to a page of
periodic Parrot performances, provided as pretty pictures. Please provide
possible improvement pointers.</p>

<h4><a href="http://xrl.us/dvjh">Uniline <code>yield()</code> and
<code>return()</code></a></h4>

<p>St&eacute;phane Payrard (whose name Google objects to strenuously) re-sent
his patch for uniline <code>yield</code> and <code>return</code> in PIR.  Leo
applied the patch.</p>

<h4><a href="http://xrl.us/dvji">Mod_parrot 0.1</a></h4>

<p>Jeff Horwitz released mod_parrot 0.1. Pretty nifty.</p>

<p><a href="http://xrl.us/dvjj">download mod_parrot</a></p>

<h4><a href="http://xrl.us/dvjk">IO Auto-Flush Troubles</a></h4>

<p>Christian Aperghis-Tramoni wondered how to make stdout not buffer away his
prompt. The answer (provided by Mary Pauley and Luke Palmer) requires using
<code>pioctl</code> and strange magic numbers.</p>

<h4><a href="http://xrl.us/dvjm">BigChanges--; release++?</a></h4>

<p>Since the big indirect register change has gone through, some voices
suggested putting out a 0.1.2 release. Leo felt that it was too soon, but
seemed to be holding a minority opinion. I vote that we release after the new
register allocator (and possibly Dan's string stuff depending on how long it
takes).</p>

<h4><a href="http://xrl.us/dvjn">Dan's String Stuff</a></h4>

<p>Dan is about to make some "Irrevocable Changes" so he decided to do his work
in a branch named <code>pluggable_encodings</code>, assuming he can use CVS
(which is surprisingly hard at times). Because no one screamed foul, I think it
is a safe assumption.</p>

<h4><a href="http://xrl.us/dvjo">Clone mmd</a></h4>

<p>Sam Ruby submitted a patch adding <code>mmd_clone</code> for dynclasses. Leo
suggested an alternate approach, and Warnock['s Dilemma] took over.</p>

<h4><a href="http://xrl.us/dvjp">True Coroutines</a></h4>

<p>Klaas-Jan Stol wondered if Parrot had "true" coroutine because Roberto
Ierusalimschy (of Lua fame) called it into question. Some confusion ensued as
to what the platonic ideal of a coroutine actually is, but the answer seems to
be: we should and if they aren't, patches welcome.</p>

<h4><a href="http://xrl.us/dvjq">Trouble with Closures and Subs</a></h4>

<p>Klaas-Jan Stol was having trouble with closures and subs. Many people
provided some very useful pointers. If you are writing a compiler for Parrot
you should read this thread carefully. If you are writing a summary for Parrot
you should skim it and punt.</p>

<h4><a href="http://xrl.us/dvjr">Shared Library and Dynclasses</a></h4>

<p>Sam Ruby wondered if dynclasses should link to <em>libparrot.so</em>. Dan
provided the answer: yes. Sam Ruby went on to suggest that if most PMCs would
eventually become dynclasses, then (to reduce executable size, the Parrot
executable should probably also link to <em>libparrot.so</em> rather than
including all of it. No one commented on this observation.</p>

<h4><a href="http://xrl.us/dvjs">Search Paths and Libraries</a></h4>

<p>Dan wants to stop being annoyed by library path issues. He figures that the
right way to do this is to allow dynamic library loading. Best of all he wants
the code to do that be in the library. Thus he put out a request for the
ability to embed bytecode into an executable. Brent "Dax" Royal-Gordon provided
a slightly too-evil method of doing this. Other slightly less-evil (or even
good) options would definitely be received thankfully.</p>

<h4><a href="http://xrl.us/dvjt">Benchmarks? Tests? Or Both?</a></h4>

<p>Joshua Gatcomb noticed that some benchmarks fail on occassion.  Matt
Diephouse suggested making them tests too. Leo felt that would be fine provided
they did not take too long to run.</p>

<h4><a href="http://xrl.us/dvju">Fibonacci Still Slow</a></h4>

<p>It is odd how the wheel comes full circle. Originally designed as an
exercise in addition for students, the Fibonacci Sequence has some really
interesting mathematical properties. While completely ignoring its unexpected
niftiness (and explicit formula), this miraculous sequence is still used as
busy work for poor creatures.  This time the creature is Parrot, and despite
Leo's best efforts, it is still slow. There was some talk of how to optimize
this before Dan put the smack down all of it:</p>

<p>"No more performance changes. Period. We get Parrot fully functional
first."</p>

<h4><a href="http://xrl.us/dvjv">Parrot on Windows</a></h4>

<p>Jerry Wiltz wondered how to get Parrot on his poor Win XP box.  Fred and
Georgy provided many pointers. Christian Lott also had trouble, but Nicholas
Clark, Ron Blaschke, Peter Sinnott, and Steve Peters all provided pointers.</p>

<h4><a href="http://xrl.us/dvjx">Parrot Build Issues</a></h4>

<p>Jack J. Woehr was having trouble building parrot on his Sun. Leo provided
the needed help. Then ICU became problematic. Many people provided help and he
eventually got it running Forth, which promptly segfaulted. Jack sounded
discouraged, but he really should stay with it now that he has overcome the
hard part....</p>

<h4><a href="http://xrl.us/dvjz">Detecting <em>perldoc</em></a></h4>

<p>James deBoer wondered if we should detect the presence of perldoc and fail
to configure if it is missing. The consensus seems to be that we should detect
the absence of <em>perldoc</em>, but if it is not there throw up a big fat
warning and proceed.</p>

<h4><a href="http://xrl.us/dvj2"><code>Pow</code> and Other Ops</a></h4>

<p>There was/is a fairly long and ongoing discussion about ops on PMCs, which
Sam Ruby unwittingly started when he asked for MMD <code>pow</code>.  While
there are people on all sides, it appears likely that the ops will stay.</p>

<h4><a href="http://xrl.us/dvj5">C on Parrot?</a></h4>

<p>Bloves wondered what the current state of C on Parrot was. But I think he
posted it through Google Groups (which does not actually reach the list) as I
did not find it in my email. The answer is it essentially non-existent, but if you
are feeling brave/insane/suicidal patches welcome.</p>

<h4><a href="http://xrl.us/dvj6">Streams and Filters</a></h4>

<p>Ron Blaschke tracked does the problem with <em>t/library/streams.t</em> #14
on Win32. The guilty party is line endings. One workaround would be to set the
file in question to binary in CVS (although that feels like cheating).</p>

<h4><a href="http://xrl.us/dvj7">AIX PPC JIT</a></h4>

<p>Adam Thomason provided a patch to fix some warnings. Leo applied it.</p>

<h4><a href="http://xrl.us/dvj8">Register Allocation/Volatility</a></h4>

<p>Despite Dan's line-in-the-sand strong statements about no more optimization,
Jeff Clites and Leo tossed about some radical ideas for how to speed everything
up.</p>

<h4><a href="http://xrl.us/dvj9">GC Invocation</a></h4>

<p>Leo suggested changing the GC from one that interrupts everybody and does its
thing, to one that waits its turn and does its thing.  I am concerned that this
could lead to resource starvation in a multithreaded system, but nobody else
posted anything. Of course, he only suggested this today.</p>

<h4><a href="http://xrl.us/dvka"><code>Eval</code> Questions</a></h4>

<p>Leo wants some answers to some <code>eval</code> questions before he tries
to clean up dynamic code compiling. Answers??</p>

<h4><a href="http://xrl.us/dvkb">Include Perl 6 Files in Config</a></h4>

<p>Gerd Pokorra wants to be able to run Perl 6 from anywhere. He even provided
a means of achieving this end (although not in unified diff format as is the
custom).</p>

<h4>
<code>pioctl</code> -&gt; segfault
</h4>

<p>St&eacute;phane Payrard received a segfault while playing with the
previously mentioned <code>pioctl</code> magic numbers. Leo speculates that
this might be due to the lack of an <code>end</code> opcode.</p>

<h4><a href="http://xrl.us/dvkc">[TODO] Improve <em>parrot-config.imc</em></a></h4>

<p>Takers wanted.</p>

<h4><a href="http://xrl.us/dvkd">Missing Arguments</a></h4>

<p>Klaas-Jan Stol wondered how to detect missing arguments. Leo and Dan both
pointed to the argument count registers.</p>

<h4><a href="http://xrl.us/dvke">Update to <em>embed.pod</em></a></h4>

<p>St&eacute;phane Payrard provided an update to <em>embed.pod</em>. Leo
applied it, but Brent "Dax" Royal-Gordon cried foul over the including of
<em>parrot.h</em>. Dan agreed with Brent, and St&eacute;phane provided a patch
to remove the offending line.</p>

<h4><a href="http://xrl.us/dvkf">Calling Conventions, Tracebacks, and Register
Allocations</a></h4>

<p>Leo suggested a new way to invoke functions that would clean up calling,
tracebacks, and register allocation. While such a change would have great
aesthetic value, Dan declared it premature as Parrot is not yet fully
specified. Doubtless this will re-arise later, as aesthetics is a powerful
motivator.</p>

<h3>The Usual Footer</h3>

<p>If you find these summaries useful or enjoyable, please consider
contributing to the Perl Foundation to help support the development of Perl.
You might also like to <a href="mailto:ubermatt@gmail.com">send
feedback</a>.</p>

<ul>

<li><a href="http://donate.perl-foundation.org/">The Perl Foundation</a></li>
<li><a href="http://dev.perl.org/perl6/">Perl 6 Development site</a></li>
<li><a href="http://planet.parrotcode.org/">Parrot Blog aggregator</a></li>

</ul>





        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1016" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2004/11/11/floodcontrol.html" rel="bookmark">Implementing Flood Control</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Vladi Belperchinov-Shabanski</span> on <abbr class="published" title="2004-11-11T00:00:00-08:00">November 11, 2004 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            <p>Accordingly to Merriam-Webster Online, "flood" means:</p>

<blockquote><p>1: a rising and overflowing of a body of water especially onto
normally dry land;</p>

<p>2: an overwhelming quantity or volume.</p></blockquote>

<p>In computer software there are very similar situations when an unpredictable
and irregular flow of events can reach higher levels. Such situations usually
are not comfortable for users, either slowing down systems or having other undesired
effects.</p>

<p>Floods can occur from accessing web pages, requesting information from
various sources (ftp lists, irc services, etc.), receiving SMS notification
messages, and email processing. It is obvious that it is not possible to list
all flood cases.</p>

<p>"Flood control" is a method of controlling the processing-rate of a stream of
events. It can reject or postpone events until there are available resources (CPU, time, space, etc.) for them.  Essentially the flood control restricts the
number of events processed in a specific period of time.</p>

<h3><a id="closing_the_gates">Closing the Gates</a></h3>

<p>To maintain flood control, you must calculate the flood ratio, which is:</p>

<p><img src="/pub/2004/11/11/graphics/flood2-eq1.gif" width="73" height="50" alt="flood ratio equation" /><br /><em>Figure 1.
Flood ratio equation.</em></p>

<pre><code><em>fr</em> flood ratio
<em>ec</em> event count
<em>tp</em> time period for ec</code></pre>

<p>To determine if a flood is occurring, compare the flood ratio to the fixed
maximum (threshold) ratio. If the result is less than the threshold, there's no
flood.  Accept the event.  If the result is higher, refuse or postpone the
event.</p>

<p><img src="/pub/2004/11/11/graphics/flood2-eq2.gif" width="68" height="50" alt="comparing the ratios" /><br /><em>Figure 2.
Comparing the ratios.</em></p>

<pre><code><em>ec</em> event count
<em>tp</em> time period for ec
<em>fc</em> fixed event count (max)
<em>fp</em> fixed time period for fc</code></pre>

<p>It is possible to keep an array of timestamps of all events. Upon receipt of
a new event, calculate the time period since the oldest event to use as the
current count/time ratio. This approach has two drawbacks.  The first is that
it uses more and more memory to hold all of the timestamps.  Suppose that you
want only two events to happen inside a one-minute period, giving two events
per minute.  Someone can trigger a single event, wait half an hour, and finally
flood you with another 58 requests. At this point the ratio will be 1.9/min.,
well below the 2/min. limit.  This is the second drawback.</p>

<p>A better approach is to keep a sliding window either of events
(<code>fc</code>) or time period (<code>fp</code>).</p>

<p>This period window requires an array of the last events. This array size is
unknown. (The specific time units are not important, but the following examples
use minutes.)</p>

<pre><code>
               past                                   now
    Timeline:  1----2----3----4----5----6----7----8----9---&gt; (min)
    Events:    e1      e2 e3         e4     e5 e6     e7</code></pre>

<p>This timeline measures event timestamps.  To calculate the flood ratio,
you count events newer than the current time window of size <code>fp</code>. And check against a ratio of four events in three minutes:</p>

<pre><code>Time now:      9
Time window:   from 9-3 = 6 to now(9), so window is 6-9
Oldest event:  e5 (not before 6)
Event count:   3 (in 6-9 period)
Flood ratio:   3/3</code></pre>

<p>This ratio of 3/3 is below the flood threshold of 4/3, so at this moment
there is no flood.  Perform this check at the last event to check.  In this
example, this event is <code>e7</code>. After each check, you can safely remove
all events older than the time window to reduce memory consumption.</p>

<p>The other solution requires a fixed array of events with size <code>fc</code>.
With our 4ev/3min example, then:</p>

<pre><code>
               past                  now
    Timeline:  &lt;--5----6----7----8----9---&gt; (min)
    Events:      e4        e5 e6     e7</code></pre>

<p>The event array (window) is size 4. To check for a flood at
<code>e7</code>, we use this:</p>

<pre><code>Window size "fc": 4
First event time: e4 -&gt; 5
Last  event time: e7 -&gt; 9
Time period "tp": 9-5 = 4
Flood ratio is:   4/4</code></pre>

<p>The ratio of 4/4 is also below the threshold of 4/3, so it's OK to accept
event <code>e7</code>.  When you must check a new event, add it to the end
of the event array (window) and remove the oldest one.  If the new event would
cause a flood, remember to reverse these operations.</p>

<p>If the flood check fails, you can find a point in the future when this check
will be OK.  This makes it possible to return some feedback information to the
user indicating how much time to wait before the system will accept the next
event:</p>

<p><img src="/pub/2004/11/11/graphics/flood2-eq3.gif" width="126" height="50" alt="time until next event equation" /><br
/><em>Figure 3.  Time until next event equation.</em></p>

<pre><code><em>ec</em>  event count (requests received, here equal to fc)
<em>fc</em>  fixed event count (max)
<em>fp</em>  fixed time period for fc
<em>now</em> the future time point we search for
<em>ot</em>  oldest event time point in the array (event timestamp)</code></pre>
    
<p><img src="/pub/2004/11/11/graphics/flood2-eq4.gif" width="186" height="50" alt="simplified time until next event equation"
/><br /><em>Figure 4.  Simplified time until next event equation.</em></p>

<p><img src="/pub/2004/11/11/graphics/flood2-eq5.gif" width="192" height="30" alt="time to wait equation" /><br
/><em>Figure 5.  The time-to-wait equation.</em></p>

<pre><code><em>time</em> the actual current time (time of the new event)
<em>wait</em> time period to wait before next allowed event</code></pre>

<p>If <code>wait</code> is positive, then this event should be either rejected
or postponed. When <code>wait</code> is 0 or negative, it's OK to process the
event immediately.</p>

<h3><a id="the_code">The Code</a></h3>

<p>In the following implementation I'll use a slightly modified version of the
sliding window of events.  To avoid removing the last event and eventually
replacing it after a failed check, I decided to check the current flood ratio with
the existing events array and with the time of the new one:</p>

<pre><code>
               past                  now
    Timeline:  &lt;--5----6----7----8----9---&gt; (min)
    Events:      e3   e4   e5 e6    (e7)

    Window size <em>fc</em>: 4 (without e7)
    First event time: e4 -&gt; 5
    Last event time: e7 -&gt; 9
    Time period <em>tp</em>: 9-5 = 4
    Flood ratio is:   4/4</code></pre>

<p>This seems a bit strange at first, but it works exactly as needed. The check
is performed as if <code>e6</code> is timed as <code>e7</code>, which is the
worst case (the biggest time period for the fixed event window size). If the
check passes, than after removing <code>e3</code>, the flood ratio will be
always below the threshold!</p>

<p>Following this description I wrote a function to call for each request or
event that needs flood control. It receives a fixed, maximum count of requests
(the events window size) and a fixed time period. It returns how much time must
elapse until the next allowed event, or 0 if it's OK to process the event
immediately.</p>

<p>This function should be generic, so it needs some kind of event names. To
achieve this there is a third argument -- the specific event name for each
flood check.</p>

<p>Here is the actual code:</p>

<pre><code># this package hash holds flood arrays for each event name
# hash with flood keys, this is the internal flood check data storage
our %FLOOD;

sub flood_check
{
  my $fc = shift; # max flood events count
  my $fp = shift; # max flood time period for $fc events
  my $en = shift; # event name (key) which identifies flood check data

  $FLOOD{ $en } ||= [];   # make empty flood array for this event name
  my $ar = $FLOOD{ $en }; # get array ref for event's flood array
  my $ec = @$ar;          # events count in the flood array
  
  if( $ec &gt;= $fc ) 
    {
    # flood array has enough events to do real flood check
    my $ot = $$ar[0];      # oldest event timestamp in the flood array
    my $tp = time() - $ot; # time period between current and oldest event
    
    # now calculate time in seconds until next allowed event
    my $wait = int( ( $ot + ( $ec * $fp / $fc ) ) - time() );
    if( $wait &gt; 0 )
      {
      # positive number of seconds means flood in progress
      # event should be rejected or postponed
      return $wait;
      }
    # negative or 0 seconds means that event should be accepted
    # oldest event is removed from the flood array
    shift @$ar;
    }
  # flood array is not full or oldest event is already removed
  # so current event has to be added
  push  @$ar, time();
  # event is ok
  return 0;
}</code></pre>

<p>I've put this on the CPAN as <a
href="http://search.cpan.org/dist/Algorithm-FloodControl">Algorithm::FloodControl</a>.</p>

<p>To test it, I wrote a simple program that accepts text, line by line, from
standard input and prints each accepted line or the amount of time before the
program will accept the next line.</p>

<pre><code>#!/usr/bin/perl
use strict;
use Algorithm::FloodControl;

while(&lt;&gt;)
  {
  # time is used to illustrate the results
  my $tm = scalar localtime;
  
  # exit on `quit' or `exit' strings
  exit if /exit|quit/i;
  
  # FLOOD CHECK: allow no more than 2 same lines in 10 seconds
  # here I use the actual data for flood event name!
  my $lw = flood_check( 2, 10, $_ );
  
  if( $lw ) # local wait time
    {
    chomp;
    print "WARNING: next event allowed in $lw seconds (LOCAL CHECK for '$_')\n";
    next;
    }
  print "$tm: LOCAL  OK: $_";
  
  # FLOOD CHECK: allow no more than 5 lines in 60 seconds
  my $gw = flood_check( 5, 60, 'GLOBAL' );
  
  if( $gw ) # global wait time
    {
    print "WARNING: next event allowed in $gw seconds (GLOBAL CHECK)\n";
    next;
    }
  print "$tm: GLOBAL OK: $_";
  }</code></pre>

<p>I named this <code>floodtest.pl</code>.  The  of the test were: ("&gt;"
marks my input lines)</p>

<pre><code>cade@aenea:~$ ./floodtest.pl 
&gt; hello
Wed Feb 17 08:25:35 2004: LOCAL  OK: hello
Wed Feb 17 08:25:35 2004: GLOBAL OK: hello
&gt; hello
Wed Feb 17 08:25:38 2004: LOCAL  OK: hello
Wed Feb 17 08:25:38 2004: GLOBAL OK: hello
&gt; hello
WARNING: next event allowed in 5 seconds (LOCAL CHECK for 'hello')
&gt; bye
Wed Feb 17 08:25:43 2004: LOCAL  OK: bye
Wed Feb 17 08:25:43 2004: GLOBAL OK: bye
&gt; hello
Wed Feb 17 08:25:45 2004: LOCAL  OK: hello
Wed Feb 17 08:25:45 2004: GLOBAL OK: hello
&gt; see you
Wed Feb 17 08:25:48 2004: LOCAL  OK: see you
Wed Feb 17 08:25:48 2004: GLOBAL OK: see you
&gt; next time
Wed Feb 17 08:25:52 2004: LOCAL  OK: next time
WARNING: next event allowed in 43 seconds (GLOBAL CHECK)
&gt; one more try?
Wed Feb 17 08:26:09 2004: LOCAL  OK: one more try?
WARNING: next event allowed in 26 seconds (GLOBAL CHECK)
&gt; free again
Wed Feb 17 08:26:31 2004: LOCAL  OK: free again
WARNING: next event allowed in 4 seconds (GLOBAL CHECK)
&gt; free again
Wed Feb 17 08:26:42 2004: LOCAL  OK: free again
Wed Feb 17 08:26:42 2004: GLOBAL OK: free again</code></pre>

<p>You can see that I could not enter "hello" 3 times during the first 10
seconds but still I managed to enter one more "hello" a bit later (the 10-second flood had ended for the "hello" line) and 2 other lines before the
global flood check triggered (5 lines for 1 minute).  After 60 seconds,
<em>floodtest.pl</em> finally accepted my sixth line, "free again."</p>

<p>The next sections show how to use flood control in several applications.
These examples are not exhaustive but are very common, so they will work as
templates for other cases.</p>

<h3><a id="my_scores_please">My Scores Please?</a></h3>

<p>Imagine an IRC bot (robot) which can report scores from the local game servers. Generally this bot receives requests from someone inside IRC channel
(a chat room, for those of you who haven�t used IRC) and reports current
scores back to the channel. If this eventually becomes very popular, people
will start requesting scores more frequently than it is useful just for fun, so
there's a clear need for flood control.</p>

<p>I'd prefer to allow any user to request scores no more than twice per minute,
but at the same time I want to allow 10 requests total every two minutes:</p>

<pre><code>sub scores_request
{
    my $irc     = shift; # the IRC connection which I communicate over
                         # this is a Net::IRC::Connection object
    my $channel = shift; # the channel where "scores" are requested
    my $user    = shift; # the user who requested scores

    # next line means: do flood check for $user and if it is ok, then
    #                  check for global flood. this is usual Perl idiom.
    my $wait = flood_check( 2, 60, $user ) || flood_check( 10, 120, '*' );
    if( $wait ) # can be 0 or positive number so this check is simple
      {
      # oops flood detected, report this personally to the user
      $irc-&gt;notice( $user, "please wait $wait seconds" );
      }
    else
      {
      # it is ok, there is no flood, print scores back to the channel
      $irc-&gt;privmsg( $channel, get_scores() );
      }
}</code></pre>

<p>This code uses the <a
href="http://search.cpan.org/dist/Net-IRC">Net::IRC</a> module, so if you want
to know the details of the <code>notice()</code> and <code>privmsg()</code>
functions, check the module documentation.</p>

<p>This is good example of combining events, but it works correctly only if the
second flood ratio (in this case 10/120) is greater than first one (2/60).
Otherwise you should extend the <code>flood_check()</code> function with an
array of events to check in one loop, so if any of them fails the internal
storage will update. Perhaps <code>Algorithm::FloodControl</code> will have such a feature
in the future.</p>

<p>Another common case is to limit the execution of resource-consuming web
scripts (CGI).</p>

<h3><a id="_don_t__flood_the_page_">(Don't) Flood the Page!</a></h3>

<p>If you want to limit CGI-script execution you will hit a problem: you must
save and restore the flood-control internal data between script invocations.
For this reason the <code>Algorithm::FloodControl</code> module exports another function
called <code>flood_storage</code>, which can get or set the internal data.</p>

<p>In this example I'll use two other modules, <a
href="http://search.cpan.org/dist/Storable">Storable</a> and <a
href="http://search.cpan.org/dist/LockFile-Simple">LockFile::Simple</a>.  I use
the first to save and restore the flood-control data to and from disk files and
the second to lock this file to avoid corruptions if two or more instances of
the script run at the same time:</p>

<pre><code>#!/usr/bin/perl
use strict;
use Storable qw( store retrieve );
use LockFile::Simple qw( lock unlock );
use Algorithm::FloodControl;

# this is the file that should keep the flood data though /tmp is not
# the perfect place for it
my $flood_file = "/tmp/flood-cgi.dat";

# this is required so the web browser will know what is expected
print "Content-type: text/plain\n\n";

# I wanted to limit the script executions per remote IP so I have to
# read it from the web server environment
my $remote_ip = $ENV{'REMOTE_ADDR'};

# first of all--lock the flood file
lock( $flood_file );

# now read the flood data if flood file exists
my $FLOOD = retrieve( $flood_file ) if -r $flood_file;

# load flood data into the internal storage
flood_storage( $FLOOD ) if $FLOOD;

# do the actual flood check: max 5 times per minute for each IP
# this is the place where more checks can be done
my $wait = flood_check( 5, 60, "TEST_CGI:$remote_ip" );

# save hte internal data back to the disk
store( flood_storage(), $flood_file );

# and finally unlock the file
unlock( $flood_file );

if( $wait )
  {
  # report flood situation
  print "You have to wait $wait seconds before requesting this page again.\n";
  exit;
  }

# there is no flood, continue with the real work here
print "Hello, this is main script here, local time is:\n";
print scalar localtime;
print "\n...\n";</code></pre>

<p>There are various issues to consider, such as the save/restore method, time
required, and locking, but in any case the scheme will be similar.</p>

<h3><a id="beep__beep__beep___">Beep, Beep, Beep ...</a></h3>

<p>In this last example I'll describe a small program, a variation of which I
use for (email) SMS notifications. I wanted to avoid scanning large mail
directories so I made my email filter copy incoming messages into a
separate folder.  The program scans this copy folder every 10 minutes for new
messages. If there are any, it sends a notification for each one to my mobile
phone and removes the copy of the message.</p>

<pre><code>#!/usr/bin/perl
use strict;
use Algorithm::FloodControl;

our $MAIL_ROOT = '/home/cade/mail';
our @SCAN = ( 
              { # this is my personal mail, I'd like to be notified often
                FOLDER  =&gt; 'Personal2', # directory (mail folder) to scan
                FC      =&gt; 20,          # fixed event count
                FP      =&gt; 60*60,       # fixed time period, 1 hour
              }, 
              { # this is a mailing list, I don't need frequent notifications
                FOLDER  =&gt; 'AList2',    # directory (mail folder) to scan
                FC      =&gt; 3,           # fixed event count
                FP      =&gt; 20*60,       # fixed time period, 20 minutes
              }
            );
while(4)
  {
  process_folder( $_ ) for @SCAN;
  sleep(10*60); # sleep 10 minutes
  }

sub process_folder
{
  my $hr     = shift; # this is hash reference
  my $fc     = $hr-&gt;{ 'FC' };
  my $fp     = $hr-&gt;{ 'FP' };
  my $folder = $hr-&gt;{ 'FOLDER' };
  
  my @msg = glob "$MAIL_ROOT/$folder/*";
  return unless @msg; # no messages found
  for( @msg )
    {
    # there are new messages, so flood check is required
    my  $wait = flood_check( $fc, $fp, $folder );
    if( $wait )
      {
      # skip this pass if non-zero wait time is received for this folder
      print "FLOOD! $wait seconds required.\n";
      return;
      }
    send_sms( $folder, $_ );
    }
}

sub send_sms
{
  my $folder = shift;
  my $file   = shift;
  # implementation of this function is beyond the scope of this example
  # so I'll point just that it extracts subject line from the message file
  # and sends (over local sms gateway) text including folder name, time 
  # and subject
  unlink( $file );
  print "SMS: $folder, $file\n";
}</code></pre>

<p>As you can see, this code -- while implementing a totally different task -- has
exactly the same flood check as in the previous two examples.</p>

<h3><a id="conclusion">Conclusion</a></h3>

<p>I said in the beginning that flood control has a vast field of applications.
There are many cases where it is appropriate or even necessary. There is no
excuse to avoid such checks; implementing it is not hard at all.</p>




        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1026" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2004/11/p6pdigest/20041131.html" rel="bookmark">This Fortnight on Perl 6, October 2004 Part Two</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Matt Fowles</span> on <abbr class="published" title="2004-11-04T00:00:00-08:00">November  4, 2004 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            <h2>Perl 6 Summary for 2004-10-18 through 2004-10-23</h2>

<p>Last week, I received a request to summarize perl6-language before internals.
Frankly, it seems like a reasonable idea. Perl6-internals has always been first
as long as I can remember. So perhaps, it is time to switch it up.  Before I
start off with perl6-language, let me remind all American readers to vote.
Non-American readers should also vote, but it seems unlikely that your day of
voting is tomorrow (as I write this). So without further ado...</p>

<h3>Perl6 Language</h3>

<h4><a href="http://xrl.us/dndb">Packrat Parsing</a></h4>

<p>Thomas Sandlass posted a link to an article on Packrat Parsing. It looks
like a promising techinque for small programs, although its memory
requirements may be a bit heavy for large programs. Mr. Sandlass appears to
have been Warnocked, but there are several explanations. First, he posted from
Google; there has been trouble in the past about such things getting through.
Second, he posted to Perl6 Language instead of Perl6 Compiler.</p>

<h4><a href="http://xrl.us/drsq">Assorted Questions</a></h4>

<p>Rich Morin wanted to know two things. One, can he hook into function calls
and just about everything else for his evil purposes? Two, can he get floating
point values which automagically track their rounding errors?  Austin Hastings
pointed out that two would probably best be implemented as an opaque object
whose value is a junction. Luke Palmer demonstrated an evil way to embed
whatever hooks he wanted by adding an extra layer to the grammar. Somehow, I
worry that shooting myself in the foot with this would take most of my body
off...</p>

<h4><a href="http://xrl.us/drsr">Perl 6 Backwards Compatibility</a></h4>

<pre><code> U. Ruirarchzatrea expressed a desire for perfect backwards
compatibility to Perl 5 and a Ponie too.  Matthew Walton, Brent "Dax"
Royal-Gordon, and Luke Palmer all told him that he could have a Ponie, but it
would not be perfect.</code></pre>

<h3>Perl6 Compiler</h3>

<h4>Perl6 Compiler List Troubles</h4>

<p>In the last summary, I mentioned that Perl6 Compiler has not yet found its
way to Google groups. Leo seems to have had trouble subscribing to it also. Perhaps this bears investigation?  Does anyone know someone who can be
poked/prodded/pleaded with about this? End result: no links for you!</p>

<h4>Status Check?</h4>

<p>Ovid popped in to see if he could find more detailed status info about the
progress of P6C. Patrick Michaud provided a slightly unsatisfying answer of
"not much longer," and Luke Palmer provided a slightly more detailed answer,
which can be summarized as "not much longer."</p>
<csperl file="grab" domain="on" record="b/971" template="b/article_sidebar.view">
<h3>Parrot</h3>

<h4><a href="http://xrl.us/dndc">Unununium</a></h4>

<p>Dan and Steve Fink told Jacques Mony that a port to Unununium would probably
require substantial changes to <em>Configure</em>.</p>

<h4><a href="http://xrl.us/dndd">grsecurity Interfering with the Parrot
JIT/build</a></h4>

<p>Apparently, our current scheme of <code>mem_alloc_executable</code> and
<code>mem_free_executable</code> is not quite enough to make grsecurity happy.
Work is ongoing...</p>

<h4><a href="http://xrl.us/dnde"><em>signal.t</em> Failure</a></h4>

<p>Will Coleda had problems with <em>signal.t</em> failing while his machine
was under load. Leo pointed out that this is known behavior. Jeff Clites was a
little confused and disappointed that his earlier patches to help solve this
problem had not sufficed.</p>

<h4><a href="http://xrl.us/dndf">New Naming for
<code>parrot_interp</code></a></h4>

<p>Brent "Dax" Royal-Gordon warned everyone that he was committing a gianormous
change that would affect any pending patches.  From the lack of chaos on the
list, I would say that his warning worked.</p>

<h4><a href="http://xrl.us/dndg">Parrot Forth</a></h4>

<p>Michel Pelletier and Matt Diephouse discussed some of the finer points of
Forth implementations and optimizations.</p>

<h4>Win32 Update</h4>

<p>Ron Blaschke gave a quick update on his progress with VC7.1 on Win32.  Looks
good. Keep on chugging, Ron.</p>

<h4><a href="http://xrl.us/dndh">Downloading Parrot</a></h4>

<p>Jerry Wiltz asked if help in downloading Parrot [he was starting from
scratch (no Perl or C compiler)] on a WinXP box. Fred the LastNamelessOne
provided a plethora of useful links.</p>

<h4>
The Return of Register Stacks
</h4>

<p>Miroslav Silovic posted a summary of a design change that he and Leo were
considering. I asked for more details as to how it was different then something
we had moved away from much earlier. Leo provided quite a nice and thorough
explanation. Thanks. Dan observed that this recurring thread happened nearly
yearly, but that the cycle was not quite 12 months. Dan also observed that the
timing coinciding with his being sick was fortuitous. Leo and Dan went back
and forth for a while discussing the implementation and implications of it. I
believe that the end result is that we will have indirect access to registers;
we will not need to have <code>saveall</code>/<code>restoreall</code> pairs
around function calls; and Dan should eventually get better, but not until this
is fully thrashed out.</p>

<ul>

<li><a href="http://xrl.us/dndi">http://xrl.us/dndi</a></li>
<li><a href="http://xrl.us/dndj">http://xrl.us/dndj</a></li>
<li><a href="http://xrl.us/dndk">http://xrl.us/dndk</a></li>
<li><a href="http://xrl.us/dndm">http://xrl.us/dndm</a></li>
<li><a href="http://xrl.us/dndn">http://xrl.us/dndn</a></li>
</ul>

<h4>JIT Rework</h4>

<p>As a side effect of indirect access to registers, the JIT needs to be
rejiggered to account for this. Leo and Jeff Clites went back and forth working
on this with what sounds like good progress being made.</p>

<ul>
<li><a href="http://xrl.us/dndo">http://xrl.us/dndo</a></li>
<li><a href="http://xrl.us/dndp">http://xrl.us/dndp</a></li>
<li><a href="http://xrl.us/dndq">http://xrl.us/dndq</a></li>
</ul>

<h4><a href="http://xrl.us/dndr">Win32 <code>perlnum</code> Test Fix</a></h4>

<p>Ron Blaschke fixed a test failing because of <code>-0.0</code>. Leo applied
the patch.</p>

<h4><a href="http://xrl.us/dnds">x86-64 Problems Fix</a></h4>

<p>Brian Wheeler submitted a patch to fix x86-64. Leo couldn't apply it.  Brian
resubmitted. It got mangled on the way. Brian reresubmitted. Leo applied it.
Thanks for perservering, Brian!</p>

<h4><a href="http://xrl.us/dndt">External Dependencies</a></h4>

<p>Robert Spier suggested several options on how to simplify the problem of
Parrot and external dependencies. Sadly, Warnock applies.</p>

<h4>
mod_parrot
</h4>

<p>Jeff Horwitz is making amazing progress with his cybernetically enhanced
parrot. Oh wait, I mean embedding Parrot into Apache. It all looks really cool,
and he has been able to use his experience to provide valuable critiques to us
all.</p>

<ul>

<li><a href="http://xrl.us/dndu">http://xrl.us/dndu</a></li>

<li><a href="http://xrl.us/dndv">http://xrl.us/dndv</a></li>

</ul>

<h4><a href="http://xrl.us/dndw">Python, Parrot, and Scoping</a></h4>

<p>Sam Ruby has "been trying to make sense of Python's scoping in the
context of Parrot." Leo, Dan, and Allen Short all rushed to his aid.</p>

<h4><a href="http://xrl.us/dndx"><code>Resizable*Array</code>
Implementation</a></h4>

<p>Bernhard Schmalhofer wondered if the <code>Resizable*Arrays</code> should
use chunked allocation. Dan told him, "No, the motivation behind them is simple
and fast, thus the chunking would be unwanted overhead." He did mention that
they could do something clever (like chunking) if they got big enough.</p>

<h4><a href="http://xrl.us/dndy">Register Spilling</a></h4>

<p>In a flash of good news for Dan, Bill Coffman has started to put his mighty
brain to work on the register spilling code. He, Leo, and Jeff discussed
various aspects of it. I eagerly look forward to the results of getting Parrot
a really cool spilling algorithm (although probably not a eagerly as Dan
and his nasty pathological code ;-)</p>

<h4>
C89 Spec
</h4>

<p>Bill Coffman wondered if he could find the C89 spec so that he could ensure
his changes were compliant. Dan suggested using K&amp;R second edition.  Jeff
Clites pointed out the <code>-std=c89</code> flag for gcc. Michael G Schwern
suggested using C99 spec (which should also contain the C89 spec) as a
"frightening accessory this Halloween." Michael frightens me.</p>

<ul>

<li><a href="http://xrl.us/dndz">http://xrl.us/dndz</a></li>

<li><a href="http://xrl.us/dnd2">http://xrl.us/dnd2</a></li>

</ul>

<h4><a href="http://xrl.us/dnd3"><em>method_util.c</em></a></h4>

<p>Leo asked what the state of the functions in <em>src/method_util.c</em> is.
He got Warnocked. I would say that means they should get pitched and see what
happens.</p>

<h4><a href="http://xrl.us/dnd4"><code>.include 'absolute path'</code></a></h4>

<p>Matthias Huerlemann created a patch allowing absolute paths in <code>.include</code>
statements. Leo responed that the implementation was not quite right, but the
format of the patch was good.</p>

<h4><a href="http://xrl.us/dnd5">ICU + Red Hat == Pain</a></h4>

<p>Joshua Gatcomb had a fairly long conversation with himself fleshing out a
problem with ICU on Red Hat. Leo broke into his monologue to say that it seemed
Red Hat specific.</p>

<h4><a href="http://xrl.us/dnd6">Strange Segfault Involving String
Concat</a></h4>

<p>Matthias Hoelzl has a fairly hard-to-pin-down segfault. Leo suggested trying
to use <code>parrot -G</code>, <code>--gc-debug</code>, and <code>-t</code> to
track it down. No response yet.</p>

<h4><a href="http://xrl.us/dnd7">pmccache</a></h4>

<p>Leo suggested a small Perl task of making something akin to ccache for PMCs.
Jeff Clites jumped on it.</p>

<h4><a href="http://xrl.us/dnd8">Befunge Shall Live Again!!</a></h4>

<p>Stepan Roh fixed somethings with the Befunge interpreter while simultaneously
accusing befunge of being unimportant.  Jerome applied some of those fixes and
admonished Stepan for saying such things.  I remember a time when Befunge
fleshed out many troublesome bugs in Parrot, and I forsee a future when Befunge
will be included in webservers everywhere through the magic of mod_parrot!</p>

<h4><a href="http://xrl.us/drss">Siva, the multifaceted PMC</a></h4>

<p>St&eacute;phane Payrard asked about some problems he had encountered
creating the magical all-in-one Siva PMC. Leo provided a helpful prod towards
<code>LVALUE_CAST</code>. The other problems may or may not related to the
Mandrake Cooker. Hopefully, someone will tell us.</p>

<h4><a href="http://xrl.us/drst">JITted Functions Calling External
Functions</a></h4>

<p>Leo reported that, thanks to Jeff, one can now call into Parrot functions
from JIT. Yay!</p>

<h4><a href="http://xrl.us/drsu"><code>make testexec</code></a></h4>

<p>Currently, <code>make testexec</code> will create and run a trivial "hello
world" program for the exec core. Leo would like it to run the full test suite
instead. This is a big thing but would probably win you many friends and even
influence people.</p>

<h4>
Calling Conventions and Indirect Register Access
</h4>

<p>Leo provided several warnings that he was going to make some big changes
that would break any code that did not follow the calling conventions. He went
on to implement and commit a whole lot of stuff. I was impressed, and Dan later
wondered if it was all done or not (as he wants to make some big changes soon).
Apparently, it is for the most part.</p>

<ul>

<li><a href="http://xrl.us/drsv">http://xrl.us/drsv</a></li>

<li><a href="http://xrl.us/drsw">http://xrl.us/drsw</a></li>

<li><a href="http://xrl.us/drsx">http://xrl.us/drsx</a></li>

<li><a href="http://xrl.us/drsy">http://xrl.us/drsy</a></li>

<li><a href="http://xrl.us/drsz">http://xrl.us/drsz</a></li>

<li><a href="http://xrl.us/drs2">http://xrl.us/drs2</a></li>

</ul>

<h4><a href="http://xrl.us/drs3">Stalk Walking Bug</a></h4>

<p>Nicholas Clark, with Leo's help, found a bug in the stalk walking code.
Apparrently, our mask for valid pointers was a little overzealous.  Nicholas
checked in a quick fix. Steve Fink has a few suggestions.</p>

<h4>Register Allocation</h4>

<p>Bill Coffman is continuing his amazing work with register allocation. He has
been making strong progress, and his new code is fast approaching production-ready. Unfortunately for Dan, it still has a few rough points and a small
memory leak preventing it from being used on Dan's evil code.  Leo has been
helping him along the entire time, and I predict that all of Bill's work will
find its way into Parrot before the next summary.</p>

<ul>

<li><a href="http://xrl.us/drs4">http://xrl.us/drs4</a></li>

<li><a href="http://xrl.us/drs5">http://xrl.us/drs5</a></li>

</ul>

<h4><a href="http://xrl.us/drs7">libjit</a></h4>

<p>Robert Spier pointed out the fairly nifty <a
href="http://xrl.us/drs6">libjit</a>. Unfortunately, according to Leo, the
current jit is far enough along that it would be too much work to switch. I
tend to believe him.</p>

<h4><a href="http://xrl.us/drs8">Looking for a Hardware Donation</a></h4>

<p>H. Merijn Brand reminded Leo that he hadn't been contacted yet about some
"Diana" menthol alcohol. I was confused, but apparently Leo wasn't...</p>

<h4><a href="http://xrl.us/drs9">PMC/inode analogy</a></h4>

<p>St&eacute;phane Payrard wanted to know if his analogy between pmcs and filesystems
was correct. Leo felt that it was mostly right and attempted to explain the 
value/variable split. Dan corrected Leo and went a little further.  What I have
taken away from this is: "do not think of it in terms of high level language
operators, instead think of it in terms of C. You get pointers and values (and
you can point to a value). Some things do shallow copies (i.e. pointer copies)
others do deep."</p>

<h4><a href="http://xrl.us/drta"><code>pmc_type</code></a></h4>

<p>Nicholas Clark wanted to know what a <code>pcm_type</code> of 0 means. The
answer: no such type. This led to St&eacute;phane Payrard asking about pmc_type values
for abstract types. They don't get types because they can't be directly
instantiated. This led Paolo Molaro to wonder about the virtue of having a
system closer to C++ with array lookup for virtual functions. Nicholas, Leo,
and Paolo banged on this for awhile and decided that there was some room for
optimization. Leo scares me when he optimizes...</p>

<h4><a href="http://xrl.us/drtb"><em>extend.c</em>:
<code>Parrot_call</code></a></h4>

<p>Leo was bothered by the fact that <code>Parrot_call</code> only supported
void return values.  Much to Jeff Horwitz's joy, he fixed it.</p>

<h4><a href="http://xrl.us/drtc">Computed Goto Destroyer of Weak
Machines!!!</a></h4>

<p>Vijay D. though that parrot was failing to install when it "hung" while
compiling the computed goto cores. Nick Glencross, Leo, Dan, Peter Sinnott, and
Joshua Gatcomb all helped out, explaining that cg is really hard on one's system
and can be disabled with the <code>--cgoto=0</code> flag to
<em>Configure.pl</em>.</p>

<h4><a href="http://xrl.us/drtd">Byte Code</a></h4>

<p>Peter Hickman wanted to know if Perl 6 would be able to be distributed in
bytecode. The answer is yes, but this won't help you hide your source, as that
will frequently be necessary meta-data. It will, however, speed up your
compilation and even allow mmap of the bytecode to share between threads.</p>

<h4><a href="http://xrl.us/drte">Pirate/Python</a></h4>

<p>Sam Ruby has continued his work on Python and is making good progress.  He
was a little concerned about the speed issues of converting everything to
dynclasses. He and Leo talked out some alternatives. Things are looking
promising.</p>

<h4><a href="http://xrl.us/drtf">Threading Issues</a></h4>

<p>Sam Ruby wanted to know about possible threading issues. Leo requested that
they let the sleeping giant lie for a while longer.</p>

<h4><a href="http://xrl.us/drtg"><code>.include "../relative
path"</code></a></h4>

<p>Matt Diephouse added a todo item for <code>.include</code>ing with relative
paths.  Takers welcome.</p>

<h4><a href="http://xrl.us/drth">Array Fun</a></h4>

<p>Bernhard Schmalhofer added a few benchmarks for the various array PMCs.
Leo applied the patch.</p>

<h4><a href="http://xrl.us/drti">Prederefed Run Cores</a></h4>

<p>Leo had some concerns about the prederef run cores. Dan suggested pitching
them, but Leo opted to fix them instead. Some discussion of their relative
values ensued, and then someone started using assembly to support a point and my
head exploded.</p>

<h4><a href="http://xrl.us/drtj">Parakeet in CVS</a></h4>

<p>Michel Pelletier has finally gotten himself a perl.org account. The idea is
that this would allow him to maintain Parakeet in CVS. Unfortunately, Warnock
applies.</p>

<h4><a href="http://xrl.us/drtk">GC Crash</a></h4>

<p>Matt Diephouse found a way to make Parrot's GC crash. Leo fixed it with
alacrity.</p>

<h4><a href="http://xrl.us/drtm">PPC JIT failure</a></h4>

<p>Jeff Clites found and fixed a bug in the grow-the-arena threshold for JIT.
Leo seemed to feel that Jeff's solution was only a temporary one.</p>

<h4><a href="http://xrl.us/drtn">AIX PPC JIT warning</a></h4>

<p>Jeff Clites voiced some concern over the state of JIT on AIX. Adam Thomason
told him, "Worry not, it's already broken."</p>

<h4><a href="http://xrl.us/drto">Call Chain Access</a></h4>

<p>Appropriately, Leo found himself playing with chains around Halloween.  He
wondered if the call chain should have a PMC wrapper. Dan figured not, as ops
which do evil things would be unlikely to be invoked accidentally, whereas a
PMC might...</p>

<h4>
newsub opcodes
</h4>

<p>Leo wanted to add some newsub opcodes to save allocations. Dan countered
that it would be a better thing to make constant PMCs work properly.  Leo
did.</p>

<ul>

<li><a href="http://xrl.us/drtp">http://xrl.us/drtp</a></li>

<li><a href="http://xrl.us/drtq">http://xrl.us/drtq</a></li>

<li><a href="http://xrl.us/drtr">http://xrl.us/drtr</a></li>

</ul>

<h4><a href="http://xrl.us/drts"><em>pmc2c2.pm</em> features</a></h4>

<p>Leo suggested a couple of extra features that he wanted in <em>pmc2c2.pm</em>.
Sam Ruby supplied them.</p>

<h4><a href="http://xrl.us/drtt">Build Dynclasses by Default</a></h4>

<p>Will Coleda provided a patch to build dynclasses by default. Leo is stalling
before applying it, hoping to hear from other platforms. Now would be a great
time to chime in... ::cricket noises:::</p>

<h4><a href="http://xrl.us/drtu">Warnings for Duplicate Vars</a></h4>

<p>IMCC currently doesn't produce them. Will Coleda supplied a naive
attempt at this, but Leo decided it would be better to do it the elegant
way and split the PASM and PIR lexers/parsers apart.</p>

<h4><a href="http://xrl.us/drtv">Parrot on AMD64</a></h4>

<p>Brent "Dax" Royal-Gordon managed to find an AMD64 for himself. Not only am I
jealous, but Parrot passes all expected tests on it when built with
<code>--ccflags=':add{ -fPIC }</code>.</p>

<h4><a href="http://xrl.us/drtw">dynopslib Troubles</a></h4>

<p>Klaas-Jan discovered that dynopslib was failing. Leo concurred and asked
for patches.</p>

<h4><a href="http://xrl.us/drtx">makefile bad <code>$(TOUCH)</code></a></h4>

<p>Jeff Clites noticed that <em>Makefile</em>'s <code>$(TOUCH)</code> does not
actually work on many platforms and suggested a solution. Michael G. Schwern
suggested using <a
href="http://search.cpan.org/dist/ExtUtils-Command">ExtUtils::Command</a>
instead. Who knows what will finally happen?</p>

<h4><a href="http://xrl.us/drty">Debug ops</a></h4>

<p>Dan wondered about adding some ops for debugging parrot code. The response
was favorable and enthusiastic.</p>

<h4><a href="http://xrl.us/drtz"><code>parrot -t</code> Massive Leaks</a></h4>

<p>Dan noticed that <code>parrot -t</code> leaks more memory then most cheap
computers have.</p>

<h4><a href="http://xrl.us/drt2">hash vtable</a></h4>

<p>Sam Ruby wondered about adding a hash vtable method for Python's benefit.
Dan seemed to think it was a good idea.</p>

<h4><a href="http://xrl.us/drt3">disassembler broken</a></h4>

<p>Matt Diephouse noticed that the dissambler was broken. Dan pointed out that
he was testing it wrong, but Matt soon discovered that it didn't work even if
he tested it right.</p>

<h4>
Shebangs for Everybody
</h4>

<p>James deBoer provided a patch adding shebang lines to <em>config/*.pl</em>.
Brent "Dax" Royal-Gordon reasoned that these were unnessecary as these scripts
should only be run by <em>Configure.pl</em>. James countered by offering a
patch removing all of the shebang lines from the other ones. I like his
style.</p>

<ul>

<li><a href="http://xrl.us/drt4">http://xrl.us/drt4</a></li>

<li><a href="http://xrl.us/drt5">http://xrl.us/drt4</a></li>

</ul>

<h3>The Usual Footer</h3>

<p>If you find these summaries useful or enjoyable, please consider
contributing to the Perl Foundation to help support the development of Perl.
You might also like to send feedback to <a
href="mailto:ubermatt@gmail.com">ubermatt@gmail.com</a>.</p>

<ul>

<li><a href="http://donate.perl-foundation.org/">The Perl Foundation</a></li>
<li><a href="http://dev.perl.org/perl6/">Perl 6 Development site</a></li>
<li><a href="http://planet.parrotcode.org/">Parrot Blog aggregator</a></li>

</ul>



        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-1014" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2004/11/04/komodo3.html" rel="bookmark">Komodo 3.0 Review</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Jason Purdy</span> on <abbr class="published" title="2004-11-04T00:00:00-08:00">November  4, 2004 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            <p>There are several different types of programmers, but I would wager that the
vast majority are just like me: their mouse is a crucial input extension, and
having an environment that supports the task at hand makes coding easier and,
dare I say, more fun. This is where a GUI IDE (Integrated Development
Environment) can help, with syntax highlighting, project management, code
completion, reference documentation, support tools, and being able to use your
mouse to place your cursor or to select a particular segment of code.</p>

<p>I'm a GUI IDE kind of guy, and I've been through quite a few of them to find
the one that best suits me as a Perl Web Developer. ActiveState's <a
href="http://www.activestate.com/Products/Komodo">Komodo</a> (version 3.0.1)
fits the bill, though there remains room for improvement. Let's start with the
positive, and then I'll address where Komodo can improve.</p>

<h3>Pluses</h3>

<p>The last time that <a
href="/pub/a/2002/10/09/komodo.html">Perl.com reviewed
Komodo</a> was October 2002.  At that time, Komodo was at version 2.0, which
was slow and whose functionality seemed only halfway implemented.  It showed
promise then and has made huge leaps in subsequent versions to overcome the
major failings, with speed increases, functionality improvements, and adding
even more features.</p>

<p>My first criteria for any editor is (accurate) syntax highlighting.  All
editors have this to some extent, but when you throw some wacky Perl stuff
their way (heredocs, for example), they start to choke and mislead you. Komodo
has handled everything I've thrown at it flawlessly and has a neat preferences
panel where you can customize the color scheme with your own flair (or some
might say lack thereof when they see my screen).</p>

<p>Another important feature for an IDE is project management, a way to group a
list of files relevant to the project you're working on in an easy-to-access
fashion.  Komodo has a Projects tab, through which you can do pretty much
anything in that regard; it even includes a powerful Import from File System that'll
help you set up a project in no time. Also, within that same tab is a Code
Explorer, which will parse and index the open file for subroutines</p>
<csperl file="grab" domain="on" record="b/936" template="b/article_sidebar.view">

<p>Simon referred to Komodo's Toolbox in the previous review, and that's
certainly been a great feature for me. I've setup some tools, such as PerlTidy,
to run on an open file. Then, when I open a messy file, I can just double-click
on that tool, and it'll clean up the file. I also have other tools to insert
standard snippets of HTML and HTML::Template code. Snippets are really cool
because you can set the cursor placement after you've inserted the snippet, as
well as maintain the indentation styles. You can also assign Key Bindings to
pretty much anything, including the tools. When I hit Ctrl-1, the editor will
insert this:</p>

<pre><code>&lt;!-- TMPL_VAR NAME="" --&gt;</code></pre>

<p>into my code and put the cursor right there in the <code>NAME</code>
parameter, so I can keep typing. I've included some instructions after the
review below to show you how to set these up.</p>

<p>Simon also referred to the Rx Toolkit, which is still available and great to
use to play around with regular expressions and figure out how they will work.
Version 3.0 brings vast improvements to the Rx Toolkit, with different modes
for Match, Match All (for multiline text to match against), Split, and
Replace/Replace All. This tool is indispensable for those who are tinkering
with a regular expression and trying to figure things out.  ActiveState went a
step further and added a Perl Interactive Shell that allows you to type or paste
in lines of code and play around.  This has been useful for me when figuring
out data structures and how to access deeply-nested data.</p>

<p>Komodo also supports CVS [and Perforce (version control)], such that within
the IDE, you can perform versioning functionality (diff, commit, checkout,
etc). It will also monitor the files and repository so that if there are any
changes, the files' indicator will change accordingly, keeping you aware of
what's going on. You can also setup the CVS remotely over SSH to interact with
a remote repository securely.</p>

<p>I feel like I've barely scratched the surface with what Komodo can do, both
in this review as well as my personal experience with the IDE. Komodo has a
powerful debugger, which in an IDE setting is a great way to visualize your
code executing, with the line of code in one window and a tab with call stacks,
output, watched variables (that you can change midstream if you like),
breakpoints, and more. Komodo presents complex watched variables in a nested
tree format, allowing you to expand elements of hashes and arrays to go through the
data. Komodo also supports remote debugging, allowing you to debug a remote
console script or web application right inside Komodo, stepping in and out of
code and watching variables right off the remote server. Personally, I could
never make this work (despite ActiveState Technical Support's best efforts),
but I haven't had the need for it in the first place.</p>

<p>Komodo also supports different languages besides Perl, such as HTML, PHP,
Python, and XML (including syntax highlighting support for 30 other languages).
I do dabble in PHP from time to time, so Komodo gives me a one-stop IDE to
handle that, too. I can also incorporate all of these file types into one
project for easy access.</p>

<p>Just as the power of Perl comes from its community, ActiveState also extends
a sense of community with Komodo, with <a
href="http://aspn.activestate.com/ASPN">ASPN</a>, a portal of sorts that
encompasses mailing lists, documentation, cookbooks (code recipes), and a
bugzilla. With an ActivePerl Pro Studio subscription, ASPN also integrates with
Safari, such that you can search and read over 1,000 technical books from
O'Reilly, Addison Wesley, and other publishers.</p>

<p>Komodo installs a ton of helpful documentation and tutorials locally.  You
can easily pull up the documentation for a specific function/module by
highlighting it and hitting Shift-F1 (which does a Google search on perldoc.com
for the highlighted string) or Ctrl-F1 (which does a Google search on any site
for the highlighted string). Komodo also comes with some sample tools in the
Toolbox (that you could bind to another key combination) to run
<code>perldoc</code> locally on the highlighted function or module.</p>

<p>ActiveState is also working on a new point release that will bring
AutoComplete and CallTips to the Perl language, which will provide even more
efficiency to coding and reference documentation. This next release will also
address a few bugs (some of which I address below) and reinforces their
dedication to responding to our feedback and pushing for even more
functionality.</p>

<h3>Minuses</h3>

<p>Komodo 3.0 has a few hiccups and flaws, though. It seems the winds of
version control have shifted to something called Subversion.  The IDE doesn't
directly support it, though you could certainly create supporting tools in the
Toolbox. As I said earlier, I also had problems with Remote Debugging, though
it was never a high-enough priority for me to figure out what was going on.
Komodo also allows you to access files through FTP, but not SCP/SSH, which is
more secure and becoming the standard for accessing remote files.</p>

<p>Also, when Komodo went from 2.5.2 to 3.0, they moved the Toolbox from a tab
in the Projects Tab to a tab of its own, which kind of annoys me because it
eats into my precious screen real estate. It would be nice to be able to
customize the placements of the various tabs and what they contain. Komodo also
doesn't support code descriptions in the Code Browser for Perl (they do for PHP
and Python), though that may change, hopefully with the next release.</p>

<p>Lastly, there seem to be quite a few minor GUI flaws. There's nothing major
to prevent you from doing your work; the flaws are things like double-clicking on a
subroutine name in the Code Browser goes to the line, but in a huge Perl file, it
doesn't center on the screen (you may have to scroll a bit) and more seldom,
doesn't go to the right line (the start of the subroutine).  I also had a
problem with copy and pasting stuff in a line-wrapped code that would then
appear as if I have lost code.  Reflowing the paragraphs sometimes doesn't work
 (it would reflow more narrowly than it should have). When I ran the PerlTidy
tool on my open file, I wouldn't see the "File Changed on Disk" alert until I
Alt-Tabbed to another application and then Alt-Tabbed back.</p>

<h3>Conclusion</h3>

<p>The great thing about ActiveState is that their developers and technical
support use their mailing lists and a Bugzilla to interact with the feedback
and to track down these types of flaws and address them.</p>

<p>At the risk of sounding like a fanboy, ActiveState's Komodo is an amazing
platform, surrounding you with the power to accomplish any Perl task at hand.
Despite its negative points, they aren't enough to overcome the benefits it
brings to the table, and I highly recommend it for Perl programmers of any
variety. Komodo is available for Windows, Linux, and Solaris.  Prices start at
$29.95 for the personal edition (non-commercial/educational use) and $295 for
the professional edition. Subscriptions, upgrade pricing, and a free 21-day
fully-functional edition are also available off of their web site.</p>

<h3>Toolbox Setup Instructions</h3>

<p><u>To setup PerlTidy</u>:</p>

<ol>

<li>Make sure you have Perl and PerlTidy installed. For Windows, grab the
ActivePerl distribution from ActiveState and then download and install the <a
href="http://perltidy.sourceforge.net/">PerlTidy</a> script from
SourceForge.</li>

<li>In your toolbox tab, click the Add Item button at the top; then select New
Command.</li>

<li><p>The cursor starts off in the Command line, which you
can specify as:</p>

<pre><code>perl c:\path\to\perltidy -b [perltidy style prefs] %f</code></pre>

<p><em>(<code>-b</code> specifies to tidy the file in place, making a
<em>.bak</em> backup file.)</em></p></li>

<li>In the advanced section, put <code>%D</code> in the Start field to
launch PerlTidy in the script's working directory.</li>

<li>Rename the Command to PerlTidy in the field at the top.</li>

<li>At this point, you can also go to the Key Binding tab and assign a key
combination to run the command.</li>

<li> Save, open a Perl file and give it a shot, either using the key
combination you assigned or by double clicking on the command from your
Toolbox.</li>

</ol>

<p><u>To setup a snippet, such as the HTML::Template tag:</u></p>

<ol>

<li> In your toolbox tab, click the Add Item button at the top, and then select New
Snippet.</li>

<li><p>Type in the text to insert when you run the snippet.  In my case, I
used:</p>

<pre><code>&lt;!-- TMPL_VAR NAME="" ESCAPE=HTML --&gt;</code></pre></li>

<li>Be sure to place the cursor between the quote marks and select the
Maintain selected text or cursor position after insertion checkbox.</li>

<li>Name the snippet (I used <code>tmplvar</code>) at the top. You can also go
to the Key Binding tab at the top and assign a key combination to run the
snippet.</li>

<li>Save and then give it a shot, either using the key combination you assigned
or by double clicking on the command from your Toolbox.</li>

</ol>





        </div>



    </div>
    <div class="asset-footer"></div>
</div>




                            <div class="content-nav">
                                <a href="/pub/2004/10/">&laquo; October 2004</a> |
                                <a href="/pub/">Main Index</a> |
                                <a href="/pub/archives.html">Archives</a>
                                | <a href="/pub/2004/12/">December 2004 &raquo;</a>
                            </div>


                        </div>
                    </div>


                    <div id="beta">
    <div id="beta-inner">


    
    <div class="widget-what-is-perl widget">
    <div class="widget-content widget-content-what-is-perl">
       Visit the home of the  Perl programming language: <a href="http://www.perl.org/">Perl.org</a
    </div>
</div>
<div class="widget-find-out-more widget-archives widget">
    <div class="widget-content">
        <ul>
            <li><a href="http://www.perl.org/get.html">Download</a></li>
            <li><a href="http://perldoc.perl.org/">Documentation</a></li>
            <li><a href="http://blogs.perl.org/">Perl Bloggers</a></li>
            <li><a href="http://news.perlfoundation.org/">Foundation News</a></li>
        </ul>
    </div>
</div><div class="widget-tcpc widget">
<h3 class="widget-header">Sponsored by</h3>
    <div class="widget-content">
        <a href="http://training.perl.com/" alt="Perl Training" target="_blank"><img src="/i/tcpc.png" width="150" height="50"></a>
    </div>
</div>

<div class="widget-syndication widget">
    <div class="widget-content">
        <ul>
            <li><img src="/mt-static/images/status_icons/feed.gif" alt="Subscribe to feed" width="9" height="9" /> <a href="/pub/atom.xml">Subscribe to this website's feed</a></li>

        </ul>
    </div>
</div>
<div class="widget-archive-monthly widget-archive widget">
    <h3 class="widget-header">Monthly <a href="/pub/archives.html">Archives</a></h3>
    <div class="widget-content">
        <ul>
        
            <li><a href="/pub/2014/02/">February 2014 (1)</a></li>
        
    
        
            <li><a href="/pub/2014/01/">January 2014 (1)</a></li>
        
    
        
            <li><a href="/pub/2013/10/">October 2013 (1)</a></li>
        
    
        
            <li><a href="/pub/2013/01/">January 2013 (1)</a></li>
        
    
        
            <li><a href="/pub/2012/12/">December 2012 (1)</a></li>
        
    
        
            <li><a href="/pub/2012/11/">November 2012 (1)</a></li>
        
    
        
            <li><a href="/pub/2012/10/">October 2012 (2)</a></li>
        
    
        
            <li><a href="/pub/2012/08/">August 2012 (2)</a></li>
        
    
        
            <li><a href="/pub/2012/06/">June 2012 (11)</a></li>
        
    
        
            <li><a href="/pub/2012/05/">May 2012 (18)</a></li>
        
    
        
            <li><a href="/pub/2012/04/">April 2012 (17)</a></li>
        
    
        
            <li><a href="/pub/2012/02/">February 2012 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/12/">December 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/09/">September 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/08/">August 2011 (2)</a></li>
        
    
        
            <li><a href="/pub/2011/06/">June 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/05/">May 2011 (3)</a></li>
        
    
        
            <li><a href="/pub/2011/04/">April 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/03/">March 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/02/">February 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/01/">January 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2010/11/">November 2010 (1)</a></li>
        
    
        
            <li><a href="/pub/2010/10/">October 2010 (2)</a></li>
        
    
        
            <li><a href="/pub/2010/09/">September 2010 (1)</a></li>
        
    
        
            <li><a href="/pub/2010/08/">August 2010 (3)</a></li>
        
    
        
            <li><a href="/pub/2010/07/">July 2010 (2)</a></li>
        
    
        
            <li><a href="/pub/2010/04/">April 2010 (2)</a></li>
        
    
        
            <li><a href="/pub/2010/03/">March 2010 (4)</a></li>
        
    
        
            <li><a href="/pub/2008/05/">May 2008 (1)</a></li>
        
    
        
            <li><a href="/pub/2008/04/">April 2008 (2)</a></li>
        
    
        
            <li><a href="/pub/2008/03/">March 2008 (1)</a></li>
        
    
        
            <li><a href="/pub/2008/02/">February 2008 (1)</a></li>
        
    
        
            <li><a href="/pub/2008/01/">January 2008 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/12/">December 2007 (2)</a></li>
        
    
        
            <li><a href="/pub/2007/09/">September 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/08/">August 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/07/">July 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/06/">June 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/05/">May 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/04/">April 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/03/">March 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/02/">February 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/01/">January 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/12/">December 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/11/">November 2006 (2)</a></li>
        
    
        
            <li><a href="/pub/2006/10/">October 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/09/">September 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/08/">August 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/07/">July 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/06/">June 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/05/">May 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/04/">April 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/03/">March 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/02/">February 2006 (4)</a></li>
        
    
        
            <li><a href="/pub/2006/01/">January 2006 (4)</a></li>
        
    
        
            <li><a href="/pub/2005/12/">December 2005 (4)</a></li>
        
    
        
            <li><a href="/pub/2005/11/">November 2005 (3)</a></li>
        
    
        
            <li><a href="/pub/2005/10/">October 2005 (2)</a></li>
        
    
        
            <li><a href="/pub/2005/09/">September 2005 (2)</a></li>
        
    
        
            <li><a href="/pub/2005/08/">August 2005 (9)</a></li>
        
    
        
            <li><a href="/pub/2005/07/">July 2005 (8)</a></li>
        
    
        
            <li><a href="/pub/2005/06/">June 2005 (9)</a></li>
        
    
        
            <li><a href="/pub/2005/05/">May 2005 (8)</a></li>
        
    
        
            <li><a href="/pub/2005/04/">April 2005 (7)</a></li>
        
    
        
            <li><a href="/pub/2005/03/">March 2005 (6)</a></li>
        
    
        
            <li><a href="/pub/2005/02/">February 2005 (7)</a></li>
        
    
        
            <li><a href="/pub/2005/01/">January 2005 (6)</a></li>
        
    
        
            <li><a href="/pub/2004/12/">December 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/11/">November 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/10/">October 2004 (5)</a></li>
        
    
        
            <li><a href="/pub/2004/09/">September 2004 (9)</a></li>
        
    
        
            <li><a href="/pub/2004/08/">August 2004 (6)</a></li>
        
    
        
            <li><a href="/pub/2004/07/">July 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/06/">June 2004 (6)</a></li>
        
    
        
            <li><a href="/pub/2004/05/">May 2004 (7)</a></li>
        
    
        
            <li><a href="/pub/2004/04/">April 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/03/">March 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/02/">February 2004 (9)</a></li>
        
    
        
            <li><a href="/pub/2004/01/">January 2004 (7)</a></li>
        
    
        
            <li><a href="/pub/2003/12/">December 2003 (4)</a></li>
        
    
        
            <li><a href="/pub/2003/11/">November 2003 (7)</a></li>
        
    
        
            <li><a href="/pub/2003/10/">October 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2003/09/">September 2003 (6)</a></li>
        
    
        
            <li><a href="/pub/2003/08/">August 2003 (7)</a></li>
        
    
        
            <li><a href="/pub/2003/07/">July 2003 (9)</a></li>
        
    
        
            <li><a href="/pub/2003/06/">June 2003 (9)</a></li>
        
    
        
            <li><a href="/pub/2003/05/">May 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2003/04/">April 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2003/03/">March 2003 (10)</a></li>
        
    
        
            <li><a href="/pub/2003/02/">February 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2003/01/">January 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2002/12/">December 2002 (5)</a></li>
        
    
        
            <li><a href="/pub/2002/11/">November 2002 (9)</a></li>
        
    
        
            <li><a href="/pub/2002/10/">October 2002 (7)</a></li>
        
    
        
            <li><a href="/pub/2002/09/">September 2002 (11)</a></li>
        
    
        
            <li><a href="/pub/2002/08/">August 2002 (8)</a></li>
        
    
        
            <li><a href="/pub/2002/07/">July 2002 (8)</a></li>
        
    
        
            <li><a href="/pub/2002/06/">June 2002 (4)</a></li>
        
    
        
            <li><a href="/pub/2002/05/">May 2002 (6)</a></li>
        
    
        
            <li><a href="/pub/2002/04/">April 2002 (6)</a></li>
        
    
        
            <li><a href="/pub/2002/03/">March 2002 (7)</a></li>
        
    
        
            <li><a href="/pub/2002/02/">February 2002 (5)</a></li>
        
    
        
            <li><a href="/pub/2002/01/">January 2002 (8)</a></li>
        
    
        
            <li><a href="/pub/2001/12/">December 2001 (7)</a></li>
        
    
        
            <li><a href="/pub/2001/11/">November 2001 (5)</a></li>
        
    
        
            <li><a href="/pub/2001/10/">October 2001 (9)</a></li>
        
    
        
            <li><a href="/pub/2001/09/">September 2001 (7)</a></li>
        
    
        
            <li><a href="/pub/2001/08/">August 2001 (13)</a></li>
        
    
        
            <li><a href="/pub/2001/07/">July 2001 (8)</a></li>
        
    
        
            <li><a href="/pub/2001/06/">June 2001 (13)</a></li>
        
    
        
            <li><a href="/pub/2001/05/">May 2001 (11)</a></li>
        
    
        
            <li><a href="/pub/2001/04/">April 2001 (9)</a></li>
        
    
        
            <li><a href="/pub/2001/03/">March 2001 (8)</a></li>
        
    
        
            <li><a href="/pub/2001/02/">February 2001 (8)</a></li>
        
    
        
            <li><a href="/pub/2001/01/">January 2001 (8)</a></li>
        
    
        
            <li><a href="/pub/2000/12/">December 2000 (6)</a></li>
        
    
        
            <li><a href="/pub/2000/11/">November 2000 (10)</a></li>
        
    
        
            <li><a href="/pub/2000/10/">October 2000 (10)</a></li>
        
    
        
            <li><a href="/pub/2000/09/">September 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/2000/08/">August 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/2000/07/">July 2000 (5)</a></li>
        
    
        
            <li><a href="/pub/2000/06/">June 2000 (7)</a></li>
        
    
        
            <li><a href="/pub/2000/05/">May 2000 (7)</a></li>
        
    
        
            <li><a href="/pub/2000/04/">April 2000 (3)</a></li>
        
    
        
            <li><a href="/pub/2000/03/">March 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/2000/02/">February 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/2000/01/">January 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/1999/12/">December 1999 (6)</a></li>
        
    
        
            <li><a href="/pub/1999/11/">November 1999 (6)</a></li>
        
    
        
            <li><a href="/pub/1999/10/">October 1999 (5)</a></li>
        
    
        
            <li><a href="/pub/1999/09/">September 1999 (4)</a></li>
        
    
        
            <li><a href="/pub/1999/08/">August 1999 (3)</a></li>
        
    
        
            <li><a href="/pub/1999/07/">July 1999 (2)</a></li>
        
    
        
            <li><a href="/pub/1999/06/">June 1999 (3)</a></li>
        
    
        
            <li><a href="/pub/1999/04/">April 1999 (1)</a></li>
        
    
        
            <li><a href="/pub/1999/03/">March 1999 (1)</a></li>
        
    
        
            <li><a href="/pub/1999/01/">January 1999 (1)</a></li>
        
    
        
            <li><a href="/pub/1998/12/">December 1998 (1)</a></li>
        
    
        
            <li><a href="/pub/1998/11/">November 1998 (1)</a></li>
        
    
        
            <li><a href="/pub/1998/07/">July 1998 (2)</a></li>
        
    
        
            <li><a href="/pub/1998/06/">June 1998 (1)</a></li>
        
    
        
            <li><a href="/pub/1998/03/">March 1998 (1)</a></li>
        
        </ul>
    </div>
</div>
        
    

<div class="widget-powered widget">
    <div class="widget-content">
        <a href="http://www.movabletype.com/"><img src="/mt-static/images/bug-pbmt-white.png" alt="Powered by Movable Type 5.13-en" width="120" height="75" /></a>
    </div>
</div>



    </div>
</div>






                </div>
            </div>


            <div id="footer">
    <div id="footer-inner">
        <div id="footer-content">
            <div class="widget-powered widget">
                <div class="widget-content">
                    Powered by <a href="http://www.movabletype.com/" rel="generator">Movable Type Pro</a>
                </div>
            </div>

            <div class="widget-creative-commons widget">
                <div class="widget-content">
                    This blog is licensed under a <a href="http://creativecommons.org/licenses/by-nc-nd/3.0/">Creative Commons License</a>.
                </div>
            </div>

        </div>
    </div>
</div>



        </div>
    </div>
</body>
</html>
