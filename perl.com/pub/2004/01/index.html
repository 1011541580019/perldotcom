<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" id="sixapart-standard">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="generator" content="Movable Type Pro 5.13-en" />
<link rel="stylesheet" href="/pub/styles.css" type="text/css" />
<link rel="start" href="/pub/" title="Home" />
<link rel="alternate" type="application/atom+xml" title="Recent Entries" href="/pub/atom.xml" />
<script type="text/javascript" src="/pub/mt.js"></script>
<!--
<rdf:RDF xmlns="http://web.resource.org/cc/"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
<Work rdf:about="/pub/">
<dc:title>Perl.com</dc:title>
<dc:description>news and views of the Perl programming language</dc:description>
<license rdf:resource="http://creativecommons.org/licenses/by-nc-nd/3.0/" />
</Work>
<License rdf:about="http://creativecommons.org/licenses/by-nc-nd/3.0/">
</License>
</rdf:RDF>
-->

<script type="text/javascript">

 var _gaq = _gaq || [];
 _gaq.push(['_setAccount', 'UA-50555-22']);
 _gaq.push(['_trackPageview']);

 (function() {
   var ga = document.createElement('script'); ga.type =
   'text/javascript'; ga.async = true;
   ga.src = ('https:' == document.location.protocol ? 'https://ssl' :
   'http://www') + '.google-analytics.com/ga.js';
   var s = document.getElementsByTagName('script')[0];
   s.parentNode.insertBefore(ga, s);
 })();

</script>
<script type='text/javascript' src='http://partner.googleadservices.com/gampad/google_service.js'></script>
<script type='text/javascript'>
GS_googleAddAdSenseService("ca-pub-4136420132070439");
GS_googleEnableAllServices();
</script>
<script type='text/javascript'>
GA_googleAddSlot("ca-pub-4136420132070439", "Perl_728x90");
</script>
<script type='text/javascript'>GA_googleFetchAds();</script>
    <title>Perl.com: January 2004 Archives</title>


    <link rel="prev" href="/pub/2003/12/" title="December 2003" />
    <link rel="next" href="/pub/2004/02/" title="February 2004" />

</head>
<body id="perl-com" class="mt-archive-listing mt-datebased-monthly-archive layout-wt">
    <div id="container">
        <div id="container-inner">


            <div id="header">
    <div id="header-inner">
        <div id="header-content">
        <span id="top_advert"> 
<!-- Put any landscape advert in here -->
<!-- Perl_728x90 -->
<script type='text/javascript'>
GA_googleFillSlot("Perl_728x90");
</script>
        </span> 



            <div id="header-name"><a href="/pub/" accesskey="1">Perl.com</a></div>
            <div id="header-description">news and views of the Perl programming language</div>




        </div>
    </div>
</div>



            <div id="content">
                <div id="content-inner">


                    <div id="alpha">
                        <div id="alpha-inner">


                            <h1 id="page-title" class="archive-title">January 2004 Archives</h1>





                            
                            <div id="entry-864" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2004/01/30/ttbook.html" rel="bookmark">How We Wrote the Template Toolkit Book ...</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                <abbr class="published" title="2004-01-30T00:00:00-08:00">January 30, 2004 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            <p>There are a number of tools available for writing books.
Many people would immediately reach for their favorite word processor,
but having written one book using Microsoft Word I'm very unlikely to repeat the experience.
Darren Chamberlain,
Andy Wardley, and I are all Perl hackers, so when we got together to write <a href="http://www.oreilly.com/catalog/perltt/index.html?CMP=IL7015">Perl Template Toolkit</a>,
it didn't take us long to agree that we wanted to write it using POD (Plain Old Documentation).</p>

<p>Of course, any chosen format has its pros and cons.
With POD we had all the advantages of working with plain text files and all of the existing POD tools were available to convert our text into various other formats,
but there were also some disadvantages.
These largely stem from the way that books (especially technical books) are written.
Authors rarely write the chapters in the order in which they are published in the finished book.
In fact, it's very common for the chapters to rearranged a few times before the book is published.</p>

<p>Now this poses a problem with internal references.
It's all very well saying &quot;see chapter Six for further details&quot;,
but when the book is rearranged and Chapter Six becomes Chapter Four,
all of these references are broken.
Most word processors will allow you to insert these references as &quot;tags&quot; that get expanded (correctly) as the document is printed.
POD and emacs doesn't support this functionality.</p>

<csperl file="grab" domain="on" record="b/971" template="b/article_sidebar.view">

<p>Another common problem with technical books is the discrepancy between the code listings in the book and the code that actually got run to produce the output shown.
It's easily done.
You create an example program and cut-and-paste the code into the document.
You then find a subtle bug in the code and fix it in the version that you're running but forget to fix it in the book.
What would be really useful would be if you could just use tags saying &quot;insert this program file here&quot; and even &quot;insert the output of running the program here&quot;.
That's functionality that no word processor offers.</p>

<p>Of course,
these shortcomings would be simple to solve if you had a powerful templating system at the ready.
Luckily Andy,
Darren, and I had the Template Toolkit (TT) handy.</p>

<h3><a name="The_Book_Templates">The Book Templates</a></h3>

<p>We produced a series of templates that controlled the book's structure and a Perl program that pulled together each chapter into a single POD file.
This program was very similar to the <code>tpage</code> program that comes with TT,
but was specialized for our requirements.</p>

<h4><a name="Separating_code_from_code">Separating Code from Code</a></h4>

<p>There was one problem we had to address very early on with our book templates. This was the problem of listing TT code within a TT template.
We needed a way to distinguish the template directives we were using to produce the book from the template directives we were demonstrating <i>in the book</i>.</p>

<p>Of course TT provides a simple way to achieve this.
You can define the characters that TT uses to recognize template directives.
By default it looks for <code>[% ... %]</code>,
but there are a number of predefined groups of tags that you can turn on using the <code>TAGS</code> directive.
All of our book templates started with the line:</p>

<pre><code>  [% TAGS star %]</code></pre>

<p>When it sees this directive, the TT parser starts to look for template directives that are delimited with <code>[* ... *]</code>. The default delimiters (<code>[% ... %]</code>) are treated as plain text and passed through unaltered. Therefore, by using this directive we can use <code>[% ... %]</code> in our example code and <code>[* ... *]</code> for the template directives that we wanted TT to process.</p>

<p>Of course, the page where we introduced the <code>TAGS</code> directive and gave examples of its usage was still a little complex.</p>

<p>In the rest of this article, I'll go back to using the <code>[% ... %]</code> style of tags.</p>

<h4><a name="Useful_blocks_and_macros">Useful Blocks and Macros</a></h4>

<p>We defined a number of useful blocks and macros that expanded to useful phrases that would be used throughout the book. For example:</p>

<pre><code>  [% TT = 'Template Toolkit';

     versions = {
       stable = '2.10'
       developer = '2.10a'
     } %]</code></pre>

<p>The first of these must have saved each of us many hours of typing time and the second gave us an easy way to keep the text up-to-date if Andy released a new version of TT while we were writing the book. A template using these variables might look like this:</p>

<pre><code>  The current stable version of the [% TT %] is [% stable %]</code></pre>

<h4><a name="Keeping_track_of_chapters">Keeping Track of Chapters</a></h4>

<p>We used a slightly more complex set of variables and macros to solve the problem of keeping chapter references consistent. First we defined an array that contained details of the chapters (in the current order):</p>

<pre><code>  Chapters = [
    {  name  = 'intro'
       title = &quot;Introduction to the Template Toolkit&quot;
    }
    {  name  = 'web'
       title = &quot;A Simple Web Site&quot;
    }
    {  name  = 'language'
       title = &quot;The Template Language&quot;
    }
    {  name  = 'directives'
       title = &quot;Template Directives&quot;
    }
    {  name  = 'filters'
       title = &quot;Filters&quot;
    }
    {  name  = 'plugins'
       title = &quot;Plugins&quot;
    }
    ... etc ...
   ]</code></pre>

<p>Each entry in this array is a hash with two keys. The name is the name of the directory in our source tree that contains that chapter's files and the title is the human-readable name of the chapter.</p>

<p>The next step is to convert this into a hash so that we can look up the details of a chapter when given its symbolic name.</p>

<pre><code>    FOREACH c = Chapters;
      c.number = loop.count;
      Chapter.${c.name} = c;
    END;</code></pre>

<p>Notice that we are adding a new key to the hash that describes a chapter. We use the <code>loop.count</code> variable to set the chapter number. This means that we can reorder our original <code>Chapters</code> array and the chapter numbers in the <code>Chapter</code> hash will always remain accurate.</p>

<p>Using this hash, it's now simple to create a macro that lets us reference chapters. It looks like this:</p>

<pre><code>  MACRO chref(id) BLOCK;
    THROW chapter &quot;invalid chapter id: $id&quot;
      UNLESS (c = Chapter.$id);
    seen = global.chapter.$id;
    global.chapter.$id = 1;
    seen ? &quot;Chapter $c.number&quot;
         : &quot;Chapter $c.number, I&lt;$c.title&gt;&quot;;
  END;</code></pre>

<p>The macro takes one argument, which is the id of the chapter (this is the unique name from the original array). If this chapter doesn't exist in the <code>Chapter</code> hash then the macro throws an error. If the chapter exists in the hash then the macro displays a reference to the chapter. Notice that we remember when we have seen a particular chapter (using <code>global.chapter.$id</code>) -- this is because O'Reilly's style guide says that a chapter is referenced differently the first time it is mentioned in another chapter. The first time, it is referenced as &quot;Chapter 2, <i>A Simple Web Site</i>&quot;, and on subsequent references it is simply called &quot;Chapter 2. &quot;</p>

<p>So with this mechanism in place, we can have templates that say things like this:</p>

<pre><code>  Plugins are covered in more detail in [% chref(plugins) %].</code></pre>

<p>And TT will convert that to:</p>

<pre><code>  Plugins are covered in more detail in Chapter 6, I&lt;Plugins&gt;.</code></pre>

<p>And if we subsequently reorder the book again, the chapter number will be replaced with the new correct number.</p>

<h4><a name="Running_example_code">Running Example Code</a></h4>

<p>The other problem I mentioned above is that of ensuring that sample code and its output remain in step. The solution to this problem is a great example of the power of TT.</p>

<p>The macro that inserts an example piece of code looks like this:</p>

<pre><code>  MACRO example(file, title) BLOCK;
    global.example = global.example + 1;
    INCLUDE example
      title = title or &quot;F&lt;$file&gt;&quot;
      id    = &quot;$chapter.id/example/$file&quot;
      file  = &quot;example/$file&quot;
      n     = global.example;
    global.exref.$file = global.example;
  END;</code></pre>

<p>The macro takes two arguments, the name of the file containing the example code and (optionally) a title for the example. If the title is omitted then the filename is used in its place. All of the examples in a particular chapter are numbered sequentially and the <code>global.example</code> variable holds the last used value, which we increment. The macro then works out the path of the example file (the structure of our directory tree is very strict) and <code>INCLUDE</code>s a template called <code>example</code>, passing it various information about the example file. After processing the example, we store the number that is associated with this example by storing it in the hash <code>global.exref.$file</code>.</p>

<p>The <code>example</code> template looks like this:</p>

<p>[% IF publishing -%] =begin example [% title %]</p>

<pre><code>      Z&lt;[% id %]&gt;[% INSERT $file FILTER indent(4) +%]

  =end
  [% ELSE -%]
  B&lt;Example [% n %]: [% title %]&gt;

  [% INSERT $file FILTER indent(4) +%]</code></pre>

<p>[% END -%]</p>

<p>This template looks at a global flag called <code>publishing</code>, which determines if we are processing this file for submission to O'Reilly or just for our own internal use. The <code>Z&lt; ... &gt;</code> POD escape is an O'Reilly extension used to identify the destination of a link anchor (we'll see the link itself later on). Having worked out how to label the example, the template simply inserts it and indents it by four spaces.</p>

<p>This template is used within our chapter template by adding code like <code>[% example('xpath', 'Processing XML with XPath') %]</code> to your document. That will be expanded to something like, "Example 2: Processing XML with Xpath," followed by the source of the example file, <code>xpath</code>.</p>

<p>All of that gets the example code into that document. We now have to do two other things. We need to be able to reference the code from the text of the chapter ('As example 3 demonstrates...'), and we also need to include the results of running the code.</p>

<p>For the first of these there is a macro called <code>exref</code>, which is shown below:</p>

<pre><code>  MACRO exref(file) BLOCK;
    # may be a forward reference to next example
    SET n = global.example + 1
      UNLESS (n = global.exref.$file);
    INCLUDE exref
      id    = &quot;$chapter.id/example/$file&quot;;
  END;</code></pre>

<p>This works in conjunction with another template, also called <code>exref</code>.</p>

<pre><code>  [% IF publishing -%]
  A&lt;[% id %]&gt;
  [%- ELSE -%]
  example [% n %]
  [%- END -%]</code></pre>

<p>The clever thing about this is that you can use it <i>before</i> you have included the example code. So you can do things like:</p>

<pre><code>  This is demonstrated in [% exref('xpath') %].

  [% example('xpath', 'Processing XML with XPath') %]</code></pre>

<p>As long as you only look at a maximum of one example ahead, it still works. Notice that the <code>A&lt; ... &gt;</code> POD escape is another O'Reilly extension that marks a link anchor. So within the O'Reilly publishing system it's the <code>A&lt;foo&gt;</code> and the associated <code>Z&lt;foo&gt;</code> that make the link between the reference and the actual example code.</p>

<p>The final thing we need is to be able to run the example code and insert the output into the document. For this we defined a macro called <code>output</code>.</p>

<pre><code>  MACRO output(file) BLOCK;
    n = global.example;
    &quot;B&lt;Output of example $n:&gt;\n\n&quot;;
    INCLUDE &quot;example/$file&quot; FILTER indent(4);
  END;</code></pre>

<p>This is pretty simple. The macro is passed the name of the example file. It assumes that this is the most recent example included in the document so it gets the example number from <code>global.example</code>. It then displays a header and <code>INCLUDE</code>s the file. Notice that the major difference between <code>example</code> and <code>output</code> is that <code>example</code> uses <code>INSERT</code> to just insert the file's contents, whereas <code>output</code> uses <code>INCLUDE</code>, which loads the file and processes it.</p>

<p>With all of these macros and templates, we can now have example code in our document and be sure that the output we show really reflects the output that you would get by running that code. So we can put something like this in the document:</p>

<pre><code>  The use of GET and SET is demonstrated in [% exref('get_set') %].

  [% example('get_set', 'GET and SET') %]

  [% output('get_set') %]</code></pre>

<p>And that will be expanded to the following.</p>

<pre><code>  The use of GET and SET is demonstrated in example 1.

  B&lt;Example 1: GET and SET&gt;

      [% SET foo = 'bar -%]
      The variable foo is set to &quot;[% GET foo %]&quot;.

  B&lt;Output of example 1:

      The variable foo is set to &quot;bar&quot;.</code></pre>

<p>As another bonus, all of the example code is neatly packaged away in individual files that can easily be made into a tarball for distribution from the book's web site.</p>

<h4><a name="Other_templates,_blocks_and_macros">Other Templates, Blocks, and Macros</a></h4>

<p>Once we started creating these timesaving templates, we found a huge numbers of areas where we could make our lives easier. We had macros that inserted references to other books in a standard manner, macros for inserting figures and screenshots, as well as templates that ensured that all our chapters had the same standard structure and warned us if any of the necessary sections were missing. I'm convinced that the TT templates we wrote for the project saved us all a tremendous amount of time that would have otherwise been spent organizing and reorganizing the work of the three authors. I would really recommend a similar approach to other authors.</p>

<p>The Template Toolkit is often seen as a tool for building web sites, but we have successfully demonstrated one more non-Web area where the Template Toolkit excels.</p>





        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-870" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2004/01/p6pdigest/20040125.html" rel="bookmark">This week on Perl 6, week ending 2004-01-25</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Piers Cawley</span> on <abbr class="published" title="2004-01-25T00:00:00-08:00">January 25, 2004 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            
<p>Welcome to the first summary from my new home in Gateshead.
The same old wibble,
with a different view from its window and fewer trips to London.
Right,
time to see what&#39;s been going on in perl6&#45;internals this week.</p>

<h4><a name="Global_labels_in_IMCC">Global labels in IMCC</a></h4>

<p>The cryptically named TOGoS wondered how to get the address of a label in a different IMCC compilation unit.
According to Dan there&#39;s no way to do that,
and you didn&#39;t want to do that anyway.</p>

<p><a href='http://groups.google.com/groups?selm=20040119201611.71859.qmail@web41408.mail.yahoo.com'>http://groups.google.com/groups</a></p>

<h4><a name="Dan&#39;s_threads_proposal">Dan&#39;s threads proposal</a></h4>

<p>After a few weeks of everyone else&#39;s proposals,
Dan started to outline the design of Parrot&#39;s threading capabilities.
He started by defining his terms (a useful thing to do in a field where there seem to me multiple competing definitions of various terms) and guaranteeing that user code wouldn&#39;t crash the interpreter (subject to the assumption that system level memory allocation was thread safe) before getting into the meat of his proposal.
Which you&#39;re probably best reading for yourself; it&#39;s a long document but there&#39;s very little flab and any attempt of mine to summarize it would probably end up being at least as long as and a good deal less lucid than the original.</p>

<p>Of course,
this sparked a ton of discussion,
generally positive,
as people asked for various clarifications and made suggestions.
Gordon Henriksen pointed out a nasty race condition that means that the garbage collector can&#39;t be made as thread safe as Dan had hoped.</p>

<p>Summarizer Barbie says &#34;Threads are hard!&#34;</p>

<p>On Thursday,
Dan posted a last call for comments and objections before he went on to the detailed design.
This time there were some objections,
but I don&#39;t think any of &#39;em are going to stop Dan.</p>

<p><a href='http://groups.google.com/groups?selm=a0601020dbc31eb8d1b67@[10.0.1.2]'>http://groups.google.com/groups</a></p>

<p><a href='http://groups.google.com/groups?selm=a06010210bc35dbe3d5bf@[10.0.1.4]'>http://groups.google.com/groups</a></p>

<h4><a name="Vtables_organization">Vtables organization</a></h4>

<p>Last week Dan had outlined an approach to organizing PMC vtables using a chaining approach; this week saw the discussion of that proposal with Benjamin K.
Stuhl asking the hard questions.</p>

<p><a href='http://groups.google.com/groups?selm=400BDD81.1060909@cornell.edu'>http://groups.google.com/groups</a></p>

<h4><a name="Benchmark_suite">Benchmark suite</a></h4>

<p>Matt Fowles suggested that it might make sense to create a canonical suite of benchmarks to exercise Parrot well.
His idea being that,
if we have a standard suite of Parrot benchmarks,
then potential performance affecting changes could be tested against that,
rather than having custom benchmarks rolled each time.
Luke Palmer pointed to <em lang='und' xml:lang='und'>examples/benchmarks</em> and noted that it&#39;s hard to create benchmarks that test everything.
However,
he hoped that any good benchmark that gets posted to the list would get added to this suite,
along with some documentation describing what is being tested.</p>

<p><a href='http://groups.google.com/groups?selm=40144AE1.9050205@softhome.net'>http://groups.google.com/groups</a></p>

<h4><a name="Number_formatting">Number formatting</a></h4>

<p>Dan did some more designing,
this time mandating that Parrot will,
eventually adopt ICU&#39;s formatting template for numeric templates but,
to start with,
we&#39;ll be rolling our own.
The new op will be <code lang='und' xml:lang='und'>format Sx,
[INP]y,
[SP]z</code>.</p>

<p><a href='http://groups.google.com/groups?selm=a06010210bc31f337e755@[10.0.1.2]'>http://groups.google.com/groups</a></p>

<h4><a name="Base_string_transforms">Base string transforms</a></h4>

<p>Dan announced that he would be adding <code lang='und' xml:lang='und'>upcase</code>,
<code lang='und' xml:lang='und'>downcase</code>,
<code lang='und' xml:lang='und'>titlecase</code> and <code lang='und' xml:lang='und'>to_chartype</code> to the various chartype vtables.
He also noted that he&#39;d like to get some alternative chartypes and encodings into Parrot as soon as possible to make sure we can actually handle things without having to use Unicode all the time.</p>

<p><a href='http://groups.google.com/groups?selm=a06010211bc31f77ae6da@[10.0.1.2]'>http://groups.google.com/groups</a></p>

<h4><a name="Calling_conventions_in_IMCC">Calling conventions in IMCC</a></h4>

<p>Will Coleda had some problems with IMCC&#39;s handling of the parrot calling conventions when he found that code that worked a couple of months ago had stopped working in the current Parrot (A month is a *very* long time in Parrot development though.) The problem took a fair bit of tracking down and I&#39;m not entirely sure it&#39;s entirely fixed yet; Will had reached the point where the code would compile,
but it still wouldn&#39;t actually run.</p>

<p><a href='http://groups.google.com/groups?selm=B8548E4C&#45;4AA8&#45;11D8&#45;95BB&#45;000A95909DD0@coleda.com'>http://groups.google.com/groups</a></p>

<h4><a name="Steve_Fink&#39;s_obnoxious_test_case">Steve Fink&#39;s obnoxious test case</a></h4>

<p>Steve Fink posted an obnoxious test case that generated memory corruption.
The test case is obnoxious because it&#39;s 56KB of IMCC source code,
and Steve had been unable to reduce it.
This didn&#39;t discourage Leo T&#246;tsch though,
who set about tracking the bug to its lair.
It&#39;s not fixed yet,
but with the Patchmonster on the case it can only be a matter of time.</p>

<p>There were several other GC related issues that cropped up over the week; I wonder if they&#39;re all aspects of a single lurking bug.</p>

<p><a href='http://groups.google.com/groups?selm=20040120004855.GA28881@foxglove'>http://groups.google.com/groups</a></p>

<h4><a name="IMCC_returning_ints">IMCC returning ints</a></h4>

<p>Steve Fink also found a problem with IMCC failing to properly return integers from unprototyped routines and posted an appropriate patch to the test suite.
It turns out that the problem is that IMCC doesn&#39;t quite implement the full Parrot Calling Conventions,
especially the return convention,
but it&#39;s getting there.</p>

<p><a href='http://groups.google.com/groups?selm=20040120015843.GC27636@foxglove'>http://groups.google.com/groups</a></p>

<h4><a name="The_costs_of_sharing">The costs of sharing</a></h4>

<p>Leo T&#246;posted a test program and some results for timing the difference between using shared and unshared PMCs.
The shared versions are (not surprisingly) slower than the unshared ones; the question is whether the difference between the two can be improved.
Hopefully the benchmark will get checked into <em lang='und' xml:lang='und'>examples/benchmarks</em> as suggested by Luke earlier.</p>

<p><a href='http://groups.google.com/groups?selm=400D5BD3.1020409@toetsch.at'>http://groups.google.com/groups</a></p>

<h4><a name="An_array_of_array_types">An array of array types</a></h4>

<p>Dan noted that we have &#34;a pile of different array classes with fuzzy requirements and specified behaviours which sort of inherit from each other except when they don&#39;t.&#34; He suggested that the time had come to work out what we actually <i>want</i> in the way of array classes,
compare our requirements with what we have,
and then to do something about making what was available match what was required.
I&#39;m not sure that the resulting discussion has finalized the set of array types needed,
but it&#39;s getting there.
(Does anyone else think &#39;FixedMixedArray&#39; is awfully clumsy as names go?).</p>

<p><a href='http://groups.google.com/groups?selm=a0601020ebc3350821beb@[10.0.1.2]'>http://groups.google.com/groups</a></p>

<h4><a name="Remember_to_nag_Robert_Spier">Remember to nag Robert Spier</a></h4>

<p>Robert Spier announced that repairing the web accessible TODO list was on his personal TODO list and asked to be nagged about it periodically.</p>

<p>Robert,
remember you need to fix the web accessible TODO list.</p>

<p><a href='http://groups.google.com/groups?selm=m3k73mw9fa.wl_rspier@pobox.com'>http://groups.google.com/groups</a></p>

<h4><a name="Churchill&#39;s_parrot_still_swearing">Churchill&#39;s parrot still swearing</a></h4>

<p>Effortlessly Godwinning himself,
Uri Guttman pointed to a press release which stated that Winston Churchill&#39;s parrot,
Charlie,
is now 104 years old and can still be coaxed into squawking certain inflammatory remarks which had apparently made it rather unsuitable for keeping at its owner&#39;s pet shop due to its habit of swearing at children.</p>

<p><a href='http://groups.google.com/groups?selm=x7d69eey3y.fsf@mail.sysarch.com'>http://groups.google.com/groups</a></p>

<h4><a name="Updated_documentation_in_Perl_scripts">Updated documentation in Perl scripts</a></h4>

<p>Michael Scott continued his sterling work of updating and generally improving Parrot&#39;s documentation.
This week his attention fell upon: the Perl scripts found in <em lang='und' xml:lang='und'>build_tools</em>,
<em lang='und' xml:lang='und'>classes</em> and <em lang='und' xml:lang='und'>tools/dev</em>.
Top man that he is,
he&#39;s currently working on the documentation embedded in C code.</p>

<p><a href='http://groups.google.com/groups?selm=051BEB2F&#45;4B99&#45;11D8&#45;86A0&#45;000A95C50226@mac.com'>http://groups.google.com/groups</a></p>

<p><a href='http://groups.google.com/groups?selm=a0601021fbc36e6903a5c@[10.0.1.4]'>http://groups.google.com/groups</a></p>

<h4><a name="Open_issue_review">Open issue review</a></h4>

<p>Robert Spier (don&#39;t forget the web accessible todo list Robert) posted a list of the 177 currently outstanding Parrot issues in the RT system and asked for volunteers to go through them to help weed out those issues that were no longer current.
So people did.
Which is nice.</p>

<p><a href='http://groups.google.com/groups?selm=m3isj6w7c0.wl_rspier@pobox.com'>http://groups.google.com/groups</a></p>

<h4><a name="How_to_subclass_dynamic_PMCs">How to subclass dynamic PMCs</a></h4>

<p>Michal Wallace is trying to make a dynamically loaded PMC that subclasses another dynamically loaded PMC and he can&#39;t work out how to do it.
Leo T&#246;tsch had the answer.</p>

<p><a href='http://groups.google.com/groups?selm=Pine.LNX.4.58.0401211335500.19552@hydrogen.sabren.com'>http://groups.google.com/groups</a></p>

<h4><a name="How_does_Parrot_handle_High_Level_Language_eval">How does Parrot handle High Level Language eval</a></h4>

<p>Nigel Sandever wondered how Parrot would handle <code lang='und' xml:lang='und'>eval</code> opcodes for multiple different languages.
Leo pointed him at the <code lang='und' xml:lang='und'>compile</code> op,
which (while it isn&#39;t fully implemented yet) will address this issue.
Dan noted that it&#39;s currently working for PIR and PASM code but that it should be able to work eventually with any compiler that generates standard bytecode.</p>

<p><a href='http://groups.google.com/groups?selm=1103_1074823506@nntp.perl.org'>http://groups.google.com/groups</a></p>

<h4><a name="Signals_and_events">Signals and events</a></h4>

<p>Leo is working on turning OS level signals into Parrot level events,
and he&#39;s not having an easy time of it.
He posted a summary of the issues and asked for comments.
Discussion continues.</p>

<p><a href='http://groups.google.com/groups?selm=4010EB5B.1040608@toetsch.at'>http://groups.google.com/groups</a></p>

<h4><a name="Threading_again">Threading again</a></h4>

<p>Gordon Henriksen worries that Parrot&#39;s current architecture is actively thread hostile.
He also accepted that trying to change it now wasn&#39;t really possible.
So he outlined various ways in which the need for locking could be reduced,
which should help speed things up.
The big problem,
as Gordon sees it,
is that so many Parrot data structures are mutable,
and mutable data structures require locks.
And having PMCs that can morph from one type to another is...
well,
Gordon claims that <code lang='und' xml:lang='und'>morph</code> must die,
though he later modified this claim.
He and Leo batted this back and forth for a while; I&#39;m not sure either side is convinced.</p>

<p><a href='http://groups.google.com/groups?selm=8A1B28F4&#45;4E28&#45;11D8&#45;85AB&#45;000502994722@mac.com'>http://groups.google.com/groups</a></p>

<h4><a name="Embedding_vs._extending_interface_types">Embedding vs.
extending interface types</a></h4>

<p>Mattia Barbon noted that the embedding and extending interfaces were still using different names for <code lang='und' xml:lang='und'>Parrot_Interp</code> and <code lang='und' xml:lang='und'>Parrot_INTERP</code>.
He wondered which was correct.
It turns out that nobody&#39;s quite sure,
but the person who can make the decision &#45;&#45; Dan &#45;&#45; was en route to Copenhagen when this came up,
so there&#39;s no answer yet.</p>

<p><a href='http://groups.google.com/groups?selm=Mahogany&#45;0.66.0&#45;920&#45;20040124&#45;172842.00@rbnet.it'>http://groups.google.com/groups</a></p>

<h3><a name="Meanwhile_in_perl6&#45;language">Meanwhile in perl6&#45;language</a></h3>

<h4><a name="Semantics_of_Vector_operations">Semantics of Vector operations</a></h4>

<p>Determined to test everyone&#39;s Unicode readiness,
Luke Palmer kicked off a discussion of the semantics of <code lang='und' xml:lang='und'>[1,2,3] &#187;+&#171; [4,5,6]</code>.
At first glance it looks like the result should be <code lang='und' xml:lang='und'>[5,7,9]</code>,
but Luke argued that actually,
the code was trying to add two lists,
each containing a single scalar,
that just happened to be listrefs.
Larry pointed out that &#34;Doing what you expect at first glance is also called &#39;not violating the principle of least surprise&#39;&#34;,
before going on to surprise us all with &#39;lopsided&#39; vector ops,
which would allow the programmer to specify when a value was expected to be treated as a scalar:</p>

<pre><code>    $a   &#187;+&#171; $b     # Treat $a and $b as lists
    $x    +&#171; $y     # Treat $x as a scalar and $b as a list
          &#45;&#171; @bar   # Return a list of every element of @bar, negated
    @foo &#187;+  @bar   # Add the length of @bar to every element of @foo</code></pre>

<p>Then he scared me with <code lang='und' xml:lang='und'>@foo &#187;+= @foo</code>. He noted that it might take some getting used to, but that it helped if you pronounce <code lang='und' xml:lang='und'>&#187;</code> and <code lang='und' xml:lang='und'>&#171;</code> as &#39;each&#39;. Austin Hastings didn&#39;t like it (from a syntax highlighting point of view), but he appeared to be outvoted. Larry pointed out that <code lang='und' xml:lang='und'>&#171;&#187;</code> etc were the least of a syntax highlighters worries given that any <code lang='und' xml:lang='und'>use</code>, <code lang='und' xml:lang='und'>eval</code> or operator declaration had the potential to morph any subsequent syntax. Piers Cawley thought that truly accurate syntax highlighting would have to be done in an image based IDE implemented in Perl because such an editor would always know what rules were in scope for a given chunk of code. A. Pagaltzis thought that this would definitely increment the Smalltalkometer for Perl 6.</p>

<p>As discussion and exploration of this idea continued it became apparent that people seem to like this particular weirding of the language, and it certainly allows the programmer to disambiguate things rather neatly. Luke even pointed out that this new approach allows for calling a method on a list of values: <code lang='und' xml:lang='und'>@list &#187;.method</code>, and to call a list of methods on a value: <code lang='und' xml:lang='und'>$value.&#171; @methods</code>.</p>

<p>Then the fun began. The issue is that <code lang='und' xml:lang='und'>&#187;</code> and <code lang='und' xml:lang='und'>&#171;</code> can also be written <code lang='und' xml:lang='und'>&#60;&#60;</code> and <code lang='und' xml:lang='und'>&#62;&#62;</code> (but your POD processor hates you for it). This leads to ambiguities like <code lang='und' xml:lang='und'>&#62;&#62;+&#60;&#60;=&#60;&#60;</code> (which are even harder to type in a Pod escape) which can be parsed as <code lang='und' xml:lang='und'>&#187;+&#60;&#60;=&#171;</code> or <code lang='und' xml:lang='und'>&#187;+&#171;=&#171;</code>. Larry wondered if the problem arose because of trying to make the <code lang='und' xml:lang='und'>&#60;<code lang='und' xml:lang='und'>lt</code></code> and <code lang='und' xml:lang='und'>&#62;&#62;</code> alternatives look too similar to the Unicode glyphs.</p>

<p>You know, looking at that last paragraph I can see why people think Perl 6 is horribly scary. The thing is, you&#39;re not expected to use constructions like that in real world programs all the time; but when you&#39;re working out what a grammar should be you <i>have</i> to think of all the nasty edge cases to see where things break.</p>

<p>Anyway, such nastiness led to the possibility of introducing a &#39;whitespace eating&#39; macro which would allow for the introduction of disambiguating whitespace. The front runner for this macro is <code lang='und' xml:lang='und'>_</code>.</p>

<p><a href='http://groups.google.com/groups?selm=20040120085433.GA23075@babylonia.flatirons.org'>http://groups.google.com/groups</a></p>

<h4><a name="Comma_operator">Comma operator</a></h4>

<p>Remember a few months ago when there was some discussion of replacing the C style comma with some other glyph? If that were done, one of the consequences would be that</p>

<pre><code>   @foo = 1,2,3;</code></pre>

<p>would fill <code lang='und' xml:lang='und'>@foo</code> with three elements instead of just the one as it does in Perl 5. Joe Gottman had a few questions about the implications of that, and wondered if Larry had actually ruled on it. Larry ruled that list construction would continue to require brackets (or, if you&#39;re American, parentheses) and went on to discuss some further implications of that.</p>

<p><a href='http://groups.google.com/groups?selm=000b01c3dfc4$bab7d620$e58f8445@carolina.rr.com'>http://groups.google.com/groups</a></p>

<h3><a name="Acknowledgements,_Apologies,_Announcements">Acknowledgements, Apologies, Announcements</a></h3>

<p>Thankfully, this section&#39;s normal service is resumed this week. The only catch is, I can&#39;t think of anything to say.</p>

<p>However, if you find these summaries useful or enjoyable, please consider contributing to the Perl Foundation to help support the development of Perl. You might also like to send me feedback at <a href='TODO'>p6summarizer@bofh.org.uk</a>, or drop by my website (New! Improved! listening on port 80! Still sadly lacking in desperately new content!)</p>

<p><a href='http://donate.perl&#45;foundation.org/'>http://donate.perl&#45;foundation.org/</a> &#45;&#45; The Perl Foundation</p>

<p><a href='http://dev.perl.org/perl6/'>http://dev.perl.org/perl6/</a> &#45;&#45; Perl 6 Development site</p>

<p><a href='http://www.bofh.org.uk/'>http://www.bofh.org.uk/</a> &#45;&#45; My website, &#34;Just a Summary&#34;</p>

        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-862" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2004/01/23/macglue.html" rel="bookmark">Introducing Mac::Glue</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Simon Cozens</span> on <abbr class="published" title="2004-01-23T00:00:00-08:00">January 23, 2004 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            
<!-- sidebar begins -->
<!-- don't move sidebars -->
<!-- sidebar ends -->

<p> Thanks to the popularity of Mac OS X, the new iBook, and the
    PowerBook G4, it's no longer uncool to talk about owning an
    Apple. Longtime Mac devotees have now been joined by longtime
    Unix devotees and pretty much anyone who wants computers to be
    shiny, and speakers at conferences such as the <a
    href="http://conferences.oreillynet.com/os2004/">Open Source
    Convention</a> are beginning to get used to looking down over a
    sea of Apple laptops.
    </p>

    <p> One of the great features about Apple's Mac OS is its support
      for flexible inter-process communication (IPC), which Apple
      calls inter-application communication (IAC). One of the components
      of IAC is called Apple events, and allows applications to
      command each other to perform various tasks. On top of the raw
      Apple events layer, Apple has developed the <b>Open Scripting
	Architecture</b>, an architecture for scripting languages such
      as Apple's own AppleScript.
    </p>

    <p>
      But this is <code>perl.com</code>, and we don't need inferior
      scripting languages! The <code>Mac::Glue</code> module provides
      OSA compatibility and allows us to talk to Mac applications with
      Perl code. Let's take a look at how to script Mac tools at a
      high level in Perl.
    </p>

    <h3>The Pre-History of <code>Mac::Glue</code></h3>

    <p>
      In the beginning, there was <code>Mac::AppleEvents</code>. This
      module wrapped the raw Apple events API, with its cryptic
      four-character codes to describe applications and their
      capabilities, and its collection of awkward constants. You had
      to find out the four-character identifiers yourself, you had to
      manage and dispose of memory yourself, but at least it got you
      talking Apple events. Here's some <code>Mac::AppleEvents</code>
      code to open your System Folder in the Finder::
    </p>

    <pre><code>
use Mac::AppleEvents;

my $evt = AEBuildAppleEvent('aevt', 'odoc', typeApplSignature, 
             'MACS', kAutoGenerateReturnID, kAnyTransactionID,
             "'----': obj{want:type(prop), from:'null'()," .
                "form:prop, seld:type(macs)}"
          );
my $rep = AESend($evt, kAEWaitReply);

AEDisposeDesc($evt);
AEDisposeDesc($rep);
</code></pre>

    <p>
       Obviously this isn't putting the computer to its full use; in a
       high-level language like Perl, we shouldn't have to concern
       ourselves with clearing up descriptors when they're no longer
       in use, or providing low-level flags. We just want to send the
       message to the Finder. So along came
       <code>Mac::AppleEvents::Simple</code>, which does more of the work:
    </p>

<pre><code>
use Mac::AppleEvents::Simple;
do_event(qw(aevt odoc MACS),
     "'----': obj{want:type(prop), from:'null'()," .
     "form:prop, seld:type(macs)}"
);
</code></pre>

    <p>
       This is a bit better; at least we're just talking the IAC
      language now, instead of having to emulate the raw API. But
      those troublesome identifiers -- "aevt" for the Finder, "odoc"
      to open a document, and "MACS" for the System folder. 
    </p>
    <p>
      Maybe we'd be better off in AppleScript after all -- the
      AppleScript code for the same operation looks like this:
    </p>
<pre><code>
tell application "Finder" to open folder "System Folder"
</code></pre>
    <p>
      And before <code>Mac::Glue</code> was ported to Mac OS X, this is
      exactly what we had to do: 
    </p>
    <pre><code>
use Mac::AppleScript qw(RunAppleScript);
RunAppleScript('tell application "Finder" to open folder "System Folder"');
</code></pre>
    <p>
      This is considerably easier to understand, but it's just not
      Perl. <code>Mac::Glue</code> uses the same magic that allows
      AppleScript to use names instead of identifiers, but wraps it in
      Perl syntax:
    </p>
    <pre><code>
use Mac::Glue;
my $finder = Mac::Glue->new('Finder');
$finder->open( $finder->prop('System Folder') );
</code></pre>

<csperl file="grab" domain="on" record="b/1005" template="b/article_sidebar.view">

<h3>Setting Up and Creating Glues</h3>

    <p>On Mac OS 9, MacPerl comes with <code>Mac::Glue</code>. However, OS
    X users will need to install it themselves. <code>Mac::Glue</code>
    requires several other CPAN modules to be installed, including the
    <code>Mac-Carbon</code> distribution.</p>
    <p>
      Because this in turn requires the Carbon headers to be
      available, you need to install the correct Apple developer kits;
      if you don't have the Developer Tools installed already, you can
      download them from <a href="https://connect.apple.com/">the ADC
      site</a>.
    </p>
    <p>
      Once you have the correct headers installed, the best way to get
      <code>Mac::Glue</code> up and running is through the CPAN or
      CPANPLUS modules:
    </p>
    <pre><code>
% perl -MCPAN -e 'install "Mac::Glue"'
</code></pre>
    <p>
      This should download and install all the prerequisites and then
      the <code>Mac::Glue</code> module itself.
    </p>
    <p>
      When it installs itself, <code>Mac::Glue</code> also creates
      "glue" files for the core applications -- Finder, the System Events
      library, and so on. A glue file is used to describe the resources
      available to an application and what can be done to the
      properties that it has.
    </p>
    <p>
      If you try to use <code>Mac::Glue</code> to control an
      application for which it doesn't currently have a glue file, it
      will say something like this:
    </p>
    <pre><code>
No application glue for 'JEDict' found in 
'/Library/Perl/5.8.1/Mac/Glue/glues' at -e line 1
</code></pre>
    <p>
      To create glues for additional applications that are not
      installed by default, you can drop them onto the Mac OS 9 droplet
      "macglue." On Mac OS X, run the <code>gluemac</code> command.
    </p>
<h3>What's a Property?</h3>
    <p>
      Once you have all your glues set up, you can start scripting Mac
      applications in Perl. It helps if you already have some
      knowledge of how AppleScript works before doing this, because
      sometimes <code>Mac::Glue</code> doesn't behave the way you
      expect it to.
    </p>
    <p>
      For instance, we want to dump all the active to-do items from
      iCal. To-dos are associated with calendars, so first we need a
      list of all the calendars:
    </p>
    <pre><code>
use Mac::Glue;
my $ical = new Mac::Glue("iCal");

my @cals = $ical->prop("calendars");
</code></pre>
    <p>
       The problem we face immediately is that
      <code>$ical->prop("calendars")</code> doesn't give us the
      calendars. Instead, it gives us a way to talk about the
      calendars' property. It's an object. To get the value of that
      property, we call its <code>get</code> method:
    </p>
    <pre><code>
my @cals = $ical->prop("calendars")->get;
</code></pre>
    <p>
      This returns a list of objects that allow us to talk about
      individual calendars. We can get their titles like so:
    </p>
    <pre><code>
for my $cal (@cals) {
    my $name = $cal->prop("title")->get;
</code></pre>
    <p>
      And now we want to get the to-dos in each calendar that haven't
      yet been completed or have no completion date:
    </p>
    <pre><code>
    my @todos = grep { !$_->prop("completion_date")->get }
                       $cal->prop("todos")->get;
</code></pre>
    <p>
      If we then store the summary for each of the to-do items in a
      hash keyed by the calendar name:
    </p>
    <pre><code>
    $todos{$name} = [ map { $_->prop("summary")->get } @todos ]
	if @todos;
}
</code></pre>
    <p>
      Then we can print out the summary of all the outstanding to-do
      items in each calendar: 
</p>
    <pre><code>
for my $cal(keys %todo) {
    print "$cal:\n";
    print "\t$_\n" for @{$todo{$cal}};
}
</code></pre>
    <p>
      Putting it all together, the code looks like:
    </p>
    <pre><code>
use Mac::Glue;
my $ical = new Mac::Glue("iCal");

my @cals = $ical->prop("calendars")->get;
for my $cal (@cals) {
    my $name = $cal->prop("title")->get;
    my @todos = map  { $_->prop("summary")->get }
                grep { !$_->prop("completion_date")->get }
                       $cal->prop("todos")->get;
    $todo{$name} = \@todos if @todos;
}

for my $cal(keys %todo) {
    print "$cal:\n";
    print "\t$_\n" for @{$todo{$cal}};
}
</code></pre>
    <p>
       The question is, where did we get the property names like
       <code>summary</code> and <code>completion_date</code> from? How did we know that the
       calendars had <code>titles</code> but the to-do items had <code>summaries</code>, and
       so on?
    </p>
    <p>
       There are two answers to this: the first is to use the
       documentation created when the glue is installed. Typing
       <code>gluedoc iCal</code> on Mac OS X or using Shuck on Mac OS 9, you
       will find the verbs, properties, and objects that the
      application supports. For instance, under the calendar class,
      you should see:
    </p>
    <blockquote>
<dl>
<dd>
This class represents a calendar
</dd>
<dd>
<p>Properties:</p>
</dd>
<dd>
<pre>
    description (wr12/utxt): This is the calendar
description. (read-only)
    inheritance (c@#^/item): All of the properties of the
superclass. (read-only)
    key (wr03/utxt): An unique calendar key (read-only)
    tint (wr04/utxt): The calendar color (read-only)
    title (wr02/utxt): This is the calendar title.
    writable (wr05/bool): If this calendar is writable
(read-only)</pre>
</dd>
<dd>
<p>Elements:</p>
</dd>
<dd>
<pre>
    event, todo</pre>
</dd>
</dl>
</blockquote>
    <p>
      This tells us that we can ask a calendar for its
      <code>title</code> property, and also for the
      <code>events</code> or <code>todos</code> contained within it.
    </p>
    <p>
      Similarly, when we get the events back, we can look up the
      "event" class in the documentation and see what properties are
      available on it.
    </p>
    <p>
      The second, and perhaps easier, way to find out what you can do
      with an application is to open the AppleScript Script Editor
      application, select Open Dictionary from the File menu, and
      choose the application you want to script. Now you can browse a
      list of the classes and commands associated with the application:
    </p>
    
<img src="/pub/2004/01/23/graphics/glue.jpg" width="450" height="343" alt="" /> 
<p>
      When you need to know how to translate those back into Perl, you
      can then consult the glue documentation. It takes a few attempts
      to get used to the way <code>Mac::Glue</code> works, but once
      you've done that, you'll find that you can translate between the
      AppleScript documentation and a <code>Mac::Glue</code>
      equivalent in your head.
    </p>
	










	
	
<h3>Some Examples</h3>
    <p>
      In a couple of weeks, we'll be presenting a "Mac::Glue Hacks"
      article in the spirit of the O'Reilly <a
      href="http://hacks.oreilly.com">hacks books</a> series, with
      several simple <code>Mac::Glue</code>-based application
      scripting tricks to whet your appetite and explore what
      <code>Mac::Glue</code> can do. But to get you started, here's a
      couple we found particularly useful.
    </p>
    <p>
      First, iTunes allows you to give a rating to your favorite
      songs, on the scale of zero to five stars. Actually,
      internally, this is stored in the iTunes database as a number
      between 0 and 100. Simon keeps iTunes playing randomly over his
      extensive music collection, and every time an interesting track
      comes up, he runs this script:
    </p>
    <pre><code>
my $itunes = Mac::Glue->new("iTunes");
exit unless $itunes->prop("player state")->get eq "playing";

my $rating = $itunes->prop("current track")->prop("rating");
$rating->set(to => ($rating->get + 20))
  if $rating->get &lt; 81;
</code></pre>
    <p>
      As well as getting properties from <code>Mac::Glue</code>, we
      can also set them back with the <code>set</code> method.
    </p>
    <p>
      One more complex example is the <a
      href="http://dev.macperl.org/files/scripts/happening">happening</a> script Chris uses to publish details of
      what's going on at his computer. As well as simply reporting the
      current foremost application, it dispatches based on that
      application to report more information. For instance, if Safari
      has the focus, it reports what web page is being looked at; if
      it's the Terminal, what program is currently being run. It also
      contacts iTunes to see what song is playing, and if there's
      nothing playing on a local iTunes, asks likely other computers
      on the network if they're playing anything.
    </p>
    <p>
      Once <code>happening</code> has discovered what's going on, it
      checks to see if the iChat status is set to "Available," and if
      so, resets itself it to report this status. Let's break down
      <code>happening</code> and see how it accomplishes each of these
      tasks.
    </p>
    <p>
      First, to work out the name of the currently focused application:
    </p>
    <pre><code>
my $system = get_app('System Events') or return;
$app    ||= $system->prop(name => item => 1,
    application_process => whose(frontmost => equals => 1)
);

$app-&gt;get;
</code></pre>
    <p>
      <code>get_app</code> is just a utility function that memorizes
      the process of calling
      <code>Mac::Glue-&gt;new($app_name)</code>; since loading up the
      glue file is quite expensive, keeping around application glue
      objects is a big speed-saving approach. 
    </p>
    <p>
      The next incantation shows you how natural <code>Mac::Glue</code>
      programming can look, but also how much you need to know about how
      the Apple environment works. We're asking the System Events
      library to tell us about the application process that matches a
      certain condition. <code>Mac::Glue</code> exports the
      <code>whose</code> function to create conditions.
    </p>
    <p>
      The important thing about this is the fact that we use
      <code>$app ||= ...</code>. The construction that we saved in
      <code>$app</code> does not give us "the name of the front-most
      application at this moment," but it represents the whole concept
      of "the name of the front-most application." At any time in the
      future, we can call <code>get</code> on it, and it will find out
      and return the name of the front-most application at that time, even
      if it has changed since the last time you called <code>get</code>.
    </p>
    <p>
      Now that we know what the front-most application is, we can look it up
      in a hash that contains subroutines returning information
      specific to that application. For instance, here's the entry for
      Safari:
    </p>
    <pre><code>
Safari => sub { my ($glue) = @_;
                my $obj = $glue->prop(url => document => 1 => window => 1);
                my $url = $obj->get;
                return URI->new($url)->host if $url;
</code></pre>
    <p>
      This returns the host part of the URL in the first document in
      the first window. For <code>ircle</code>, an IRC client, this code will get
      the channel and server name for the current connection:
    </p>
    <pre><code>
ircle       => sub { sprintf("%s:%s",
               $_[0]->prop('currentchannel')->get,
               $_[0]->prop(servername => connection =>
                   $_[0]->prop('currentconnection')->get
               )->get
              )
            },
</code></pre>
    <p>
      A decent default action is to return the window title:
    </p>
    <pre><code>
default     => sub { my($glue) = @_;
                     my $obj = $objs{$glue->{APPNAME}} ||=
                               $glue->prop(name => window => 1);
                     $obj->get;
                   },
</code></pre>
    <p>
      As before, we cache the concept of "the name of the current
      window" and only create it when we don't have one already.
    </p>
    <p>
      Now let's look at the "Now playing in iTunes" part:
    </p>
    <pre><code>
$state  ||= $itunes->prop('player state');
return unless $state->get eq "playing";

$track  ||= $itunes->prop('current track');
%props    = map { $_ => $track->prop($_) } qw(name artist)
            unless keys %props;

my %info;
for my $prop (keys %props) {
    $info{$prop} = $props{$prop}->get;
}
</code></pre>
    <p>
      This first checks to see if iTunes is playing, and returns
      unless it is. Next, we look for the current track, and get
      handles to the name and artist properties of that track, as in
      our previous iTunes example.
    </p>
    <p>
      Finally, when we've set up all the handles we need, we call
      <code>get</code> to turn them into real data. This populates
      <code>%info</code> with the name and artist of the
      currently playing track.
    </p>
    <p>
      Now that we have the current application name, the extra information,
      and the current track, we can publish them as the iChat status,
      with this subroutine:
    </p>
    <pre><code>
use Mac::Apps::Launch qw(IsRunning);

sub ichat {
    my($output) = @_;

    my $ichat = get_app('iChat') or return;
    return unless IsRunning($ichat->{ID});

    $status  ||= $ichat->prop('status');
    return unless $status->get eq 'available';

    $message ||= $ichat->prop('status message');
    $message->set(to => $output);
}
</code></pre>
    <p>
      First, we have the <code>IsRunning</code>
      subroutine from <code>Mac::AppleEvents::Simple</code>, which
      takes the old-style four-character ID of the application we want
      to ask about. The <code>ID</code> slot of the glue object will
      tell us this ID, and so we can immediately give up setting the
      iChat status if iChat isn't even running. Then we use
      <code>set</code> as before to change the status to whatever we want.
    </p>
    <p>
      Finally, we mentioned that <code>happening</code> can also ask other
      hosts what's playing on their iTunes as well. This is because, if
      "Remote Apple Events" is turned on in the Sharing preferences,
      Macs support passing these Apple events between machines. Of
      course, this often requires authentication, so when it first
      contacts a host to send an Event, <code>happening</code> will
      pop-up a login box to ask for credentials -- this is all handled
      internally by the operating system. Here's the code that
      <code>happening</code> actually uses:
    </p>
    <pre><code>
my $found = 0;
if (IsRunning($itunes->{ID})) {
    $itunes->ADDRESS;
    $found = 1 if $state->get eq 'playing';
}

unless ($found) {
    for my $host (@hosts) {
        next unless $hosts{$host} + 60 &lt; time();
        $itunes-&gt;ADDRESS(eppc => iTunes => $host);
        $found = 1, last if $state->get eq 'playing';
        $hosts{$host} = time();
    }
}
</code></pre>
    <p>
      The first paragraph checks to see if iTunes is running
      locally. If so, we're done. If not, we're
      going to have to ask the hosts specified in the
      <code>@hosts</code> array about it. The first and last lines
      inside the <code>for</code> loop simple ensure that hosts are
      only tried every minute at most. The second line in there is the
      interesting one, though:
    </p>
    <pre><code>
$itunes-&gt;ADDRESS(eppc => iTunes => $host);
</code></pre>
    <p>
      This changes the <code>iTunes</code> glue handle from being a
      local one to being one that contacts the "iTunes" application on
      host <code>$host</code> over EPPC, the remote Apple events
      transport.
    </p>
    <p>
      Because <code>$state</code> is the player status of
      <code>$itunes</code>, it will now return the correct status even
      though <code>$itunes</code> now refers to an application on a
      different computer! Similarly, all the handles we have to the
      artist and name of the  current track will correctly refer to
      <code>$itunes</code>, no matter which iTunes instance that means.
    </p>
    <p>
      We hope you'll join us next time for more <code>Mac::Glue</code>
      tips and tricks, as we look at real-life applications of
      scripting Mac applications in Perl.
    </p>



        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-860" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2004/01/16/regexps.html" rel="bookmark">Maintaining Regular Expressions</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Aaron Mackey</span> on <abbr class="published" title="2004-01-16T00:00:00-08:00">January 16, 2004 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            
<!-- sidebar begins -->
<!-- don't move sidebars -->
<!-- sidebar ends -->

<p>For some, regular expressions provide the chainsaw functionality of
the much-touted Perl "Swiss Army knife" metaphor.  They are powerful,
fast, and very sharp, but like real chainsaws, can be dangerous when
used without appropriate safety measures. </p>

<p>In this article I'll
discuss the issues associated with using heavy-duty, contractor-grade
regular expressions, and demonstrate a few maintenance techniques to
keep these chainsaws in proper condition for safe and effective
long-term use.</p>

<h3>Readability: Whitespace and Comments</h3>

<p>Before getting into any deep issues, I want to cover the number one
rule of shop safety: use whitespace to format your regular
expressions.  Most of us already honor this wisdom in our various
coding styles (though perhaps not with the zeal of Python developers).
But more of us could make better, judicious use of whitespace in our
regular expressions, via the <code>/x</code> modifier.  Not only does
it improve readability, but allows us to add meaningful, explanatory
comments.  For example, this simple regular expression:</p>

<pre><code># matching "foobar" is critical here ...
  $_ =~ m/foobar/;</code></pre>

<p>Could be rewritten, using a trailing <code>/x</code> modifier,
as:</p>

<pre><code>$_ =~ m/ foobar    # matching "foobar" is critical here ...
         /x;</code></pre>

<p>Now, in this example you might argue that readability wasn't
improved at all; I guess that's the problem with triviality.  Here's
another, slightly less trivial example that also illustrates the need
to escape literal whitespace and comment characters when using
the <code>/x</code> modifier:</p>

<pre><code>$_ =~ m/^                         # anchor at beginning of line
          The\ quick\ (\w+)\ fox    # fox adjective
          \ (\w+)\ over             # fox action verb
          \ the\ (\w+) dog          # dog adjective
          (?:                       # whitespace-trimmed comment:
            \s* \# \s*              #   whitespace and comment token
            (.*?)                   #   captured comment text; non-greedy!
            \s*                     #   any trailing whitespace
          )?                        # this is all optional
          $                         # end of line anchor
         /x;                        # allow whitespace</code></pre>

<p>This regular expression successfully matches the following lines of
input:</p>

<pre><code>The quick brown fox jumped over the lazy dog
The quick red fox bounded over the sleeping dog
The quick black fox slavered over the dead dog   # a bit macabre, no?</code></pre>

<p>While embedding meaningful explanatory comments in your regular
expressions can only help readability and maintenance, many of us
don't like the plethora of backslashed spaces made necessary by the
"global" <code>/x</code> modifier.  Enter the "locally"
acting <code>(?#)</code> and <code>(?x:)</code> embedded
modifiers:</p>

<pre><code>$_ =~ m/^(?#                      # anchor at beginning of line

          )The quick (\w+) fox (?#  # fox adjective
          )(\w+) over (?#           # fox action verb
          )the (\w+) dog(?x:        # dog adjective
                                    # optional, trimmed comment:
            \s*                     #   leading whitespace
            \# \s* (.*?)            #   comment text
            \s*                     #   trailing whitespace

          )?$(?#                    # end of line anchor
          )/;</code></pre>

<p>In this case, the <code>(?#)</code> embedded modifier was used to
introduce our commentary between each set of whitespace-sensitive
textual components; the non-capturing parentheses
construct <code>(?:)</code> used for the optional comment text was
also altered to include a locally-acting <code>x</code> modifier.  No
backslashing was necessary, but it's a bit harder to quickly
distinguish relevant whitespace.  To each their own, YMMV, TIMTOWTDI,
etc.; the fact is, both commented examples are probably easier to
maintain than:</p>

<pre><code># match the fox adjective and action verb, then the dog adjective,
  # and any optional, whitespace-trimmed commentary:
  $_ =~ m/^The quick (\w+) fox (\w+) over the (\w+) dog(?:\s*#\s*(.*?)\s*$/;</code></pre>

<p>This example, while well-commented and clear at first, quickly
deteriorates into the nearly unreadable "line noise" that gives Perl
programmers a bad name and makes later maintenance difficult.</p>

<csperl file="grab" domain="on" record="b/834" template="b/article_sidebar2.view">

<p>So, as in other programming languages, use whitespace formatting
and commenting as appropriate, or maybe even when it seems like
overkill; it can't hurt.  And like the choice between alternative code
indentation and bracing styles, Perl regular expressions allow a few
different options (global <code>/x</code> modifier,
local <code>(?#)</code> and <code>(?x:)</code> embedded modifiers) to
suit your particular aesthetics.</p>

<h3>Capturing Parenthesis: Taming the Jungle</h3>

<p>Most of us use regular expressions to actually do something with
the parsed text (although the condition that the input matches the
expressions is also important).  Assigning the captured text from the
previous example is relatively easy: the first three capturing
parentheses are visually distinct and can be clearly
numbered <code>$1</code>, <code>$2</code> and <code>$3</code>;
however, the extra set of non-capturing parentheses, which provide
optional commentary, themselves have another set of embedded,
capturing parentheses; here's another rewriting of the example, with
slightly less whitespace formatting:</p>

<pre><code>my ($fox, $verb, $dog, $comment);
  if ( $_ =~ m/^                         # anchor at beginning of line
               The\ quick\ (\w+)\ fox    # fox adjective
               \ (\w+)\ over             # fox action verb
               \ the\ (\w+) dog          # dog adjective
               (?:\s* \# \s* (.*?) \s*)? # an optional, trimmed comment
               $                         # end of line anchor
              /x
     ) {
      ($fox, $verb, $dog, $comment) = ($1, $2, $3, $4);
  }</code></pre>

<p>From a quick glance at this code, can you immediately tell whether
the <code>$comment</code> variable will come from <code>$4</code>
or <code>$5</code>?  Will it include the leading <code>#</code>
comment character?  If you are a practiced regular expression
programmer, you probably can answer these questions without
difficulty, at least for this fairly trivial example. But if we could
make <i>this</i> example even clearer, you will hopefully agree
that similarly clarifying some of your more gnarly regular expressions
would be beneficial in the long run.</p>

<p>When regular expressions grow very large, or include more than three pairs of parentheses (capturing or otherwise), a useful clarifying
technique is to embed the capturing assignments directly within the
regular expression, via the code-executing pattern <code>(?{})</code>.
In the embedded code, the special <code>$^N</code> variable, which
holds the contents of the last parenthetical capture, is used to
"inline" any variable assignments; our previous example turns into
this:</p>

<pre><code>my ($fox, $verb, $dog, $comment);
  $_ =~ m/^                               # anchor at beginning of line
          The\ quick\  (\w+)              # fox adjective
                       (?{ $fox  = $^N }) 
          \ fox\       (\w+)              # fox action verb
                       (?{ $verb = $^N })
          \ over\ the\ (\w+)              # dog adjective
                       (?{ $dog  = $^N })
          dog
                                          # optional trimmed comment
            (?:\s* \# \s*                 #   leading whitespace
            (.*?)                         #   comment text
            (?{ $comment = $^N })
            \s*)?                         #   trailing whitespace
          $                               # end of line anchor
         /x;                              # allow whitespace</code></pre>

<p>Now it should be explicitly clear that the <code>$comment</code>
variable will only contain the whitespace-trimmed commentary following
(but not including) the <code>#</code> character.  We also don't have
to worry about numbered
variables <code>$1</code>, <code>$2</code>, <code>$3</code>,
etc. anymore, since we don't make use of them. This regular expression
can be easily extended to capture other text without rearranging
variable assignments.</p>

<h3>Repeated Execution</h3>

<p>There are a few caveats to using this technique, however; note that
code within <code>(?{})</code> constructs is executed immediately as
the regular expression engine incorporates it into a match. That is,
if the engine backtracks off a parenthetical capture to generate a
successful match that does not include that capture, the associated
<code>(?{})</code> code will have already been executed.  To illustrate, let's
again look at just the capturing pattern for the comment
text <code>(.*?)</code> and let's also add a debugging <code>warn
"$comment\n"</code> statement:</p>

<pre><code># optional trimmed comment
            (?:\s* \# \s*               #   leading whitespace
            (.*?) (?{ $comment = $^N;   #   comment text
                      warn "&gt;&gt;$comment&lt;&lt;\n"
                        if $debug;
                    })
            \s*)?                       #   trailing whitespace
          $                             # end of line anchor</code></pre>

<p>The capturing <code>(.*?)</code> pattern is a non-greedy extension
that will cause the regular expression matching engine to constantly
try to finish the match (looking for any trailing whitespace and the
end of string, <code>$</code>) without extending the <code>.*?</code>
pattern any further.  The upshot of all this is that with debugging
turned on, this input text:</p>

<pre><code>The quick black fox slavered over the dead dog # a bit macabre, no?</code></pre>

<p>Will lead to these debugging statements:</p>

<pre><code>&gt;&gt;&lt;&lt;
&gt;&gt;a&lt;&lt;
&gt;&gt;a &lt;&lt;
&gt;&gt;a b&lt;&lt;
&gt;&gt;a bi&lt;&lt;
&gt;&gt;a bit&lt;&lt;
&gt;&gt;a bit &lt;&lt;
&gt;&gt;a bit m&lt;&lt;
[ ... ]
&gt;&gt;a bit macabre, n&lt;&lt;
&gt;&gt;a bit macabre, no&lt;&lt;
&gt;&gt;a bit macabre, no?&lt;&lt;</code></pre>

<p>In other words, the adjacent embedded <code>(?{})</code> code gets
executed every time the matching engine "uses" it while trying to
complete the match; because the matching engine may "backtrack" to try
many alternatives, the embedded code will also be executed as many
times.</p>

<p>This multiple execution behavior does raise a few concerns.  If the
embedded code is only performing assignments, via <code>$^N</code>,
there doesn't seem at first to be much of a problem, because each
successive execution overrides any previous assignments, and only the
final, successful execution matters, right?  However, what if the
input text had instead been:</p>

<pre><code>The quick black fox slavered over the dead doggie # a bit macabre, no?</code></pre>

<p>This text should fail to match the regular expression overall
(since "doggie" won't match "dog"), and it does.  But, because the
embedded <code>(?{})</code> code chunks are executed as the match is
evaluated, the <code>$fox</code>, <code>$verb</code>
and <code>$dog</code> variables are successfully assigned; the match
doesn't fail until "doggie" is seen.  Our program might now be more
readable and maintainable, but we've also subtly altered the behavior
of the program.</p>

<p>The second problem is one of performance; what if our assignment
code hadn't simply copied <code>$^N</code> into a variable, but had
instead executed a remote database update?  Repeatedly hitting the
database with meaningless updates may be crippling and inefficient.
However, the behavioral aspects of the database example are even more
frightening: what if the match failed overall, but our updates had
already been executed?  Imagine that instead of an update operation,
our code triggered a new row insert for the comment, inserting
multiple, incorrect comment rows!</p>













<h3>Deferred Execution</h3>

<p>Luckily, Perl's ability to introduce "locally scoped" variables
provides a mechanism to "defer" code execution until an overall
successful match is accomplished.  As the regular expression matching
engine tries alternative matches, it introduces a new, nested scope
for each <code>(?{})</code> block, and, more importantly, it exits a
local scope if a particular match is abandoned for another.  If we
were to write out the code executed by the matching engine as it moved
(and backtracked) through our input, it might look like this:</p>

<pre><code>{ # introduce new scope
  $fox = $^N;
  { # introduce new scope
    $verb = $^N;
    { # introduce new scope
      $dog = $^N;
      { # introduce new scope
        $comment = $^N;
      } # close scope: failed overall match
      { # introduce new scope
        $comment = $^N;
      } # close scope: failed overall match
      { # introduce new scope
        $comment = $^N;
      } # close scope: failed overall match

      # ...

      { # introduce new scope
        $comment = $^N;
      } # close scope: successful overall match
    } # close scope: successful overall match
  } # close scope: successful overall match
} # close scope: successful overall match</code></pre>

<p>We can use this block-scoping behavior to solve both our altered
behavior and performance issues.  Instead of executing code
immediately within each block, we'll cleverly "bundle" the code up,
save it away on a locally scoped "stack," and only process the code if
and when we get to the end of a successful match:</p>

<pre><code>my ($fox, $verb, $dog, $comment);
  $_ =~ m/(?{
              local @c = ();            # provide storage "stack"
          })
          ^                             # anchor at beginning of line
          The\ quick\  (\w+)            # fox adjective
                       (?{
                           local @c;
                           push @c, sub {
                               $fox = $^N;
                           };
                       })
          \ fox\       (\w+)            # fox action verb
                       (?{
                           local @c = @c;
                           push @c, sub {
                               $verb = $^N;
                           };
                       })
          \ over\ the\ (\w+)            # dog adjective
                       (?{
                           local @c = @c;
                           push @c, sub {
                               $dog = $^N;
                           };
                       })
          dog
                                        # optional trimmed comment
            (?:\s* \# \s*               #   leading whitespace
            (.*?)                       #   comment text
            (?{
                local @c = @c;
                push @c, sub {
                    $comment = $^N;
                    warn "&gt;&gt;$comment&lt;&lt;\n"
                      if $debug;
                };
            })
            \s*)?                       #   trailing whitespace
          $                             # end of line anchor
          (?{
              for (@c) { &amp;$_; }         # execute the deferred code
          })
         /x;                            # allow whitespace</code></pre>

<p>Using subroutine "closures" to package up our code and save them on
a locally defined stack, <code>@c</code>, allows us to defer any
processing until the very end of a successful match. Here's the
matching engine code execution "path":</p>

<pre><code>{ # introduce new scope

  local @c = (); # provide storage "stack"

  { # introduce new scope

    local @c;
    push @c, sub { $fox = $^N; };

    { # introduce new scope

      local @c = @c;
      push @c, sub { $verb = $^N; };

      { # introduce new scope

        local @c = @c;
        push @c, sub { $dog = $^N; };

        { # introduce new scope

          local @c = @c;
          push @c, sub { $comment = $^N; };

        } # close scope; lose changes to @c

        { # introduce new scope

          local @c = @c;
          push @c, sub { $comment = $^N; };

        } # close scope; lose changes to @c

        # ...

        { # introduce new scope

          local @c = @c;
          push @c, sub { $comment = $^N; };

          { # introduce new scope

            for (@c) { &amp;$_; }

          } # close scope

        } # close scope; lose changes to @c
      } # close scope; lose changes to @c
    } # close scope; lose changes to @c
  } # close scope; lose changes to @c
} # close scope; no more @c at all</code></pre>

<p>This last technique is especially wordy; however, given judicious
use of whitespace and well-aligned formatting, this idiom could ease
the maintenance of long, complicated regular expressions.</p>

<p>But, more importantly, <b>it doesn't work</b> as written.  What!?!
Why?  Well, it turns out that Perl's support for code blocks
inside <code>(?{})</code> constructs doesn't support subroutine
closures (even attempting to compile one causes a core dump).  But
don't worry, all is not lost!  Since this is Perl, we can always take
things a step further, and make the hard things easy ...</p>

<csperl file="grab" domain="on" record="b/754" template="b/article_sidebar2.view">

<h3>Making it Actually Work: <code>use Regexp::DeferredExecution</code></h3>

<p>Though we cannot (yet) compile subroutines within <code>(?{})</code>
constructs, we can manipulate all the other types of Perl variables:
scalars, arrays, and hashes.  So instead of using closures:</p>

<pre><code>m/
    (?{ local @c = (); })
    # ...
    (?{ local @c; push @c, sub { $comment = ^$N; } })
    # ...
    (?{ for (@c) { &amp;$_; } })
   /x</code></pre>

<p>We can instead just package up our <code>$comment = $^N</code> code into
a string, to be executed by an <code>eval</code> statement later:</p>

<pre><code>m/
    (?{ local @c = (); })
    # ...
    (?{ local @c; push @c, [ $^N, q{ $comment = ^$N; } ] })
    # ...
    (?{ for (@c) { $^N = $$[0]; eval $$[1]; } })
   /x</code></pre>

<p>Note that we also had to store away the version of <code>$^N</code> that was
active at the time of the <code>(?{})</code> pattern, because it very
likely will have changed by the end of the match.  We didn't need to do this previously, as we were storing closures that efficiently captured all the local context of the code to be executed.</p>

<p>Well, now this is getting <i>really</i> wordy, and downright ugly
to be honest.  However, through the magic of Perl's overloading
mechanism, we can avoid having to see any of that ugliness, by simply
using the <code>Regexp::DeferredExecution</code> module from CPAN:</p>

<pre><code>use Regexp:DeferredExecution;

  my ($fox, $verb, $dog, $comment);
  $_ =~ m/^                               # anchor at beginning of line
          The\ quick\  (\w+)              # fox adjective
                       (?{ $fox  = $^N }) 
          \ fox\       (\w+)              # fox action verb
                       (?{ $verb = $^N })
          \ over\ the\ (\w+)              # dog adjective
                       (?{ $dog  = $^N })
          dog
                                          # optional trimmed comment
            (?:\s* \# \s*                 #   leading whitespace
            (.*?)
            (?{ $comment = $^N })         #   comment text
            \s*)?                         #   trailing whitespace
          $                               # end of line anchor
         /x;                              # allow whitespace</code></pre>

<p>How does the <code>Regexp::DeferredExecution</code> module perform its magic?  Carefully, of course, but also simply; it just makes the
same alterations to regular expressions that we made manually.  1) An
initiating embedded code pattern is prepended to declare local "stack"
storage. 2) Another embedded code pattern is added at the end of the
expression to execute any code found in the stack (the stack itself is
stored in
<code>@Regexp::DeferredExecution::c</code>, so you shouldn't need to
worry about variable name collisions with your own code).  3) Finally,
any <code>(?{})</code> constructs seen in your regular expressions are
saved away onto a local copy of the stack for later execution.  It
looks a little like this:</p>

<pre><code>package Regexp::DeferredExecution;

use Text::Balanced qw(extract_multiple extract_codeblock);

use overload;

sub import { overload::constant 'qr' =&gt; \&amp;convert; }
sub unimport { overload::remove_constant 'qr'; }

sub convert {

  my $re = shift; 

  # no need to convert regexp's without (?{ &lt;code> }):
  return $re unless $re =~ m/\(\?\{/;

  my @chunks = extract_multiple($re,
                                [ qr/\(\?  # '(?' (escaped)
                                     (?={) # followed by '{' (lookahead)
                                    /x,
                                  \&amp;extract_codeblock
                                ]
                               );

  for (my $i = 1 ; $i &lt; @chunks ; $i++) {
    if ($chunks[$i-1] eq "(?") {
      # wrap all code into a closure and push onto the stack:
      $chunks[$i] =~
        s/\A{ (.*) }\Z/{
          local \@Regexp::DeferredExecution::c;
          push \@Regexp::DeferredExecution::c, [\$^N, q{$1}];
        }/msx;
  }

  $re = join("", @chunks);

  # install the stack storage and execution code:
  $re = "(?{
            local \@Regexp::DeferredExecution::c = (); # the stack
         })$re(?{
            for (\@Regexp::DeferredExecution::c) {
              \$^N = \$\$_[0];  # reinstate \$^N
              eval \$\$_[1];    # execute the code
            }
         })";

  return $re;
}

1;</code></pre>

<p>One caveat of <code>Regexp::DeferredExecution</code> use is that
while execution will occur only once per compiled regular expressions,
the ability to embed regular expressions inside of other regular
expressions will circumvent this behavior:</p>

<pre><code>use Regexp::DeferredExecution;

  # the quintessential foobar/foobaz parser:
  $re = qr/foo
           (?:
              bar (?:{ warn "saw bar!\n"; })
              |
              baz (?:{ warn "saw baz!\n"; })
           )?/x;

  # someone's getting silly now:
  $re2 = qr/ $re
             baroo!
             (?:{ warn "saw foobarbaroo! (or, foobazbaroo!)\n"; })
           /x;

  "foobar" =~ /$re2/;

  __END__
  "saw bar!"
</code></pre>Even though the input text to <code>$re2</code> failed to match, the
deferred code from <code>$re</code> was executed because its pattern
<i>did</i> match successfully.
Therefore, <code>Regexp::DeferredExecution</code> should only be used
with "constant" regular expressions; there is currently no way to
overload dynamic, "interpolated" regular expressions.

<h3>See Also</h3>

<p>The <code>Regexp::Fields</code> module provides a much more compact
shorthand for embedded named variable
assignments, <code>(?&lt;varname&gt; <i>pattern</i>)</code>, such that
our example becomes:</p>

<pre><code>use Regexp::Fields qw(my);

  my $rx =
    qr/^                             # anchor at beginning of line
       The\ quick\ (?&lt;fox&gt; \w+)\ fox # fox adjective
       \ (?&lt;verb&gt; \w+)\ over         # fox action verb
       \ the\ (?&lt;dog&gt; \w+) dog       # dog adjective
       (?:\s* \# \s*
          (?&lt;comment&gt; .*?)
       \s*)? # an optional, trimmed comment
       $                             # end of line anchor
      /x;</code></pre>

<p>Note that in this particular example, the <code>my $rx</code>
compilation stanza actually implicitly
declared <code>$fox</code>, <code>$verb</code> etc.  If variable
assignment is all you're ever doing, <code>Regexp::Fields</code> is
all you'll need. If you want to embed more generic code fragments in
your regular expressions, <code>Regexp::DeferredExecution</code> may
be your ticket.</p>

<p>And finally, because in Perl there is always One More Way To Do It,
I'll also demonstrate <code>Regexp::English</code>, a module that
allows you to use regular expressions without actually writing any
regular expressions:</p>

<pre><code>use Regexp::English;

  my ($fox, $verb, $dog, $comment);

  my $rx = Regexp::English-&gt;new
               -&gt; start_of_line
               -&gt; literal('The quick ')

               -&gt; remember(\$fox)
                   -&gt; word_chars
               -&gt; end

               -&gt; literal(' fox ')

               -&gt; remember(\$verb)
                   -&gt; word_chars
               -&gt; end

               -&gt; literal(' over the ')

               -&gt; remember(\$dog)
                   -&gt; word_chars
               -&gt; end

               -&gt; literal(' dog')

               -&gt; optional
                   -&gt; zero_or_more -&gt; whitespace_char -&gt; end
                   -&gt; literal('#')
                   -&gt; zero_or_more -&gt; whitespace_char -&gt; end

                   -&gt; remember(\$comment)
                       -&gt; minimal
                           -&gt; multiple
                               -&gt; word_char
                               -&gt; or
                               -&gt; whitespace_char
                           -&gt; end
                       -&gt; end
                   -&gt; end
                   -&gt; zero_or_more -&gt; whitespace_char -&gt; end
               -&gt;end

               -&gt; end_of_line;

  $rx-&gt;match($_);</code></pre>

<p>I must admit that this last example appeals to my inner-Lispish
self.</p>

<p>Hopefully you've gleaned a few tips and tricks from this little
workshop of mine that you can take back to your own shop.</p>
        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-868" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2004/01/p6pdigest/20040111.html" rel="bookmark">This week on Perl 6, week ending 2004-01-11</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Piers Cawley</span> on <abbr class="published" title="2004-01-11T00:00:00-08:00">January 11, 2004 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            
<!-- sidebar begins -->
<!-- don't move sidebars -->
<!-- sidebar ends -->

<p>It's Monday.
People have been talking about Perl 6,
Parrot and the European Union Constitution.
Let's find out what they've been saying about Parrot first shall we?</p>

<h4><a name="Threads">Threads</a></h4>

<p>Threads were discussed some more.
Dan's deadline is coming up soon,
hopefully soon after that discussion will move from Holy Skirmishes about architecture and on to meaningful discussions of a real implementation.</p>

<p>Hmm...
that came out rather more dismissive than I intended.</p>

<h4><a name="Continuation_problems">Continuation problems</a></h4>

<p>Luke Palmer found a problem with Parrot's continuations.
A continuation is supposed to encapsulate the interpreter's control state,
in other words the position of the program counter and the state of the register stacks,
and a pointer to the previous continuation.
However,
it turns out that a Parrot continuation just contains the program counter and a pointer to the previous continuation.
There was some discussion of why this was so (Melvin Smith seemed to claim that it was both his fault and not his fault).</p>

<csperl file="grab" domain="on" record="b/940" template="b/article_sidebar.view">

<p>Everyone agreed that this needed to be fixed pretty promptly and it wasn't long before Luke posted a patch.</p>

<p><a href='http://groups.google.com/groups?selm=20040106145324.GA12805@babylonia.flatirons.org'>http://groups.google.com</a></p>

<p><a href='http://groups.google.com/groups?selm=20040108031029.GA19161@babylonia.flatirons.org'>http://groups.google.com</a></p>

<h4><a name="A_problem_with_threads">A problem with threads</a></h4>

<p>In a change from the discussions of thread philosophy,
Jeff Clites posted about a problem he was having with Parrot's current threads implementation which was causing problems when trying to join multiple threads.
Between them,
Jeff and Leo T&ouml;tsch tracked down a possible cause of the problem and Jeff offered up a patch which Leo applied.</p>

<p><a href='http://groups.google.com/groups?selm=B8972372-3F66-11D8-A5EA-000393A6B9DA@mac.com'>http://groups.google.com</a></p>

<h4><a name="The_PPC_JIT_gets_fixed">The PPC JIT gets fixed</a></h4>

<p>Jeff Clites also posted a patch which cleans up the last problems with the JIT on PPC.
Leo applied it.
Us Apple users cheered.</p>

<p><a href='http://groups.google.com/groups?selm=200401061713.i06HDgZ14086@thu8.leo.home'>http://groups.google.com</a></p>

<h4><a name="Luke_Palmer_gets_his_act_together">Luke Palmer gets his act together</a></h4>

<p>Luke Palmer decided to get his act together (given the level of his contribution to the Perl 6 lists so far,
I'm almost scared to find out what he's going to be like now...) and finish up his 'Priority DOD' rethink of the Garbage Collector.
I confess I'm not really qualified to discuss what's different about it,
beyond the claim of a 10,000% speed up when there were no 'eager' PMCs about (things that need immediate cleanup on scope exit; the canonical example being a Perlish file handle) and only a 5% slowdown when there were.</p>

<p>Luke and Leo discussed the patch a bit before Leo applied it.</p>

<p><a href='http://groups.google.com/groups?selm=20040105134753.GA2215@babylonia.flatirons.org'>http://groups.google.com</a></p>

<p><a href='http://groups.google.com/groups?selm=20040105192430.GA32476@babylonia.flatirons.org'>http://groups.google.com</a> -- Luke explains the patch</p>

<h4><a name="IMCC_speed_issues">IMCC speed issues</a></h4>

<p>Dan posted some timings he'd made of IMCC compiling some large subs,
which were not the most wonderful timings I've ever seen.
A 41 minute compile isn't generally what one wishes to see.
Melvin Smith had a few ideas about what was causing it,
as did Leo (it seems that IMCC's register allocation is very slow in the presence of spilling and Live analysis increases with the product of the number of lines and variables in a segment.
Leo recommended redoing the sub to reduce the number of (and avoid long lived) PIR variables (ie.
registers) by using lexicals or globals instead.</p>

<p><a href='http://groups.google.com/groups?selm=a0601020fbc1f2406c38a@[10.0.1.2]'>http://groups.google.com/</a></p>

<h4><a name="References_to_hash_elements">References to hash elements</a></h4>

<p>Arthur &quot;Ponie&quot; Bergman had some questions about how references to hash elements would be done.
Consider the following Perl code:</p>

<pre lang='und' xml:lang='und'>   my %hash;
   $foo = \$hash{key};

   $$foo = &quot;bar&quot;;

   print $hash{key}; # Prints &quot;bar&quot;</pre>

<p>Arthur wondered how this could be made to work with the current vtable setup, specifically in the presence of tying. Simon Cozens thought that there should be a special HashElement PMC which would handle fetching the actual value from the hash (or writing it back to the hash) as appropriate. Dan agreed with him, so it looks like this might be the way forward.</p>

<p><a href='http://groups.google.com/groups?selm=E8338D24-4068-11D8-896A-000A95A2734C@nanisky.com'>http://groups.google.com</a></p>

<h4><a name="Instantiation?">Instantiation?</a></h4>

<p>Michal Wallace asked how to instantiate objects from Parrot. Luke Palmer supplied the answer, but pointed out that, at present, classes can only have integer attributes. It turns out that, for Michal's purposes, he can probably get by with using properties instead, so that's all right.</p>

<p>St&eacute;phane Payrard did the decent thing and implemented the other attribute types. He even wrote tests.</p>

<p><a href='http://groups.google.com/groups?selm=Pine.LNX.4.58.0401071857360.13262@hydrogen.sabren.com'>http://groups.google.com</a></p>

<p><a href='http://groups.google.com/groups?selm=20040110212248.GA12650@stefp.dyndns.org'>http://groups.google.com</a></p>

<h4><a name="Creating_'proper'_interpreters_in_Parrot">Creating 'proper' interpreters in Parrot</a></h4>

<p>Simon Cozens wondered what was left to do to allow parrot to be embedded in an interpreter and have PIR fed directly to it. Leo pointed him at his own YAL.</p>

<p><a href='http://groups.google.com/groups?selm=87u136fzs2.fsf@alibi.simon-cozens.org'>http://groups.google.com</a></p>

<p><a href='http://toetsch.at/yal/'>http://toetsch.at/yal/</a> -- Yet Another Language</p>

<h4><a name="yield_op?"><code lang='und' xml:lang='und'>yield</code> op?</a></h4>

<p>Michal Wallace was uncomfortable with the workings of Parrot Coroutines and posted a sample of parrot code which demonstrated why. Leo promised to fix it once he'd applied Luke's Continuations patch.</p>

<p><a href='http://groups.google.com/groups?selm=Pine.LNX.4.58.0401090305540.21408@hydrogen.sabren.com'>http://groups.google.com</a></p>

<h4><a name="Congratulations_Dan">Congratulations Dan</a></h4>

<p>Melvin Smith offered his congratulations to Dan for the first commercial use of Parrot. I think I can safely say we all echo those congratulations.</p>

<p><a href='http://www.sidhe.org/~dan/blog/archives/000288.html'>http://www.sidhe.org/~dan/blog/archives/000288.html</a></p>

<h3><a name="Meanwhile_in_perl6-language">Meanwhile in perl6-language</a></h3>

<h4><a name="Roles_and_Mix-ins">Roles and Mix-ins</a></h4>

<p>Discussion of roles as mix-ins kicked off again after the Christmas break. The canonical <code lang='und' xml:lang='und'>Dog::bark</code> vs. <code lang='und' xml:lang='und'>Tree::bark</code> problem was discussed.</p>

<p><a href='http://groups.google.com/groups?selm=20040105164608.GA69309@megazone.bigpanda.com'>http://groups.google.com</a></p>

<h4><a name="The_European_Union_Constitution">The European Union Constitution</a></h4>

<p>For reasons that still escape me various Americans paraded their ignorance about the putative constitution of a loose union of sovereign states.</p>

<h4><a name="Perl_6_Story_Cards">Perl 6 Story Cards</a></h4>

<p>In last week's summary I mentioned the Perl 6 Stories Kwiki that Allison and chromatic set up some months ago and suggested that people wanting to write tests and stories for the new language take a look at it. It seems they did, and the Wiki's seen a good deal of activity. Check it out if you're interested in helping with the project.</p>

<p><a href='http://p6stories.kwiki.org/'>http://p6stories.kwiki.org/</a></p>

<h4><a name="A_modest_question">A modest question</a></h4>

<p>Austin Hastings asked the design team why they were fascinated with Traits (which will be called Roles in Perl 6). He'd read the original paper and was unimpressed with the gains that were made by using them.</p>

<p>The awkwardly cased chromatic opened the case for Roles by pointing out that Roles allow for finer grained naming of chunks of functionality and code reuse. I must say I agree; I'm always keen on opportunities to name something.</p>

<p><a href='http://groups.google.com/groups?selm=ICELKKFHGNOHCNCCCBKFMEDNCJAA.Austin_Hastings@Yahoo.com'>http://groups.google.com</a></p>

<h3><a name="Announcement">Announcement</a></h3>

<p>Iain &quot;Spoon&quot; Truskett was not a prolific contributor to the Perl 6 mailing lists. He was, however, an important contributor to these summaries every week; he was the maintainer of WWW::Shorten, the module that I use to shorten the URLs on the version of the summary that goes out to perl6-announce.</p>

<p>He died from a sudden cardiac arrest on the 29th of December. He was 24. He will be missed. This summary is dedicated to his memory.</p>

<p><a href='http://iain.truskett.id.au/'>http://iain.truskett.id.au/</a> -- Iain's website</p>
        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-858" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2004/01/09/survey.html" rel="bookmark">The State of Perl</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Adam Turoff</span> on <abbr class="published" title="2004-01-09T00:00:00-08:00">January  9, 2004 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            
<!-- sidebar begins -->
<!-- don't move sidebars -->
<!-- sidebar ends -->

<p>A colleague of mine recently asked me about Perl's future.
Specifically,
he wondered if we have any tricks up our sleeves to compete against today's two most popular platforms: .NET and Java.
Without a second's hesitation,
I repeated the same answer I've used for years when people ask me if Perl has a future:</p>

<pre><code>        Perl certainly is alive and well.  The Perl 6 development team is
        working very hard to define the next version of the Perl language.
        Another team of developers is working hard on Parrot, the next-
        generation runtime engine for Perl 6.  Parrot is being designed to
        support dynamic languages like Perl 6, but also Python, Ruby and
        others.  Perl 6 will also support a transparent migration of
        existing Perl 5 code.</code></pre>

<p>Then I cheerfully continued with this addendum:</p>

<pre><code>        Fotango is sponsoring one of their developers, Arthur Bergman, to
        work on Ponie, the reimplementation of Perl 5.10 on top of Parrot.</code></pre>

<p>That is often a sufficient answer to the question, &quot;Does Perl have a future?&quot;</p>

<p>However, my colleague already knew about Perl 6 and Parrot. Perl 6 was announced with a great deal of fanfare about three and a half years ago. The Parrot project, announced as an April Fool's joke in 2001, is now over two years old as a real open source project. While Parrot has made some amazing progress, it is not yet ready for production usage, and will not be for some time to come. The big near-term goal for Parrot is to execute Python bytecode faster than the standard CPython implementation, and to do so by the Open Source Convention in July 2004. There's a fair amount of work to do between now and then, and even more work necessary to take Parrot from that milestone to something you can use as a replacement for something like, say, Perl.</p>

<csperl file="grab" domain="on" record="b/940" template="b/article_sidebar.view">

<p>So, aside from the grand plans of Perl 6 and Parrot, does Perl <i>really</i> have a future?</p>

<h3><a name="The_State_of_Perl_Development">The State of Perl Development</a></h3>

<p>Perl 6 and Parrot do not represent our future, but rather our long-term insurance policy. When Perl 6 was announced, the Perl 5 implementation was already about seven years old. Core developers were leaving perl5-porters and not being replaced. (We didn't know it at the time, but this turned out to be a temporary lull. Thankfully.) The source code is quite complex, and very daunting to new developers. It was and remains unclear whether Perl can sustain itself as an open source project for another ten or twenty years if virtually no one can hack on the core interpreter.</p>

<p>In 2000, Larry Wall saw Perl 6 as a means to keep Perl relevant, and to keep the ideas flowing within the Perl world. The fear at the time was quite palpable: if enough alpha hackers develop in Java or Python and not Perl, the skills we have spent years acquiring and honing will soon become useless and literally worthless. Furthermore, backwards compatibility with thirteen years (now sixteen years) of working Perl code was starting to limit the ease with which Perl can adapt to new demands. Taken to a logical extreme, all of these factors could work against Perl, rendering it yesterday's language, incapable of effectively solving tomorrow's problems.</p>

<p>The plan for Perl 6 was to provide not only a new implementation of the language, but also a new language design that could be extended by mere mortals. This could increase the number of people who would be both capable and interested in maintaining and extending Perl, both as a language and as a compiler/interpreter. A fresh start would help Perl developers take Perl into bold new directions that were simply not practical with the then-current Perl 5 implementation.</p>

<p>Today, over three years later, the Perl development community is quite active writing innovative software that solves the problems real people and businesses face today. However, the innovation and inspiration is not entirely where we thought it would be. Instead of seeing the new language and implementation driving a new wave of creativity, we are seeing innovation in the libraries and modules available on CPAN -- code you can use right now with Perl 5, a language we all know and love.</p>

<p>In a very real sense, the Perl 6 project has already achieved its true goals: to keep Perl relevant and interesting, and to keep the creativity flowing within the Perl community.</p>

<p>What does this mean for Perl's future? First of all, Perl 5 development continues alongside Perl 6 and Parrot. There are currently <b>five</b> active development branches for Perl 5. The main branch, Perl 5.8.x, is alive and well. Jarkko Hietaniemi released Perl 5.8.1 earlier this year as a maintenance upgrade to Perl 5.8.0, and turned over the patch pumpkin to Nick Clark, who is presently working on building Perl 5.8.3. In October, Hugo van der Sanden released the initial snapshot of Perl 5.9.0, the development branch that will lead to Perl 5.10. And this summer, Fotango announced that Arthur Bergman is working on Ponie, a port of Perl 5.10 to run on top of Parrot, instead of the current Perl 5 engine. Perl 5.12 may be the first production release to run on top of the new implementation.</p>

<p>For developers who are using older versions of Perl for compatibility reasons, Rafael Garcia-Suarez is working on Perl 5.6.2, an update to Perl 5.6.1 that adds support for recent operating-system and compiler releases. Leon Brocard is working on making the same kinds of updates for Perl 5.005_04.</p>

<p>Where is Perl going? Perl is moving forward, and in a number of parallel directions. For workaday developers, three releases of Perl will help you get your job done: 5.8.x, 5.6.x and, when absolutely necessary, 5.005_0x. For the perl5-porters who develop Perl itself, fixes are being accepted in 5.8.x and 5.9.x. For bleeding-edge developers, there's plenty of work to do on with Parrot. For the truly bleeding edge, Larry and his lieutenants are hashing out the finer points of the design of the Perl 6 language.</p>

<p>That describes where development of Perl as a language and as a platform is going. But the truly interesting things about Perl aren't language issues, but how Perl is <i>used</i>.</p>

<h3><a name="The_State_of_Perl_Usage">The State of Perl Usage</a></h3>

<p>One way to get a glimpse how Perl is used in the wild is to look at CPAN. I recently took a look at the modules list (<a href="http://www.cpan.org/modules/01modules.index.html">www.cpan.org/modules/01modules.index.html</a>) and counted module distributions by the year of their most recent release. These statistics are not perfect, but they do give a reasonable first approximation of the age of CPAN distributions currently available.</p>

<pre><code>        1995:   30 ( 0.51%)
        1996:   35 ( 0.59%)
        1997:   68 ( 1.16%)
        1998:  189 ( 3.21%)
        1999:  287 ( 4.88%)
        2000:  387 ( 6.58%)
        2001:  708 (12.03%)
        2002: 1268 (21.55%)
        2003: 2907 (49.40%)
        cpan: 5885 (100.00%)</code></pre>

<p>Interestingly, about half of the distributions on CPAN were created or updated in 2003. A little further analysis shows that nearly 85% of these distributions were created or updated since the Perl 6 announcement in July 2000. Clearly, interest in developing in Perl is not on the wane. If anything, Perl development, as measured by CPAN activity, is quite healthy.</p>

<p>Looking at the &quot;freshness&quot; of CPAN doesn't tell the whole story about Perl. It merely indicates that Perl developers are actively releasing code on CPAN. Many of these uploads are new and interesting modules, or updates that add new features or fix bugs in modules that we use every day. Some modules are quite stable and very useful, even though they have not been updated in years. But many modules are old, outdated, joke modules, or abandoned.</p>

<p>A pessimist looks at CPAN and sees abandoned distributions, buggy software, joke modules and packages in the early stage of development (certainly not ready for &quot;prime time&quot; use). An optimist looks at CPAN and sees some amazingly useful modules (DBI, LWP, Apache::*, and so on), and ignores the less useful modules lurking in the far corners of CPAN.</p>

<p>Which view is correct? Looking over the module list, only a very small number of modules are jokes registered in the <code lang='und' xml:lang='und'>Acme</code> namespace: about 85 of over 5800 distributions, or less than 2% of the modules on CPAN. Of course, there are joke modules that are not in the <code lang='und' xml:lang='und'>Acme</code> namespace, like <code lang='und' xml:lang='und'>Lingua::Perligata::Romana</code> and <code lang='und' xml:lang='und'>Lingua::Atinlay::Igpay</code>. Yet the number of jokes released as CPAN modules remains quite small when compared to CPAN as a whole.</p>

<p>But how much of CPAN is actually <i>useful</i>? It depends on what kind of problems you're solving. Let's assume that only the code released within the last three years, or roughly 82% of CPAN, is worth investigating. Let's further assume that everything in the <code lang='und' xml:lang='und'>Acme</code> namespace can be safely ignored, and that the total number of joke modules is no more than twice the number of <code lang='und' xml:lang='und'>Acme</code> modules. Ignoring a further 3-4% of CPAN leaves us with about 78%, or over 4,000 distributions, to examine.</p>

<p>How much of this code is production-quality? It's quite difficult to say, actually. These modules cover a stunningly diverse range of problem domains, including, but not limited to:</p>

<ul>
<li>Application servers</li>

<li>Artificial intelligence algorithms</li>

<li>Astronomy</li>

<li>Audio</li>

<li>Bioinformatics</li>

<li>Compression and encryption</li>

<li>Content management systems (for both small and large scale web sites)</li>

<li>Database interfaces</li>

<li>Date/Time Processing</li>

<li>eCommerce</li>

<li>Email processing</li>

<li>GUI development</li>

<li>Generic algorithms from computer science</li>

<li>Graphing and charting</li>

<li>Image processing</li>

<li>Mathematical and statistical programming</li>

<li>Natural language processing (in English, Chinese, Japanese, and Finnish, among others)</li>

<li>Network programming</li>

<li>Operating-system integration with Windows, Solaris, Linux, Mac OS, etc.</li>

<li>Perl development support</li>

<li>Perl/Apache integration</li>

<li>Spam identification</li>

<li>Software testing</li>

<li>Templating systems</li>

<li>Text processing</li>

<li>Web services, web clients, and web servers</li>

<li>XML/HTML processing</li>
</ul>

<p>...and that's a very incomplete sample of the kinds of distributions available on CPAN today. Suffice it to say that hundreds, if not thousands, of CPAN modules are actively used on a daily basis to solve the kinds problems that we regularly face.</p>

<p>And isn't that the <b>real</b> definition of production quality, anyway?</p>

<h3><a name="The_Other_State_of_Perl_Usage">The Other State of Perl Usage</a></h3>

<p>As Larry mentioned in his second keynote address to the Perl Conference in 1998 (<a href="/pub/a/1998/08/show/onion.html">www.perl.com/pub/a/1998/08/show/onion.html</a>), the Perl community is like an onion. The important part isn't the small core, but rather the larger outer layers where most of the mass and all of the growth are found. Therefore, the true state of Perl isn't about interpreter development or CPAN growth, but in how we all use Perl every day.</p>

<p>Why do we use Perl <i>every day</i>? Because Perl scales to solve both small and large problems. Unlike languages like C, C++, and Java, Perl allows us to write small, trivial programs quickly and easily, without sacrificing the ability to build large applications and systems. The skills and tools we use on large projects are also available when we write small programs.</p>

<h4><a name="Programming_in_the_Small">Programming in the Small</a></h4>

<p>Here's a common example. Suppose I want to look at the O'Reilly Perl resource page and find all links off of that page. My program starts out by loading two modules, <code lang='und' xml:lang='und'>LWP::Simple</code> to fetch the page, and <code lang='und' xml:lang='und'>HTML::LinkExtor</code> to extract all of the links:</p>

<pre><code>        #!/usr/bin/perl -w

        use strict;
        use LWP::Simple;
        use HTML::LinkExtor;

        my $ext = new HTML::LinkExtor;
        $ext-&#62;parse(get(&quot;http://perl.oreilly.com/&quot;));
        my @links = $ext-&#62;links();</code></pre>

<p>At this point, I have the beginnings of a web spider or possibly a screen scraper. With a few regular expressions and a couple of list operations like <code lang='und' xml:lang='und'>grep</code>, <code lang='und' xml:lang='und'>map</code>, or <code lang='und' xml:lang='und'>foreach</code>, I can whittle this list of links down to a list of links to Safari, the O'Reilly's book catalog, or new articles on Perl.com. A couple of lines more, and I could store these links in a database (using <code lang='und' xml:lang='und'>DBI</code>, <code lang='und' xml:lang='und'>DB_File</code>, <code lang='und' xml:lang='und'>GDBM</code>, or some other persistent store).</p>

<p>I've written (and thrown away) many programs like this over the years. They are consistently easy to write, and typically less than one page of code. That says a lot about the capabilities Perl and CPAN provide. It also says a lot about how much a single programmer can accomplish in a few minutes with a small amount of effort.</p>

<p>Yet the most important lesson is this: Perl allows us to use the same tools we use to write applications and large systems to write small scripts and little hacks. Not only are we able to solve mundane problems quickly and easily, but we can use one set of tools and one set of skills to solve a wide range of problems. Furthermore, because we use the same tools, our quick hacks can work alongside larger systems.</p>

<h4><a name="Programming_in_the_Large">Programming in the Large</a></h4>

<p>Of course, it's one thing to assert that Perl programs can scale up beyond the quick hack. It's another thing to actually build large systems with Perl. The Perl Success Stories Archive (<a href="http://perl.oreilly.com/news/success_stories.html">perl.oreilly.com/news/success_stories.html</a>) details many such efforts, including many large systems, high-volume systems, and critical applications.</p>

<p>Then there are the high-profile systems that get a lot of attention at Perl conferences and on various Perl-related mailing lists. For example, Amazon.com, the Internet's largest retailer, uses <code lang='und' xml:lang='und'>HTML::Mason</code> for portions of their web site. Another fifty-odd Mason sites are profiled (<a href="http://www.masonhq.com/about/sites.html">www.masonhq.com/about/sites.html</a>) at <a href="http://www.masonhq.org/">www.masonhq.org</a>, including Salon.com, AvantGo, and DynDNS.</p>

<p>Morgan Stanley is another big user of Perl. As far back as 2001, W. Phillip Moore talked about where Perl and Linux fit into the technology infrastructure at Morgan Stanley. More recently, Merijn Broeren detailed (<a href="http://conferences.oreillynet.com/cs/os2003/view/e_sess/4293">conferences.oreillynet.com/cs/os2003/view/e_sess/4293</a>) how Morgan Stanley relies on Perl to keep 9,000 of its computers up and running non-stop, and how Perl is used for a wide variety of applications used worldwide.</p>

<p>ValueClick, a provider of high-performance Internet advertising, pushes Perl in a different direction. Each day, ValueClick serves up over 100 million targeted banner ads on publisher web sites. The process of choosing which ad to send where is very precise, and handled by some sophisticated Perl code. Analyzing how effective these ads are requires munging through huge amounts of logging data. Unsurprisingly, ValueClick uses Perl here, too.</p>

<p>Ticketmaster sells tickets to sporting and entertainment events in at least twenty countries around the world. In a year, Ticketmaster sells over 80 million tickets worldwide. Recently, Ticketmaster sold one million tickets in a single day, and about half of those tickets were sold over the Web. And the Ticketmaster web site is almost entirely written in Perl.</p>

<p>These are only some of the companies that use Perl for large, important products. Ask around and you'll hear many, many more stories like these. Over the years, I've worked with more than a few companies who created some web-based product or service that was built entirely with Perl. Some of these products were responsible for bringing in tens of millions of dollars in annual revenue.</p>

<p>Clearly, Perl is for more than just simple hacks.</p>

<h3><a name="The_New_State_of_Perl_Usage">The New State of Perl Usage</a></h3>

<p>Many companies use Perl to build proprietary products and Internet-based services they can sell to their customers. Still more companies use Perl to keep internal systems running, and save money through automating mundane processes.</p>

<p>A new way people are using Perl today is the open source business. Companies like Best Practical and Kineticode are building products with Perl, and earning money from training, support contracts, and custom development. Their products are open source, freely available, and easy to extend. Yet there is enough demand for add-on services that these companies are profitable and sustain development of these open source products.</p>

<p>Best Practical Solutions (<a href="http://www.bestpractical.com/">www.bestpractical.com</a>) develops Request Tracker, more commonly known as RT (<a href="http://www.bestpractical.com/rt/">www.bestpractical.com/rt</a>). RT is an issue-tracking system that allows teams to coordinate their activities to manage user requests, fix bugs, and track actions taken on each task. As an open source project, RT has been under development since 1996, and has thousands of corporate users, including those listed on the testimonials page (<a href="http://www.bestpractical.com/rt/praise.html">www.bestpractical.com/rt/praise.html</a>). Today, RT powers bug tracking for Perl development (<a href="http://rt.perl.org/perlbug">rt.perl.org/perlbug</a>), and for CPAN module development (<a href="http://rt.cpan.org">rt.cpan.org</a>). Many organizations rely on the information they keep in RT, sometimes upwards of 1000 issues per day, or 300,000 issues that must be tracked and resolved each year.</p>

<p>Kineticode (<a href="http://www.kineticode.com/">www.kineticode.com</a>)is another successful open source business built around a Perl product, the Bricolage content management system (<a href="http://www.bricolage.cc/">www.bricolage.cc</a>). Bricolage is used by some rather large web sites, including ETOnline (<a href="http://www.etonline.com/">www.etonline.com</a>) and the World Health Organization (<a href="http://www.who.int/">www.who.int</a>). Recently, the Howard Dean campaign (<a href="http://www.deanforamerica.com/">www.deanforamerica.com</a>) adopted Bricolage as its content management system to handle the site's frequent updates in the presence of millions of pageviews per day, with peak demand more than ten times that rate.</p>

<p>A somewhat related business is SixApart (<a href="http://www.sixapart.com/">www.sixapart.com</a>), makers of the ever-popular MovableType (<a href="http://www.movabletype.org/">www.movabletype.org</a>). SixApart offers MovableType with a free license for personal and non-commercial use, but charges a licensing fee for corporate and commercial use. Make no mistake, MovableType <b>is</b> proprietary software, even though it is implemented in Perl. Nevertheless, SixApart has managed to build a profitable business around their Perl-based product.</p>

<p>Surely these are the early days for businesses selling or supporting software written in Perl. These three companies are not the only ones forging this path, although they are certainly three of the most visible.</p>

<h3><a name="Conclusion">Conclusion</a></h3>

<p>I started looking into the state of Perl today when my colleague asked me if Perl has a future. He challenged me to look past my knee-jerk answers, &quot;<i>Of course Perl has a future!</i>&quot; and &quot;<i>Perl's future is in Perl 6 and Parrot!</i>&quot; I'm glad he did.</p>

<p>There's a lot of activity in the Perl world today, and much of it quite easily overlooked. Core development is moving along at a respectable pace; CPAN activity is quite healthy; and Perl remains a capable environment for solving problems, whether they need a quick hack, a large system, or a Perl-based product. Even if we don't see Perl 6 in 2004, there's a lot of work to be done in Perl 5, and a lot of work Perl 5 is still quite capable of doing.</p>

<p>Then there's the original question that started this investigation rolling: &quot;<i>Can Perl compete with Java and .NET?</i>&quot; Clearly, when it comes to solving problems, Perl is at least as capable a tool as Java and .NET today. When it comes to evangelizing one platform to the exclusion of all others, then perhaps Perl can't compete with .NET or Java. Then again, when did evangelism ever solve a problem that involved sitting down and writing code?</p>

<p>Of course, if Java or .NET is more your speed, by all means use those environments. Perl's success is not predicated on some other language's failure. Perl's success hinges upon helping you get <i>your</i> job done.</p>



        </div>



    </div>
    <div class="asset-footer"></div>
</div>


                            
                            <div id="entry-866" class="entry-asset asset hentry">
    <div class="asset-header">
        <h2 class="asset-name entry-title"><a href="/pub/2004/01/p6pdigest/20040104.html" rel="bookmark">This week on Perl 6, week ending 2004-01-04</a></h2>
        <div class="asset-meta">
            <span class="byline">
    
                By <span class="vcard author">Piers Cawley</span> on <abbr class="published" title="2004-01-04T00:00:00-08:00">January  4, 2004 12:00 AM</abbr>
    
            </span>

            
            

        </div>
    </div>
    <div class="asset-content entry-content">

        <div class="asset-body">
            <p>What a surprise,
a scant week after the last Perl 6 Summary of 2003,
it's the first Perl 6 Summary of 2004.
Will wonders never cease?
Without further ado,
we'll start with perl6-internals as usual.</p>

<h2><a name="Garbage_Collection_Tasks"
>Garbage Collection Tasks</a></h2>

<p>Dan noted that a copying garbage collector doesn't play that well with threads so he proposed a twofold task to fix things.</p>

<ol>
<li>The GC and memory allocation APIs need to be formalized and abstracted in order to allow for changing the GC mechanism when threads come into play.</li>

<li>Someone needs to implement a more traditional,
non-moving GC as an alternative to the copying collector.</li>
</ol>

<h2><a name="Plugging_Parrot_into_Mozilla"
>Plugging Parrot into Mozilla</a></h2>

<p>Stephane Peiry posted a set of patches to allow a parrot plugin for Mozilla.
Not satisfied with this (but pretty darned impressed all the same) Sam Vilain noted that it would be nice if someone wrote an ECMAscript front-end to Parrot.
Patches welcome Sam.</p>

<p><a href='http://groups.google.com/groups?selm=a06010201bc16014403dd@[10.0.1.2]'>http://groups.google.com/groups?selm=a06010201bc16014403dd@[10.0.1.2]</a></p>

<h2><a name="Problems_with_make_test"
>Problems with <code lang='und' xml:lang='und'>make test</code></a></h2>

<p>Harry Jackson couldn't get his build of parrot to finish running <code lang='und' xml:lang='und'>make test</code>.
After a certain amount of thrashing about by the team,
Dan narrowed it down to issues with the mutant '2.96' version of GCC that some versions of Red Hat used for a while.
This is currently the list's best guess as to the root of the problem,
but it's not absolutely certain.
If it does turn out to be the compiler,
the config suite will have to be rejigged to detect and warn.</p>

<p><a href='http://groups.google.com/groups?selm=20031229221255.12911.qmail@onion.perl.org'>http://groups.google.com/groups?selm=20031229221255.12911.qmail@onion.perl.org</a></p>

<h2><a name="Threading_threads"
>Threading threads</a></h2>

<p>They're everywhere!
And I despair of summarizing them.
So I won't.
Here's the root messages for anyone interested enough.
Once things have died down and we know how threading is going to work in Parrot I'll summarize that.</p>

<p>Dan opened the floodgates and asked anyone who was serious about their particular Right Way To Do Threading to write things up as a proper proposal.
He outlined the constraints that Parrot's threading will be working under and encouraged everyone to speak now or forever hold their peace.</p>

<p><a href='http://groups.google.com/groups?selm=1BAB64E0-3AE5-11D8-9E96-000502994722@mac.com'>http://groups.google.com/groups?selm=1BAB64E0-3AE5-11D8-9E96-000502994722@mac.com</a></p>

<p><a href='http://groups.google.com/groups?selm=a06010202bc176658b1c7@[172.24.18.98]'>http://groups.google.com/groups?selm=a06010202bc176658b1c7@[172.24.18.98]</a></p>

<p><a href='http://groups.google.com/groups?selm=a06010205bc17976efc33@[172.24.18.98]'>http://groups.google.com/groups?selm=a06010205bc17976efc33@[172.24.18.98]</a> -- Dan says put up or shut up</p>

<p><a href='http://groups.google.com/groups?selm=3FF2D35D.2090707@toetsch.at'>http://groups.google.com/groups?selm=3FF2D35D.2090707@toetsch.at</a></p>

<p><a href='http://groups.google.com/groups?selm=1106_1072984463@nntp.perl.org'>http://groups.google.com/groups?selm=1106_1072984463@nntp.perl.org</a></p>

<p><a href='http://groups.google.com/groups?selm=9227ACBD-3CB1-11D8-9E96-000502994722@mac.com'>http://groups.google.com/groups?selm=9227ACBD-3CB1-11D8-9E96-000502994722@mac.com</a></p>

<p><a href='http://groups.google.com/groups?selm=a06010200bc1cfc809cde@[10.0.1.2]'>http://groups.google.com/groups?selm=a06010200bc1cfc809cde@[10.0.1.2]</a></p>

<p><a href='http://groups.google.com/groups?selm=a0601020abc1e255347d5@[10.0.1.2]'>http://groups.google.com/groups?selm=a0601020abc1e255347d5@[10.0.1.2]</a> -- Dan offers up common terminology</p>

<h2><a name="Don't_use_IMCC_macros"
>Don't use IMCC macros</a></h2>

<p>Bernhard Schmalhofer found what looked like a bug in IMCC's macro support.
This prompted Melvin Smith to expedite the removal of IMCC macro support as threatened some weeks ago.
However,
it turned out that that wasn't actually the seat of the bug.
But if you like IMCC macros now is the time to make a <i>very</i> good case to Melvin,
I doubt you'll convince him though; macros belong in a preprocessor.</p>

<p><a href='http://groups.google.com/groups?selm=1072802718.3ff1ab9e10ebc@maxplanck.biomax.de'>http://groups.google.com/groups?selm=1072802718.3ff1ab9e10ebc@maxplanck.biomax.de</a></p>

<h2><a name="wxWindows_support?"
>wxWindows support?</a></h2>

<p>David Cuny wondered if Parrot's objects were not at the point where it's possible to interface wxWindows to Parrot.
So far he's been Warnocked.</p>

<p>Just try implementing it David.</p>

<p><a href='http://groups.google.com/groups?selm=200312310021.20878.dcuny@lanset.com'>http://groups.google.com/groups?selm=200312310021.20878.dcuny@lanset.com</a></p>

<h2><a name="Win32_Core_Dumps"
>Win32 Core Dumps</a></h2>

<p>Dan's a fan of core dumps (when appropriate) and wondered if there was a way of getting windows to either produce a core dump or attach a debugger to a crashed process.
Vladimir Lipsky and Nigel Sandever gave good answers.</p>

<p><a href='http://groups.google.com/groups?selm=a06010206bc1895ed462f@[10.0.1.2]'>http://groups.google.com/groups?selm=a06010206bc1895ed462f@[10.0.1.2]</a></p>

<h2><a name="The_Piemark_is_ready"
>The Piemark is ready</a></h2>

<p>Dan forwarded the announcement that the Pie-thon Parrot Benchmark (which I've unilaterally decided to call the Piemark) code is ready.
Let's make sure it's Guido not Dan who gets Pie eyed in Portland this year.</p>

<p><a href='http://groups.google.com/groups?selm=a06010200bc18c1883507@[172.24.18.98]'>http://groups.google.com/groups?selm=a06010200bc18c1883507@[172.24.18.98]</a></p>

<p><a href='ftp://ftp.python.org/pub/python/parrotbench/parrotbench.tgz'>ftp://ftp.python.org/pub/python/parrotbench/parrotbench.tgz</a></p>

<h2><a name="Object_System?"
>Object System?</a></h2>

<p>Luke Palmer wondered what work was needed to finish up Parrot's object system.
Judging by Leo's response there are name mangling issues that need deciding on,
and we're not quite sure who's supposed to be making the decision.
Dan?</p>

<p><a href='http://groups.google.com/groups?selm=20031231210619.GA27582@babylonia.flatirons.org'>http://groups.google.com/groups?selm=20031231210619.GA27582@babylonia.flatirons.org</a></p>

<h2><a name="Enhancements_for_the_debugger"
>Enhancements for the debugger</a></h2>

<p>Whilst wearing his employee implementing a large project targetting Parrot hat,
Dan has been using IMCC's debugging facilities.
This led to a bunch of suggestions/decisions about how these could be improved.</p>

<p><a href='http://groups.google.com/groups?selm=a06010203bc1b7e26d061@[10.0.1.2]'>http://groups.google.com/groups?selm=a06010203bc1b7e26d061@[10.0.1.2]</a></p>

<h2><a name="NCI_callback_functions"
>NCI callback functions</a></h2>

<p>Leo isn't enamoured of the current PDD16 design of callbacks in NCI,
so he proposed a new design.
Dan seemed to think that this proposal smacked of getting a little to sophisticated to early,
arguing that the best thing to do was to flesh out what's there (and get it working) before using it as a base on which to build.
This means that,
once his work deadline is out of the way,
we should be expecting some better examples in PDD16.
And we'll be reminding Dan of this in a couple of weeks' time.</p>

<p><a href='http://groups.google.com/groups?selm=3FF86732.6090405@toetsch.at'>http://groups.google.com/groups?selm=3FF86732.6090405@toetsch.at</a></p>

<h1><a name="Meanwhile_in_perl6-language"
>Meanwhile in perl6-language</a></h1>

<p>Nobody said anything.
But that's boring,
so on Friday I sent an email out to various denizens of the Perl 6 mailing lists asking them for their thoughts on where Perl 6 stands today and where they think it's going in the next 12 months.
I'm pleased to say that,
despite the ludicrously short notice,
a decent number of people responded.</p>

<p>Everyone was remarkably consistent about where they think Perl 6 will be in the next year,
they all expect to see a 'useful' alpha released and running on Parrot by the end of next year.
Nat Torkington said that he didn't expect &quot;any more unexpected delays -- I believe the doctors have run out of things to remove from Larry.&quot; and I think I am sure we all hope he's right,
especially about the second part.</p>

<p>Leo T&#246;tsch said that back when he answered the &quot;Who's Who in Perl 6&quot; questionnaire back in 2002,
he'd said he thought Perl 6 would be out on 16 September 2004.
He asked to increment the year of that prediction by at least one.
Austin Hastings reckoned that we'd have a usable early version of Perl 6 sometime in Q2 or Q3,
and expects the object apocalypse some time in Q1.
However,
he expected that there'd be fairly substantial exegesis drift from the original apocalypse to the 'real' design.
Austin thinks that Perl 6's main 'cultural' impact will be grammars,
arguing that in 10 years time 'getting coders to stop parsing characters,
getting them instead to think,
code,
and word in terms of &quot;sentences&quot; or &quot;paragraphs&quot; will be considered a turning point.' Don't tell Austin this,
but I remember Ward Cunningham saying something similar (but less emphatic) to me after Damian's Perl6::Rules presentation at OSCON 2003.</p>

<p>Allison Randal's in the slightly less bullish camp,
arguing that it should be possible to produce a reasonably solid Perl 6 alpha in about 3 apocalypses time.
She reckoned that we may see Apocalypses 12,
17 and 9 finished this year,
and maybe a working prototype Perl 6 compiler.
Allison's house mate,
chromatic,
reckoned that we were about 80% done now (I'm not sure if he was deliberately invoking the old saw that the first 80% takes 80% of the time,
and the last 20% takes the other 80% of the time...).
He predicted that:</p>

<ol>
<li>Dan will win his bet with Guido,
and that the Python.Net people will be so embarrassed by the piemark that they won't publish numbers.</li>

<li>Perl 6 won't quite be self-hosting,
but it'll be usable for small apps.</li>

<li>NCI will continue to be much nicer than XS.</li>

<li>Apocalypse 12 will convince everyone that Roles are what object orientation should have had from the beginning.</li>
</ol>

<p>Asked for pithy comments,
chromatic gave good pith,
noting that if he 'had a test case from everyone who asked &quot;When'll it be done&quot; and code to pass a test case from everyone who said &quot;I'd like to help,
but I don't know where to start&quot;...' then he'd happily check them into the repository.
He also said that anyone who 'wants to revive the Perl 6 Documentation project,
start turning Apocalypses and Exegeses into story cards,
and story cards into tests' would be his hero.
And mine too.
He didn't mention <a href='http://p6stories.kwiki.org/'>http://p6stories.kwiki.org/</a> so I'll do that instead.</p>

<p>Adam Turoff sounded a note of caution; he worries that Perl 6 'is Larry's Modula 2' but he doesn't think that matters because the real boon is Parrot (and Ponie) which has the potential to open the existing work on CPAN up to any language that targets Parrot (potentially making good work in other languages available to us Perlers too).
He didn't think that Perl 6 will offer enough of an incentive for people to move to the new language from Perl 5.
Indeed,
he argued that the changes in syntax will put people off making the shift.
We discussed this on AIM,
personally I think Adam's wrong,
and that Perl 6 will have enough good new stuff in it that people will bite the bullet of the new syntax (and the changes are reasonably simple after all) in order to get access to Perl 6's goodies.
Adam certainly sees the change from Perl 5 to 6 as qualitatively different from the change from 4 to 5.
He thinks people aren't going to switch quickly (especially if Ponie fulfils their needs) and he points out that it's going to be a few years before we've worked out the best practices for using all this new stuff.</p>

<p>Sadly,
I didn't get any feedback from Larry before my deadline (if I do get something,
rest assured it'll get space in next week's summary).
I did get a lot from everyone's favourite evil genius though.
Damian is alive,
well and living in Australia.
It seems that his recent silence on p6l may have something to do with his hopes 'to see Exegesis 7 published (along with a full Perl 5 implementation of the new formatting module) by late January.' In other Conway related news,
he's attending linux.conf.au and will be attempting to describe the top 100 features of Perl 6 in 30 minutes.
After that,
he's 'set aside February through April to complete Perl6::Rules and a large test suite for Perl 6 regular expressions,
under a small grant generously provided by The Perl Foundation'.
Which can only be good news.</p>

<p>Me?
I think Perl 6's design 'in the large' will be pretty much done once Apocalypse 12 and its corresponding Exegesis are finished.
Of course,
the devil is in the details,
but I don't doubt that the hoped for existence of a working Perl6::Rules by the end of April is going to provide us with a great deal of the leverage we need to get a working Perl 6 alpha ready for OSCON with something rather more solid ready by the end of the year.
Parrot continues to amaze and delight with its progress; Dan tells me that he's about ready to roll out a large parrot based application for his employers,
so it's approaching the point where people's salaries will depend on Parrot.
I confess I wouldn't be surprised if,
by the end of the year,
we haven't seen the full implementation of at least one of the big non-Perl scripting languages on top of Parrot.</p>

<h1><a name="Acknowledgements,_Apologies,_Announcements."
>Acknowledgements,
Apologies,
Announcements.</a></h1>

<p>Many thanks to those of you who took the time to answer my mail about Perl 6 in the coming year.
Apologies to anyone who I may have offended by failing to ask them.
If you've got strong opinions about where you think Perl 6 is going,
let me know; I'll either make space for them next week make some space for discussion on my website.</p>

<p>If you find these summaries useful or enjoyable,
show your appreciation by contributing to the Perl Foundation to help support the ongoing development of Perl.
Money and time are both good.
Also,
I'm always pleased to get feedback at <csperl file="mailmunge" arg_email="p6summarizer@bofh.org.uk"> and traffic at my website.</p>

<p><a href='http://donate.perl-foundation.org/'>http://donate.perl-foundation.org/</a> -- The Perl Foundation</p>

<p><a href='http://www.bofh.org.uk:8080/'>http://www.bofh.org.uk:8080/</a> -- My website,
Just a Summary</p>

        </div>



    </div>
    <div class="asset-footer"></div>
</div>




                            <div class="content-nav">
                                <a href="/pub/2003/12/">&laquo; December 2003</a> |
                                <a href="/pub/">Main Index</a> |
                                <a href="/pub/archives.html">Archives</a>
                                | <a href="/pub/2004/02/">February 2004 &raquo;</a>
                            </div>


                        </div>
                    </div>


                    <div id="beta">
    <div id="beta-inner">


    
    <div class="widget-what-is-perl widget">
    <div class="widget-content widget-content-what-is-perl">
       Visit the home of the  Perl programming language: <a href="http://www.perl.org/">Perl.org</a
    </div>
</div>
<div class="widget-find-out-more widget-archives widget">
    <div class="widget-content">
        <ul>
            <li><a href="http://www.perl.org/get.html">Download</a></li>
            <li><a href="http://perldoc.perl.org/">Documentation</a></li>
            <li><a href="http://blogs.perl.org/">Perl Bloggers</a></li>
            <li><a href="http://news.perlfoundation.org/">Foundation News</a></li>
        </ul>
    </div>
</div><div class="widget-tcpc widget">
<h3 class="widget-header">Sponsored by</h3>
    <div class="widget-content">
        <a href="http://training.perl.com/" alt="Perl Training" target="_blank"><img src="/i/tcpc.png" width="150" height="50"></a>
    </div>
</div>

<div class="widget-syndication widget">
    <div class="widget-content">
        <ul>
            <li><img src="/mt-static/images/status_icons/feed.gif" alt="Subscribe to feed" width="9" height="9" /> <a href="/pub/atom.xml">Subscribe to this website's feed</a></li>

        </ul>
    </div>
</div>
<div class="widget-archive-monthly widget-archive widget">
    <h3 class="widget-header">Monthly <a href="/pub/archives.html">Archives</a></h3>
    <div class="widget-content">
        <ul>
        
            <li><a href="/pub/2014/02/">February 2014 (1)</a></li>
        
    
        
            <li><a href="/pub/2014/01/">January 2014 (1)</a></li>
        
    
        
            <li><a href="/pub/2013/10/">October 2013 (1)</a></li>
        
    
        
            <li><a href="/pub/2013/01/">January 2013 (1)</a></li>
        
    
        
            <li><a href="/pub/2012/12/">December 2012 (1)</a></li>
        
    
        
            <li><a href="/pub/2012/11/">November 2012 (1)</a></li>
        
    
        
            <li><a href="/pub/2012/10/">October 2012 (2)</a></li>
        
    
        
            <li><a href="/pub/2012/08/">August 2012 (2)</a></li>
        
    
        
            <li><a href="/pub/2012/06/">June 2012 (11)</a></li>
        
    
        
            <li><a href="/pub/2012/05/">May 2012 (18)</a></li>
        
    
        
            <li><a href="/pub/2012/04/">April 2012 (17)</a></li>
        
    
        
            <li><a href="/pub/2012/02/">February 2012 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/12/">December 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/09/">September 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/08/">August 2011 (2)</a></li>
        
    
        
            <li><a href="/pub/2011/06/">June 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/05/">May 2011 (3)</a></li>
        
    
        
            <li><a href="/pub/2011/04/">April 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/03/">March 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/02/">February 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2011/01/">January 2011 (1)</a></li>
        
    
        
            <li><a href="/pub/2010/11/">November 2010 (1)</a></li>
        
    
        
            <li><a href="/pub/2010/10/">October 2010 (2)</a></li>
        
    
        
            <li><a href="/pub/2010/09/">September 2010 (1)</a></li>
        
    
        
            <li><a href="/pub/2010/08/">August 2010 (3)</a></li>
        
    
        
            <li><a href="/pub/2010/07/">July 2010 (2)</a></li>
        
    
        
            <li><a href="/pub/2010/04/">April 2010 (2)</a></li>
        
    
        
            <li><a href="/pub/2010/03/">March 2010 (4)</a></li>
        
    
        
            <li><a href="/pub/2008/05/">May 2008 (1)</a></li>
        
    
        
            <li><a href="/pub/2008/04/">April 2008 (2)</a></li>
        
    
        
            <li><a href="/pub/2008/03/">March 2008 (1)</a></li>
        
    
        
            <li><a href="/pub/2008/02/">February 2008 (1)</a></li>
        
    
        
            <li><a href="/pub/2008/01/">January 2008 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/12/">December 2007 (2)</a></li>
        
    
        
            <li><a href="/pub/2007/09/">September 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/08/">August 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/07/">July 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/06/">June 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/05/">May 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/04/">April 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/03/">March 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/02/">February 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2007/01/">January 2007 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/12/">December 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/11/">November 2006 (2)</a></li>
        
    
        
            <li><a href="/pub/2006/10/">October 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/09/">September 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/08/">August 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/07/">July 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/06/">June 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/05/">May 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/04/">April 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/03/">March 2006 (1)</a></li>
        
    
        
            <li><a href="/pub/2006/02/">February 2006 (4)</a></li>
        
    
        
            <li><a href="/pub/2006/01/">January 2006 (4)</a></li>
        
    
        
            <li><a href="/pub/2005/12/">December 2005 (4)</a></li>
        
    
        
            <li><a href="/pub/2005/11/">November 2005 (3)</a></li>
        
    
        
            <li><a href="/pub/2005/10/">October 2005 (2)</a></li>
        
    
        
            <li><a href="/pub/2005/09/">September 2005 (2)</a></li>
        
    
        
            <li><a href="/pub/2005/08/">August 2005 (9)</a></li>
        
    
        
            <li><a href="/pub/2005/07/">July 2005 (8)</a></li>
        
    
        
            <li><a href="/pub/2005/06/">June 2005 (9)</a></li>
        
    
        
            <li><a href="/pub/2005/05/">May 2005 (8)</a></li>
        
    
        
            <li><a href="/pub/2005/04/">April 2005 (7)</a></li>
        
    
        
            <li><a href="/pub/2005/03/">March 2005 (6)</a></li>
        
    
        
            <li><a href="/pub/2005/02/">February 2005 (7)</a></li>
        
    
        
            <li><a href="/pub/2005/01/">January 2005 (6)</a></li>
        
    
        
            <li><a href="/pub/2004/12/">December 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/11/">November 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/10/">October 2004 (5)</a></li>
        
    
        
            <li><a href="/pub/2004/09/">September 2004 (9)</a></li>
        
    
        
            <li><a href="/pub/2004/08/">August 2004 (6)</a></li>
        
    
        
            <li><a href="/pub/2004/07/">July 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/06/">June 2004 (6)</a></li>
        
    
        
            <li><a href="/pub/2004/05/">May 2004 (7)</a></li>
        
    
        
            <li><a href="/pub/2004/04/">April 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/03/">March 2004 (8)</a></li>
        
    
        
            <li><a href="/pub/2004/02/">February 2004 (9)</a></li>
        
    
        
            <li><a href="/pub/2004/01/">January 2004 (7)</a></li>
        
    
        
            <li><a href="/pub/2003/12/">December 2003 (4)</a></li>
        
    
        
            <li><a href="/pub/2003/11/">November 2003 (7)</a></li>
        
    
        
            <li><a href="/pub/2003/10/">October 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2003/09/">September 2003 (6)</a></li>
        
    
        
            <li><a href="/pub/2003/08/">August 2003 (7)</a></li>
        
    
        
            <li><a href="/pub/2003/07/">July 2003 (9)</a></li>
        
    
        
            <li><a href="/pub/2003/06/">June 2003 (9)</a></li>
        
    
        
            <li><a href="/pub/2003/05/">May 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2003/04/">April 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2003/03/">March 2003 (10)</a></li>
        
    
        
            <li><a href="/pub/2003/02/">February 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2003/01/">January 2003 (8)</a></li>
        
    
        
            <li><a href="/pub/2002/12/">December 2002 (5)</a></li>
        
    
        
            <li><a href="/pub/2002/11/">November 2002 (9)</a></li>
        
    
        
            <li><a href="/pub/2002/10/">October 2002 (7)</a></li>
        
    
        
            <li><a href="/pub/2002/09/">September 2002 (11)</a></li>
        
    
        
            <li><a href="/pub/2002/08/">August 2002 (8)</a></li>
        
    
        
            <li><a href="/pub/2002/07/">July 2002 (8)</a></li>
        
    
        
            <li><a href="/pub/2002/06/">June 2002 (4)</a></li>
        
    
        
            <li><a href="/pub/2002/05/">May 2002 (6)</a></li>
        
    
        
            <li><a href="/pub/2002/04/">April 2002 (6)</a></li>
        
    
        
            <li><a href="/pub/2002/03/">March 2002 (7)</a></li>
        
    
        
            <li><a href="/pub/2002/02/">February 2002 (5)</a></li>
        
    
        
            <li><a href="/pub/2002/01/">January 2002 (8)</a></li>
        
    
        
            <li><a href="/pub/2001/12/">December 2001 (7)</a></li>
        
    
        
            <li><a href="/pub/2001/11/">November 2001 (5)</a></li>
        
    
        
            <li><a href="/pub/2001/10/">October 2001 (9)</a></li>
        
    
        
            <li><a href="/pub/2001/09/">September 2001 (7)</a></li>
        
    
        
            <li><a href="/pub/2001/08/">August 2001 (13)</a></li>
        
    
        
            <li><a href="/pub/2001/07/">July 2001 (8)</a></li>
        
    
        
            <li><a href="/pub/2001/06/">June 2001 (13)</a></li>
        
    
        
            <li><a href="/pub/2001/05/">May 2001 (11)</a></li>
        
    
        
            <li><a href="/pub/2001/04/">April 2001 (9)</a></li>
        
    
        
            <li><a href="/pub/2001/03/">March 2001 (8)</a></li>
        
    
        
            <li><a href="/pub/2001/02/">February 2001 (8)</a></li>
        
    
        
            <li><a href="/pub/2001/01/">January 2001 (8)</a></li>
        
    
        
            <li><a href="/pub/2000/12/">December 2000 (6)</a></li>
        
    
        
            <li><a href="/pub/2000/11/">November 2000 (10)</a></li>
        
    
        
            <li><a href="/pub/2000/10/">October 2000 (10)</a></li>
        
    
        
            <li><a href="/pub/2000/09/">September 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/2000/08/">August 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/2000/07/">July 2000 (5)</a></li>
        
    
        
            <li><a href="/pub/2000/06/">June 2000 (7)</a></li>
        
    
        
            <li><a href="/pub/2000/05/">May 2000 (7)</a></li>
        
    
        
            <li><a href="/pub/2000/04/">April 2000 (3)</a></li>
        
    
        
            <li><a href="/pub/2000/03/">March 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/2000/02/">February 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/2000/01/">January 2000 (2)</a></li>
        
    
        
            <li><a href="/pub/1999/12/">December 1999 (6)</a></li>
        
    
        
            <li><a href="/pub/1999/11/">November 1999 (6)</a></li>
        
    
        
            <li><a href="/pub/1999/10/">October 1999 (5)</a></li>
        
    
        
            <li><a href="/pub/1999/09/">September 1999 (4)</a></li>
        
    
        
            <li><a href="/pub/1999/08/">August 1999 (3)</a></li>
        
    
        
            <li><a href="/pub/1999/07/">July 1999 (2)</a></li>
        
    
        
            <li><a href="/pub/1999/06/">June 1999 (3)</a></li>
        
    
        
            <li><a href="/pub/1999/04/">April 1999 (1)</a></li>
        
    
        
            <li><a href="/pub/1999/03/">March 1999 (1)</a></li>
        
    
        
            <li><a href="/pub/1999/01/">January 1999 (1)</a></li>
        
    
        
            <li><a href="/pub/1998/12/">December 1998 (1)</a></li>
        
    
        
            <li><a href="/pub/1998/11/">November 1998 (1)</a></li>
        
    
        
            <li><a href="/pub/1998/07/">July 1998 (2)</a></li>
        
    
        
            <li><a href="/pub/1998/06/">June 1998 (1)</a></li>
        
    
        
            <li><a href="/pub/1998/03/">March 1998 (1)</a></li>
        
        </ul>
    </div>
</div>
        
    

<div class="widget-powered widget">
    <div class="widget-content">
        <a href="http://www.movabletype.com/"><img src="/mt-static/images/bug-pbmt-white.png" alt="Powered by Movable Type 5.13-en" width="120" height="75" /></a>
    </div>
</div>



    </div>
</div>






                </div>
            </div>


            <div id="footer">
    <div id="footer-inner">
        <div id="footer-content">
            <div class="widget-powered widget">
                <div class="widget-content">
                    Powered by <a href="http://www.movabletype.com/" rel="generator">Movable Type Pro</a>
                </div>
            </div>

            <div class="widget-creative-commons widget">
                <div class="widget-content">
                    This blog is licensed under a <a href="http://creativecommons.org/licenses/by-nc-nd/3.0/">Creative Commons License</a>.
                </div>
            </div>

        </div>
    </div>
</div>



        </div>
    </div>
</body>
</html>
